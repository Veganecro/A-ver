import{r as y5,t as $x,i as b5,a as Ba,b as $C,S as VC,c as WC,d as UC,e as mp,f as GC,g as hp,h as j5,j as S5,k as k5,l as ZC,m as w5,n as I5,o as M5,p as i0,q as _5,s as A5,u,R as te,v as c0,w as jd,x as P5,y as E5,z as D5,A as L5,P as T5,B as u0,C as R5,D as B5,E as O5,F as N5,G as j,L as F5,H as Vx,I as z5,J as H5,$ as $5,K as V5,M as R,N as s,O as We,Q as _l,U as L,T as ns,V as W5,W as J,X as Oa,Y as U5,Z as Qe,_ as _t,a0 as ic,a1 as Fe,a2 as js,a3 as qC,a4 as Ro,a5 as d0,a6 as QC,a7 as f0,a8 as m0,a9 as Pn,aa as Ss,ab as Na,ac as ot,ad as gn,ae as h0,af as nn,ag as Pt,ah as G5,ai as p0,aj as KC,ak as Z5,al as Fa,am as rf,an as YC,ao as jo,ap as q5,aq as cc,ar as Q5,as as K5,at as Wx,au as g0,av as Gr,aw as pe,ax as U,ay as Xe,az as eo,aA as x0,aB as wo,aC as Y5,aD as rs,aE as X5,aF as XC,aG as JC,aH as Ux,aI as J5,aJ as e6,aK as Sn,aL as Y,aM as kt,aN as gt,aO as Tl,aP as ey,aQ as t6,aR as Zr,aS as za,aT as v0,aU as qr,aV as n6,aW as Qr,aX as ur,aY as Ge,aZ as s6,a_ as Ue,a$ as $e,b0 as C0,b1 as Kr,b2 as Vn,b3 as o6,b4 as r6,b5 as l6,b6 as a6,b7 as Al,b8 as tr,b9 as Pl,ba as nr,bb as Ha,bc as sr,bd as ft,be as i6,bf as ss,bg as c6,bh as u6,bi as ty,bj as ny,bk as El,bl as d6,bm as je,bn as Gx,bo as y0,bp as dt,bq as b0,br as f6,bs as m6,bt as Or,bu as Aa,bv as Yr,bw as Zo,bx as it,by as uc,bz as sy,bA as lf,bB as zr,bC as Bi,bD as j0,bE as af,bF as cf,bG as zs,bH as oy,bI as h6,bJ as jt,bK as uf,bL as df,bM as ff,bN as p6,bO as ry,bP as Ca,bQ as Pr,bR as Cs,bS as g6,bT as x6,bU as v6,bV as wn,bW as jn,bX as ly,bY as C6,bZ as y6,b_ as b6,b$ as mf,c0 as hf,c1 as Zx,c2 as j6,c3 as Xo,c4 as S6,c5 as S0,c6 as k0,c7 as ay,c8 as pf,c9 as Er,ca as w0,cb as iy,cc as k6,cd as I0,ce as Eu,cf as Du,cg as Ci,ch as yh,ci as ld,cj as ad,ck as id,cl as cd,cm as qx,cn as Sd,co as bh,cp as pp,cq as Qx,cr as gp,cs as Kx,ct as xp,cu as ya,cv as vp,cw as Yx,cx as Ii,cy as jh,cz as Cp,cA as Sh,cB as kh,cC as wh,cD as Ih,cE as Lu,cF as yp,cG as Xx,cH as bp,cI as jp,cJ as Sp,cK as kp,cL as dc,cM as cy,cN as w6,cO as Jx,cP as gf,cQ as kd,cR as uy,cS as Bn,cT as yi,cU as oa,cV as xf,cW as dy,cX as Tu,cY as vf,cZ as I6,c_ as fy,c$ as Mh,d0 as Cf,d1 as M6,d2 as wp,d3 as my,d4 as hy,d5 as py,d6 as _6,d7 as gy,d8 as A6,d9 as xy,da as P6,db as vy,dc as E6,dd as Cy,de as D6,df as M0,dg as yy,dh as ls,di as _0,dj as by,dk as L6,dl as T6,dm as A0,dn as an,dp as e2,dq as R6,dr as Xr,ds as Jr,dt as wt,du as hn,dv as B6,dw as O6,dx as N6,dy as jy,dz as Sy,dA as yf,dB as bf,dC as ky,dD as P0,dE as F6,dF as z6,dG as H6,dH as wd,dI as or,dJ as wy,dK as Iy,dL as $6,dM as Rl,dN as An,dO as fc,dP as My,dQ as V6,dR as W6,dS as U6,dT as G6,dU as Z6,dV as q6,dW as Q6,dX as E0,dY as K6,dZ as Y6,d_ as X6,d$ as _y,e0 as J6,e1 as jf,e2 as eI,e3 as tI,e4 as nI,e5 as sI,e6 as D0,e7 as oI,e8 as rI,e9 as lI,ea as aI,eb as iI,ec as cI,ed as uI,ee as so,ef as Ay,eg as dI,eh as Id,ei as fI,ej as mI,ek as Pa,el as hI,em as pI,en as Py,eo as gI,ep as xI,eq as vI,er as CI,es as yI,et as bI,eu as jI,ev as SI,ew as kI,ex as wI,ey as II,ez as MI,eA as _I,eB as AI,eC as PI,eD as EI,eE as DI,eF as LI,eG as TI,eH as RI,eI as BI,eJ as OI,eK as NI,eL as FI,eM as zI,eN as HI,eO as $I,eP as VI,eQ as WI,eR as UI,eS as GI,eT as ZI,eU as qI,eV as QI,eW as KI,eX as Ey,eY as Dy,eZ as YI,e_ as XI,e$ as Oi,f0 as JI,f1 as eM,f2 as tM,f3 as Ly,f4 as mc,f5 as nM,f6 as sM,f7 as oM,f8 as rM,f9 as t2,fa as Ty,fb as lM,fc as aM,fd as Ry,fe as iM,ff as cM,fg as uM,fh as dM,fi as Sf,fj as By,fk as fM,fl as Oy,fm as mM,fn as hM,fo as Ru,fp as pM,fq as gM,fr as L0,fs as xM,ft as vM,fu as Ny,fv as CM,fw as $a,fx as yM,fy as bM,fz as jM,fA as SM,fB as kM,fC as wM,fD as IM,fE as MM,fF as _M,fG as AM,fH as $s,fI as PM,fJ as EM,fK as DM,fL as LM,fM as Ui,fN as Fy,fO as zy,fP as TM,fQ as RM,fR as BM,fS as OM,fT as NM,fU as n2,fV as s2,fW as FM,fX as zM,fY as HM,fZ as $M,f_ as VM,f$ as WM,g0 as UM,g1 as GM,g2 as ZM,g3 as qM,g4 as QM,g5 as KM,g6 as YM,g7 as XM,g8 as JM,g9 as e8,ga as t8,gb as n8,gc as s8,gd as o8,ge as r8,gf as l8,gg as a8,gh as i8,gi as c8,gj as T0,gk as u8,gl as d8,gm as f8,gn as Hy,go as $y,gp as Vy,gq as m8,gr as h8,gs as Wy,gt as p8,gu as Uy,gv as g8,gw as o2,gx as ud,gy as x8,gz as Md,gA as v8,gB as C8,gC as y8,gD as b8,gE as j8,gF as S8,gG as k8,gH as r2,gI as w8,gJ as I8,gK as Gy,gL as M8,gM as _8,gN as Zy,gO as qy,gP as Qy,gQ as A8,gR as P8,gS as E8,gT as Ky,gU as D8,gV as L8,gW as T8,gX as yl,gY as Yy,gZ as Xy,g_ as hc,g$ as Eo,h0 as Jy,h1 as eb,h2 as l2,h3 as R8,h4 as ca,h5 as Ip,h6 as Ir,h7 as B8,h8 as tb,h9 as O8,ha as N8,hb as F8,hc as z8,hd as H8,he as nb,hf as sb,hg as $8,hh as Sr,hi as ob,hj as rb,hk as V8,hl as lb,hm as W8,hn as U8,ho as G8,hp as Z8,hq as q8,hr as Q8,hs as K8,ht as Y8,hu as X8,hv as ab,hw as R0,hx as Mp,hy as J8,hz as ib,hA as e3,hB as a2,hC as B0,hD as cb,hE as t3,hF as O0,hG as kf,hH as ub,hI as n3,hJ as Ko,hK as s3,hL as Va,hM as db,hN as o3,hO as r3,hP as Mi,hQ as da,hR as l3,hS as a3,hT as i3,hU as c3,hV as i2,hW as c2,hX as u3,hY as d3,hZ as f3,h_ as m3,h$ as u2,i0 as h3,i1 as p3,i2 as g3,i3 as x3,i4 as v3,i5 as C3,i6 as d2,i7 as y3,i8 as b3,i9 as j3,ia as S3,ib as k3,ic as w3,id as I3,ie as M3,ig as _3,ih as A3,ii as pc,ij as P3,ik as E3,il as D3,im as L3,io as T3,ip as R3,iq as B3,ir as O3,is as N3,it as F3,iu as z3,iv as H3,iw as ln,ix as Dr,iy as Gi,iz as fb,iA as mb,iB as _d,iC as $3,iD as V3,iE as bi,iF as Ad,iG as dd,iH as N0,iI as F0,iJ as W3,iK as U3,iL as G3,iM as Zi,iN as Z3,iO as z0,iP as hb,iQ as q3,iR as Q3,iS as K3,iT as Y3,iU as _i,iV as X3,iW as J3,iX as e9,iY as t9,iZ as f2,i_ as fd,i$ as n9,j0 as pb,j1 as ra,j2 as s9,j3 as o9,j4 as r9,j5 as l9,j6 as m2,j7 as a9,j8 as i9,j9 as c9,ja as u9,jb as d9,jc as f9,jd as m9,je as h9,jf as p9,jg as g9,jh as _h,ji as Bu,jj as Ou,jk as fa,jl as Ai,jm as ji,jn as h2,jo as Ah,jp as p2,jq as x9,jr as gb,js as v9,jt as C9,ju as y9,jv as b9,jw as j9,jx as S9,jy as k9,jz as w9,jA as I9,jB as M9,jC as _9,jD as A9,jE as P9,jF as Ph,jG as E9,jH as D9,jI as L9,jJ as T9,jK as R9,jL as B9,jM as O9,jN as N9,jO as g2,jP as F9,jQ as z9,jR as H9,jS as $9,jT as V9,jU as W9,jV as U9,jW as G9,jX as Z9,jY as q9}from"./index-BM76ybxb.js";var Eh=function(){return y5.Date.now()},Q9="Expected a function",K9=Math.max,Y9=Math.min;function X9(e,t,n){var o,r,l,c,d,f,m=0,g=!1,p=!1,x=!0;if(typeof e!="function")throw new TypeError(Q9);t=$x(t)||0,b5(n)&&(g=!!n.leading,p="maxWait"in n,l=p?K9($x(n.maxWait)||0,t):l,x="trailing"in n?!!n.trailing:x);function y(A){var F=o,Q=r;return o=r=void 0,m=A,c=e.apply(Q,F),c}function S(A){return m=A,d=setTimeout(M,t),g?y(A):c}function b(A){var F=A-f,Q=A-m,q=t-F;return p?Y9(q,l-Q):q}function I(A){var F=A-f,Q=A-m;return f===void 0||F>=t||F<0||p&&Q>=l}function M(){var A=Eh();if(I(A))return w(A);d=setTimeout(M,b(A))}function w(A){return d=void 0,x&&o?y(A):(o=r=void 0,c)}function _(){d!==void 0&&clearTimeout(d),m=0,o=f=r=d=void 0}function T(){return d===void 0?c:w(Eh())}function D(){var A=Eh(),F=I(A);if(o=arguments,r=this,f=A,F){if(d===void 0)return S(f);if(p)return clearTimeout(d),d=setTimeout(M,t),y(f)}return d===void 0&&(d=setTimeout(M,t)),c}return D.cancel=_,D.flush=T,D}var J9=200;function e_(e,t,n,o){var r=-1,l=WC,c=!0,d=e.length,f=[],m=t.length;if(!d)return f;n&&(t=Ba(t,$C(n))),o?(l=UC,c=!1):t.length>=J9&&(l=mp,c=!1,t=new VC(t));e:for(;++r<d;){var g=e[r],p=n==null?g:n(g);if(g=o||g!==0?g:0,c&&p===p){for(var x=m;x--;)if(t[x]===p)continue e;f.push(g)}else l(t,p,o)||f.push(g)}return f}var t_=GC(function(e,t){return hp(e)?e_(e,j5(t,1,hp,!0)):[]});function n_(e,t){var n=-1,o=S5(e)?Array(e.length):[];return k5(e,function(r,l,c){o[++n]=t(r,l,c)}),o}function ys(e,t){var n=w5(e)?Ba:n_;return n(e,ZC(t))}var s_=Object.prototype,o_=s_.hasOwnProperty,r_=I5(function(e,t,n){o_.call(e,n)?e[n].push(t):M5(e,n,[t])});function l_(e,t){return Ba(t,function(n){return e[n]})}function a_(e){return e==null?[]:l_(e,i0(e))}var i_=Math.min;function c_(e,t,n){for(var o=n?UC:WC,r=e[0].length,l=e.length,c=l,d=Array(l),f=1/0,m=[];c--;){var g=e[c];c&&t&&(g=Ba(g,$C(t))),f=i_(g.length,f),d[c]=!n&&(t||r>=120&&g.length>=120)?new VC(c&&g):void 0}g=e[0];var p=-1,x=d[0];e:for(;++p<r&&m.length<f;){var y=g[p],S=t?t(y):y;if(y=n||y!==0?y:0,!(x?mp(x,S):o(m,S,n))){for(c=l;--c;){var b=d[c];if(!(b?mp(b,S):o(e[c],S,n)))continue e}x&&x.push(S),m.push(y)}}return m}function u_(e){return hp(e)?e:[]}var d_=GC(function(e){var t=Ba(e,u_);return t.length&&t[0]===e[0]?c_(t):[]});function zn(e){return e==null}function x2(e,t){if(e==null)return{};var n=Ba(_5(e),function(o){return[o]});return t=ZC(t),A5(e,n,function(o,r){return t(o,r[0])})}const xb=({id:e,x:t,y:n,width:o,height:r,style:l,color:c,strokeColor:d,strokeWidth:f,className:m,borderRadius:g,shapeRendering:p,onClick:x,selected:y})=>{const{background:S,backgroundColor:b}=l||{},I=c||S||b;return te.createElement("rect",{className:c0(["react-flow__minimap-node",{selected:y},m]),x:t,y:n,rx:g,ry:g,width:o,height:r,fill:I,stroke:d,strokeWidth:f,shapeRendering:p,onClick:x?M=>x(M,e):void 0})};xb.displayName="MiniMapNode";var f_=u.memo(xb);const m_=e=>e.nodeOrigin,h_=e=>e.getNodes().filter(t=>!t.hidden&&t.width&&t.height),Dh=e=>e instanceof Function?e:()=>e;function p_({nodeStrokeColor:e="transparent",nodeColor:t="#e2e2e2",nodeClassName:n="",nodeBorderRadius:o=5,nodeStrokeWidth:r=2,nodeComponent:l=f_,onClick:c}){const d=jd(h_,u0),f=jd(m_),m=Dh(t),g=Dh(e),p=Dh(n),x=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return te.createElement(te.Fragment,null,d.map(y=>{const{x:S,y:b}=P5(y,f).positionAbsolute;return te.createElement(l,{key:y.id,x:S,y:b,width:y.width,height:y.height,style:y.style,selected:y.selected,className:p(y),color:m(y),borderRadius:o,strokeColor:g(y),strokeWidth:r,shapeRendering:x,onClick:c,id:y.id})}))}var g_=u.memo(p_);const x_=200,v_=150,C_=e=>{const t=e.getNodes(),n={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:n,boundingRect:t.length>0?O5(N5(t,e.nodeOrigin),n):n,rfId:e.rfId}},y_="react-flow__minimap-desc";function vb({style:e,className:t,nodeStrokeColor:n="transparent",nodeColor:o="#e2e2e2",nodeClassName:r="",nodeBorderRadius:l=5,nodeStrokeWidth:c=2,nodeComponent:d,maskColor:f="rgb(240, 240, 240, 0.6)",maskStrokeColor:m="none",maskStrokeWidth:g=1,position:p="bottom-right",onClick:x,onNodeClick:y,pannable:S=!1,zoomable:b=!1,ariaLabel:I="React Flow mini map",inversePan:M=!1,zoomStep:w=10,offsetScale:_=5}){const T=E5(),D=u.useRef(null),{boundingRect:A,viewBB:F,rfId:Q}=jd(C_,u0),q=(e==null?void 0:e.width)??x_,G=(e==null?void 0:e.height)??v_,Z=A.width/q,N=A.height/G,z=Math.max(Z,N),$=z*q,se=z*G,he=_*z,ke=A.x-($-A.width)/2-he,Ce=A.y-(se-A.height)/2-he,ge=$+he*2,De=se+he*2,Se=`${y_}-${Q}`,oe=u.useRef(0);oe.current=z,u.useEffect(()=>{if(D.current){const P=D5(D.current),B=le=>{const{transform:fe,d3Selection:ue,d3Zoom:xe}=T.getState();if(le.sourceEvent.type!=="wheel"||!ue||!xe)return;const W=-le.sourceEvent.deltaY*(le.sourceEvent.deltaMode===1?.05:le.sourceEvent.deltaMode?1:.002)*w,Me=fe[2]*Math.pow(2,W);xe.scaleTo(ue,Me)},H=le=>{const{transform:fe,d3Selection:ue,d3Zoom:xe,translateExtent:W,width:Me,height:ye}=T.getState();if(le.sourceEvent.type!=="mousemove"||!ue||!xe)return;const Pe=oe.current*Math.max(1,fe[2])*(M?-1:1),Ve={x:fe[0]-le.sourceEvent.movementX*Pe,y:fe[1]-le.sourceEvent.movementY*Pe},Ye=[[0,0],[Me,ye]],O=R5.translate(Ve.x,Ve.y).scale(fe[2]),ne=xe.constrain()(O,Ye,W);xe.transform(ue,ne)},V=L5().on("zoom",S?H:null).on("zoom.wheel",b?B:null);return P.call(V),()=>{P.on("zoom",null)}}},[S,b,M,w]);const re=x?P=>{const B=B5(P);x(P,{x:B[0],y:B[1]})}:void 0,de=y?(P,B)=>{const H=T.getState().nodeInternals.get(B);y(P,H)}:void 0;return te.createElement(T5,{position:p,style:e,className:c0(["react-flow__minimap",t]),"data-testid":"rf__minimap"},te.createElement("svg",{width:q,height:G,viewBox:`${ke} ${Ce} ${ge} ${De}`,role:"img","aria-labelledby":Se,ref:D,onClick:re},I&&te.createElement("title",{id:Se},I),te.createElement(g_,{onClick:de,nodeColor:o,nodeStrokeColor:n,nodeBorderRadius:l,nodeClassName:r,nodeStrokeWidth:c,nodeComponent:d}),te.createElement("path",{className:"react-flow__minimap-mask",d:`M${ke-he},${Ce-he}h${ge+he*2}v${De+he*2}h${-ge-he*2}z
        M${F.x},${F.y}h${F.width}v${F.height}h${-F.width}z`,fill:f,fillRule:"evenodd",stroke:m,strokeWidth:g,pointerEvents:"none"})))}vb.displayName="MiniMap";var b_=u.memo(vb),to;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(to||(to={}));function j_({color:e,dimensions:t,lineWidth:n}){return te.createElement("path",{stroke:e,strokeWidth:n,d:`M${t[0]/2} 0 V${t[1]} M0 ${t[1]/2} H${t[0]}`})}function S_({color:e,radius:t}){return te.createElement("circle",{cx:t,cy:t,r:t,fill:e})}const k_={[to.Dots]:"#91919a",[to.Lines]:"#eee",[to.Cross]:"#e2e2e2"},w_={[to.Dots]:1,[to.Lines]:1,[to.Cross]:6},I_=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function Cb({id:e,variant:t=to.Dots,gap:n=20,size:o,lineWidth:r=1,offset:l=2,color:c,style:d,className:f}){const m=u.useRef(null),{transform:g,patternId:p}=jd(I_,u0),x=c||k_[t],y=o||w_[t],S=t===to.Dots,b=t===to.Cross,I=Array.isArray(n)?n:[n,n],M=[I[0]*g[2]||1,I[1]*g[2]||1],w=y*g[2],_=b?[w,w]:M,T=S?[w/l,w/l]:[_[0]/l,_[1]/l];return te.createElement("svg",{className:c0(["react-flow__background",f]),style:{...d,position:"absolute",width:"100%",height:"100%",top:0,left:0},ref:m,"data-testid":"rf__background"},te.createElement("pattern",{id:p+e,x:g[0]%M[0],y:g[1]%M[1],width:M[0],height:M[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${T[0]},-${T[1]})`},S?te.createElement(S_,{color:x,radius:w/l}):te.createElement(j_,{dimensions:_,color:x,lineWidth:r})),te.createElement("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${p+e})`}))}Cb.displayName="Background";var M_=u.memo(Cb);const yb=e=>{const t=j(r=>r.system.consoleLogLevel),n=j(r=>r.system.shouldLogToConsole);return u.useEffect(()=>{n?(localStorage.setItem("ROARR_LOG","true"),localStorage.setItem("ROARR_FILTER",`context.logLevel:>=${F5[t]}`)):localStorage.setItem("ROARR_LOG","false"),Vx.ROARR.write=z5.createLogWriter()},[t,n]),u.useEffect(()=>{const r={...H5};$5.set(Vx.Roarr.child(r))},[]),u.useMemo(()=>V5(e),[e])};function _p(){return _p=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},_p.apply(this,arguments)}var bb=["shift","alt","meta","mod","ctrl"],__={esc:"escape",return:"enter",".":"period",",":"comma","-":"slash"," ":"space","`":"backquote","#":"backslash","+":"bracketright",ShiftLeft:"shift",ShiftRight:"shift",AltLeft:"alt",AltRight:"alt",MetaLeft:"meta",MetaRight:"meta",OSLeft:"meta",OSRight:"meta",ControlLeft:"ctrl",ControlRight:"ctrl"};function Lr(e){return(__[e]||e).trim().toLowerCase().replace(/key|digit|numpad|arrow/,"")}function A_(e){return bb.includes(e)}function Lh(e,t){return t===void 0&&(t=","),e.split(t)}function Th(e,t,n){t===void 0&&(t="+");var o=e.toLocaleLowerCase().split(t).map(function(c){return Lr(c)}),r={alt:o.includes("alt"),ctrl:o.includes("ctrl")||o.includes("control"),shift:o.includes("shift"),meta:o.includes("meta"),mod:o.includes("mod")},l=o.filter(function(c){return!bb.includes(c)});return _p({},r,{keys:l,description:n})}(function(){typeof document<"u"&&(document.addEventListener("keydown",function(e){e.key!==void 0&&jb([Lr(e.key),Lr(e.code)])}),document.addEventListener("keyup",function(e){e.key!==void 0&&Sb([Lr(e.key),Lr(e.code)])})),typeof window<"u"&&window.addEventListener("blur",function(){Tr.clear()})})();var Tr=new Set;function H0(e){return Array.isArray(e)}function P_(e,t){t===void 0&&(t=",");var n=H0(e)?e:e.split(t);return n.every(function(o){return Tr.has(o.trim().toLowerCase())})}function jb(e){var t=Array.isArray(e)?e:[e];Tr.has("meta")&&Tr.forEach(function(n){return!A_(n)&&Tr.delete(n.toLowerCase())}),t.forEach(function(n){return Tr.add(n.toLowerCase())})}function Sb(e){var t=Array.isArray(e)?e:[e];e==="meta"?Tr.clear():t.forEach(function(n){return Tr.delete(n.toLowerCase())})}function E_(e,t,n){(typeof n=="function"&&n(e,t)||n===!0)&&e.preventDefault()}function D_(e,t,n){return typeof n=="function"?n(e,t):n===!0||n===void 0}function L_(e){return kb(e,["input","textarea","select"])}function kb(e,t){var n=e.target;t===void 0&&(t=!1);var o=n&&n.tagName;return H0(t)?!!(o&&t&&t.some(function(r){return r.toLowerCase()===o.toLowerCase()})):!!(o&&t&&t===!0)}function T_(e,t){return e.length===0&&t?(console.warn('A hotkey has the "scopes" option set, however no active scopes were found. If you want to use the global scopes feature, you need to wrap your app in a <HotkeysProvider>'),!0):t?e.some(function(n){return t.includes(n)})||e.includes("*"):!0}var R_=function(t,n,o){o===void 0&&(o=!1);var r=n.alt,l=n.meta,c=n.mod,d=n.shift,f=n.ctrl,m=n.keys,g=t.key,p=t.code,x=t.ctrlKey,y=t.metaKey,S=t.shiftKey,b=t.altKey,I=Lr(p),M=g.toLowerCase();if(!(m!=null&&m.includes(I))&&!(m!=null&&m.includes(M))&&!["ctrl","control","unknown","meta","alt","shift","os"].includes(I))return!1;if(!o){if(r===!b&&M!=="alt"||d===!S&&M!=="shift")return!1;if(c){if(!y&&!x)return!1}else if(l===!y&&M!=="meta"&&M!=="os"||f===!x&&M!=="ctrl"&&M!=="control")return!1}return m&&m.length===1&&(m.includes(M)||m.includes(I))?!0:m?P_(m):!m},B_=u.createContext(void 0),O_=function(){return u.useContext(B_)};function wb(e,t){return e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(e).length===Object.keys(t).length&&Object.keys(e).reduce(function(n,o){return n&&wb(e[o],t[o])},!0):e===t}var N_=u.createContext({hotkeys:[],enabledScopes:[],toggleScope:function(){},enableScope:function(){},disableScope:function(){}}),F_=function(){return u.useContext(N_)};function z_(e){var t=u.useRef(void 0);return wb(t.current,e)||(t.current=e),t.current}var v2=function(t){t.stopPropagation(),t.preventDefault(),t.stopImmediatePropagation()},H_=typeof window<"u"?u.useLayoutEffect:u.useEffect;function Oe(e,t,n,o){var r=u.useRef(null),l=u.useRef(!1),c=n instanceof Array?o instanceof Array?void 0:o:n,d=H0(e)?e.join(c==null?void 0:c.splitKey):e,f=n instanceof Array?n:o instanceof Array?o:void 0,m=u.useCallback(t,f??[]),g=u.useRef(m);f?g.current=m:g.current=t;var p=z_(c),x=F_(),y=x.enabledScopes,S=O_();return H_(function(){if(!((p==null?void 0:p.enabled)===!1||!T_(y,p==null?void 0:p.scopes))){var b=function(T,D){var A;if(D===void 0&&(D=!1),!(L_(T)&&!kb(T,p==null?void 0:p.enableOnFormTags))){if(r.current!==null){var F=r.current.getRootNode();if((F instanceof Document||F instanceof ShadowRoot)&&F.activeElement!==r.current&&!r.current.contains(F.activeElement)){v2(T);return}}(A=T.target)!=null&&A.isContentEditable&&!(p!=null&&p.enableOnContentEditable)||Lh(d,p==null?void 0:p.splitKey).forEach(function(Q){var q,G=Th(Q,p==null?void 0:p.combinationKey);if(R_(T,G,p==null?void 0:p.ignoreModifiers)||(q=G.keys)!=null&&q.includes("*")){if(p!=null&&p.ignoreEventWhen!=null&&p.ignoreEventWhen(T)||D&&l.current)return;if(E_(T,G,p==null?void 0:p.preventDefault),!D_(T,G,p==null?void 0:p.enabled)){v2(T);return}g.current(T,G),D||(l.current=!0)}})}},I=function(T){T.key!==void 0&&(jb(Lr(T.code)),((p==null?void 0:p.keydown)===void 0&&(p==null?void 0:p.keyup)!==!0||p!=null&&p.keydown)&&b(T))},M=function(T){T.key!==void 0&&(Sb(Lr(T.code)),l.current=!1,p!=null&&p.keyup&&b(T,!0))},w=r.current||(c==null?void 0:c.document)||document;return w.addEventListener("keyup",M),w.addEventListener("keydown",I),S&&Lh(d,p==null?void 0:p.splitKey).forEach(function(_){return S.addHotkey(Th(_,p==null?void 0:p.combinationKey,p==null?void 0:p.description))}),function(){w.removeEventListener("keyup",M),w.removeEventListener("keydown",I),S&&Lh(d,p==null?void 0:p.splitKey).forEach(function(_){return S.removeHotkey(Th(_,p==null?void 0:p.combinationKey,p==null?void 0:p.description))})}}},[d,p,y]),r}const $_={opacity:0},V_={opacity:1,transition:{duration:.1}},W_={opacity:0,transition:{duration:.1}},U_=e=>{const{t}=R(),{dropzone:n,setIsHandlingUpload:o}=e;return Oe("esc",()=>{o(!1)},[o]),s.jsxs(We,{initial:$_,animate:V_,exit:W_,as:_l.div,position:"absolute",top:0,insetInlineStart:0,width:"100vw",height:"100vh",zIndex:999,backdropFilter:"blur(20px)",children:[s.jsx(L,{position:"absolute",top:0,insetInlineStart:0,w:"full",h:"full",bg:"base.900",opacity:.7,alignItems:"center",justifyContent:"center",transitionProperty:"common",transitionDuration:"0.1s"}),s.jsx(L,{position:"absolute",top:0,insetInlineStart:0,width:"full",height:"full",alignItems:"center",justifyContent:"center",p:4,children:s.jsx(L,{width:"full",height:"full",alignItems:"center",justifyContent:"center",flexDir:"column",gap:4,borderWidth:3,borderRadius:"xl",borderStyle:"dashed",color:"base.100",borderColor:"base.200",children:n.isDragAccept?s.jsx(ns,{size:"lg",children:t("gallery.dropToUpload")}):s.jsxs(s.Fragment,{children:[s.jsx(ns,{size:"lg",children:t("toast.invalidUpload")}),s.jsx(ns,{size:"md",children:t("toast.uploadFailedInvalidUploadDesc")})]})})})]},"image-upload-overlay")},G_=u.memo(U_),Ib=()=>u.useCallback(()=>{W5(),localStorage.clear()},[]),Z_=()=>{const e=J(),t=j(o=>o.system.toastQueue),n=Oa();return u.useEffect(()=>{t.forEach(o=>{n(o)}),t.length>0&&e(U5())},[e,n,t]),null},ao=()=>{const e=J();return u.useCallback(n=>e(Qe(_t(n))),[e])},q_=u.memo(Z_);var Mb={exports:{}},Q_="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED",K_=Q_,Y_=K_;function _b(){}function Ab(){}Ab.resetWarningCache=_b;var X_=function(){function e(o,r,l,c,d,f){if(f!==Y_){var m=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw m.name="Invariant Violation",m}}e.isRequired=e;function t(){return e}var n={array:e,bigint:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:Ab,resetWarningCache:_b};return n.PropTypes=n,n};Mb.exports=X_();var J_=Mb.exports;const Dt=ic(J_);function Wa(e,t,n,o){function r(l){return l instanceof n?l:new n(function(c){c(l)})}return new(n||(n=Promise))(function(l,c){function d(g){try{m(o.next(g))}catch(p){c(p)}}function f(g){try{m(o.throw(g))}catch(p){c(p)}}function m(g){g.done?l(g.value):r(g.value).then(d,f)}m((o=o.apply(e,t||[])).next())})}function Ua(e,t){var n={label:0,sent:function(){if(l[0]&1)throw l[1];return l[1]},trys:[],ops:[]},o,r,l,c;return c={next:d(0),throw:d(1),return:d(2)},typeof Symbol=="function"&&(c[Symbol.iterator]=function(){return this}),c;function d(m){return function(g){return f([m,g])}}function f(m){if(o)throw new TypeError("Generator is already executing.");for(;c&&(c=0,m[0]&&(n=0)),n;)try{if(o=1,r&&(l=m[0]&2?r.return:m[0]?r.throw||((l=r.return)&&l.call(r),0):r.next)&&!(l=l.call(r,m[1])).done)return l;switch(r=0,l&&(m=[m[0]&2,l.value]),m[0]){case 0:case 1:l=m;break;case 4:return n.label++,{value:m[1],done:!1};case 5:n.label++,r=m[1],m=[0];continue;case 7:m=n.ops.pop(),n.trys.pop();continue;default:if(l=n.trys,!(l=l.length>0&&l[l.length-1])&&(m[0]===6||m[0]===2)){n=0;continue}if(m[0]===3&&(!l||m[1]>l[0]&&m[1]<l[3])){n.label=m[1];break}if(m[0]===6&&n.label<l[1]){n.label=l[1],l=m;break}if(l&&n.label<l[2]){n.label=l[2],n.ops.push(m);break}l[2]&&n.ops.pop(),n.trys.pop();continue}m=t.call(e,n)}catch(g){m=[6,g],r=0}finally{o=l=0}if(m[0]&5)throw m[1];return{value:m[0]?m[1]:void 0,done:!0}}}function C2(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var o=n.call(e),r,l=[],c;try{for(;(t===void 0||t-- >0)&&!(r=o.next()).done;)l.push(r.value)}catch(d){c={error:d}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(c)throw c.error}}return l}function y2(e,t,n){if(n||arguments.length===2)for(var o=0,r=t.length,l;o<r;o++)(l||!(o in t))&&(l||(l=Array.prototype.slice.call(t,0,o)),l[o]=t[o]);return e.concat(l||Array.prototype.slice.call(t))}var eA=new Map([["aac","audio/aac"],["abw","application/x-abiword"],["arc","application/x-freearc"],["avif","image/avif"],["avi","video/x-msvideo"],["azw","application/vnd.amazon.ebook"],["bin","application/octet-stream"],["bmp","image/bmp"],["bz","application/x-bzip"],["bz2","application/x-bzip2"],["cda","application/x-cdf"],["csh","application/x-csh"],["css","text/css"],["csv","text/csv"],["doc","application/msword"],["docx","application/vnd.openxmlformats-officedocument.wordprocessingml.document"],["eot","application/vnd.ms-fontobject"],["epub","application/epub+zip"],["gz","application/gzip"],["gif","image/gif"],["heic","image/heic"],["heif","image/heif"],["htm","text/html"],["html","text/html"],["ico","image/vnd.microsoft.icon"],["ics","text/calendar"],["jar","application/java-archive"],["jpeg","image/jpeg"],["jpg","image/jpeg"],["js","text/javascript"],["json","application/json"],["jsonld","application/ld+json"],["mid","audio/midi"],["midi","audio/midi"],["mjs","text/javascript"],["mp3","audio/mpeg"],["mp4","video/mp4"],["mpeg","video/mpeg"],["mpkg","application/vnd.apple.installer+xml"],["odp","application/vnd.oasis.opendocument.presentation"],["ods","application/vnd.oasis.opendocument.spreadsheet"],["odt","application/vnd.oasis.opendocument.text"],["oga","audio/ogg"],["ogv","video/ogg"],["ogx","application/ogg"],["opus","audio/opus"],["otf","font/otf"],["png","image/png"],["pdf","application/pdf"],["php","application/x-httpd-php"],["ppt","application/vnd.ms-powerpoint"],["pptx","application/vnd.openxmlformats-officedocument.presentationml.presentation"],["rar","application/vnd.rar"],["rtf","application/rtf"],["sh","application/x-sh"],["svg","image/svg+xml"],["swf","application/x-shockwave-flash"],["tar","application/x-tar"],["tif","image/tiff"],["tiff","image/tiff"],["ts","video/mp2t"],["ttf","font/ttf"],["txt","text/plain"],["vsd","application/vnd.visio"],["wav","audio/wav"],["weba","audio/webm"],["webm","video/webm"],["webp","image/webp"],["woff","font/woff"],["woff2","font/woff2"],["xhtml","application/xhtml+xml"],["xls","application/vnd.ms-excel"],["xlsx","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],["xml","application/xml"],["xul","application/vnd.mozilla.xul+xml"],["zip","application/zip"],["7z","application/x-7z-compressed"],["mkv","video/x-matroska"],["mov","video/quicktime"],["msg","application/vnd.ms-outlook"]]);function gc(e,t){var n=tA(e);if(typeof n.path!="string"){var o=e.webkitRelativePath;Object.defineProperty(n,"path",{value:typeof t=="string"?t:typeof o=="string"&&o.length>0?o:e.name,writable:!1,configurable:!1,enumerable:!0})}return n}function tA(e){var t=e.name,n=t&&t.lastIndexOf(".")!==-1;if(n&&!e.type){var o=t.split(".").pop().toLowerCase(),r=eA.get(o);r&&Object.defineProperty(e,"type",{value:r,writable:!1,configurable:!1,enumerable:!0})}return e}var nA=[".DS_Store","Thumbs.db"];function sA(e){return Wa(this,void 0,void 0,function(){return Ua(this,function(t){return Pd(e)&&oA(e.dataTransfer)?[2,iA(e.dataTransfer,e.type)]:rA(e)?[2,lA(e)]:Array.isArray(e)&&e.every(function(n){return"getFile"in n&&typeof n.getFile=="function"})?[2,aA(e)]:[2,[]]})})}function oA(e){return Pd(e)}function rA(e){return Pd(e)&&Pd(e.target)}function Pd(e){return typeof e=="object"&&e!==null}function lA(e){return Ap(e.target.files).map(function(t){return gc(t)})}function aA(e){return Wa(this,void 0,void 0,function(){var t;return Ua(this,function(n){switch(n.label){case 0:return[4,Promise.all(e.map(function(o){return o.getFile()}))];case 1:return t=n.sent(),[2,t.map(function(o){return gc(o)})]}})})}function iA(e,t){return Wa(this,void 0,void 0,function(){var n,o;return Ua(this,function(r){switch(r.label){case 0:return e.items?(n=Ap(e.items).filter(function(l){return l.kind==="file"}),t!=="drop"?[2,n]:[4,Promise.all(n.map(cA))]):[3,2];case 1:return o=r.sent(),[2,b2(Pb(o))];case 2:return[2,b2(Ap(e.files).map(function(l){return gc(l)}))]}})})}function b2(e){return e.filter(function(t){return nA.indexOf(t.name)===-1})}function Ap(e){if(e===null)return[];for(var t=[],n=0;n<e.length;n++){var o=e[n];t.push(o)}return t}function cA(e){if(typeof e.webkitGetAsEntry!="function")return j2(e);var t=e.webkitGetAsEntry();return t&&t.isDirectory?Eb(t):j2(e)}function Pb(e){return e.reduce(function(t,n){return y2(y2([],C2(t),!1),C2(Array.isArray(n)?Pb(n):[n]),!1)},[])}function j2(e){var t=e.getAsFile();if(!t)return Promise.reject("".concat(e," is not a File"));var n=gc(t);return Promise.resolve(n)}function uA(e){return Wa(this,void 0,void 0,function(){return Ua(this,function(t){return[2,e.isDirectory?Eb(e):dA(e)]})})}function Eb(e){var t=e.createReader();return new Promise(function(n,o){var r=[];function l(){var c=this;t.readEntries(function(d){return Wa(c,void 0,void 0,function(){var f,m,g;return Ua(this,function(p){switch(p.label){case 0:if(d.length)return[3,5];p.label=1;case 1:return p.trys.push([1,3,,4]),[4,Promise.all(r)];case 2:return f=p.sent(),n(f),[3,4];case 3:return m=p.sent(),o(m),[3,4];case 4:return[3,6];case 5:g=Promise.all(d.map(uA)),r.push(g),l(),p.label=6;case 6:return[2]}})})},function(d){o(d)})}l()})}function dA(e){return Wa(this,void 0,void 0,function(){return Ua(this,function(t){return[2,new Promise(function(n,o){e.file(function(r){var l=gc(r,e.fullPath);n(l)},function(r){o(r)})})]})})}var fA=function(e,t){if(e&&t){var n=Array.isArray(t)?t:t.split(","),o=e.name||"",r=(e.type||"").toLowerCase(),l=r.replace(/\/.*$/,"");return n.some(function(c){var d=c.trim().toLowerCase();return d.charAt(0)==="."?o.toLowerCase().endsWith(d):d.endsWith("/*")?l===d.replace(/\/.*$/,""):r===d})}return!0};function S2(e){return pA(e)||hA(e)||Lb(e)||mA()}function mA(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function hA(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function pA(e){if(Array.isArray(e))return Pp(e)}function k2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,o)}return n}function w2(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?k2(Object(n),!0).forEach(function(o){Db(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):k2(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function Db(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function qi(e,t){return vA(e)||xA(e,t)||Lb(e,t)||gA()}function gA(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Lb(e,t){if(e){if(typeof e=="string")return Pp(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Pp(e,t)}}function Pp(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function xA(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o=[],r=!0,l=!1,c,d;try{for(n=n.call(e);!(r=(c=n.next()).done)&&(o.push(c.value),!(t&&o.length===t));r=!0);}catch(f){l=!0,d=f}finally{try{!r&&n.return!=null&&n.return()}finally{if(l)throw d}}return o}}function vA(e){if(Array.isArray(e))return e}var CA="file-invalid-type",yA="file-too-large",bA="file-too-small",jA="too-many-files",SA=function(t){t=Array.isArray(t)&&t.length===1?t[0]:t;var n=Array.isArray(t)?"one of ".concat(t.join(", ")):t;return{code:CA,message:"File type must be ".concat(n)}},I2=function(t){return{code:yA,message:"File is larger than ".concat(t," ").concat(t===1?"byte":"bytes")}},M2=function(t){return{code:bA,message:"File is smaller than ".concat(t," ").concat(t===1?"byte":"bytes")}},kA={code:jA,message:"Too many files"};function Tb(e,t){var n=e.type==="application/x-moz-file"||fA(e,t);return[n,n?null:SA(t)]}function Rb(e,t,n){if(Cl(e.size))if(Cl(t)&&Cl(n)){if(e.size>n)return[!1,I2(n)];if(e.size<t)return[!1,M2(t)]}else{if(Cl(t)&&e.size<t)return[!1,M2(t)];if(Cl(n)&&e.size>n)return[!1,I2(n)]}return[!0,null]}function Cl(e){return e!=null}function wA(e){var t=e.files,n=e.accept,o=e.minSize,r=e.maxSize,l=e.multiple,c=e.maxFiles,d=e.validator;return!l&&t.length>1||l&&c>=1&&t.length>c?!1:t.every(function(f){var m=Tb(f,n),g=qi(m,1),p=g[0],x=Rb(f,o,r),y=qi(x,1),S=y[0],b=d?d(f):null;return p&&S&&!b})}function Ed(e){return typeof e.isPropagationStopped=="function"?e.isPropagationStopped():typeof e.cancelBubble<"u"?e.cancelBubble:!1}function Nu(e){return e.dataTransfer?Array.prototype.some.call(e.dataTransfer.types,function(t){return t==="Files"||t==="application/x-moz-file"}):!!e.target&&!!e.target.files}function _2(e){e.preventDefault()}function IA(e){return e.indexOf("MSIE")!==-1||e.indexOf("Trident/")!==-1}function MA(e){return e.indexOf("Edge/")!==-1}function _A(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:window.navigator.userAgent;return IA(e)||MA(e)}function yo(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(o){for(var r=arguments.length,l=new Array(r>1?r-1:0),c=1;c<r;c++)l[c-1]=arguments[c];return t.some(function(d){return!Ed(o)&&d&&d.apply(void 0,[o].concat(l)),Ed(o)})}}function AA(){return"showOpenFilePicker"in window}function PA(e){if(Cl(e)){var t=Object.entries(e).filter(function(n){var o=qi(n,2),r=o[0],l=o[1],c=!0;return Bb(r)||(console.warn('Skipped "'.concat(r,'" because it is not a valid MIME type. Check https://developer.mozilla.org/en-US/docs/Web/HTTP/Basics_of_HTTP/MIME_types/Common_types for a list of valid MIME types.')),c=!1),(!Array.isArray(l)||!l.every(Ob))&&(console.warn('Skipped "'.concat(r,'" because an invalid file extension was provided.')),c=!1),c}).reduce(function(n,o){var r=qi(o,2),l=r[0],c=r[1];return w2(w2({},n),{},Db({},l,c))},{});return[{description:"Files",accept:t}]}return e}function EA(e){if(Cl(e))return Object.entries(e).reduce(function(t,n){var o=qi(n,2),r=o[0],l=o[1];return[].concat(S2(t),[r],S2(l))},[]).filter(function(t){return Bb(t)||Ob(t)}).join(",")}function DA(e){return e instanceof DOMException&&(e.name==="AbortError"||e.code===e.ABORT_ERR)}function LA(e){return e instanceof DOMException&&(e.name==="SecurityError"||e.code===e.SECURITY_ERR)}function Bb(e){return e==="audio/*"||e==="video/*"||e==="image/*"||e==="text/*"||/\w+\/[-+.\w]+/g.test(e)}function Ob(e){return/^.*\.[\w]+$/.test(e)}var TA=["children"],RA=["open"],BA=["refKey","role","onKeyDown","onFocus","onBlur","onClick","onDragEnter","onDragOver","onDragLeave","onDrop"],OA=["refKey","onChange","onClick"];function NA(e){return HA(e)||zA(e)||Nb(e)||FA()}function FA(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function zA(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function HA(e){if(Array.isArray(e))return Ep(e)}function Rh(e,t){return WA(e)||VA(e,t)||Nb(e,t)||$A()}function $A(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Nb(e,t){if(e){if(typeof e=="string")return Ep(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);if(n==="Object"&&e.constructor&&(n=e.constructor.name),n==="Map"||n==="Set")return Array.from(e);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return Ep(e,t)}}function Ep(e,t){(t==null||t>e.length)&&(t=e.length);for(var n=0,o=new Array(t);n<t;n++)o[n]=e[n];return o}function VA(e,t){var n=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(n!=null){var o=[],r=!0,l=!1,c,d;try{for(n=n.call(e);!(r=(c=n.next()).done)&&(o.push(c.value),!(t&&o.length===t));r=!0);}catch(f){l=!0,d=f}finally{try{!r&&n.return!=null&&n.return()}finally{if(l)throw d}}return o}}function WA(e){if(Array.isArray(e))return e}function A2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,o)}return n}function qt(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?A2(Object(n),!0).forEach(function(o){Dp(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):A2(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function Dp(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function Dd(e,t){if(e==null)return{};var n=UA(e,t),o,r;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)o=l[r],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function UA(e,t){if(e==null)return{};var n={},o=Object.keys(e),r,l;for(l=0;l<o.length;l++)r=o[l],!(t.indexOf(r)>=0)&&(n[r]=e[r]);return n}var $0=u.forwardRef(function(e,t){var n=e.children,o=Dd(e,TA),r=wf(o),l=r.open,c=Dd(r,RA);return u.useImperativeHandle(t,function(){return{open:l}},[l]),te.createElement(u.Fragment,null,n(qt(qt({},c),{},{open:l})))});$0.displayName="Dropzone";var Fb={disabled:!1,getFilesFromEvent:sA,maxSize:1/0,minSize:0,multiple:!0,maxFiles:0,preventDropOnDocument:!0,noClick:!1,noKeyboard:!1,noDrag:!1,noDragEventsBubbling:!1,validator:null,useFsAccessApi:!0,autoFocus:!1};$0.defaultProps=Fb;$0.propTypes={children:Dt.func,accept:Dt.objectOf(Dt.arrayOf(Dt.string)),multiple:Dt.bool,preventDropOnDocument:Dt.bool,noClick:Dt.bool,noKeyboard:Dt.bool,noDrag:Dt.bool,noDragEventsBubbling:Dt.bool,minSize:Dt.number,maxSize:Dt.number,maxFiles:Dt.number,disabled:Dt.bool,getFilesFromEvent:Dt.func,onFileDialogCancel:Dt.func,onFileDialogOpen:Dt.func,useFsAccessApi:Dt.bool,autoFocus:Dt.bool,onDragEnter:Dt.func,onDragLeave:Dt.func,onDragOver:Dt.func,onDrop:Dt.func,onDropAccepted:Dt.func,onDropRejected:Dt.func,onError:Dt.func,validator:Dt.func};var Lp={isFocused:!1,isFileDialogActive:!1,isDragActive:!1,isDragAccept:!1,isDragReject:!1,acceptedFiles:[],fileRejections:[]};function wf(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},t=qt(qt({},Fb),e),n=t.accept,o=t.disabled,r=t.getFilesFromEvent,l=t.maxSize,c=t.minSize,d=t.multiple,f=t.maxFiles,m=t.onDragEnter,g=t.onDragLeave,p=t.onDragOver,x=t.onDrop,y=t.onDropAccepted,S=t.onDropRejected,b=t.onFileDialogCancel,I=t.onFileDialogOpen,M=t.useFsAccessApi,w=t.autoFocus,_=t.preventDropOnDocument,T=t.noClick,D=t.noKeyboard,A=t.noDrag,F=t.noDragEventsBubbling,Q=t.onError,q=t.validator,G=u.useMemo(function(){return EA(n)},[n]),Z=u.useMemo(function(){return PA(n)},[n]),N=u.useMemo(function(){return typeof I=="function"?I:P2},[I]),z=u.useMemo(function(){return typeof b=="function"?b:P2},[b]),$=u.useRef(null),se=u.useRef(null),he=u.useReducer(GA,Lp),ke=Rh(he,2),Ce=ke[0],ge=ke[1],De=Ce.isFocused,Se=Ce.isFileDialogActive,oe=u.useRef(typeof window<"u"&&window.isSecureContext&&M&&AA()),re=function(){!oe.current&&Se&&setTimeout(function(){if(se.current){var ve=se.current.files;ve.length||(ge({type:"closeDialog"}),z())}},300)};u.useEffect(function(){return window.addEventListener("focus",re,!1),function(){window.removeEventListener("focus",re,!1)}},[se,Se,z,oe]);var de=u.useRef([]),P=function(ve){$.current&&$.current.contains(ve.target)||(ve.preventDefault(),de.current=[])};u.useEffect(function(){return _&&(document.addEventListener("dragover",_2,!1),document.addEventListener("drop",P,!1)),function(){_&&(document.removeEventListener("dragover",_2),document.removeEventListener("drop",P))}},[$,_]),u.useEffect(function(){return!o&&w&&$.current&&$.current.focus(),function(){}},[$,w,o]);var B=u.useCallback(function(K){Q?Q(K):console.error(K)},[Q]),H=u.useCallback(function(K){K.preventDefault(),K.persist(),ne(K),de.current=[].concat(NA(de.current),[K.target]),Nu(K)&&Promise.resolve(r(K)).then(function(ve){if(!(Ed(K)&&!F)){var Ee=ve.length,Ze=Ee>0&&wA({files:ve,accept:G,minSize:c,maxSize:l,multiple:d,maxFiles:f,validator:q}),lt=Ee>0&&!Ze;ge({isDragAccept:Ze,isDragReject:lt,isDragActive:!0,type:"setDraggedFiles"}),m&&m(K)}}).catch(function(ve){return B(ve)})},[r,m,B,F,G,c,l,d,f,q]),V=u.useCallback(function(K){K.preventDefault(),K.persist(),ne(K);var ve=Nu(K);if(ve&&K.dataTransfer)try{K.dataTransfer.dropEffect="copy"}catch{}return ve&&p&&p(K),!1},[p,F]),le=u.useCallback(function(K){K.preventDefault(),K.persist(),ne(K);var ve=de.current.filter(function(Ze){return $.current&&$.current.contains(Ze)}),Ee=ve.indexOf(K.target);Ee!==-1&&ve.splice(Ee,1),de.current=ve,!(ve.length>0)&&(ge({type:"setDraggedFiles",isDragActive:!1,isDragAccept:!1,isDragReject:!1}),Nu(K)&&g&&g(K))},[$,g,F]),fe=u.useCallback(function(K,ve){var Ee=[],Ze=[];K.forEach(function(lt){var St=Tb(lt,G),Ot=Rh(St,2),Xt=Ot[0],Jt=Ot[1],xn=Rb(lt,c,l),on=Rh(xn,2),en=on[0],Tt=on[1],is=q?q(lt):null;if(Xt&&en&&!is)Ee.push(lt);else{var cn=[Jt,Tt];is&&(cn=cn.concat(is)),Ze.push({file:lt,errors:cn.filter(function(_s){return _s})})}}),(!d&&Ee.length>1||d&&f>=1&&Ee.length>f)&&(Ee.forEach(function(lt){Ze.push({file:lt,errors:[kA]})}),Ee.splice(0)),ge({acceptedFiles:Ee,fileRejections:Ze,type:"setFiles"}),x&&x(Ee,Ze,ve),Ze.length>0&&S&&S(Ze,ve),Ee.length>0&&y&&y(Ee,ve)},[ge,d,G,c,l,f,x,y,S,q]),ue=u.useCallback(function(K){K.preventDefault(),K.persist(),ne(K),de.current=[],Nu(K)&&Promise.resolve(r(K)).then(function(ve){Ed(K)&&!F||fe(ve,K)}).catch(function(ve){return B(ve)}),ge({type:"reset"})},[r,fe,B,F]),xe=u.useCallback(function(){if(oe.current){ge({type:"openDialog"}),N();var K={multiple:d,types:Z};window.showOpenFilePicker(K).then(function(ve){return r(ve)}).then(function(ve){fe(ve,null),ge({type:"closeDialog"})}).catch(function(ve){DA(ve)?(z(ve),ge({type:"closeDialog"})):LA(ve)?(oe.current=!1,se.current?(se.current.value=null,se.current.click()):B(new Error("Cannot open the file picker because the https://developer.mozilla.org/en-US/docs/Web/API/File_System_Access_API is not supported and no <input> was provided."))):B(ve)});return}se.current&&(ge({type:"openDialog"}),N(),se.current.value=null,se.current.click())},[ge,N,z,M,fe,B,Z,d]),W=u.useCallback(function(K){!$.current||!$.current.isEqualNode(K.target)||(K.key===" "||K.key==="Enter"||K.keyCode===32||K.keyCode===13)&&(K.preventDefault(),xe())},[$,xe]),Me=u.useCallback(function(){ge({type:"focus"})},[]),ye=u.useCallback(function(){ge({type:"blur"})},[]),Pe=u.useCallback(function(){T||(_A()?setTimeout(xe,0):xe())},[T,xe]),Ve=function(ve){return o?null:ve},Ye=function(ve){return D?null:Ve(ve)},O=function(ve){return A?null:Ve(ve)},ne=function(ve){F&&ve.stopPropagation()},ce=u.useMemo(function(){return function(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ve=K.refKey,Ee=ve===void 0?"ref":ve,Ze=K.role,lt=K.onKeyDown,St=K.onFocus,Ot=K.onBlur,Xt=K.onClick,Jt=K.onDragEnter,xn=K.onDragOver,on=K.onDragLeave,en=K.onDrop,Tt=Dd(K,BA);return qt(qt(Dp({onKeyDown:Ye(yo(lt,W)),onFocus:Ye(yo(St,Me)),onBlur:Ye(yo(Ot,ye)),onClick:Ve(yo(Xt,Pe)),onDragEnter:O(yo(Jt,H)),onDragOver:O(yo(xn,V)),onDragLeave:O(yo(on,le)),onDrop:O(yo(en,ue)),role:typeof Ze=="string"&&Ze!==""?Ze:"presentation"},Ee,$),!o&&!D?{tabIndex:0}:{}),Tt)}},[$,W,Me,ye,Pe,H,V,le,ue,D,A,o]),_e=u.useCallback(function(K){K.stopPropagation()},[]),be=u.useMemo(function(){return function(){var K=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},ve=K.refKey,Ee=ve===void 0?"ref":ve,Ze=K.onChange,lt=K.onClick,St=Dd(K,OA),Ot=Dp({accept:G,multiple:d,type:"file",style:{display:"none"},onChange:Ve(yo(Ze,ue)),onClick:Ve(yo(lt,_e)),tabIndex:-1},Ee,se);return qt(qt({},Ot),St)}},[se,n,d,ue,o]);return qt(qt({},Ce),{},{isFocused:De&&!o,getRootProps:ce,getInputProps:be,rootRef:$,inputRef:se,open:Ve(xe)})}function GA(e,t){switch(t.type){case"focus":return qt(qt({},e),{},{isFocused:!0});case"blur":return qt(qt({},e),{},{isFocused:!1});case"openDialog":return qt(qt({},Lp),{},{isFileDialogActive:!0});case"closeDialog":return qt(qt({},e),{},{isFileDialogActive:!1});case"setDraggedFiles":return qt(qt({},e),{},{isDragActive:t.isDragActive,isDragAccept:t.isDragAccept,isDragReject:t.isDragReject});case"setFiles":return qt(qt({},e),{},{acceptedFiles:t.acceptedFiles,fileRejections:t.fileRejections});case"reset":return qt({},Lp);default:return e}}function P2(){}const ZA={"image/png":[".png"],"image/jpeg":[".jpg",".jpeg",".png"]},qA=Fe(js,e=>{let t={type:"TOAST"};return e==="unifiedCanvas"&&(t={type:"SET_CANVAS_INITIAL_IMAGE"}),e==="img2img"&&(t={type:"SET_INITIAL_IMAGE"}),t}),QA=()=>{const{t:e}=R(),t=ao(),n=j(qA),o=j(x=>x.gallery.autoAddBoardId),[r,l]=u.useState(!1),[c]=qC(),d=u.useCallback(x=>{l(!0),t({title:e("toast.uploadFailed"),description:x.errors.map(y=>y.message).join(`
`),status:"error"})},[e,t]),f=u.useCallback(async x=>{c({file:x,image_category:"user",is_intermediate:!1,postUploadAction:n,board_id:o==="none"?void 0:o})},[o,n,c]),m=u.useCallback((x,y)=>{if(y.length>1){t({title:e("toast.uploadFailed"),description:e("toast.uploadFailedInvalidUploadDesc"),status:"error"});return}y.forEach(S=>{d(S)}),x.forEach(S=>{f(S)})},[e,t,f,d]),g=u.useCallback(()=>{l(!0)},[]),p=wf({accept:ZA,noClick:!0,onDrop:m,onDragOver:g,multiple:!1,noKeyboard:!0});return u.useEffect(()=>{const x=async y=>{var S,b;p.inputRef.current&&(S=y.clipboardData)!=null&&S.files&&(p.inputRef.current.files=y.clipboardData.files,(b=p.inputRef.current)==null||b.dispatchEvent(new Event("change",{bubbles:!0})))};return document.addEventListener("paste",x),()=>{document.removeEventListener("paste",x)}},[p.inputRef]),{dropzone:p,isHandlingUpload:r,setIsHandlingUpload:l}},V0=()=>{const e=j(m=>m.system.isConnected),{data:t}=Ro(),[n,{isLoading:o}]=d0(),r=J(),{t:l}=R(),c=u.useMemo(()=>t==null?void 0:t.queue.item_id,[t==null?void 0:t.queue.item_id]),d=u.useCallback(async()=>{if(c)try{await n(c).unwrap(),r(Qe({title:l("queue.cancelSucceeded"),status:"success"}))}catch{r(Qe({title:l("queue.cancelFailed"),status:"error"}))}},[c,r,l,n]),f=u.useMemo(()=>!e||zn(c),[e,c]);return{cancelQueueItem:d,isLoading:o,currentQueueItemId:c,isDisabled:f}},xc=()=>{const{t:e}=R(),t=J(),{data:n}=Ro(),o=j(f=>f.system.isConnected),[r,{isLoading:l}]=QC({fixedCacheKey:"clearQueue"}),c=u.useCallback(async()=>{if(n!=null&&n.queue.total)try{await r().unwrap(),t(Qe({title:e("queue.clearSucceeded"),status:"success"})),t(f0(void 0)),t(m0(void 0))}catch{t(Qe({title:e("queue.clearFailed"),status:"error"}))}},[n==null?void 0:n.queue.total,r,t,e]),d=u.useMemo(()=>!o||!(n!=null&&n.queue.total),[o,n==null?void 0:n.queue.total]);return{clearQueue:c,isLoading:l,queueStatus:n,isDisabled:d}},KA=Fe([Pn,Ss,Na,ot,gn,h0,js],(e,t,n,o,r,l,c)=>{const{initialImage:d,model:f,positivePrompt:m}=t,{isConnected:g}=n,p=[];return g||p.push(nn.t("parameters.invoke.systemDisconnected")),c==="img2img"&&!d&&p.push(nn.t("parameters.invoke.noInitialImageSelected")),c==="nodes"?o.shouldValidateGraph&&(o.nodes.length||p.push(nn.t("parameters.invoke.noNodesInGraph")),o.nodes.forEach(x=>{if(!Pt(x))return;const y=r.templates[x.data.type];if(!y){p.push(nn.t("parameters.invoke.missingNodeTemplate"));return}const S=G5([x],o.edges);p0(x.data.inputs,b=>{const I=y.inputs[b.name],M=S.some(w=>w.target===x.id&&w.targetHandle===b.name);if(!I){p.push(nn.t("parameters.invoke.missingFieldTemplate"));return}if(I.required&&b.value===void 0&&!M){p.push(nn.t("parameters.invoke.missingInputForField",{nodeLabel:x.data.label||y.title,fieldLabel:b.label||I.title}));return}})})):(l.prompts.length===0&&KC(m)&&p.push(nn.t("parameters.invoke.noPrompts")),f||p.push(nn.t("parameters.invoke.noModelSelected")),Z5(e).forEach((x,y)=>{x.isEnabled&&(x.model?x.model.base_model!==(f==null?void 0:f.base_model)&&p.push(nn.t("parameters.invoke.incompatibleBaseModelForControlAdapter",{number:y+1})):p.push(nn.t("parameters.invoke.noModelForControlAdapter",{number:y+1})),(!x.controlImage||Fa(x)&&!x.processedControlImage&&x.processorType!=="none")&&p.push(nn.t("parameters.invoke.noControlImageForControlAdapter",{number:y+1})))})),{isReady:!p.length,reasons:p}}),W0=()=>{const{isReady:e,reasons:t}=j(KA);return{isReady:e,reasons:t}},U0=()=>{const e=J(),t=j(js),{isReady:n}=W0(),[o,{isLoading:r}]=rf({fixedCacheKey:"enqueueBatch"}),l=u.useMemo(()=>!n,[n]);return{queueBack:u.useCallback(()=>{l||e(YC({tabName:t,prepend:!1}))},[e,l,t]),isLoading:r,isDisabled:l}},Kt=e=>{const t=j(c=>c.config.disabledTabs),n=j(c=>c.config.disabledFeatures),o=j(c=>c.config.disabledSDFeatures),r=u.useMemo(()=>n.includes(e)||o.includes(e)||t.includes(e),[n,o,t,e]),l=u.useMemo(()=>!(n.includes(e)||o.includes(e)||t.includes(e)),[n,o,t,e]);return{isFeatureDisabled:r,isFeatureEnabled:l}},zb=()=>{const e=J(),t=j(js),{isReady:n}=W0(),[o,{isLoading:r}]=rf({fixedCacheKey:"enqueueBatch"}),l=Kt("prependQueue").isFeatureEnabled,c=u.useMemo(()=>!n||!l,[n,l]);return{queueFront:u.useCallback(()=>{c||e(YC({tabName:t,prepend:!0}))},[e,c,t]),isLoading:r,isDisabled:c}},YA=()=>{const e=J(),t=Kt("modelManager").isFeatureEnabled,{queueBack:n,isDisabled:o,isLoading:r}=U0();Oe(["ctrl+enter","meta+enter"],n,{enabled:()=>!o&&!r,preventDefault:!0,enableOnFormTags:["input","textarea","select"]},[n,o,r]);const{queueFront:l,isDisabled:c,isLoading:d}=zb();Oe(["ctrl+shift+enter","meta+shift+enter"],l,{enabled:()=>!c&&!d,preventDefault:!0,enableOnFormTags:["input","textarea","select"]},[l,c,d]);const{cancelQueueItem:f,isDisabled:m,isLoading:g}=V0();Oe(["shift+x"],f,{enabled:()=>!m&&!g,preventDefault:!0},[f,m,g]);const{clearQueue:p,isDisabled:x,isLoading:y}=xc();Oe(["ctrl+shift+x","meta+shift+x"],p,{enabled:()=>!x&&!y,preventDefault:!0},[p,x,y]),Oe("1",()=>{e(jo("txt2img"))},[e]),Oe("2",()=>{e(jo("img2img"))},[e]),Oe("3",()=>{e(jo("unifiedCanvas"))},[e]),Oe("4",()=>{e(jo("nodes"))},[e]),Oe("5",()=>{t&&e(jo("modelManager"))},[e,t]),Oe(t?"6":"5",()=>{e(jo("queue"))},[e,t])},XA=Fe(q5,e=>e.imagesToChange),JA=()=>{const e=J(),[t,n]=u.useState(),{data:o,isFetching:r}=cc(),l=j(b=>b.changeBoardModal.isModalOpen),c=j(XA),[d]=Q5(),[f]=K5(),{t:m}=R(),g=u.useMemo(()=>[{label:m("boards.uncategorized"),value:"none"}].concat((o??[]).map(b=>({label:b.board_name,value:b.board_id}))),[o,m]),p=u.useMemo(()=>g.find(b=>b.value===t),[g,t]),x=u.useCallback(()=>{e(Wx()),e(g0(!1))},[e]),y=u.useCallback(()=>{!c.length||!t||(t==="none"?f({imageDTOs:c}):d({imageDTOs:c,board_id:t}),n(null),e(Wx()))},[d,e,c,f,t]),S=u.useCallback(b=>{b&&n(b.value)},[]);return s.jsx(Gr,{isOpen:l,onClose:x,title:m("boards.changeBoard"),acceptCallback:y,acceptButtonText:m("boards.move"),cancelButtonText:m("boards.cancel"),children:s.jsxs(L,{flexDir:"column",gap:4,children:[s.jsxs(pe,{children:[m("boards.movingImagesToBoard",{count:c.length}),":"]}),s.jsx(U,{isDisabled:r,children:s.jsx(Xe,{placeholder:m(r?"boards.loading":"boards.selectBoard"),onChange:S,value:p,options:g})})]})})},e7=u.memo(JA),t7=e=>{const{t}=R(),{imageUsage:n,topMessage:o=t("gallery.currentlyInUse"),bottomMessage:r=t("gallery.featuresWillReset")}=e;return!n||!eo(n)?null:s.jsxs(s.Fragment,{children:[s.jsx(pe,{children:o}),s.jsxs(x0,{paddingInlineStart:6,children:[n.isInitialImage&&s.jsx(wo,{children:t("common.img2img")}),n.isCanvasImage&&s.jsx(wo,{children:t("common.unifiedCanvas")}),n.isControlImage&&s.jsx(wo,{children:t("common.controlNet")}),n.isNodesImage&&s.jsx(wo,{children:t("common.nodeEditor")})]}),s.jsx(pe,{children:r})]})},Hb=u.memo(t7),n7=Fe([Y5,Ss,rs,ot,Pn,X5],(e,t,n,o,r,l)=>{const{imagesToDelete:c}=e,d=(c??[]).map(({image_name:m})=>XC(t,n,o,r,m)),f={isInitialImage:eo(d,m=>m.isInitialImage),isCanvasImage:eo(d,m=>m.isCanvasImage),isNodesImage:eo(d,m=>m.isNodesImage),isControlImage:eo(d,m=>m.isControlImage)};return{imagesToDelete:c,imagesUsage:l,imageUsageSummary:f}}),s7=()=>{const e=J(),{t}=R(),n=j(p=>p.system.shouldConfirmOnDelete),o=j(p=>p.config.canRestoreDeletedImagesFromBin),r=j(p=>p.deleteImageModal.isModalOpen),{imagesToDelete:l,imagesUsage:c,imageUsageSummary:d}=j(n7),f=u.useCallback(p=>e(JC(!p.target.checked)),[e]),m=u.useCallback(()=>{e(Ux()),e(J5(!1))},[e]),g=u.useCallback(()=>{!l.length||!c.length||(e(Ux()),e(e6({imageDTOs:l,imagesUsage:c})))},[e,l,c]);return s.jsx(Gr,{title:t("gallery.deleteImage"),isOpen:r,onClose:m,cancelButtonText:t("boards.cancel"),acceptButtonText:t("controlnet.delete"),acceptCallback:g,children:s.jsxs(L,{direction:"column",gap:3,children:[s.jsx(Hb,{imageUsage:d}),s.jsx(Sn,{}),s.jsx(pe,{children:t(o?"gallery.deleteImageBin":"gallery.deleteImagePermanent")}),s.jsx(pe,{children:t("common.areYouSure")}),s.jsxs(U,{children:[s.jsx(Y,{children:t("common.dontAskMeAgain")}),s.jsx(kt,{isChecked:!n,onChange:f})]})]})})},o7=u.memo(s7),Bh=Tl(!1),$b=()=>{const e=gt(Bh),t=u.useCallback(()=>{Bh.set(!0)},[]),n=u.useCallback(()=>{Bh.set(!1)},[]);return{isOpen:e,onOpen:t,onClose:n}};var Vb={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},E2=te.createContext&&te.createContext(Vb),r7=["attr","size","title"];function l7(e,t){if(e==null)return{};var n=a7(e,t),o,r;if(Object.getOwnPropertySymbols){var l=Object.getOwnPropertySymbols(e);for(r=0;r<l.length;r++)o=l[r],!(t.indexOf(o)>=0)&&Object.prototype.propertyIsEnumerable.call(e,o)&&(n[o]=e[o])}return n}function a7(e,t){if(e==null)return{};var n={},o=Object.keys(e),r,l;for(l=0;l<o.length;l++)r=o[l],!(t.indexOf(r)>=0)&&(n[r]=e[r]);return n}function Ld(){return Ld=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e},Ld.apply(this,arguments)}function D2(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);t&&(o=o.filter(function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable})),n.push.apply(n,o)}return n}function Td(e){for(var t=1;t<arguments.length;t++){var n=arguments[t]!=null?arguments[t]:{};t%2?D2(Object(n),!0).forEach(function(o){i7(e,o,n[o])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):D2(Object(n)).forEach(function(o){Object.defineProperty(e,o,Object.getOwnPropertyDescriptor(n,o))})}return e}function i7(e,t,n){return t=c7(t),t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function c7(e){var t=u7(e,"string");return typeof t=="symbol"?t:String(t)}function u7(e,t){if(typeof e!="object"||e===null)return e;var n=e[Symbol.toPrimitive];if(n!==void 0){var o=n.call(e,t||"default");if(typeof o!="object")return o;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(e)}function Wb(e){return e&&e.map((t,n)=>te.createElement(t.tag,Td({key:n},t.attr),Wb(t.child)))}function Ie(e){return t=>te.createElement(d7,Ld({attr:Td({},e.attr)},t),Wb(e.child))}function d7(e){var t=n=>{var{attr:o,size:r,title:l}=e,c=l7(e,r7),d=r||n.size||"1em",f;return n.className&&(f=n.className),e.className&&(f=(f?f+" ":"")+e.className),te.createElement("svg",Ld({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,o,c,{className:f,style:Td(Td({color:e.color||n.color},n.style),e.style),height:d,width:d,xmlns:"http://www.w3.org/2000/svg"}),l&&te.createElement("title",null,l),e.children)};return E2!==void 0?te.createElement(E2.Consumer,null,n=>t(n)):t(Vb)}function f7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M244,56v48a12,12,0,0,1-12,12H184a12,12,0,1,1,0-24H201.1l-19-17.38c-.13-.12-.26-.24-.38-.37A76,76,0,1,0,127,204h1a75.53,75.53,0,0,0,52.15-20.72,12,12,0,0,1,16.49,17.45A99.45,99.45,0,0,1,128,228h-1.37A100,100,0,1,1,198.51,57.06L220,76.72V56a12,12,0,0,1,24,0Z"},child:[]}]})(e)}function vc(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,128a100,100,0,0,1-98.66,100H128a99.39,99.39,0,0,1-68.62-27.29,12,12,0,0,1,16.48-17.45,76,76,0,1,0-1.57-109c-.13.13-.25.25-.39.37L54.89,92H72a12,12,0,0,1,0,24H24a12,12,0,0,1-12-12V56a12,12,0,0,1,24,0V76.72L57.48,57.06A100,100,0,0,1,228,128Z"},child:[]}]})(e)}function m7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,128a12,12,0,0,1-12,12H69l51.52,51.51a12,12,0,0,1-17,17l-72-72a12,12,0,0,1,0-17l72-72a12,12,0,0,1,17,17L69,116H216A12,12,0,0,1,228,128Z"},child:[]}]})(e)}function h7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M224.49,136.49l-72,72a12,12,0,0,1-17-17L187,140H40a12,12,0,0,1,0-24H187L135.51,64.48a12,12,0,0,1,17-17l72,72A12,12,0,0,1,224.49,136.49Z"},child:[]}]})(e)}function Ub(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,104a12,12,0,0,1-24,0V69l-59.51,59.51a12,12,0,0,1-17-17L187,52H152a12,12,0,0,1,0-24h64a12,12,0,0,1,12,12Zm-44,24a12,12,0,0,0-12,12v64H52V84h64a12,12,0,0,0,0-24H48A20,20,0,0,0,28,80V208a20,20,0,0,0,20,20H176a20,20,0,0,0,20-20V140A12,12,0,0,0,184,128Z"},child:[]}]})(e)}function G0(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M200.49,183.51a12,12,0,0,1,0,17c-1.13,1.12-28,27.51-72.49,27.51-33.71,0-59.35-17.46-76-33.86V208a12,12,0,0,1-24,0V160a12,12,0,0,1,12-12H88a12,12,0,0,1,0,24H64.12c13.1,14.32,35.08,32,63.88,32,34.63,0,55.31-20.28,55.51-20.49A12,12,0,0,1,200.49,183.51ZM216,36a12,12,0,0,0-12,12V61.86C187.35,45.46,161.71,28,128,28,83.54,28,56.64,54.39,55.51,55.51a12,12,0,0,0,17,17C72.69,72.28,93.37,52,128,52c28.8,0,50.78,17.68,63.88,32H168a12,12,0,0,0,0,24h48a12,12,0,0,0,12-12V48A12,12,0,0,0,216,36Z"},child:[]}]})(e)}function Z0(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M88,108H40A12,12,0,0,1,28,96V48a12,12,0,0,1,24,0V61.86C68.65,45.46,94.29,28,128,28c44.46,0,71.36,26.39,72.49,27.51a12,12,0,0,1-16.94,17C183.11,72.09,162,52,128,52,99,52,77.06,69.68,64,84H88a12,12,0,0,1,0,24Zm128,40H168a12,12,0,0,0,0,24h24c-13,14.32-35,32-64,32-34,0-55.11-20.09-55.55-20.52a12,12,0,0,0-16.94,17C56.64,201.61,83.54,228,128,228c33.71,0,59.35-17.46,76-33.86V208a12,12,0,0,0,24,0V160A12,12,0,0,0,216,148Z"},child:[]}]})(e)}function p7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M120.49,167.51a12,12,0,0,1,0,17l-32,32a12,12,0,0,1-17,0l-32-32a12,12,0,1,1,17-17L68,179V48a12,12,0,0,1,24,0V179l11.51-11.52A12,12,0,0,1,120.49,167.51Zm96-96-32-32a12,12,0,0,0-17,0l-32,32a12,12,0,0,0,17,17L164,77V208a12,12,0,0,0,24,0V77l11.51,11.52a12,12,0,0,0,17-17Z"},child:[]}]})(e)}function Gb(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M218.29,182.17a12,12,0,0,1-16.47,4.12L140,149.19V216a12,12,0,0,1-24,0V149.19l-61.82,37.1a12,12,0,1,1-12.35-20.58L104.68,128,41.83,90.29A12,12,0,1,1,54.18,69.71L116,106.81V40a12,12,0,0,1,24,0v66.81l61.82-37.1a12,12,0,1,1,12.35,20.58L151.32,128l62.85,37.71A12,12,0,0,1,218.29,182.17Z"},child:[]}]})(e)}function g7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M235.57,193.73,202.38,35.93a20,20,0,0,0-23.76-15.48L131.81,30.51a19.82,19.82,0,0,0-11,6.65A20,20,0,0,0,104,28H56A20,20,0,0,0,36,48V208a20,20,0,0,0,20,20h48a20,20,0,0,0,20-20V90.25l25.62,121.82A20,20,0,0,0,169.15,228a20.27,20.27,0,0,0,4.23-.45l46.81-10.06A20.1,20.1,0,0,0,235.57,193.73ZM148.19,88.65l39-8.38,2.53,12-39,8.38Zm7.46,35.5,39-8.38,9.16,43.58-39,8.38Zm24.06-79.39,2.53,12-39,8.38-2.53-12ZM60,88h40v80H60Zm40-36V64H60V52ZM60,204V192h40v12Zm112.29-.76-2.53-12,39-8.38,2.53,12Z"},child:[]}]})(e)}function x7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M224,152a12,12,0,0,0,0-24H212V112h12a12,12,0,0,0,0-24H210.45a83.7,83.7,0,0,0-18.78-38.7l16.82-16.81a12,12,0,0,0-17-17l-18,18a83.7,83.7,0,0,0-91.1,0l-18-18a12,12,0,0,0-17,17L64.33,49.3A83.7,83.7,0,0,0,45.55,88H32a12,12,0,0,0,0,24H44v16H32a12,12,0,0,0,0,24H44a83.55,83.55,0,0,0,1.55,16H32a12,12,0,0,0,0,24H54.15a84,84,0,0,0,147.7,0H224a12,12,0,0,0,0-24H210.45A83.55,83.55,0,0,0,212,152ZM128,44a60.1,60.1,0,0,1,57.82,44H70.18A60.1,60.1,0,0,1,128,44Zm12,166.79V140a12,12,0,0,0-24,0v70.79A60.09,60.09,0,0,1,68,152V112H188v40A60.09,60.09,0,0,1,140,210.79Z"},child:[]}]})(e)}function v7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M144.49,136.49l-80,80a12,12,0,0,1-17-17L119,128,47.51,56.49a12,12,0,0,1,17-17l80,80A12,12,0,0,1,144.49,136.49Zm80-17-80-80a12,12,0,1,0-17,17L199,128l-71.52,71.51a12,12,0,0,0,17,17l80-80A12,12,0,0,0,224.49,119.51Z"},child:[]}]})(e)}function Zb(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M168.49,199.51a12,12,0,0,1-17,17l-80-80a12,12,0,0,1,0-17l80-80a12,12,0,0,1,17,17L97,128Z"},child:[]}]})(e)}function qb(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M184.49,136.49l-80,80a12,12,0,0,1-17-17L159,128,87.51,56.49a12,12,0,1,1,17-17l80,80A12,12,0,0,1,184.49,136.49Z"},child:[]}]})(e)}function q0(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216.49,168.49a12,12,0,0,1-17,0L128,97,56.49,168.49a12,12,0,0,1-17-17l80-80a12,12,0,0,1,17,0l80,80A12,12,0,0,1,216.49,168.49Z"},child:[]}]})(e)}function Qb(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M232.49,80.49l-128,128a12,12,0,0,1-17,0l-56-56a12,12,0,1,1,17-17L96,183,215.51,63.51a12,12,0,0,1,17,17Z"},child:[]}]})(e)}function C7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M236,128a108,108,0,0,1-216,0c0-42.52,24.73-81.34,63-98.9A12,12,0,1,1,93,50.91C63.24,64.57,44,94.83,44,128a84,84,0,0,0,168,0c0-33.17-19.24-63.43-49-77.09A12,12,0,1,1,173,29.1C211.27,46.66,236,85.48,236,128Z"},child:[]}]})(e)}function y7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M71.68,97.22,34.74,128l36.94,30.78a12,12,0,1,1-15.36,18.44l-48-40a12,12,0,0,1,0-18.44l48-40A12,12,0,0,1,71.68,97.22Zm176,21.56-48-40a12,12,0,1,0-15.36,18.44L221.26,128l-36.94,30.78a12,12,0,1,0,15.36,18.44l48-40a12,12,0,0,0,0-18.44ZM164.1,28.72a12,12,0,0,0-15.38,7.18l-64,176a12,12,0,0,0,7.18,15.37A11.79,11.79,0,0,0,96,228a12,12,0,0,0,11.28-7.9l64-176A12,12,0,0,0,164.1,28.72Z"},child:[]}]})(e)}function el(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,28H88A12,12,0,0,0,76,40V76H40A12,12,0,0,0,28,88V216a12,12,0,0,0,12,12H168a12,12,0,0,0,12-12V180h36a12,12,0,0,0,12-12V40A12,12,0,0,0,216,28ZM156,204H52V100H156Zm48-48H180V88a12,12,0,0,0-12-12H100V52H204Z"},child:[]}]})(e)}function b7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M128,20A108,108,0,1,0,236,128,108.12,108.12,0,0,0,128,20Zm12,191.13V184a12,12,0,0,0-24,0v27.13A84.18,84.18,0,0,1,44.87,140H72a12,12,0,0,0,0-24H44.87A84.18,84.18,0,0,1,116,44.87V72a12,12,0,0,0,24,0V44.87A84.18,84.18,0,0,1,211.13,116H184a12,12,0,0,0,0,24h27.13A84.18,84.18,0,0,1,140,211.13Z"},child:[]}]})(e)}function j7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M71.51,88.49a12,12,0,0,1,17-17L116,99V24a12,12,0,0,1,24,0V99l27.51-27.52a12,12,0,0,1,17,17l-48,48a12,12,0,0,1-17,0ZM224,116H188a12,12,0,0,0,0,24h32v56H36V140H68a12,12,0,0,0,0-24H32a20,20,0,0,0-20,20v64a20,20,0,0,0,20,20H224a20,20,0,0,0,20-20V136A20,20,0,0,0,224,116Zm-20,52a16,16,0,1,0-16,16A16,16,0,0,0,204,168Z"},child:[]}]})(e)}function Cc(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,152v56a20,20,0,0,1-20,20H48a20,20,0,0,1-20-20V152a12,12,0,0,1,24,0v52H204V152a12,12,0,0,1,24,0Zm-108.49,8.49a12,12,0,0,0,17,0l40-40a12,12,0,0,0-17-17L140,123V40a12,12,0,0,0-24,0v83L96.49,103.51a12,12,0,0,0-17,17Z"},child:[]}]})(e)}function S7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,204H141l86.84-86.84a28,28,0,0,0,0-39.6L186.43,36.19a28,28,0,0,0-39.6,0L28.19,154.82a28,28,0,0,0,0,39.6l30.06,30.07A12,12,0,0,0,66.74,228H216a12,12,0,0,0,0-24ZM163.8,53.16a4,4,0,0,1,5.66,0l41.38,41.38a4,4,0,0,1,0,5.65L160,151l-47-47ZM71.71,204,45.16,177.45a4,4,0,0,1,0-5.65L96,121l47,47-36,36Z"},child:[]}]})(e)}function Kb(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M178,78A84,84,0,1,0,78,178,84,84,0,1,0,178,78Zm42,82a60.75,60.75,0,0,1-.38,6.65l-44-44a83.31,83.31,0,0,0,4-19.34A60.09,60.09,0,0,1,220,160Zm-119.84-4.16a60.07,60.07,0,0,1,55.68-55.68A60.07,60.07,0,0,1,100.16,155.84Zm52.51-79.5a83.31,83.31,0,0,0-19.34,4l-44-44A60.75,60.75,0,0,1,96,36,60.09,60.09,0,0,1,152.67,76.34ZM64.19,45.16l46.73,46.73a85,85,0,0,0-19,19L45.16,64.19A60.45,60.45,0,0,1,64.19,45.16ZM36,96a60.75,60.75,0,0,1,.38-6.65l44,44a83.31,83.31,0,0,0-4,19.34A60.09,60.09,0,0,1,36,96Zm67.33,83.66a83.31,83.31,0,0,0,19.34-4l44,44A60.75,60.75,0,0,1,160,220,60.09,60.09,0,0,1,103.33,179.66Zm88.48,31.18-46.73-46.73a85,85,0,0,0,19-19l46.73,46.73A60.45,60.45,0,0,1,191.81,210.84Z"},child:[]}]})(e)}function k7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M251,123.13c-.37-.81-9.13-20.26-28.48-39.61C196.63,57.67,164,44,128,44S59.37,57.67,33.51,83.52C14.16,102.87,5.4,122.32,5,123.13a12.08,12.08,0,0,0,0,9.75c.37.82,9.13,20.26,28.49,39.61C59.37,198.34,92,212,128,212s68.63-13.66,94.48-39.51c19.36-19.35,28.12-38.79,28.49-39.61A12.08,12.08,0,0,0,251,123.13Zm-46.06,33C183.47,177.27,157.59,188,128,188s-55.47-10.73-76.91-31.88A130.36,130.36,0,0,1,29.52,128,130.45,130.45,0,0,1,51.09,99.89C72.54,78.73,98.41,68,128,68s55.46,10.73,76.91,31.89A130.36,130.36,0,0,1,226.48,128,130.45,130.45,0,0,1,204.91,156.12ZM128,84a44,44,0,1,0,44,44A44.05,44.05,0,0,0,128,84Zm0,64a20,20,0,1,1,20-20A20,20,0,0,1,128,148Z"},child:[]}]})(e)}function w7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M56.88,31.93A12,12,0,1,0,39.12,48.07l16,17.65C20.67,88.66,5.72,121.58,5,123.13a12.08,12.08,0,0,0,0,9.75c.37.82,9.13,20.26,28.49,39.61C59.37,198.34,92,212,128,212a131.34,131.34,0,0,0,51-10l20.09,22.1a12,12,0,0,0,17.76-16.14ZM128,188c-29.59,0-55.47-10.73-76.91-31.88A130.69,130.69,0,0,1,29.52,128c5.27-9.31,18.79-29.9,42-44.29l90.09,99.11A109.33,109.33,0,0,1,128,188Zm123-55.12c-.36.81-9,20-28,39.16a12,12,0,1,1-17-16.9A130.48,130.48,0,0,0,226.48,128a130.36,130.36,0,0,0-21.57-28.12C183.46,78.73,157.59,68,128,68c-3.35,0-6.7.14-10,.42a12,12,0,1,1-2-23.91c3.93-.34,8-.51,12-.51,36,0,68.63,13.67,94.49,39.52,19.35,19.35,28.11,38.8,28.48,39.61A12.08,12.08,0,0,1,251,132.88Z"},child:[]}]})(e)}function I7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,67.24a39.77,39.77,0,0,0-12.51-28.52C199.91,24,174.71,24.5,159.29,39.93L142.48,56.84a28,28,0,0,0-35.64,3.29l-9,9a20,20,0,0,0-.73,27.49L48.9,144.84A43.76,43.76,0,0,0,37,185.28l-7.5,17.19a17.66,17.66,0,0,0,3.71,19.65,19.9,19.9,0,0,0,22.15,4.19l16.31-7.13a43.88,43.88,0,0,0,39.45-12.09l48.24-48.26a20,20,0,0,0,27.47-.73l9-9a28.06,28.06,0,0,0,3.26-35.72l17.23-17.33A39.69,39.69,0,0,0,228,67.24ZM94.15,190.11a20,20,0,0,1-20,5,11.93,11.93,0,0,0-8.32.47L57,199.38,60.69,191a12,12,0,0,0,.37-8.64,19.92,19.92,0,0,1,4.81-20.55l48.2-48.22,28.28,28.3Zm105.14-111-25.37,25.52a12,12,0,0,0,0,16.95l4.88,4.89a4,4,0,0,1,0,5.66l-6.14,6.15-55-55.05,6.14-6.14a4,4,0,0,1,5.65,0L134.35,82a12,12,0,0,0,8.49,3.51h0A12,12,0,0,0,151.34,82l24.94-25.08c6.3-6.3,16.48-6.63,22.71-.74a16,16,0,0,1,.3,23Z"},child:[]}]})(e)}function M7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M225.15,197.71,164,95.81V44h4a12,12,0,0,0,0-24H88a12,12,0,0,0,0,24h4V95.81L30.85,197.71A20,20,0,0,0,48,228H208a20,20,0,0,0,17.15-30.29ZM140,44V99.14a12,12,0,0,0,1.71,6.17l35.13,58.54c-10.79.86-25.15-1.31-43.42-10.56-14-7.08-27.46-11.33-40.27-12.76l21.14-35.22A12,12,0,0,0,116,99.14V44ZM55.06,204,79,164.19c13-1.11,27.62,2.42,43.62,10.52,19.61,9.92,36.25,13.31,49.85,13.31A75.44,75.44,0,0,0,190.11,186l10.83,18Z"},child:[]}]})(e)}function yc(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M222.14,77.17,178.83,33.86A19.86,19.86,0,0,0,164.69,28H48A20,20,0,0,0,28,48V208a20,20,0,0,0,20,20H208a20,20,0,0,0,20-20V91.31A19.86,19.86,0,0,0,222.14,77.17ZM164,204H92V156h72Zm40,0H188V152a20,20,0,0,0-20-20H88a20,20,0,0,0-20,20v52H52V52H163l41,41ZM164,80a12,12,0,0,1-12,12H96a12,12,0,0,1,0-24h56A12,12,0,0,1,164,80Z"},child:[]}]})(e)}function If(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M248.49,71.51l-32-32a12,12,0,0,0-17,17L211,68H192a77.43,77.43,0,0,0-30,7.1c-14.49,6.69-32.81,21-37.81,50.92-2.69,16.17-10.58,27.4-23.43,33.39A49.4,49.4,0,0,1,90,162.93a44,44,0,1,0,.53,24.28,74.05,74.05,0,0,0,19.2-5.54c14.52-6.45,32.91-20.66,38.09-51.7,2.58-15.48,10.48-26.49,23.49-32.75A55.13,55.13,0,0,1,192,92h19l-11.52,11.51a12,12,0,0,0,17,17l32-32A12,12,0,0,0,248.49,71.51ZM48,196a20,20,0,1,1,20-20A20,20,0,0,1,48,196Z"},child:[]}]})(e)}function Yb(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,56H160L133.33,36a20.12,20.12,0,0,0-12-4H76A20,20,0,0,0,56,52V72H36A20,20,0,0,0,16,92V204a20,20,0,0,0,20,20H188.89A19.13,19.13,0,0,0,208,204.89V184h20.89A19.13,19.13,0,0,0,248,164.89V76A20,20,0,0,0,228,56ZM184,200H40V96H80l26.67,20a20.12,20.12,0,0,0,12,4H184Zm40-40H208V116a20,20,0,0,0-20-20H120L93.33,76a20.12,20.12,0,0,0-12-4H80V56h40l26.67,20a20.12,20.12,0,0,0,12,4H224Z"},child:[]}]})(e)}function Xb(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M140,88a12,12,0,0,1,12-12h32a12,12,0,0,1,12,12v32a12,12,0,0,1-24,0V100H152A12,12,0,0,1,140,88ZM72,180h32a12,12,0,0,0,0-24H84V136a12,12,0,0,0-24,0v32A12,12,0,0,0,72,180ZM236,56V200a20,20,0,0,1-20,20H40a20,20,0,0,1-20-20V56A20,20,0,0,1,40,36H216A20,20,0,0,1,236,56Zm-24,4H44V196H212Z"},child:[]}]})(e)}function _7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M128,76a52,52,0,1,0,52,52A52.06,52.06,0,0,0,128,76Zm0,80a28,28,0,1,1,28-28A28,28,0,0,1,128,156Zm113.86-49.57A12,12,0,0,0,236,98.34L208.21,82.49l-.11-31.31a12,12,0,0,0-4.25-9.12,116,116,0,0,0-38-21.41,12,12,0,0,0-9.68.89L128,37.27,99.83,21.53a12,12,0,0,0-9.7-.9,116.06,116.06,0,0,0-38,21.47,12,12,0,0,0-4.24,9.1l-.14,31.34L20,98.35a12,12,0,0,0-5.85,8.11,110.7,110.7,0,0,0,0,43.11A12,12,0,0,0,20,157.66l27.82,15.85.11,31.31a12,12,0,0,0,4.25,9.12,116,116,0,0,0,38,21.41,12,12,0,0,0,9.68-.89L128,218.73l28.14,15.74a12,12,0,0,0,9.7.9,116.06,116.06,0,0,0,38-21.47,12,12,0,0,0,4.24-9.1l.14-31.34,27.81-15.81a12,12,0,0,0,5.85-8.11A110.7,110.7,0,0,0,241.86,106.43Zm-22.63,33.18-26.88,15.28a11.94,11.94,0,0,0-4.55,4.59c-.54,1-1.11,1.93-1.7,2.88a12,12,0,0,0-1.83,6.31L184.13,199a91.83,91.83,0,0,1-21.07,11.87l-27.15-15.19a12,12,0,0,0-5.86-1.53h-.29c-1.14,0-2.3,0-3.44,0a12.08,12.08,0,0,0-6.14,1.51L93,210.82A92.27,92.27,0,0,1,71.88,199l-.11-30.24a12,12,0,0,0-1.83-6.32c-.58-.94-1.16-1.91-1.7-2.88A11.92,11.92,0,0,0,63.7,155L36.8,139.63a86.53,86.53,0,0,1,0-23.24l26.88-15.28a12,12,0,0,0,4.55-4.58c.54-1,1.11-1.94,1.7-2.89a12,12,0,0,0,1.83-6.31L71.87,57A91.83,91.83,0,0,1,92.94,45.17l27.15,15.19a11.92,11.92,0,0,0,6.15,1.52c1.14,0,2.3,0,3.44,0a12.08,12.08,0,0,0,6.14-1.51L163,45.18A92.27,92.27,0,0,1,184.12,57l.11,30.24a12,12,0,0,0,1.83,6.32c.58.94,1.16,1.91,1.7,2.88A11.92,11.92,0,0,0,192.3,101l26.9,15.33A86.53,86.53,0,0,1,219.23,139.61Z"},child:[]}]})(e)}function A7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M250.18,105.17,186.71,41.25a100.11,100.11,0,0,0-141.43,0l-.13.14L31.37,55.61a12,12,0,1,0,17.24,16.7L62.32,58.16A75.68,75.68,0,0,1,77.49,46.43L119,88,25.85,181.16a20,20,0,0,0,0,28.29l20.69,20.69a20,20,0,0,0,28.28,0L168,137l1.51,1.51h0l23.65,23.66a20,20,0,0,0,28.29,0l28.69-28.7A20,20,0,0,0,250.18,105.17ZM60.68,210.34l-15-15L108,133l15,15ZM140,131l-15-15,19.51-19.51a12,12,0,0,0,0-17L102.24,37.24a75.94,75.94,0,0,1,67.47,20.95l31.44,31.67L178,113l-1.51-1.51a12,12,0,0,0-17,0Zm67.32,11.31L195,130l23.09-23.09,12.3,12.39Z"},child:[]}]})(e)}function P7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M188,76a31.85,31.85,0,0,0-11.21,2,32,32,0,0,0-48.79-11A32,32,0,0,0,76,92v16H68a32,32,0,0,0-32,32v12a92,92,0,0,0,184,0V108A32,32,0,0,0,188,76Zm8,76a68,68,0,0,1-136,0V140a8,8,0,0,1,8-8h8v20a12,12,0,0,0,24,0V92a8,8,0,0,1,16,0v28a12,12,0,0,0,24,0V92a8,8,0,0,1,16,0v28a12,12,0,0,0,24,0V108a8,8,0,0,1,16,0Z"},child:[]}]})(e)}function E7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M184,20H72A20,20,0,0,0,52,40V76a20.1,20.1,0,0,0,8,16l48,36L60,164a20.1,20.1,0,0,0-8,16v36a20,20,0,0,0,20,20H184a20,20,0,0,0,20-20V180.36a20.13,20.13,0,0,0-7.94-16L147.9,128l48.16-36.4a20.13,20.13,0,0,0,7.94-16V40A20,20,0,0,0,184,20Zm-4,24V60H76V44Zm-52,69L89.33,84h77Zm52,99H76V182l52-39,52,39.33Z"},child:[]}]})(e)}function Qi(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M144,96a16,16,0,1,1,16,16A16,16,0,0,1,144,96Zm92-40V200a20,20,0,0,1-20,20H40a20,20,0,0,1-20-20V56A20,20,0,0,1,40,36H216A20,20,0,0,1,236,56ZM44,60v79.72l33.86-33.86a20,20,0,0,1,28.28,0L147.31,147l17.18-17.17a20,20,0,0,1,28.28,0L212,149.09V60Zm0,136H162.34L92,125.66l-48,48Zm168,0V183l-33.37-33.37L164.28,164l32,32Z"},child:[]}]})(e)}function D7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208,28H48A20,20,0,0,0,28,48V208a20,20,0,0,0,20,20H208a20,20,0,0,0,20-20V48A20,20,0,0,0,208,28Zm-4,24v63.72L186.14,97.86a20,20,0,0,0-28.28,0L52,203.72V52ZM85.66,204,172,117.66l32,32V204ZM76,96a20,20,0,1,1,20,20A20,20,0,0,1,76,96Z"},child:[]}]})(e)}function L7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,36H80A20,20,0,0,0,60,56V68H40A20,20,0,0,0,20,88V200a20,20,0,0,0,20,20H184a20,20,0,0,0,20-20V180h12a20,20,0,0,0,20-20V56A20,20,0,0,0,216,36ZM84,60H212v45.09l-3.23-3.23a20,20,0,0,0-28.28,0L165.31,117,130.14,81.86a20,20,0,0,0-28.28,0L84,99.72Zm96,136H44V92H60v68a20,20,0,0,0,20,20H180ZM84,156V133.66l32-32,40.83,40.83a12,12,0,0,0,17,0l20.83-20.83L212,139v17Z"},child:[]}]})(e)}function T7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208,28H88A20,20,0,0,0,68,48V60H48A20,20,0,0,0,28,80V208a20,20,0,0,0,20,20H176a20,20,0,0,0,20-20V188h12a20,20,0,0,0,20-20V48A20,20,0,0,0,208,28ZM92,52H204v59.72l-9.86-9.86a20,20,0,0,0-28.28,0L103.72,164H92Zm80,152H52V84H68v84a20,20,0,0,0,20,20h84Zm-34.34-40L180,121.66l24,24V164ZM108,88a20,20,0,1,1,20,20A20,20,0,0,1,108,88Z"},child:[]}]})(e)}function Mf(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M108,84a16,16,0,1,1,16,16A16,16,0,0,1,108,84Zm128,44A108,108,0,1,1,128,20,108.12,108.12,0,0,1,236,128Zm-24,0a84,84,0,1,0-84,84A84.09,84.09,0,0,0,212,128Zm-72,36.68V132a20,20,0,0,0-20-20,12,12,0,0,0-4,23.32V168a20,20,0,0,0,20,20,12,12,0,0,0,4-23.32Z"},child:[]}]})(e)}function R7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M223.51,44h-191A20.51,20.51,0,0,0,12,64.49v127A20.51,20.51,0,0,0,32.49,212h191A20.51,20.51,0,0,0,244,191.51v-127A20.51,20.51,0,0,0,223.51,44ZM220,188H36V68H220ZM52,128a12,12,0,0,1,12-12H192a12,12,0,0,1,0,24H64A12,12,0,0,1,52,128Zm0-36A12,12,0,0,1,64,80H192a12,12,0,0,1,0,24H64A12,12,0,0,1,52,92Zm0,72a12,12,0,0,1,12-12h8a12,12,0,0,1,0,24H64A12,12,0,0,1,52,164Zm108,0a12,12,0,0,1-12,12H108a12,12,0,0,1,0-24h40A12,12,0,0,1,160,164Zm44,0a12,12,0,0,1-12,12h-8a12,12,0,0,1,0-24h8A12,12,0,0,1,204,164Z"},child:[]}]})(e)}function B7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M87.5,151.52l64-64a12,12,0,0,1,17,17l-64,64a12,12,0,0,1-17-17Zm131-114a60.08,60.08,0,0,0-84.87,0L103.51,67.61a12,12,0,0,0,17,17l30.07-30.06a36,36,0,0,1,50.93,50.92L171.4,135.52a12,12,0,1,0,17,17l30.08-30.06A60.09,60.09,0,0,0,218.45,37.55ZM135.52,171.4l-30.07,30.08a36,36,0,0,1-50.92-50.93l30.06-30.07a12,12,0,0,0-17-17L37.55,133.58a60,60,0,0,0,84.88,84.87l30.06-30.07a12,12,0,0,0-17-17Z"},child:[]}]})(e)}function O7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M218.45,122.43l-30.08,30.06a12,12,0,0,1-17-17l30.08-30.07a36,36,0,0,0-50.93-50.92L120.48,84.59a12,12,0,0,1-17-17l30.07-30.06a60,60,0,0,1,84.87,84.88Zm-82.93,49-30.07,30.08a36,36,0,0,1-50.92-50.93l30.06-30.07a12,12,0,0,0-17-17L37.55,133.58a60,60,0,0,0,84.88,84.87l30.06-30.07a12,12,0,0,0-17-17Z"},child:[]}]})(e)}function N7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208,76H100V56a28,28,0,0,1,28-28c13.51,0,25.65,9.62,28.24,22.39a12,12,0,1,0,23.52-4.78C174.87,21.5,153.1,4,128,4A52.06,52.06,0,0,0,76,56V76H48A20,20,0,0,0,28,96V208a20,20,0,0,0,20,20H208a20,20,0,0,0,20-20V96A20,20,0,0,0,208,76Zm-4,128H52V100H204Z"},child:[]}]})(e)}function F7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M232.49,215.51,185,168a92.12,92.12,0,1,0-17,17l47.53,47.54a12,12,0,0,0,17-17ZM44,112a68,68,0,1,1,68,68A68.07,68.07,0,0,1,44,112Z"},child:[]}]})(e)}function z7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M156,112a12,12,0,0,1-12,12H80a12,12,0,0,1,0-24h64A12,12,0,0,1,156,112Zm76.49,120.49a12,12,0,0,1-17,0L168,185a92.12,92.12,0,1,1,17-17l47.54,47.53A12,12,0,0,1,232.49,232.49ZM112,180a68,68,0,1,0-68-68A68.08,68.08,0,0,0,112,180Z"},child:[]}]})(e)}function H7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M156,112a12,12,0,0,1-12,12H124v20a12,12,0,0,1-24,0V124H80a12,12,0,0,1,0-24h20V80a12,12,0,0,1,24,0v20h20A12,12,0,0,1,156,112Zm76.49,120.49a12,12,0,0,1-17,0L168,185a92.12,92.12,0,1,1,17-17l47.54,47.53A12,12,0,0,1,232.49,232.49ZM112,180a68,68,0,1,0-68-68A68.08,68.08,0,0,0,112,180Z"},child:[]}]})(e)}function $7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M128,60a44,44,0,1,0,44,44A44.05,44.05,0,0,0,128,60Zm0,64a20,20,0,1,1,20-20A20,20,0,0,1,128,124Zm0-112a92.1,92.1,0,0,0-92,92c0,77.36,81.64,135.4,85.12,137.83a12,12,0,0,0,13.76,0,259,259,0,0,0,42.18-39C205.15,170.57,220,136.37,220,104A92.1,92.1,0,0,0,128,12Zm31.3,174.71A249.35,249.35,0,0,1,128,216.89a249.35,249.35,0,0,1-31.3-30.18C80,167.37,60,137.31,60,104a68,68,0,0,1,136,0C196,137.31,176,167.37,159.3,186.71Z"},child:[]}]})(e)}function V7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,128a12,12,0,0,1-12,12H40a12,12,0,0,1,0-24H216A12,12,0,0,1,228,128Z"},child:[]}]})(e)}function W7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M236,32a12,12,0,0,0-12-12c-44.78,0-90,48.54-115.9,82a64,64,0,0,0-80,62c0,12-3.1,22.71-9.23,31.76A43,43,0,0,1,9.4,206.05a11.88,11.88,0,0,0-4.91,13.38A12.07,12.07,0,0,0,16.11,228h76A64,64,0,0,0,154,148C187.49,122.05,236,76.8,236,32ZM209.62,46.39c-4,12.92-13.15,27.49-26.92,42.91-3,3.39-6.16,6.7-9.35,9.89a104.31,104.31,0,0,0-16.5-16.51c3.19-3.19,6.49-6.32,9.88-9.35C182.15,59.55,196.71,50.43,209.62,46.39ZM92.07,204H42a80.17,80.17,0,0,0,10.14-40,40,40,0,1,1,40,40Zm38.18-91.32c3.12-3.93,6.55-8.09,10.23-12.35a80.52,80.52,0,0,1,15.23,15.24c-4.26,3.68-8.42,7.11-12.35,10.23A64.43,64.43,0,0,0,130.25,112.68Z"},child:[]}]})(e)}function U7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M231.5,162.63a12,12,0,0,0-15,0C214,164.64,192,183,192,208a32,32,0,0,0,64,0C256,183,234,164.64,231.5,162.63ZM224,216a8,8,0,0,1-8-8c0-6.8,3.91-13.64,8-18.83,4.07,5.17,8,12,8,18.83A8,8,0,0,1,224,216Zm8.49-101L125,7.51a12,12,0,0,0-17,0L70.25,45.29,48.48,23.51a12,12,0,1,0-17,17L53.28,62.26,12.2,103.34a28,28,0,0,0,0,39.6L97.06,227.8a28,28,0,0,0,39.6,0L232.49,132A12,12,0,0,0,232.49,115Zm-112.8,95.83a4,4,0,0,1-5.66,0L29.17,126a4,4,0,0,1,0-5.66L70.25,79.23l21.27,21.26a36,36,0,1,0,17-17L87.23,62.26,116.52,33,207,123.48ZM124,104a12,12,0,1,1-12,12A12,12,0,0,1,124,104Z"},child:[]}]})(e)}function Jb(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M251.62,39.65a12,12,0,0,0-11.27-11.27c-53.28-3.14-96.2,13.37-114.84,44.14-12.14,20-12.56,44.17-1.46,67.3a75.21,75.21,0,0,0-11.24,20l-9.7-9.7c7.19-16.77,6.43-34.11-2.4-48.69C86.73,78.36,54.89,66,15.55,68.28A12,12,0,0,0,4.28,79.55C2,118.89,14.36,150.73,37.45,164.71a49.76,49.76,0,0,0,26,7.27,57.54,57.54,0,0,0,22.7-4.87L108,189v27a12,12,0,0,0,24,0V186.51a51.63,51.63,0,0,1,9.49-29.95A76.81,76.81,0,0,0,173.58,164a64.92,64.92,0,0,0,33.9-9.46C238.25,135.85,254.76,92.92,251.62,39.65ZM49.88,144.18c-13.19-8-21.18-27.46-21.83-52.13,24.67.65,44.14,8.65,52.13,21.83a26,26,0,0,1,3.63,17L72.48,119.51a12,12,0,0,0-17,17l11.34,11.34A26.27,26.27,0,0,1,49.88,144.18ZM195.05,134c-10.66,6.45-23,7.67-35.81,3.76l37.25-37.24a12,12,0,0,0-17-17l-37.25,37.24C138.37,108,139.59,95.61,146,85c12.77-21.09,43-33.07,82-33C228.14,91,216.14,121.18,195.05,134Z"},child:[]}]})(e)}function kl(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,128a12,12,0,0,1-12,12H140v76a12,12,0,0,1-24,0V140H40a12,12,0,0,1,0-24h76V40a12,12,0,0,1,24,0v76h76A12,12,0,0,1,228,128Z"},child:[]}]})(e)}function ej(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M100,52H40A20,20,0,0,0,20,72v64a20,20,0,0,0,20,20H96v4a28,28,0,0,1-28,28,12,12,0,0,0,0,24,52.06,52.06,0,0,0,52-52V72A20,20,0,0,0,100,52Zm-4,80H44V76H96ZM216,52H156a20,20,0,0,0-20,20v64a20,20,0,0,0,20,20h56v4a28,28,0,0,1-28,28,12,12,0,0,0,0,24,52.06,52.06,0,0,0,52-52V72A20,20,0,0,0,216,52Zm-4,80H160V76h52Z"},child:[]}]})(e)}function Q0(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M238.15,70.54,185.46,17.86a20,20,0,0,0-28.29,0L17.85,157.17a20,20,0,0,0,0,28.29l52.69,52.68a20,20,0,0,0,28.29,0L238.15,98.83A20,20,0,0,0,238.15,70.54ZM84.68,218.34l-47-47L64,145l23.52,23.52a12,12,0,0,0,17-17L81,128l15-15,23.51,23.52a12,12,0,0,0,17-17L113,96l15-15,23.52,23.52a12,12,0,0,0,17-17L145,64l26.35-26.34,47,47Z"},child:[]}]})(e)}function Oh(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M240.49,103.52l-80-80A12,12,0,0,0,140,32V68.74c-25.76,3.12-53.66,15.89-76.75,35.47-29.16,24.74-47.32,56.69-51.14,90A16,16,0,0,0,39.67,207h0c10.46-11.14,47-45.74,100.33-50.42V192a12,12,0,0,0,20.48,8.48l80-80A12,12,0,0,0,240.49,103.52ZM164,163V144a12,12,0,0,0-12-12c-49,0-86.57,21.56-109.79,40.11,7.13-18.16,19.63-35.22,36.57-49.59C101.3,103.41,128.67,92,152,92a12,12,0,0,0,12-12V61l51,51Z"},child:[]}]})(e)}function G7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M240.49,175.51a12,12,0,0,1,0,17l-24,24a12,12,0,0,1-17-17L203,196h-2.09a76.17,76.17,0,0,1-61.85-31.83L97.38,105.78A52.1,52.1,0,0,0,55.06,84H32a12,12,0,0,1,0-24H55.06a76.17,76.17,0,0,1,61.85,31.83l41.71,58.39A52.1,52.1,0,0,0,200.94,172H203l-3.52-3.51a12,12,0,0,1,17-17Zm-95.62-72.62a12,12,0,0,0,16.93-1.13A52,52,0,0,1,200.94,84H203l-3.52,3.51a12,12,0,0,0,17,17l24-24a12,12,0,0,0,0-17l-24-24a12,12,0,0,0-17,17L203,60h-2.09a76,76,0,0,0-57.2,26A12,12,0,0,0,144.87,102.89Zm-33.74,50.22a12,12,0,0,0-16.93,1.13A52,52,0,0,1,55.06,172H32a12,12,0,0,0,0,24H55.06a76,76,0,0,0,57.2-26A12,12,0,0,0,111.13,153.11Z"},child:[]}]})(e)}function tj(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M40,92H70.06a36,36,0,0,0,67.88,0H216a12,12,0,0,0,0-24H137.94a36,36,0,0,0-67.88,0H40a12,12,0,0,0,0,24Zm64-24A12,12,0,1,1,92,80,12,12,0,0,1,104,68Zm112,96H201.94a36,36,0,0,0-67.88,0H40a12,12,0,0,0,0,24h94.06a36,36,0,0,0,67.88,0H216a12,12,0,0,0,0-24Zm-48,24a12,12,0,1,1,12-12A12,12,0,0,1,168,188Z"},child:[]}]})(e)}function Z7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M234.36,170A12,12,0,0,1,230,186.37l-96,56a12,12,0,0,1-12.1,0l-96-56a12,12,0,0,1,12.09-20.74l90,52.48L218,165.63A12,12,0,0,1,234.36,170ZM218,117.63,128,170.11,38.05,117.63A12,12,0,0,0,26,138.37l96,56a12,12,0,0,0,12.1,0l96-56A12,12,0,0,0,218,117.63ZM20,80a12,12,0,0,1,6-10.37l96-56a12.06,12.06,0,0,1,12.1,0l96,56a12,12,0,0,1,0,20.74l-96,56a12,12,0,0,1-12.1,0l-96-56A12,12,0,0,1,20,80Zm35.82,0L128,122.11,200.18,80,128,37.89Z"},child:[]}]})(e)}function K0(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M243,96.05a20,20,0,0,0-17.26-13.72l-57-4.93-22.3-53.14h0a20,20,0,0,0-36.82,0L87.29,77.4l-57,4.93A20,20,0,0,0,18.87,117.4l43.32,37.8-13,56.24A20,20,0,0,0,79,233.1l49-29.76,49,29.76a20,20,0,0,0,29.8-21.66l-13-56.24,43.32-37.8A20,20,0,0,0,243,96.05Zm-66.75,42.62a20,20,0,0,0-6.35,19.63l11.39,49.32-42.94-26.08a19.9,19.9,0,0,0-20.7,0L74.71,207.62,86.1,158.3a20,20,0,0,0-6.35-19.63L41.66,105.44,91.8,101.1a19.92,19.92,0,0,0,16.69-12.19L128,42.42l19.51,46.49A19.92,19.92,0,0,0,164.2,101.1l50.14,4.34Z"},child:[]}]})(e)}function Vs(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,48H40a12,12,0,0,0,0,24h4V208a20,20,0,0,0,20,20H192a20,20,0,0,0,20-20V72h4a12,12,0,0,0,0-24ZM188,204H68V72H188ZM76,20A12,12,0,0,1,88,8h80a12,12,0,0,1,0,24H88A12,12,0,0,1,76,20Z"},child:[]}]})(e)}function _f(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M228,152v56a20,20,0,0,1-20,20H48a20,20,0,0,1-20-20V152a12,12,0,0,1,24,0v52H204V152a12,12,0,0,1,24,0ZM96.49,88.49,116,69v83a12,12,0,0,0,24,0V69l19.51,19.52a12,12,0,0,0,17-17l-40-40a12,12,0,0,0-17,0l-40,40a12,12,0,0,0,17,17Z"},child:[]}]})(e)}function Y0(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M240.26,186.1,152.81,34.23h0a28.74,28.74,0,0,0-49.62,0L15.74,186.1a27.45,27.45,0,0,0,0,27.71A28.31,28.31,0,0,0,40.55,228h174.9a28.31,28.31,0,0,0,24.79-14.19A27.45,27.45,0,0,0,240.26,186.1Zm-20.8,15.7a4.46,4.46,0,0,1-4,2.2H40.55a4.46,4.46,0,0,1-4-2.2,3.56,3.56,0,0,1,0-3.73L124,46.2a4.77,4.77,0,0,1,8,0l87.44,151.87A3.56,3.56,0,0,1,219.46,201.8ZM116,136V104a12,12,0,0,1,24,0v32a12,12,0,0,1-24,0Zm28,40a16,16,0,1,1-16-16A16,16,0,0,1,144,176Z"},child:[]}]})(e)}function nj(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M128,20A108,108,0,1,0,236,128,108.12,108.12,0,0,0,128,20Zm0,192a84,84,0,1,1,84-84A84.09,84.09,0,0,1,128,212Zm-12-80V80a12,12,0,0,1,24,0v52a12,12,0,0,1-24,0Zm28,40a16,16,0,1,1-16-16A16,16,0,0,1,144,172Z"},child:[]}]})(e)}function oo(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208.49,191.51a12,12,0,0,1-17,17L128,145,64.49,208.49a12,12,0,0,1-17-17L111,128,47.51,64.49a12,12,0,0,1,17-17L128,111l63.51-63.52a12,12,0,0,1,17,17L145,128Z"},child:[]}]})(e)}function X0(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M156,128a28,28,0,1,1-28-28A28,28,0,0,1,156,128ZM48,100a28,28,0,1,0,28,28A28,28,0,0,0,48,100Zm160,0a28,28,0,1,0,28,28A28,28,0,0,0,208,100Z"},child:[]}]})(e)}function q7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208,32H188a4,4,0,0,0-4,4V80a16,16,0,0,1-16,16H88.27A8.17,8.17,0,0,1,80,88.53,8,8,0,0,1,88,80h76a4,4,0,0,0,4-4V36a4,4,0,0,0-4-4H91.31A15.86,15.86,0,0,0,80,36.69L36.69,80A15.86,15.86,0,0,0,32,91.31V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM128,184a32,32,0,1,1,32-32A32,32,0,0,1,128,184Z"},child:[]}]})(e)}function Q7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208,80H176V56a48,48,0,0,0-96,0V80H48A16,16,0,0,0,32,96V208a16,16,0,0,0,16,16H208a16,16,0,0,0,16-16V96A16,16,0,0,0,208,80ZM96,56a32,32,0,0,1,64,0V80H96Z"},child:[]}]})(e)}function sj(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M216,48V208a16,16,0,0,1-16,16H160a16,16,0,0,1-16-16V48a16,16,0,0,1,16-16h40A16,16,0,0,1,216,48ZM96,32H56A16,16,0,0,0,40,48V208a16,16,0,0,0,16,16H96a16,16,0,0,0,16-16V48A16,16,0,0,0,96,32Z"},child:[]}]})(e)}function oj(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M240,128a15.74,15.74,0,0,1-7.6,13.51L88.32,229.65a16,16,0,0,1-16.2.3A15.86,15.86,0,0,1,64,216.13V39.87a15.86,15.86,0,0,1,8.12-13.82,16,16,0,0,1,16.2.3L232.4,114.49A15.74,15.74,0,0,1,240,128Z"},child:[]}]})(e)}function J0(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M234.5,114.38l-45.1,39.36,13.51,58.6a16,16,0,0,1-23.84,17.34l-51.11-31-51,31a16,16,0,0,1-23.84-17.34L66.61,153.8,21.5,114.38a16,16,0,0,1,9.11-28.06l59.46-5.15,23.21-55.36a15.95,15.95,0,0,1,29.44,0h0L166,81.17l59.44,5.15a16,16,0,0,1,9.11,28.06Z"},child:[]}]})(e)}function K7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M176,56H80a72,72,0,0,0,0,144h96a72,72,0,0,0,0-144Zm0,112a40,40,0,1,1,40-40A40,40,0,0,1,176,168Z"},child:[]}]})(e)}function bc(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M224,56a8,8,0,0,1-8,8h-8V208a16,16,0,0,1-16,16H64a16,16,0,0,1-16-16V64H40a8,8,0,0,1,0-16H216A8,8,0,0,1,224,56ZM88,32h80a8,8,0,0,0,0-16H88a8,8,0,0,0,0,16Z"},child:[]}]})(e)}function Y7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M200,80v32a8,8,0,0,1-16,0V88H160a8,8,0,0,1,0-16h32A8,8,0,0,1,200,80ZM96,168H72V144a8,8,0,0,0-16,0v32a8,8,0,0,0,8,8H96a8,8,0,0,0,0-16ZM232,56V200a16,16,0,0,1-16,16H40a16,16,0,0,1-16-16V56A16,16,0,0,1,40,40H216A16,16,0,0,1,232,56ZM216,200V56H40V200H216Z"},child:[]}]})(e)}function X7(e){return Ie({tag:"svg",attr:{viewBox:"0 0 256 256",fill:"currentColor"},child:[{tag:"path",attr:{d:"M208,32H80A16,16,0,0,0,64,48V64H48A16,16,0,0,0,32,80V208a16,16,0,0,0,16,16H176a16,16,0,0,0,16-16V192h16a16,16,0,0,0,16-16V48A16,16,0,0,0,208,32ZM80,48H208v69.38l-16.7-16.7a16,16,0,0,0-22.62,0L93.37,176H80Zm96,160H48V80H64v96a16,16,0,0,0,16,16h96Zm32-32H116l64-64,28,28v36Zm-88-64A24,24,0,1,0,96,88,24,24,0,0,0,120,112Zm0-32a8,8,0,1,1-8,8A8,8,0,0,1,120,80Z"},child:[]}]})(e)}const J7={paramNegativeConditioning:{placement:"right"},controlNet:{href:"https://support.invoke.ai/support/solutions/articles/151000105880"},lora:{href:"https://support.invoke.ai/support/solutions/articles/151000159072"},compositingCoherenceMode:{href:"https://support.invoke.ai/support/solutions/articles/151000158838"},infillMethod:{href:"https://support.invoke.ai/support/solutions/articles/151000158841"},scaleBeforeProcessing:{href:"https://support.invoke.ai/support/solutions/articles/151000158841"},paramIterations:{href:"https://support.invoke.ai/support/solutions/articles/151000159073"},paramPositiveConditioning:{href:"https://support.invoke.ai/support/solutions/articles/151000096606-tips-on-crafting-prompts",placement:"right"},paramScheduler:{placement:"right",href:"https://support.invoke.ai/support/solutions/articles/151000159073"},paramModel:{placement:"right",href:"https://support.invoke.ai/support/solutions/articles/151000096601-what-is-a-model-which-should-i-use-"},paramRatio:{gutter:16},controlNetControlMode:{placement:"right"},controlNetResizeMode:{placement:"right"},paramVAE:{placement:"right"},paramVAEPrecision:{placement:"right"}},eP=1e3,tP=[{name:"preventOverflow",options:{padding:10}}],zt=u.memo(({feature:e,children:t,inPortal:n=!0,...o})=>{const r=j(d=>d.system.shouldEnableInformationalPopovers),l=u.useMemo(()=>J7[e],[e]),c=u.useMemo(()=>ey(t6(l,["image","href","buttonLabel"]),o),[l,o]);return r?s.jsxs(Zr,{isLazy:!0,closeOnBlur:!1,trigger:"hover",variant:"informational",openDelay:eP,modifiers:tP,placement:"top",...c,children:[s.jsx(za,{children:t}),n?s.jsx(v0,{children:s.jsx(L2,{data:l,feature:e})}):s.jsx(L2,{data:l,feature:e})]}):t});zt.displayName="InformationalPopover";const L2=({data:e,feature:t})=>{const{t:n}=R(),o=u.useMemo(()=>n(`popovers.${t}.heading`),[t,n]),r=u.useMemo(()=>n(`popovers.${t}.paragraphs`,{returnObjects:!0})??[],[t,n]),l=u.useCallback(()=>{e!=null&&e.href&&window.open(e.href)},[e==null?void 0:e.href]);return s.jsxs(qr,{w:96,children:[s.jsx(n6,{}),s.jsx(Qr,{children:s.jsxs(L,{gap:2,flexDirection:"column",alignItems:"flex-start",children:[o&&s.jsxs(s.Fragment,{children:[s.jsx(ns,{size:"sm",children:o}),s.jsx(Sn,{})]}),(e==null?void 0:e.image)&&s.jsxs(s.Fragment,{children:[s.jsx(ur,{objectFit:"contain",maxW:"60%",maxH:"60%",backgroundColor:"white",src:e.image,alt:"Optional Image"}),s.jsx(Sn,{})]}),r.map(c=>s.jsx(pe,{children:c},c)),(e==null?void 0:e.href)&&s.jsxs(s.Fragment,{children:[s.jsx(Sn,{}),s.jsx(Ge,{pt:1,onClick:l,leftIcon:s.jsx(Ub,{}),alignSelf:"flex-end",variant:"link",children:n("common.learnMore")??o})]})]})})]})},nP=()=>{const e=j(g=>g.dynamicPrompts.maxPrompts),t=j(g=>g.config.sd.dynamicPrompts.maxPrompts.sliderMin),n=j(g=>g.config.sd.dynamicPrompts.maxPrompts.sliderMax),o=j(g=>g.config.sd.dynamicPrompts.maxPrompts.numberInputMin),r=j(g=>g.config.sd.dynamicPrompts.maxPrompts.numberInputMax),l=j(g=>g.config.sd.dynamicPrompts.maxPrompts.initial),c=j(g=>!g.dynamicPrompts.combinatorial),d=J(),{t:f}=R(),m=u.useCallback(g=>{d(s6(g))},[d]);return s.jsxs(U,{isDisabled:c,children:[s.jsx(zt,{feature:"dynamicPromptsMaxPrompts",inPortal:!1,children:s.jsx(Y,{children:f("dynamicPrompts.maxPrompts")})}),s.jsx(Ue,{min:t,max:n,value:e,defaultValue:l,onChange:m,marks:!0}),s.jsx($e,{min:o,max:r,value:e,defaultValue:l,onChange:m})]})},sP=u.memo(nP),rj=u.memo(e=>e.image?s.jsx(C0,{w:`${e.image.width}px`,h:"auto",objectFit:"contain",aspectRatio:`${e.image.width}/${e.image.height}`}):s.jsx(L,{opacity:.7,w:"full",h:"full",alignItems:"center",justifyContent:"center",borderRadius:"base",bg:"base.900",children:s.jsx(Kr,{size:"xl"})}));rj.displayName="IAILoadingImageFallback";const Yt=u.memo(e=>{const{icon:t=Qi,boxSize:n=16,sx:o,...r}=e,l=u.useMemo(()=>({w:"full",h:"full",alignItems:"center",justifyContent:"center",borderRadius:"base",flexDir:"column",gap:2,userSelect:"none",opacity:.7,color:"base.500",...o}),[o]);return s.jsxs(L,{sx:l,...r,children:[t&&s.jsx(Vn,{as:t,boxSize:n,opacity:.7}),e.label&&s.jsx(pe,{textAlign:"center",fontSize:"md",children:e.label})]})});Yt.displayName="IAINoContentFallback";const eg=u.memo(e=>{const{sx:t,...n}=e,o=u.useMemo(()=>({w:"full",h:"full",alignItems:"center",justifyContent:"center",borderRadius:"base",flexDir:"column",gap:2,userSelect:"none",opacity:.7,color:"base.500",...t}),[t]);return s.jsxs(L,{sx:o,...n,children:[s.jsx(Kr,{size:"xl"}),e.label&&s.jsx(pe,{textAlign:"center",children:e.label})]})});eg.displayName="IAINoContentFallbackWithSpinner";/*!
 * OverlayScrollbars
 * Version: 2.4.6
 *
 * Copyright (c) Rene Haas | KingSora.
 * https://github.com/KingSora
 *
 * Released under the MIT license.
 */const Ys=(e,t)=>{const{o:n,u:o,_:r}=e;let l=n,c;const d=(g,p)=>{const x=l,y=g,S=p||(o?!o(x,y):x!==y);return(S||r)&&(l=y,c=x),[l,S,c]};return[t?g=>d(t(l,c),g):d,g=>[l,!!g,c]]},tg=typeof window<"u",lj=tg&&Node.ELEMENT_NODE,{toString:oP,hasOwnProperty:Nh}=Object.prototype,rP=/^\[object (.+)\]$/,Bl=e=>e===void 0,Af=e=>e===null,lP=e=>Bl(e)||Af(e)?`${e}`:oP.call(e).replace(rP,"$1").toLowerCase(),Po=e=>typeof e=="number",jc=e=>typeof e=="string",aj=e=>typeof e=="boolean",ro=e=>typeof e=="function",Do=e=>Array.isArray(e),Ki=e=>typeof e=="object"&&!Do(e)&&!Af(e),Pf=e=>{const t=!!e&&e.length,n=Po(t)&&t>-1&&t%1==0;return Do(e)||!ro(e)&&n?t>0&&Ki(e)?t-1 in e:!0:!1},Rd=e=>{if(!e||!Ki(e)||lP(e)!=="object")return!1;let t;const n="constructor",o=e[n],r=o&&o.prototype,l=Nh.call(e,n),c=r&&Nh.call(r,"isPrototypeOf");if(o&&!l&&!c)return!1;for(t in e);return Bl(t)||Nh.call(e,t)},Ni=e=>{const t=HTMLElement;return e?t?e instanceof t:e.nodeType===lj:!1},Ef=e=>{const t=Element;return e?t?e instanceof t:e.nodeType===lj:!1};function yt(e,t){if(Pf(e))for(let n=0;n<e.length&&t(e[n],n,e)!==!1;n++);else e&&yt(Object.keys(e),n=>t(e[n],n,e));return e}const Df=(e,t)=>e.indexOf(t)>=0,Yo=(e,t)=>e.concat(t),It=(e,t,n)=>(!n&&!jc(t)&&Pf(t)?Array.prototype.push.apply(e,t):e.push(t),e),Ga=e=>{const t=Array.from,n=[];return t&&e?t(e):(e instanceof Set?e.forEach(o=>{It(n,o)}):yt(e,o=>{It(n,o)}),n)},ij=e=>Do(e)?e:[e],Bd=e=>!!e&&!e.length,T2=e=>Ga(new Set(e)),Hs=(e,t,n)=>{yt(e,r=>r&&r.apply(void 0,t||[])),!n&&(e.length=0)},Lf=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),rr=e=>e?Object.keys(e):[],bt=(e,t,n,o,r,l,c)=>{const d=[t,n,o,r,l,c];return(typeof e!="object"||Af(e))&&!ro(e)&&(e={}),yt(d,f=>{yt(f,(m,g)=>{const p=f[g];if(e===p)return!0;const x=Do(p);if(p&&Rd(p)){const y=e[g];let S=y;x&&!Do(y)?S=[]:!x&&!Rd(y)&&(S={}),e[g]=bt(S,p)}else e[g]=x?p.slice():p})}),e},cj=(e,t)=>yt(bt({},e),(n,o,r)=>{n===void 0?delete r[o]:t&&n&&Rd(n)&&(r[o]=cj(n,t))}),ng=e=>{for(const t in e)return!1;return!0},Fn=(e,t,n)=>{if(Bl(n))return e?e.getAttribute(t):null;e&&e.setAttribute(t,n)},uj=(e,t)=>new Set((Fn(e,t)||"").split(" ")),Jn=(e,t)=>{e&&e.removeAttribute(t)},wl=(e,t,n,o)=>{if(n){const r=uj(e,t);r[o?"add":"delete"](n);const l=Ga(r).join(" ").trim();Fn(e,t,l)}},aP=(e,t,n)=>uj(e,t).has(n),Tp=tg&&Element.prototype,dj=(e,t)=>{const n=[],o=t?Ef(t)&&t:document;return o?It(n,o.querySelectorAll(e)):n},iP=(e,t)=>{const n=t?Ef(t)&&t:document;return n?n.querySelector(e):null},Od=(e,t)=>Ef(e)?(Tp.matches||Tp.msMatchesSelector).call(e,t):!1,Rp=e=>e?Ga(e.childNodes):[],Jo=e=>e&&e.parentElement,ma=(e,t)=>{if(Ef(e)){const n=Tp.closest;if(n)return n.call(e,t);do{if(Od(e,t))return e;e=Jo(e)}while(e)}},cP=(e,t,n)=>{const o=ma(e,t),r=e&&iP(n,o),l=ma(r,t)===o;return o&&r?o===e||r===e||l&&ma(ma(e,n),t)!==o:!1},gs=()=>{},er=e=>{if(Pf(e))yt(Ga(e),t=>er(t));else if(e){const t=Jo(e);t&&t.removeChild(e)}},sg=(e,t,n)=>{if(n&&e){let o=t,r;return Pf(n)?(r=document.createDocumentFragment(),yt(n,l=>{l===o&&(o=l.previousSibling),r.appendChild(l)})):r=n,t&&(o?o!==t&&(o=o.nextSibling):o=e.firstChild),e.insertBefore(r,o||null),()=>er(n)}return gs},Ns=(e,t)=>sg(e,null,t),uP=(e,t)=>sg(Jo(e),e,t),R2=(e,t)=>sg(Jo(e),e&&e.nextSibling,t),Il=e=>{const t=document.createElement("div");return Fn(t,"class",e),t},fj=e=>{const t=Il();return t.innerHTML=e.trim(),yt(Rp(t),n=>er(n))},bs=tg?window:{},ba=Math.max,dP=Math.min,Yi=Math.round,og=bs.cancelAnimationFrame,rg=bs.requestAnimationFrame,Xi=bs.setTimeout,Bp=bs.clearTimeout,Op=e=>e.charAt(0).toUpperCase()+e.slice(1),fP=()=>Il().style,mP=["-webkit-","-moz-","-o-","-ms-"],hP=["WebKit","Moz","O","MS","webkit","moz","o","ms"],Fh={},zh={},pP=e=>{let t=zh[e];if(Lf(zh,e))return t;const n=Op(e),o=fP();return yt(mP,r=>{const l=r.replace(/-/g,"");return!(t=[e,r+e,l+n,Op(l)+n].find(d=>o[d]!==void 0))}),zh[e]=t||""},Tf=e=>{let t=Fh[e]||bs[e];return Lf(Fh,e)||(yt(hP,n=>(t=t||bs[n+Op(e)],!t)),Fh[e]=t),t},gP=Tf("MutationObserver"),B2=Tf("IntersectionObserver"),Nd=Tf("ResizeObserver"),Np=Tf("ScrollTimeline"),Je=(e,...t)=>e.bind(0,...t),Mr=e=>{let t;const n=e?Xi:rg,o=e?Bp:og;return[r=>{o(t),t=n(r,ro(e)?e():e)},()=>o(t)]},mj=(e,t)=>{let n,o,r,l=gs;const{v:c,p:d,S:f}=t||{},m=function(S){l(),Bp(n),n=o=void 0,l=gs,e.apply(this,S)},g=y=>f&&o?f(o,y):y,p=()=>{l!==gs&&m(g(r)||r)},x=function(){const S=Ga(arguments),b=ro(c)?c():c;if(Po(b)&&b>=0){const M=ro(d)?d():d,w=Po(M)&&M>=0,_=b>0?Xi:rg,T=b>0?Bp:og,A=g(S)||S,F=m.bind(0,A);l();const Q=_(F,b);l=()=>T(Q),w&&!n&&(n=Xi(p,M)),o=r=A}else m(S)};return x.m=p,x},xP=/[^\x20\t\r\n\f]+/g,hj=(e,t,n)=>{const o=e&&e.classList;let r,l=0,c=!1;if(o&&t&&jc(t)){const d=t.match(xP)||[];for(c=d.length>0;r=d[l++];)c=!!n(o,r)&&c}return c},lg=(e,t)=>{hj(e,t,(n,o)=>n.remove(o))},Hr=(e,t)=>(hj(e,t,(n,o)=>n.add(o)),Je(lg,e,t)),vP=/^--/,O2=(e,t)=>e.getPropertyValue(t)||e[t]||"",ag=e=>{const t=e||0;return isFinite(t)?t:0},Fu=e=>ag(parseFloat(e||"")),zu=e=>`${(ag(e)*100).toFixed(3)}%`,Pi=e=>`${ag(e)}px`;function Nr(e,t){e&&yt(t,(n,o)=>{try{const r=e.style,l=Po(n)?Pi(n):n+"";vP.test(o)?r.setProperty(o,l):r[o]=l}catch{}})}function lr(e,t,n){const o=jc(t);let r=o?"":{};if(e){const l=bs.getComputedStyle(e,n)||e.style;r=o?O2(l,t):t.reduce((c,d)=>(c[d]=O2(l,d),c),r)}return r}const ja=e=>lr(e,"direction")==="rtl",N2=(e,t,n)=>{const o=t?`${t}-`:"",r=n?`-${n}`:"",l=`${o}top${r}`,c=`${o}right${r}`,d=`${o}bottom${r}`,f=`${o}left${r}`,m=lr(e,[l,c,d,f]);return{t:Fu(m[l]),r:Fu(m[c]),b:Fu(m[d]),l:Fu(m[f])}},la=(e,t)=>`translate${Ki(e)?`(${e.x},${e.y})`:`${t?"X":"Y"}(${e})`}`,pj="paddingTop",ig="paddingRight",cg="paddingLeft",Fd="paddingBottom",zd="marginLeft",Hd="marginRight",Fi="marginBottom",Ei="overflowX",Di="overflowY",ar="width",ir="height",Ea="hidden",CP={w:0,h:0},Rf=(e,t)=>t?{w:t[`${e}Width`],h:t[`${e}Height`]}:CP,yP=e=>Rf("inner",e||bs),zi=Je(Rf,"offset"),md=Je(Rf,"client"),$d=Je(Rf,"scroll"),Vd=e=>{const t=parseFloat(lr(e,ar))||0,n=parseFloat(lr(e,ir))||0;return{w:t-Yi(t),h:n-Yi(n)}},Io=e=>e.getBoundingClientRect(),Fp=e=>!!(e&&(e[ir]||e[ar])),gj=(e,t)=>{const n=Fp(e);return!Fp(t)&&n},F2=()=>performance.now(),bP=(e,t,n,o,r)=>{let l=0;const c=F2(),d=ba(0,n),f=m=>{const g=F2(),x=g-c>=d,y=m?1:1-(ba(0,c+d-g)/d||0),S=(t-e)*(ro(r)?r(y,y*d,0,1,d):y)+e,b=x||y===1;o&&o(S,y,b),l=b?0:rg(()=>f())};return f(),m=>{og(l),m&&f(m)}},Bf=(e,t,n,o)=>{if(e&&t){let r=!0;return yt(n,l=>{const c=o?o(e[l]):e[l],d=o?o(t[l]):t[l];c!==d&&(r=!1)}),r}return!1},xj=(e,t)=>Bf(e,t,["w","h"]),vj=(e,t)=>Bf(e,t,["x","y"]),jP=(e,t)=>Bf(e,t,["t","r","b","l"]),z2=(e,t,n)=>Bf(e,t,[ar,ir],n&&(o=>Yi(o)));let Hu;const H2="passive",SP=()=>{if(Bl(Hu)){Hu=!1;try{bs.addEventListener(H2,gs,Object.defineProperty({},H2,{get(){Hu=!0}}))}catch{}}return Hu},Cj=e=>e.split(" "),$2=(e,t,n,o)=>{yt(Cj(t),r=>{e.removeEventListener(r,n,o)})},tn=(e,t,n,o)=>{var r;const l=SP(),c=(r=l&&o&&o.$)!=null?r:l,d=o&&o.O||!1,f=o&&o.C||!1,m=l?{passive:c,capture:d}:d;return Je(Hs,Cj(t).map(g=>{const p=f?x=>{$2(e,g,p,d),n(x)}:n;return e.addEventListener(g,p,m),Je($2,e,g,p,d)}))},yj=e=>e.stopPropagation(),V2=e=>e.preventDefault(),kP={x:0,y:0},Hh=e=>{const t=e&&Io(e);return t?{x:t.left+bs.pageYOffset,y:t.top+bs.pageXOffset}:kP},bj=(e,t,n)=>n?n.n?-e:n.i?t-e:e:e,wP=(e,t)=>[t&&t.i?e:0,bj(e,e,t)],$r=(e,t)=>{const{x:n,y:o}=Po(t)?{x:t,y:t}:t||{};Po(n)&&(e.scrollLeft=n),Po(o)&&(e.scrollTop=o)},Da=e=>({x:e.scrollLeft,y:e.scrollTop}),W2=(e,t)=>{yt(ij(t),e)},zp=e=>{const t=new Map,n=(l,c)=>{if(l){const d=t.get(l);W2(f=>{d&&d[f?"delete":"clear"](f)},c)}else t.forEach(d=>{d.clear()}),t.clear()},o=(l,c)=>{if(jc(l)){const m=t.get(l)||new Set;return t.set(l,m),W2(g=>{ro(g)&&m.add(g)},c),Je(n,l,c)}aj(c)&&c&&n();const d=rr(l),f=[];return yt(d,m=>{const g=l[m];g&&It(f,o(m,g))}),Je(Hs,f)},r=(l,c)=>{yt(Ga(t.get(l)),d=>{c&&!Bd(c)?d.apply(0,c):d()})};return o(e||{}),[o,n,r]},U2=e=>JSON.stringify(e,(t,n)=>{if(ro(n))throw 0;return n}),G2=(e,t)=>e?`${t}`.split(".").reduce((n,o)=>n&&Lf(n,o)?n[o]:void 0,e):void 0,IP={paddingAbsolute:!1,showNativeOverlaidScrollbars:!1,update:{elementEvents:[["img","load"]],debounce:[0,33],attributes:null,ignoreMutation:null},overflow:{x:"scroll",y:"scroll"},scrollbars:{theme:"os-theme-dark",visibility:"auto",autoHide:"never",autoHideDelay:1300,autoHideSuspend:!1,dragScroll:!0,clickScroll:!1,pointers:["mouse","touch","pen"]}},jj=(e,t)=>{const n={},o=Yo(rr(t),rr(e));return yt(o,r=>{const l=e[r],c=t[r];if(Ki(l)&&Ki(c))bt(n[r]={},jj(l,c)),ng(n[r])&&delete n[r];else if(Lf(t,r)&&c!==l){let d=!0;if(Do(l)||Do(c))try{U2(l)===U2(c)&&(d=!1)}catch{}d&&(n[r]=c)}}),n},MP=(e,t,n)=>o=>[G2(e,o),n||G2(t,o)!==void 0],Sc="data-overlayscrollbars",Sj="os-environment",kj=`${Sj}-flexbox-glue`,_P=`${kj}-max`,wj="os-scrollbar-hidden",$h=`${Sc}-initialize`,Xs=Sc,Ij=`${Xs}-overflow-x`,Mj=`${Xs}-overflow-y`,Sa="overflowVisible",AP="scrollbarHidden",Z2="scrollbarPressed",Wd="updating",_r=`${Sc}-viewport`,Vh="arrange",_j="scrollbarHidden",ka=Sa,Hp=`${Sc}-padding`,PP=ka,q2=`${Sc}-content`,ug="os-size-observer",EP=`${ug}-appear`,DP=`${ug}-listener`,LP="os-trinsic-observer",TP="os-no-css-vars",RP="os-theme-none",as="os-scrollbar",BP=`${as}-rtl`,OP=`${as}-horizontal`,NP=`${as}-vertical`,Aj=`${as}-track`,dg=`${as}-handle`,FP=`${as}-visible`,zP=`${as}-cornerless`,Q2=`${as}-transitionless`,K2=`${as}-interaction`,Y2=`${as}-unusable`,$p=`${as}-auto-hide`,X2=`${$p}-hidden`,J2=`${as}-wheel`,HP=`${Aj}-interactive`,$P=`${dg}-interactive`,Pj={},Ej={},VP=e=>{yt(e,t=>yt(t,(n,o)=>{Pj[o]=t[o]}))},Dj=(e,t,n)=>rr(e).map(o=>{const{static:r,instance:l}=e[o],[c,d,f]=n||[],m=n?l:r;if(m){const g=n?m(c,d,t):m(t);return(f||Ej)[o]=g}}),Za=e=>Ej[e],WP="__osOptionsValidationPlugin",UP="__osSizeObserverPlugin",fg="__osScrollbarsHidingPlugin",Lj="__osClickScrollPlugin",GP={[Lj]:{static:()=>(e,t,n,o,r)=>{let l=0,c=gs;const d=f=>{c=bP(f,f+o*Math.sign(n),133,(m,g,p)=>{e(m);const x=t(),y=x+o,S=r>=x&&r<=y;if(p&&!S){if(l)d(m);else{const b=Xi(()=>{d(m)},222);c=()=>{clearTimeout(b)}}l++}})};return d(0),()=>c()}}};let Wh;const ev=(e,t,n,o)=>{Ns(e,t);const r=md(t),l=zi(t),c=Vd(n);return o&&er(t),{x:l.h-r.h+c.h,y:l.w-r.w+c.w}},ZP=e=>{let t=!1;const n=Hr(e,wj);try{t=lr(e,pP("scrollbar-width"))==="none"||lr(e,"display","::-webkit-scrollbar")==="none"}catch{}return n(),t},qP=(e,t)=>{Nr(e,{[Ei]:Ea,[Di]:Ea,direction:"rtl"}),$r(e,{x:0});const n=Hh(e),o=Hh(t);$r(e,{x:-999});const r=Hh(t);return{i:n.x===o.x,n:o.x!==r.x}},QP=(e,t)=>{const n=Hr(e,kj),o=Io(e),r=Io(t),l=z2(r,o,!0),c=Hr(e,_P),d=Io(e),f=Io(t),m=z2(f,d,!0);return n(),c(),l&&m},KP=()=>{const{body:e}=document,n=fj(`<div class="${Sj}"><div></div></div>`)[0],o=n.firstChild,[r,,l]=zp(),[c,d]=Ys({o:ev(e,n,o),u:vj},Je(ev,e,n,o,!0)),[f]=d(),m=ZP(n),g={x:f.x===0,y:f.y===0},p={elements:{host:null,padding:!m,viewport:I=>m&&I===I.ownerDocument.body&&I,content:!1},scrollbars:{slot:!0},cancel:{nativeScrollbarsOverlaid:!1,body:null}},x=bt({},IP),y=Je(bt,{},x),S=Je(bt,{},p),b={L:f,A:g,I:m,T:lr(n,"zIndex")==="-1",V:!!Np,U:qP(n,o),B:QP(n,o),j:Je(r,"r"),N:S,G:I=>bt(p,I)&&S(),q:y,F:I=>bt(x,I)&&y(),W:bt({},p),X:bt({},x)};return Jn(n,"style"),er(n),bs.addEventListener("resize",()=>{let I;if(!m&&(!g.x||!g.y)){const M=Za(fg);I=!!(M?M.P():gs)(b,c)}l("r",[I])}),b},os=()=>(Wh||(Wh=KP()),Wh),mg=(e,t)=>ro(t)?t.apply(0,e):t,YP=(e,t,n,o)=>{const r=Bl(o)?n:o;return mg(e,r)||t.apply(0,e)},Tj=(e,t,n,o)=>{const r=Bl(o)?n:o,l=mg(e,r);return!!l&&(Ni(l)?l:t.apply(0,e))},XP=(e,t)=>{const{nativeScrollbarsOverlaid:n,body:o}=t||{},{A:r,I:l,N:c}=os(),{nativeScrollbarsOverlaid:d,body:f}=c().cancel,m=n??d,g=Bl(o)?f:o,p=(r.x||r.y)&&m,x=e&&(Af(g)?!l:g);return!!p||!!x},hg=new WeakMap,JP=(e,t)=>{hg.set(e,t)},eE=e=>{hg.delete(e)},Rj=e=>hg.get(e),tE=(e,t,n)=>{let o=!1;const r=n?new WeakMap:!1,l=()=>{o=!0},c=d=>{if(r&&n){const f=n.map(m=>{const[g,p]=m||[];return[p&&g?(d||dj)(g,e):[],p]});yt(f,m=>yt(m[0],g=>{const p=m[1],x=r.get(g)||[];if(e.contains(g)&&p){const S=tn(g,p.trim(),b=>{o?(S(),r.delete(g)):t(b)});r.set(g,It(x,S))}else Hs(x),r.delete(g)}))}};return c(),[l,c]},tv=(e,t,n,o)=>{let r=!1;const{Y:l,K:c,J:d,Z:f,tt:m,nt:g}=o||{},p=mj(()=>r&&n(!0),{v:33,p:99}),[x,y]=tE(e,p,d),S=l||[],b=c||[],I=Yo(S,b),M=(_,T)=>{if(!Bd(T)){const D=m||gs,A=g||gs,F=[],Q=[];let q=!1,G=!1;if(yt(T,Z=>{const{attributeName:N,target:z,type:$,oldValue:se,addedNodes:he,removedNodes:ke}=Z,Ce=$==="attributes",ge=$==="childList",De=e===z,Se=Ce&&N,oe=Se?Fn(z,N||""):null,re=Se&&se!==oe,de=Df(b,N)&&re;if(t&&(ge||!De)){const P=Ce&&re,B=P&&f&&Od(z,f),V=(B?!D(z,N,se,oe):!Ce||P)&&!A(Z,!!B,e,o);yt(he,le=>It(F,le)),yt(ke,le=>It(F,le)),G=G||V}!t&&De&&re&&!D(z,N,se,oe)&&(It(Q,N),q=q||de)}),y(Z=>T2(F).reduce((N,z)=>(It(N,dj(Z,z)),Od(z,Z)?It(N,z):N),[])),t)return!_&&G&&n(!1),[!1];if(!Bd(Q)||q){const Z=[T2(Q),q];return!_&&n.apply(0,Z),Z}}},w=new gP(Je(M,!1));return[()=>(w.observe(e,{attributes:!0,attributeOldValue:!0,attributeFilter:I,subtree:t,childList:t,characterData:t}),r=!0,()=>{r&&(x(),w.disconnect(),r=!1)}),()=>{if(r)return p.m(),M(!0,w.takeRecords())}]},Bj=(e,t,n)=>{const{ot:r,st:l}=n||{},c=Za(UP),{U:d}=os(),f=Je(ja,e),[m]=Ys({o:!1,_:!0});return()=>{const g=[],x=fj(`<div class="${ug}"><div class="${DP}"></div></div>`)[0],y=x.firstChild,S=b=>{const I=b instanceof ResizeObserverEntry,M=!I&&Do(b);let w=!1,_=!1,T=!0;if(I){const[D,,A]=m(b.contentRect),F=Fp(D),Q=gj(D,A);_=!A||Q,w=!_&&!F,T=!w}else M?[,T]=b:_=b===!0;if(r&&T){const D=M?b[0]:ja(x);$r(x,{x:bj(3333333,3333333,D&&d),y:3333333})}w||t({et:M?b:void 0,ct:!M,st:_})};if(Nd){const b=new Nd(I=>S(I.pop()));b.observe(y),It(g,()=>{b.disconnect()})}else if(c){const[b,I]=c(y,S,l);It(g,Yo([Hr(x,EP),tn(x,"animationstart",b)],I))}else return gs;if(r){const[b]=Ys({o:void 0},f);It(g,tn(x,"scroll",I=>{const M=b(),[w,_,T]=M;_&&(lg(y,"ltr rtl"),Hr(y,w?"rtl":"ltr"),S([!!w,_,T])),yj(I)}))}return Je(Hs,It(g,Ns(e,x)))}},nE=(e,t)=>{let n;const o=f=>f.h===0||f.isIntersecting||f.intersectionRatio>0,r=Il(LP),[l]=Ys({o:!1}),c=(f,m)=>{if(f){const g=l(o(f)),[,p]=g;return p&&!m&&t(g)&&[g]}},d=(f,m)=>c(m.pop(),f);return[()=>{const f=[];if(B2)n=new B2(Je(d,!1),{root:e}),n.observe(r),It(f,()=>{n.disconnect()});else{const m=()=>{const g=zi(r);c(g)};It(f,Bj(r,m)()),m()}return Je(Hs,It(f,Ns(e,r)))},()=>n&&d(!0,n.takeRecords())]},sE=(e,t)=>{let n,o,r,l,c;const{I:d}=os(),f=`[${Xs}]`,m=`[${_r}]`,g=["tabindex"],p=["wrap","cols","rows"],x=["id","class","style","open"],y={rt:!1,lt:ja(e.it)},{it:S,ut:b,ft:I,_t:M,dt:w,vt:_,ht:T}=e,{B:D,j:A}=os(),[F]=Ys({u:xj,o:{w:0,h:0}},()=>{const Se=_(ka,Sa),oe=_(Vh,""),re=oe&&Da(b);T(ka,Sa),T(Vh,""),T("",Wd,!0);const de=$d(I),P=$d(b),B=Vd(b);return T(ka,Sa,Se),T(Vh,"",oe),T("",Wd),$r(b,re),{w:P.w+de.w+B.w,h:P.h+de.h+B.h}}),Q=M?p:Yo(x,p),q=mj(t,{v:()=>n,p:()=>o,S(Se,oe){const[re]=Se,[de]=oe;return[Yo(rr(re),rr(de)).reduce((P,B)=>(P[B]=re[B]||de[B],P),{})]}}),G=Se=>{yt(Se||g,oe=>{if(Df(g,oe)){const re=Fn(S,oe);jc(re)?Fn(b,oe,re):Jn(b,oe)}})},Z=(Se,oe)=>{const[re,de]=Se,P={gt:de};return bt(y,{rt:re}),!oe&&t(P),P},N=({ct:Se,et:oe,st:re})=>{const P=!(Se&&!re&&!oe)&&d?q:t,[B,H]=oe||[];oe&&bt(y,{lt:B}),P({ct:Se||re,st:re,bt:H})},z=(Se,oe)=>{const[,re]=F(),de={wt:re};return re&&!oe&&(Se?t:q)(de),de},$=(Se,oe,re)=>{const de={yt:oe};return oe&&!re?q(de):w||G(Se),de},[se,he]=I||!D?nE(S,Z):[],ke=!w&&Bj(S,N,{st:!0,ot:!0}),[Ce,ge]=tv(S,!1,$,{K:x,Y:Yo(x,g)}),De=w&&Nd&&new Nd(Se=>{const oe=Se[Se.length-1].contentRect;N({ct:!0,st:gj(oe,c)}),c=oe});return[()=>{G(),De&&De.observe(S);const Se=ke&&ke(),oe=se&&se(),re=Ce(),de=A(P=>{const[,B]=F();q({St:P,wt:B})});return()=>{De&&De.disconnect(),Se&&Se(),oe&&oe(),l&&l(),re(),de()}},({$t:Se,xt:oe,Ot:re})=>{const de={},[P]=Se("update.ignoreMutation"),[B,H]=Se("update.attributes"),[V,le]=Se("update.elementEvents"),[fe,ue]=Se("update.debounce"),xe=le||H,W=oe||re,Me=ye=>ro(P)&&P(ye);if(xe){r&&r(),l&&l();const[ye,Pe]=tv(I||b,!0,z,{Y:Yo(Q,B||[]),J:V,Z:f,nt:(Ve,Ye)=>{const{target:O,attributeName:ne}=Ve;return(!Ye&&ne&&!w?cP(O,f,m):!1)||!!ma(O,`.${as}`)||!!Me(Ve)}});l=ye(),r=Pe}if(ue)if(q.m(),Do(fe)){const ye=fe[0],Pe=fe[1];n=Po(ye)&&ye,o=Po(Pe)&&Pe}else Po(fe)?(n=fe,o=!1):(n=!1,o=!1);if(W){const ye=ge(),Pe=he&&he(),Ve=r&&r();ye&&bt(de,$(ye[0],ye[1],W)),Pe&&bt(de,Z(Pe[0],W)),Ve&&bt(de,z(Ve[0],W))}return de},y]},Vp=(e,t,n)=>ba(e,dP(t,n)),oE=(e,t,n)=>{const o=Yi(t),[r,l]=wP(o,n),c=(l-e)/l,d=e/r,f=e/l,m=n?n.n?c:n.i?d:f:f;return Vp(0,1,m)},Oj=(e,t,n)=>{if(n){const f=t?ar:ir,{Ct:m,Ht:g}=n,p=Io(g)[f],x=Io(m)[f];return Vp(0,1,p/x)}const o=t?"x":"y",{zt:r,It:l}=e,c=l[o],d=r[o];return Vp(0,1,c/(c+d))},nv=(e,t,n,o)=>{const r=Oj(e,o,t);return 1/r*(1-r)*n},rE=(e,t,n,o)=>{const{N:r,T:l}=os(),{scrollbars:c}=r(),{slot:d}=c,{At:f,it:m,ut:g,Et:p,Tt:x,Dt:y,dt:S}=t,{scrollbars:b}=p?{}:e,{slot:I}=b||{},M=new Map,w=H=>Np&&new Np({source:x,axis:H}),_=w("x"),T=w("y"),D=Tj([f,m,g],()=>S&&y?f:m,d,I),A=H=>S&&!y&&Jo(H)===g,F=(H,V,le)=>{const fe=.5*(le?1:-1),ue=V&&le?-1:1;return{transform:[la(Pi(0+fe),V),la(Pi(H*ue+fe),V)]}},Q=(H,V)=>bt(H,V?{clear:["left"]}:{}),q=H=>{M.forEach((V,le)=>{(H?Df(ij(H),le):!0)&&(yt(V||[],ue=>{ue&&ue.cancel()}),M.delete(le))})},G=(H,V,le,fe)=>{const ue=M.get(H)||[],xe=ue.find(W=>W&&W.timeline===V);xe?xe.effect=new KeyframeEffect(H,le,{composite:fe}):M.set(H,Yo(ue,[H.animate(le,{timeline:V,composite:fe})]))},Z=(H,V,le)=>{const fe=le?Hr:lg;yt(H,ue=>{fe(ue.kt,V)})},N=(H,V)=>{yt(H,le=>{const[fe,ue]=V(le);Nr(fe,ue)})},z=(H,V)=>{N(H,le=>{const{Ht:fe}=le;return[fe,{[V?ar:ir]:zu(Oj(n,V))}]})},$=(H,V)=>{_&&T?yt(H,le=>{const{kt:fe,Ht:ue}=le,xe=Je(nv,n,le),W=V&&ja(fe),Me=xe(W?1:0,V),ye=xe(W?0:1,V);G(ue,V?_:T,Q({transform:[la(zu(Me),V),la(zu(ye),V)]},W))}):N(H,le=>{const{Ht:fe,kt:ue}=le,{U:xe}=os(),W=V?"x":"y",{zt:Me}=n,ye=ja(ue),Pe=nv(n,le,oE(Da(x)[W],Me[W],V&&ye&&xe),V);return[fe,{transform:la(zu(Pe),V)}]})},se=H=>{const{kt:V}=H,le=A(V)&&V,{x:fe,y:ue}=Da(x);return[le,{transform:le?la({x:Pi(fe),y:Pi(ue)}):""}]},he=[],ke=[],Ce=[],ge=(H,V,le)=>{const fe=aj(le),ue=fe?le:!0,xe=fe?!le:!0;ue&&Z(ke,H,V),xe&&Z(Ce,H,V)},De=()=>{z(ke,!0),z(Ce)},Se=()=>{$(ke,!0),$(Ce)},oe=()=>{if(S)if(_&&T){const{zt:H}=n,V=!!ke.find(({kt:fe})=>ja(fe)),le=(fe,ue,xe,W,Me)=>G(fe,ue,Q(F(xe,W,Me),V),"add");yt(Yo(Ce,ke),({kt:fe})=>{A(fe)?(le(fe,_,H.x,!0,V),le(fe,T,H.y)):q(fe)})}else N(ke,se),N(Ce,se)},re=H=>{const V=H?OP:NP,le=H?ke:Ce,fe=Bd(le)?Q2:"",ue=Il(`${as} ${V} ${fe}`),xe=Il(Aj),W=Il(dg),Me={kt:ue,Ct:xe,Ht:W};return l||Hr(ue,TP),It(le,Me),It(he,[Ns(ue,xe),Ns(xe,W),Je(er,ue),q,o(Me,ge,$,H)]),Me},de=Je(re,!0),P=Je(re,!1),B=()=>(Ns(D,ke[0].kt),Ns(D,Ce[0].kt),Xi(()=>{ge(Q2)},300),Je(Hs,he));return de(),P(),[{Mt:De,Rt:Se,Pt:oe,Lt:ge,Vt:{V:_,Ut:ke,Bt:de,jt:Je(N,ke)},Nt:{V:T,Ut:Ce,Bt:P,jt:Je(N,Ce)}},B]},lE=(e,t,n)=>{const{it:o,Tt:r,Gt:l}=t;return(c,d,f,m)=>{const{kt:g,Ct:p,Ht:x}=c,[y,S]=Mr(333),[b,I]=Mr(),M=Je(f,[c],m),w=!!r.scrollBy,_=`client${m?"X":"Y"}`,T=m?ar:ir,D=m?"left":"top",A=m?"w":"h",F=m?"x":"y",Q=Z=>Z.propertyName.indexOf(T)>-1,q=()=>{const Z="pointerup pointerleave pointercancel lostpointercapture",N=(z,$)=>se=>{const{zt:he}=n,ke=zi(p)[A]-zi(x)[A],ge=$*se/ke*he[F];$r(r,{[F]:z+ge})};return tn(p,"pointerdown",z=>{const $=ma(z.target,`.${dg}`)===x,se=$?x:p,he=e.scrollbars,{button:ke,isPrimary:Ce,pointerType:ge}=z,{pointers:De}=he;if(ke===0&&Ce&&he[$?"dragScroll":"clickScroll"]&&(De||[]).includes(ge)){const oe=!$&&z.shiftKey,re=Je(Io,x),de=Je(Io,p),P=(Ve,Ye)=>(Ve||re())[D]-(Ye||de())[D],B=Yi(Io(r)[T])/zi(r)[A]||1,H=N(Da(r)[F]||0,1/B),V=z[_],le=re(),fe=de(),ue=le[T],xe=P(le,fe)+ue/2,W=V-fe[D],Me=$?0:W-xe,ye=Ve=>{Hs(Pe),se.releasePointerCapture(Ve.pointerId)},Pe=[Je(wl,o,Xs,Z2),tn(l,Z,ye),tn(l,"selectstart",Ve=>V2(Ve),{$:!1}),tn(p,Z,ye),tn(p,"pointermove",Ve=>{const Ye=Ve[_]-V;($||oe)&&H(Me+Ye)})];if(wl(o,Xs,Z2,!0),se.setPointerCapture(z.pointerId),oe)H(Me);else if(!$){const Ve=Za(Lj);Ve&&It(Pe,Ve(H,P,Me,ue,W))}}})};let G=!0;return Je(Hs,[tn(g,"pointerenter",()=>{d(K2,!0)}),tn(g,"pointerleave pointercancel",()=>{d(K2,!1)}),tn(g,"wheel",Z=>{const{deltaX:N,deltaY:z,deltaMode:$}=Z;w&&G&&$===0&&Jo(g)===o&&r.scrollBy({left:N,top:z,behavior:"smooth"}),G=!1,d(J2,!0),y(()=>{G=!0,d(J2)}),V2(Z)},{$:!1,O:!0}),tn(x,"transitionstart",Z=>{if(Q(Z)){const N=()=>{M(),b(N)};N()}}),tn(x,"transitionend transitioncancel",Z=>{Q(Z)&&(I(),M())}),tn(g,"mousedown",Je(tn,l,"click",yj,{C:!0,O:!0}),{O:!0}),q(),S,I])}},aE=(e,t,n,o,r,l)=>{let c,d,f,m,g,p=gs,x=0;const[y,S]=Mr(),[b,I]=Mr(),[M,w]=Mr(100),[_,T]=Mr(100),[D,A]=Mr(100),[F,Q]=Mr(()=>x),[q,G]=rE(e,r,o,lE(t,r,o)),{it:Z,qt:N,Dt:z}=r,{Lt:$,Mt:se,Rt:he,Pt:ke}=q,Ce=re=>{$($p,re,!0),$($p,re,!1)},ge=(re,de)=>{if(Q(),re)$(X2);else{const P=Je($,X2,!0);x>0&&!de?F(P):P()}},De=re=>re.pointerType==="mouse",Se=re=>{De(re)&&(m=d,m&&ge(!0))},oe=[w,Q,T,A,I,S,()=>p(),tn(Z,"pointerover",Se,{C:!0}),tn(Z,"pointerenter",Se),tn(Z,"pointerleave",re=>{De(re)&&(m=!1,d&&ge(!1))}),tn(Z,"pointermove",re=>{De(re)&&c&&y(()=>{w(),ge(!0),_(()=>{c&&ge(!1)})})}),tn(N,"scroll",re=>{b(()=>{he(),f&&ge(!0),M(()=>{f&&!m&&ge(!1)})}),l(re),ke()})];return[()=>Je(Hs,It(oe,G())),({$t:re,Ot:de,Ft:P,Wt:B})=>{const{Xt:H,Yt:V,Kt:le}=B||{},{bt:fe,st:ue}=P||{},{lt:xe}=n,{A:W}=os(),{zt:Me,Jt:ye,Zt:Pe}=o,[Ve,Ye]=re("showNativeOverlaidScrollbars"),[O,ne]=re("scrollbars.theme"),[ce,_e]=re("scrollbars.visibility"),[be,K]=re("scrollbars.autoHide"),[ve,Ee]=re("scrollbars.autoHideSuspend"),[Ze]=re("scrollbars.autoHideDelay"),[lt,St]=re("scrollbars.dragScroll"),[Ot,Xt]=re("scrollbars.clickScroll"),Jt=ue&&!de,xn=Pe.x||Pe.y,on=H||V||fe||de,en=le||_e,Tt=Ve&&W.x&&W.y,is=(cn,_s)=>{const Hl=ce==="visible"||ce==="auto"&&cn==="scroll";return $(FP,Hl,_s),Hl};if(x=Ze,Jt&&(ve&&xn?(Ce(!1),p(),D(()=>{p=tn(N,"scroll",Je(Ce,!0),{C:!0})})):Ce(!0)),Ye&&$(RP,Tt),ne&&($(g),$(O,!0),g=O),Ee&&!ve&&Ce(!0),K&&(c=be==="move",d=be==="leave",f=be!=="never",ge(!f,!0)),St&&$($P,lt),Xt&&$(HP,Ot),en){const cn=is(ye.x,!0),_s=is(ye.y,!1);$(zP,!(cn&&_s))}on&&(se(),he(),ke(),$(Y2,!Me.x,!0),$(Y2,!Me.y,!1),$(BP,xe&&!z))},{},q]},iE=e=>{const t=os(),{N:n,I:o}=t,r=Za(fg),l=r&&r.H,{elements:c}=n(),{host:d,padding:f,viewport:m,content:g}=c,p=Ni(e),x=p?{}:e,{elements:y}=x,{host:S,padding:b,viewport:I,content:M}=y||{},w=p?e:x.target,_=Od(w,"textarea"),T=w.ownerDocument,D=T.documentElement,A=w===T.body,F=T.defaultView,Q=Je(YP,[w]),q=Je(Tj,[w]),G=Je(mg,[w]),Z=Je(Il,""),N=Je(Q,Z,m),z=Je(q,Z,g),$=N(I),se=$===w,he=se&&A,ke=!se&&z(M),Ce=!se&&Ni($)&&$===ke,ge=Ce&&!!G(g),De=ge?N():$,Se=ge?ke:z(),re=he?D:Ce?De:$,de=_?Q(Z,d,S):w,P=he?re:de,B=Ce?Se:ke,H=T.activeElement,V=!se&&F.top===F&&H===w,le={At:w,it:P,ut:re,Qt:!se&&q(Z,f,b),ft:B,tn:!se&&!o&&l&&l(t),Tt:he?D:re,qt:he?T:re,nn:F,Gt:T,_t:_,Dt:A,Et:p,dt:se,sn:Ce,vt:(K,ve)=>aP(re,se?Xs:_r,se?ve:K),ht:(K,ve,Ee)=>wl(re,se?Xs:_r,se?ve:K,Ee)},fe=rr(le).reduce((K,ve)=>{const Ee=le[ve];return It(K,Ee&&Ni(Ee)&&!Jo(Ee)?Ee:!1)},[]),ue=K=>K?Df(fe,K):null,{At:xe,it:W,Qt:Me,ut:ye,ft:Pe,tn:Ve}=le,Ye=[()=>{Jn(W,Xs),Jn(W,$h),Jn(xe,$h),A&&(Jn(D,Xs),Jn(D,$h))}],O=_&&ue(W);let ne=_?xe:Rp([Pe,ye,Me,W,xe].find(K=>ue(K)===!1));const ce=he?xe:Pe||ye,_e=Je(Hs,Ye);return[le,()=>{Fn(W,Xs,se?"viewport":"host"),Fn(Me,Hp,""),Fn(Pe,q2,""),se||Fn(ye,_r,"");const K=A&&!se?Hr(Jo(w),wj):gs,ve=Ee=>{Ns(Jo(Ee),Rp(Ee)),er(Ee)};if(O&&(R2(xe,W),It(Ye,()=>{R2(W,xe),er(W)})),Ns(ce,ne),Ns(W,Me),Ns(Me||W,!se&&ye),Ns(ye,Pe),It(Ye,()=>{K(),Jn(Me,Hp),Jn(Pe,q2),Jn(ye,Ij),Jn(ye,Mj),Jn(ye,_r),ue(Pe)&&ve(Pe),ue(ye)&&ve(ye),ue(Me)&&ve(Me)}),o&&!se&&(wl(ye,_r,_j,!0),It(Ye,Je(Jn,ye,_r))),Ve&&(uP(ye,Ve),It(Ye,Je(er,Ve))),V){const Ee="tabindex",Ze=Fn(ye,Ee);Fn(ye,Ee,"-1"),ye.focus();const lt=()=>Ze?Fn(ye,Ee,Ze):Jn(ye,Ee),St=tn(T,"pointerdown keydown",()=>{lt(),St()});It(Ye,[lt,St])}else H&&H.focus&&H.focus();return ne=0,_e},_e]},cE=({ft:e})=>({Ft:t,en:n,Ot:o})=>{const{B:r}=os(),{gt:l}=t||{},{rt:c}=n;(e||!r)&&(l||o)&&Nr(e,{[ir]:c?"":"100%"})},uE=({it:e,Qt:t,ut:n,dt:o},r)=>{const[l,c]=Ys({u:jP,o:N2()},Je(N2,e,"padding",""));return({$t:d,Ft:f,en:m,Ot:g})=>{let[p,x]=c(g);const{I:y,B:S}=os(),{ct:b,wt:I,bt:M}=f||{},{lt:w}=m,[_,T]=d("paddingAbsolute");(b||x||(g||!S&&I))&&([p,x]=l(g));const A=!o&&(T||M||x);if(A){const F=!_||!t&&!y,Q=p.r+p.l,q=p.t+p.b,G={[Hd]:F&&!w?-Q:0,[Fi]:F?-q:0,[zd]:F&&w?-Q:0,top:F?-p.t:0,right:F?w?-p.r:"auto":0,left:F?w?"auto":-p.l:0,[ar]:F?`calc(100% + ${Q}px)`:""},Z={[pj]:F?p.t:0,[ig]:F?p.r:0,[Fd]:F?p.b:0,[cg]:F?p.l:0};Nr(t||n,G),Nr(n,Z),bt(r,{Qt:p,cn:!F,k:t?Z:bt({},G,Z)})}return{rn:A}}},dE=({it:e,Qt:t,ut:n,tn:o,dt:r,ht:l,Dt:c,nn:d},f)=>{const m=Je(ba,0),g="visible",p=42,x={u:xj,o:{w:0,h:0}},y={u:vj,o:{x:Ea,y:Ea}},S=(oe,re)=>{const de=bs.devicePixelRatio%1!==0?1:0,P={w:m(oe.w-re.w),h:m(oe.h-re.h)};return{w:P.w>de?P.w:0,h:P.h>de?P.h:0}},b=oe=>oe.indexOf(g)===0,{L:I,B:M,I:w,A:_}=os(),T=Za(fg),D=!r&&!w&&(_.x||_.y),A=c&&r,[F,Q]=Ys(x,Je(Vd,n)),[q,G]=Ys(x,Je($d,n)),[Z,N]=Ys(x),[z,$]=Ys(x),[se]=Ys(y),he=(oe,re)=>{if(Nr(n,{[ir]:""}),re){const{cn:de,Qt:P}=f,{ln:B,M:H}=oe,V=Vd(e),le=md(e),fe=lr(n,"boxSizing")==="content-box",ue=de||fe?P.b+P.t:0,xe=!(_.x&&fe);Nr(n,{[ir]:le.h+V.h+(B.x&&xe?H.x:0)-ue})}},ke=(oe,re)=>{const de=!w&&!oe?p:0,P=(Me,ye,Pe)=>{const Ve=lr(n,Me),O=(re?re[Me]:Ve)==="scroll";return[Ve,O,O&&!w?ye?de:Pe:0,ye&&!!de]},[B,H,V,le]=P(Ei,_.x,I.x),[fe,ue,xe,W]=P(Di,_.y,I.y);return{Jt:{x:B,y:fe},ln:{x:H,y:ue},M:{x:V,y:xe},R:{x:le,y:W}}},Ce=(oe,re,de,P)=>{const B=(ue,xe)=>{const W=b(ue),Me=xe&&W&&ue.replace(`${g}-`,"")||"";return[xe&&!W?ue:"",b(Me)?"hidden":Me]},[H,V]=B(de.x,re.x),[le,fe]=B(de.y,re.y);return P[Ei]=V&&le?V:H,P[Di]=fe&&H?fe:le,ke(oe,P)},ge=(oe,re,de,P)=>{const{M:B,R:H}=oe,{x:V,y:le}=H,{x:fe,y:ue}=B,{k:xe}=f,W=re?zd:Hd,Me=re?cg:ig,ye=xe[W],Pe=xe[Fi],Ve=xe[Me],Ye=xe[Fd];P[ar]=`calc(100% + ${ue+ye*-1}px)`,P[W]=-ue+ye,P[Fi]=-fe+Pe,de&&(P[Me]=Ve+(le?ue:0),P[Fd]=Ye+(V?fe:0))},[De,Se]=T?T.D(D,M,n,o,f,ke,ge):[()=>D,()=>[gs]];return({$t:oe,Ft:re,en:de,Ot:P},{rn:B})=>{const{ct:H,yt:V,wt:le,gt:fe,bt:ue,St:xe}=re||{},{rt:W,lt:Me}=de,[ye,Pe]=oe("showNativeOverlaidScrollbars"),[Ve,Ye]=oe("overflow"),O=ye&&_.x&&_.y,ne=!r&&!M&&(H||le||V||Pe||fe),ce=H||B||le||ue||xe||Pe,_e=b(Ve.x),be=b(Ve.y),K=_e||be;let ve=Q(P),Ee=G(P),Ze=N(P),lt=$(P),St;if(Pe&&w&&l(_j,AP,!O),ne&&(St=ke(O),he(St,W)),ce){K&&l(ka,Sa,!1);const[Oo,No]=Se(O,Me,St),[co,am]=ve=F(P),[uo,Bc]=Ee=q(P),$l=md(n);let Xa=uo,Ja=$l;Oo(),(Bc||am||Pe)&&No&&!O&&De(No,uo,co,Me)&&(Ja=md(n),Xa=$d(n));const Oc=yP(d),Nc={w:m(ba(uo.w,Xa.w)+co.w),h:m(ba(uo.h,Xa.h)+co.h)},Vl={w:m((A?Oc.w:Ja.w+m($l.w-uo.w))+co.w),h:m((A?Oc.h:Ja.h+m($l.h-uo.h))+co.h)};lt=z(Vl),Ze=Z(S(Nc,Vl),P)}const[Ot,Xt]=lt,[Jt,xn]=Ze,[on,en]=Ee,[Tt,is]=ve,cn={x:Jt.w>0,y:Jt.h>0},_s=_e&&be&&(cn.x||cn.y)||_e&&cn.x&&!cn.y||be&&cn.y&&!cn.x;if(B||ue||xe||is||en||Xt||xn||Ye||Pe||ne||ce){const Oo={[Hd]:0,[Fi]:0,[zd]:0,[ar]:"",[Ei]:"",[Di]:""},No=Ce(O,cn,Ve,Oo),co=De(No,on,Tt,Me);r||ge(No,Me,co,Oo),ne&&he(No,W),r?(Fn(e,Ij,Oo[Ei]),Fn(e,Mj,Oo[Di])):Nr(n,Oo)}wl(e,Xs,Sa,_s),wl(t,Hp,PP,_s),r||wl(n,_r,ka,K);const[rm,lm]=se(ke(O).Jt);return bt(f,{Jt:rm,It:{x:Ot.w,y:Ot.h},zt:{x:Jt.w,y:Jt.h},Zt:cn}),{Kt:lm,Xt,Yt:xn}}},fE=e=>{const[t,n,o]=iE(e),r={Qt:{t:0,r:0,b:0,l:0},cn:!1,k:{[Hd]:0,[Fi]:0,[zd]:0,[pj]:0,[ig]:0,[Fd]:0,[cg]:0},It:{x:0,y:0},zt:{x:0,y:0},Jt:{x:Ea,y:Ea},Zt:{x:!1,y:!1}},{At:l,ut:c,ht:d,dt:f}=t,{I:m,A:g,B:p}=os(),x=!m&&(g.x||g.y),y=[cE(t),uE(t,r),dE(t,r)];return[n,S=>{const b={},M=(x||!p)&&Da(c);return d("",Wd,!0),yt(y,w=>{bt(b,w(S,b)||{})}),d("",Wd),$r(c,M),!f&&$r(l,0),b},r,t,o]},mE=(e,t,n,o)=>{const[r,l,c,d,f]=fE(e),[m,g,p]=sE(d,M=>{I({},M)}),[x,y,,S]=aE(e,t,p,c,d,o),b=M=>rr(M).some(w=>!!M[w]),I=(M,w)=>{const{an:_,Ot:T,xt:D,un:A}=M,F=_||{},Q=!!T,q={$t:MP(t,F,Q),an:F,Ot:Q};if(A)return y(q),!1;const G=w||g(bt({},q,{xt:D})),Z=l(bt({},q,{en:p,Ft:G}));y(bt({},q,{Ft:G,Wt:Z}));const N=b(G),z=b(Z),$=N||z||!ng(F)||Q;return $&&n(M,{Ft:G,Wt:Z}),$};return[()=>{const{At:M,ut:w,Gt:_,Dt:T}=d,D=T?_.documentElement:M,A=Da(D),F=[m(),r(),x()];return $r(w,A),Je(Hs,F)},I,()=>({fn:p,_n:c}),{dn:d,vn:S},f]},Mo=(e,t,n)=>{const{q:o}=os(),r=Ni(e),l=r?e:e.target,c=Rj(l);if(t&&!c){let d=!1;const f=[],m={},g=G=>{const Z=cj(G,!0),N=Za(WP);return N?N(Z,!0):Z},p=bt({},o(),g(t)),[x,y,S]=zp(),[b,I,M]=zp(n),w=(G,Z)=>{M(G,Z),S(G,Z)},[_,T,D,A,F]=mE(e,p,({an:G,Ot:Z},{Ft:N,Wt:z})=>{const{ct:$,bt:se,gt:he,wt:ke,yt:Ce,st:ge}=N,{Xt:De,Yt:Se,Kt:oe}=z;w("updated",[q,{updateHints:{sizeChanged:!!$,directionChanged:!!se,heightIntrinsicChanged:!!he,overflowEdgeChanged:!!De,overflowAmountChanged:!!Se,overflowStyleChanged:!!oe,contentMutation:!!ke,hostMutation:!!Ce,appear:!!ge},changedOptions:G||{},force:!!Z}])},G=>w("scroll",[q,G])),Q=G=>{eE(l),Hs(f),d=!0,w("destroyed",[q,G]),y(),I()},q={options(G,Z){if(G){const N=Z?o():{},z=jj(p,bt(N,g(G)));ng(z)||(bt(p,z),T({an:z}))}return bt({},p)},on:b,off:(G,Z)=>{G&&Z&&I(G,Z)},state(){const{fn:G,_n:Z}=D(),{lt:N}=G,{It:z,zt:$,Jt:se,Zt:he,Qt:ke,cn:Ce}=Z;return bt({},{overflowEdge:z,overflowAmount:$,overflowStyle:se,hasOverflow:he,padding:ke,paddingAbsolute:Ce,directionRTL:N,destroyed:d})},elements(){const{At:G,it:Z,Qt:N,ut:z,ft:$,Tt:se,qt:he}=A.dn,{Vt:ke,Nt:Ce}=A.vn,ge=Se=>{const{Ht:oe,Ct:re,kt:de}=Se;return{scrollbar:de,track:re,handle:oe}},De=Se=>{const{Ut:oe,Bt:re}=Se,de=ge(oe[0]);return bt({},de,{clone:()=>{const P=ge(re());return T({un:!0}),P}})};return bt({},{target:G,host:Z,padding:N||z,viewport:z,content:$||z,scrollOffsetElement:se,scrollEventElement:he,scrollbarHorizontal:De(ke),scrollbarVertical:De(Ce)})},update:G=>T({Ot:G,xt:!0}),destroy:Je(Q,!1),plugin:G=>m[rr(G)[0]]};return It(f,[F]),JP(l,q),Dj(Pj,Mo,[q,x,m]),XP(A.dn.Dt,!r&&e.cancel)?(Q(!0),q):(It(f,_()),w("initialized",[q]),q.update(!0),q)}return c};Mo.plugin=e=>{const t=Do(e),n=t?e:[e],o=n.map(r=>Dj(r,Mo)[0]);return VP(n),t?o:o[0]};Mo.valid=e=>{const t=e&&e.elements,n=ro(t)&&t();return Rd(n)&&!!Rj(n.target)};Mo.env=()=>{const{L:e,A:t,I:n,U:o,B:r,T:l,V:c,W:d,X:f,N:m,G:g,q:p,F:x}=os();return bt({},{scrollbarsSize:e,scrollbarsOverlaid:t,scrollbarsHiding:n,rtlScrollBehavior:o,flexboxGlue:r,cssCustomProperties:l,scrollTimeline:c,staticDefaultInitialization:d,staticDefaultOptions:f,getDefaultInitialization:m,setDefaultInitialization:g,getDefaultOptions:p,setDefaultOptions:x})};Mo.plugin(GP);const kc={defer:!0,options:{scrollbars:{visibility:"auto",autoHide:"scroll",autoHideDelay:1300,theme:"os-theme-dark",clickScroll:!0},overflow:{x:"hidden"}}},Nj=(e="hidden",t="scroll")=>{const n=o6(kc);return ey(n,{options:{overflow:{y:t,x:e}}}),n},hE=()=>{if(typeof window>"u"){const m=()=>{};return[m,m]}let e,t;const n=window,o=typeof n.requestIdleCallback=="function",r=n.requestAnimationFrame,l=n.cancelAnimationFrame,c=o?n.requestIdleCallback:r,d=o?n.cancelIdleCallback:l,f=()=>{d(e),l(t)};return[(m,g)=>{f(),e=c(o?()=>{f(),t=r(m)}:m,typeof g=="object"?g:{timeout:2233})},f]},pg=e=>{const{options:t,events:n,defer:o}=e||{},[r,l]=u.useMemo(hE,[]),c=u.useRef(null),d=u.useRef(o),f=u.useRef(t),m=u.useRef(n);return u.useEffect(()=>{d.current=o},[o]),u.useEffect(()=>{const{current:g}=c;f.current=t,Mo.valid(g)&&g.options(t||{},!0)},[t]),u.useEffect(()=>{const{current:g}=c;m.current=n,Mo.valid(g)&&g.on(n||{},!0)},[n]),u.useEffect(()=>()=>{var g;l(),(g=c.current)==null||g.destroy()},[]),u.useMemo(()=>[g=>{const p=c.current;if(Mo.valid(p))return;const x=d.current,y=f.current||{},S=m.current||{},b=()=>c.current=Mo(g,y,S);x?r(b,x):b()},()=>c.current],[])},pE=(e,t)=>{const{element:n="div",options:o,events:r,defer:l,children:c,...d}=e,f=n,m=u.useRef(null),g=u.useRef(null),[p,x]=pg({options:o,events:r,defer:l});return u.useEffect(()=>{const{current:y}=m,{current:S}=g;return y&&S&&p({target:y,elements:{viewport:S,content:S}}),()=>{var b;return(b=x())==null?void 0:b.destroy()}},[p,n]),u.useImperativeHandle(t,()=>({osInstance:x,getElement:()=>m.current}),[]),te.createElement(f,{"data-overlayscrollbars-initialize":"",ref:m,...d},te.createElement("div",{"data-overlayscrollbars-contents":"",ref:g},c))},Of=u.forwardRef(pE),gE={height:"100%",width:"100%"},xE=({children:e,maxHeight:t,overflowX:n="hidden",overflowY:o="scroll"})=>{const r=u.useMemo(()=>Nj(n,o).options,[n,o]);return s.jsx(L,{w:"full",h:"full",maxHeight:t,position:"relative",children:s.jsx(We,{position:"absolute",top:0,left:0,right:0,bottom:0,children:s.jsx(Of,{defer:!0,style:gE,options:r,children:e})})})},io=u.memo(xE),vE=Fe(h0,e=>e.prompts),CE={"&::marker":{color:"base.500"}},yE=()=>{const{t:e}=R(),t=j(c=>c.dynamicPrompts.parsingError),n=j(c=>c.dynamicPrompts.isError),o=j(c=>c.dynamicPrompts.isLoading),r=j(vE),l=u.useMemo(()=>{let c=`${e("dynamicPrompts.promptsPreview")} (${r.length})`;return t&&(c+=` - ${t}`),c},[t,r.length,e]);return n?s.jsx(L,{w:"full",h:"full",layerStyle:"second",alignItems:"center",justifyContent:"center",p:8,children:s.jsx(Yt,{icon:nj,label:"Problem generating prompts"})}):s.jsxs(U,{orientation:"vertical",w:"full",h:"full",isInvalid:!!(t||n),children:[s.jsx(zt,{feature:"dynamicPrompts",inPortal:!1,children:s.jsx(Y,{children:l})}),s.jsxs(L,{w:"full",h:"full",pos:"relative",layerStyle:"first",p:4,borderRadius:"base",children:[s.jsx(io,{children:s.jsx(r6,{stylePosition:"inside",ms:0,children:r.map((c,d)=>s.jsx(wo,{fontSize:"sm",sx:CE,children:s.jsx(pe,{as:"span",children:c})},`${c}.${d}`))})}),o&&s.jsx(L,{pos:"absolute",w:"full",h:"full",top:0,insetInlineStart:0,layerStyle:"second",opacity:.7,alignItems:"center",justifyContent:"center",children:s.jsx(Kr,{})})]})]})},bE=u.memo(yE),jE=()=>{const e=J(),{t}=R(),n=j(c=>c.dynamicPrompts.seedBehaviour),o=u.useMemo(()=>[{value:"PER_ITERATION",label:t("dynamicPrompts.seedBehaviour.perIterationLabel"),description:t("dynamicPrompts.seedBehaviour.perIterationDesc")},{value:"PER_PROMPT",label:t("dynamicPrompts.seedBehaviour.perPromptLabel"),description:t("dynamicPrompts.seedBehaviour.perPromptDesc")}],[t]),r=u.useCallback(c=>{l6(c==null?void 0:c.value)&&e(a6(c.value))},[e]),l=u.useMemo(()=>o.find(c=>c.value===n),[o,n]);return s.jsxs(U,{children:[s.jsx(zt,{feature:"dynamicPromptsSeedBehaviour",inPortal:!1,children:s.jsx(Y,{children:t("dynamicPrompts.seedBehaviour.label")})}),s.jsx(Xe,{value:l,options:o,onChange:r})]})},SE=u.memo(jE),Fj=u.memo(()=>{const{t:e}=R(),{isOpen:t,onClose:n}=$b();return s.jsxs(Al,{isOpen:t,onClose:n,isCentered:!0,children:[s.jsx(tr,{}),s.jsxs(Pl,{w:"80vw",h:"80vh",maxW:"unset",maxH:"unset",children:[s.jsx(nr,{children:e("dynamicPrompts.dynamicPrompts")}),s.jsx(Ha,{}),s.jsxs(sr,{as:L,flexDir:"column",gap:4,w:"full",h:"full",pb:4,children:[s.jsxs(L,{gap:4,children:[s.jsx(SE,{}),s.jsx(sP,{})]}),s.jsx(bE,{})]})]})]})});Fj.displayName="DynamicPromptsModal";const kE=ft(Na,e=>e.language);function wE(e){return Ie({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M15.4565 9.67491L15.3144 9.53285C14.6661 8.90783 13.8549 8.43357 12.9235 8.18399C10.0168 7.40515 7.22541 9.05261 6.43185 12.0142C6.38901 12.1741 6.36574 12.3536 6.3285 12.805C6.17423 14.675 5.73449 16.0696 4.5286 17.4841C6.78847 18.3726 9.46572 18.9984 11.5016 18.9984C13.9702 18.9984 16.1644 17.3393 16.8126 14.9201C17.3306 12.9868 16.7513 11.018 15.4565 9.67491ZM13.2886 6.21289L18.2278 2.3713C18.6259 2.06168 19.1922 2.09694 19.5488 2.45355L22.543 5.44774C22.8997 5.80435 22.9349 6.3707 22.6253 6.76879L18.7847 11.7067C19.0778 12.895 19.0836 14.1719 18.7444 15.4377C17.8463 18.7896 14.8142 20.9984 11.5016 20.9984C8 20.9984 3.5 19.4966 1 17.9966C4.97978 14.9966 4.04722 13.1864 4.5 11.4966C5.55843 7.54646 9.34224 5.23923 13.2886 6.21289ZM16.7015 8.09149C16.7673 8.15494 16.8319 8.21952 16.8952 8.2852L18.0297 9.41972L20.5046 6.23774L18.7589 4.49198L15.5769 6.96685L16.7015 8.09149Z"},child:[]}]})(e)}function IE(e){return Ie({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5 5V19H19V5H5ZM4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3ZM9.86885 15L9.04918 17H6.83333L11 7H13L17.1667 17H14.9508L14.1311 15H9.86885ZM10.6885 13H13.3115L12 9.8L10.6885 13Z"},child:[]}]})(e)}function ME(e){return Ie({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5 11H19V5H5V11ZM21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3H20C20.5523 3 21 3.44772 21 4ZM19 13H5V19H19V13ZM7 15H10V17H7V15ZM7 7H10V9H7V7Z"},child:[]}]})(e)}function _E(e){return Ie({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M8 4H21V6H8V4ZM3 3.5H6V6.5H3V3.5ZM3 10.5H6V13.5H3V10.5ZM3 17.5H6V20.5H3V17.5ZM8 11H21V13H8V11ZM8 18H21V20H8V18Z"},child:[]}]})(e)}function AE(e){return Ie({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M19.3034 5.33716C17.9344 4.71103 16.4805 4.2547 14.9629 4C14.7719 4.32899 14.5596 4.77471 14.411 5.12492C12.7969 4.89144 11.1944 4.89144 9.60255 5.12492C9.45397 4.77471 9.2311 4.32899 9.05068 4C7.52251 4.2547 6.06861 4.71103 4.70915 5.33716C1.96053 9.39111 1.21766 13.3495 1.5891 17.2549C3.41443 18.5815 5.17612 19.388 6.90701 19.9187C7.33151 19.3456 7.71356 18.73 8.04255 18.0827C7.41641 17.8492 6.82211 17.5627 6.24904 17.2231C6.39762 17.117 6.5462 17.0003 6.68416 16.8835C10.1438 18.4648 13.8911 18.4648 17.3082 16.8835C17.4568 17.0003 17.5948 17.117 17.7434 17.2231C17.1703 17.5627 16.576 17.8492 15.9499 18.0827C16.2789 18.73 16.6609 19.3456 17.0854 19.9187C18.8152 19.388 20.5875 18.5815 22.4033 17.2549C22.8596 12.7341 21.6806 8.80747 19.3034 5.33716ZM8.5201 14.8459C7.48007 14.8459 6.63107 13.9014 6.63107 12.7447C6.63107 11.5879 7.45884 10.6434 8.5201 10.6434C9.57071 10.6434 10.4303 11.5879 10.4091 12.7447C10.4091 13.9014 9.57071 14.8459 8.5201 14.8459ZM15.4936 14.8459C14.4535 14.8459 13.6034 13.9014 13.6034 12.7447C13.6034 11.5879 14.4323 10.6434 15.4936 10.6434C16.5442 10.6434 17.4038 11.5879 17.3825 12.7447C17.3825 13.9014 16.5548 14.8459 15.4936 14.8459Z"},child:[]}]})(e)}function PE(e){return Ie({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12.001 2C6.47598 2 2.00098 6.475 2.00098 12C2.00098 16.425 4.86348 20.1625 8.83848 21.4875C9.33848 21.575 9.52598 21.275 9.52598 21.0125C9.52598 20.775 9.51348 19.9875 9.51348 19.15C7.00098 19.6125 6.35098 18.5375 6.15098 17.975C6.03848 17.6875 5.55098 16.8 5.12598 16.5625C4.77598 16.375 4.27598 15.9125 5.11348 15.9C5.90098 15.8875 6.46348 16.625 6.65098 16.925C7.55098 18.4375 8.98848 18.0125 9.56348 17.75C9.65098 17.1 9.91348 16.6625 10.201 16.4125C7.97598 16.1625 5.65098 15.3 5.65098 11.475C5.65098 10.3875 6.03848 9.4875 6.67598 8.7875C6.57598 8.5375 6.22598 7.5125 6.77598 6.1375C6.77598 6.1375 7.61348 5.875 9.52598 7.1625C10.326 6.9375 11.176 6.825 12.026 6.825C12.876 6.825 13.726 6.9375 14.526 7.1625C16.4385 5.8625 17.276 6.1375 17.276 6.1375C17.826 7.5125 17.476 8.5375 17.376 8.7875C18.0135 9.4875 18.401 10.375 18.401 11.475C18.401 15.3125 16.0635 16.1625 13.8385 16.4125C14.201 16.725 14.5135 17.325 14.5135 18.2625C14.5135 19.6 14.501 20.675 14.501 21.0125C14.501 21.275 14.6885 21.5875 15.1885 21.4875C19.259 20.1133 21.9999 16.2963 22.001 12C22.001 6.475 17.526 2 12.001 2Z"},child:[]}]})(e)}function EE(e){return Ie({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5 11.1005L7 9.1005L12.5 14.6005L16 11.1005L19 14.1005V5H5V11.1005ZM5 13.9289V19H8.1005L11.0858 16.0147L7 11.9289L5 13.9289ZM10.9289 19H19V16.9289L16 13.9289L10.9289 19ZM4 3H20C20.5523 3 21 3.44772 21 4V20C21 20.5523 20.5523 21 20 21H4C3.44772 21 3 20.5523 3 20V4C3 3.44772 3.44772 3 4 3ZM15.5 10C14.6716 10 14 9.32843 14 8.5C14 7.67157 14.6716 7 15.5 7C16.3284 7 17 7.67157 17 8.5C17 9.32843 16.3284 10 15.5 10Z"},child:[]}]})(e)}function zj(e){return Ie({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M22 18V20H2V18H22ZM2 3.5L10 8.5L2 13.5V3.5ZM22 11V13H12V11H22ZM22 4V6H12V4H22Z"},child:[]}]})(e)}function DE(e){return Ie({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M12 1L21.5 6.5V17.5L12 23L2.5 17.5V6.5L12 1ZM4.5 7.65311V7.65788L12 12V20.689L19.5 16.3469V7.65311L12 3.311L4.5 7.65311Z"},child:[]}]})(e)}function LE(e){return Ie({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M5.33409 4.54491C6.3494 3.63637 7.55145 2.9322 8.87555 2.49707C9.60856 3.4128 10.7358 3.99928 12 3.99928C13.2642 3.99928 14.3914 3.4128 15.1245 2.49707C16.4486 2.9322 17.6506 3.63637 18.6659 4.54491C18.2405 5.637 18.2966 6.90531 18.9282 7.99928C19.5602 9.09388 20.6314 9.77679 21.7906 9.95392C21.9279 10.6142 22 11.2983 22 11.9993C22 12.7002 21.9279 13.3844 21.7906 14.0446C20.6314 14.2218 19.5602 14.9047 18.9282 15.9993C18.2966 17.0932 18.2405 18.3616 18.6659 19.4536C17.6506 20.3622 16.4486 21.0664 15.1245 21.5015C14.3914 20.5858 13.2642 19.9993 12 19.9993C10.7358 19.9993 9.60856 20.5858 8.87555 21.5015C7.55145 21.0664 6.3494 20.3622 5.33409 19.4536C5.75952 18.3616 5.7034 17.0932 5.0718 15.9993C4.43983 14.9047 3.36862 14.2218 2.20935 14.0446C2.07212 13.3844 2 12.7002 2 11.9993C2 11.2983 2.07212 10.6142 2.20935 9.95392C3.36862 9.77679 4.43983 9.09388 5.0718 7.99928C5.7034 6.90531 5.75952 5.637 5.33409 4.54491ZM13.5 14.5974C14.9349 13.7689 15.4265 11.9342 14.5981 10.4993C13.7696 9.0644 11.9349 8.57277 10.5 9.4012C9.06512 10.2296 8.5735 12.0644 9.40192 13.4993C10.2304 14.9342 12.0651 15.4258 13.5 14.5974Z"},child:[]}]})(e)}function Hj(e){return Ie({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M2 11.9998C2 11.1353 2.1097 10.2964 2.31595 9.49631C3.40622 9.55283 4.48848 9.01015 5.0718 7.99982C5.65467 6.99025 5.58406 5.78271 4.99121 4.86701C6.18354 3.69529 7.66832 2.82022 9.32603 2.36133C9.8222 3.33385 10.8333 3.99982 12 3.99982C13.1667 3.99982 14.1778 3.33385 14.674 2.36133C16.3317 2.82022 17.8165 3.69529 19.0088 4.86701C18.4159 5.78271 18.3453 6.99025 18.9282 7.99982C19.5115 9.01015 20.5938 9.55283 21.6841 9.49631C21.8903 10.2964 22 11.1353 22 11.9998C22 12.8643 21.8903 13.7032 21.6841 14.5033C20.5938 14.4468 19.5115 14.9895 18.9282 15.9998C18.3453 17.0094 18.4159 18.2169 19.0088 19.1326C17.8165 20.3043 16.3317 21.1794 14.674 21.6383C14.1778 20.6658 13.1667 19.9998 12 19.9998C10.8333 19.9998 9.8222 20.6658 9.32603 21.6383C7.66832 21.1794 6.18354 20.3043 4.99121 19.1326C5.58406 18.2169 5.65467 17.0094 5.0718 15.9998C4.48848 14.9895 3.40622 14.4468 2.31595 14.5033C2.1097 13.7032 2 12.8643 2 11.9998ZM6.80385 14.9998C7.43395 16.0912 7.61458 17.3459 7.36818 18.5236C7.77597 18.8138 8.21005 19.0652 8.66489 19.2741C9.56176 18.4712 10.7392 17.9998 12 17.9998C13.2608 17.9998 14.4382 18.4712 15.3351 19.2741C15.7899 19.0652 16.224 18.8138 16.6318 18.5236C16.3854 17.3459 16.566 16.0912 17.1962 14.9998C17.8262 13.9085 18.8225 13.1248 19.9655 12.7493C19.9884 12.5015 20 12.2516 20 11.9998C20 11.7481 19.9884 11.4981 19.9655 11.2504C18.8225 10.8749 17.8262 10.0912 17.1962 8.99982C16.566 7.90845 16.3854 6.65378 16.6318 5.47605C16.224 5.18588 15.7899 4.93447 15.3351 4.72552C14.4382 5.52844 13.2608 5.99982 12 5.99982C10.7392 5.99982 9.56176 5.52844 8.66489 4.72552C8.21005 4.93447 7.77597 5.18588 7.36818 5.47605C7.61458 6.65378 7.43395 7.90845 6.80385 8.99982C6.17376 10.0912 5.17754 10.8749 4.03451 11.2504C4.01157 11.4981 4 11.7481 4 11.9998C4 12.2516 4.01157 12.5015 4.03451 12.7493C5.17754 13.1248 6.17376 13.9085 6.80385 14.9998ZM12 14.9998C10.3431 14.9998 9 13.6567 9 11.9998C9 10.343 10.3431 8.99982 12 8.99982C13.6569 8.99982 15 10.343 15 11.9998C15 13.6567 13.6569 14.9998 12 14.9998ZM12 12.9998C12.5523 12.9998 13 12.5521 13 11.9998C13 11.4475 12.5523 10.9998 12 10.9998C11.4477 10.9998 11 11.4475 11 11.9998C11 12.5521 11.4477 12.9998 12 12.9998Z"},child:[]}]})(e)}function TE(e){return Ie({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M17.0007 1.20801 18.3195 3.68083 20.7923 4.99968 18.3195 6.31852 17.0007 8.79134 15.6818 6.31852 13.209 4.99968 15.6818 3.68083 17.0007 1.20801ZM8.00065 4.33301 10.6673 9.33301 15.6673 11.9997 10.6673 14.6663 8.00065 19.6663 5.33398 14.6663.333984 11.9997 5.33398 9.33301 8.00065 4.33301ZM19.6673 16.333 18.0007 13.208 16.334 16.333 13.209 17.9997 16.334 19.6663 18.0007 22.7913 19.6673 19.6663 22.7923 17.9997 19.6673 16.333Z"},child:[]}]})(e)}function gg(e){return Ie({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{d:"M14 4.4375C15.3462 4.4375 16.4375 3.34619 16.4375 2H17.5625C17.5625 3.34619 18.6538 4.4375 20 4.4375V5.5625C18.6538 5.5625 17.5625 6.65381 17.5625 8H16.4375C16.4375 6.65381 15.3462 5.5625 14 5.5625V4.4375ZM1 11C4.31371 11 7 8.31371 7 5H9C9 8.31371 11.6863 11 15 11V13C11.6863 13 9 15.6863 9 19H7C7 15.6863 4.31371 13 1 13V11ZM17.25 14C17.25 15.7949 15.7949 17.25 14 17.25V18.75C15.7949 18.75 17.25 20.2051 17.25 22H18.75C18.75 20.2051 20.2051 18.75 22 18.75V17.25C20.2051 17.25 18.75 15.7949 18.75 14H17.25Z"},child:[]}]})(e)}const RE=e=>{const{boardToDelete:t,setBoardToDelete:n}=e,{t:o}=R(),r=j(w=>w.config.canRestoreDeletedImagesFromBin),{currentData:l,isFetching:c}=i6((t==null?void 0:t.board_id)??ss),d=u.useMemo(()=>Fe([Ss,rs,ot,Pn],(w,_,T,D)=>{const A=(l??[]).map(Q=>XC(w,_,T,D,Q));return{isInitialImage:eo(A,Q=>Q.isInitialImage),isCanvasImage:eo(A,Q=>Q.isCanvasImage),isNodesImage:eo(A,Q=>Q.isNodesImage),isControlImage:eo(A,Q=>Q.isControlImage)}}),[l]),[f,{isLoading:m}]=c6(),[g,{isLoading:p}]=u6(),x=j(d),y=u.useCallback(()=>{t&&(f(t.board_id),n(void 0))},[t,f,n]),S=u.useCallback(()=>{t&&(g(t.board_id),n(void 0))},[t,g,n]),b=u.useCallback(()=>{n(void 0)},[n]),I=u.useRef(null),M=u.useMemo(()=>p||m||c,[p,m,c]);return t?s.jsx(ty,{isOpen:!!t,onClose:b,leastDestructiveRef:I,isCentered:!0,children:s.jsx(tr,{children:s.jsxs(ny,{children:[s.jsxs(nr,{fontSize:"lg",fontWeight:"bold",children:[o("controlnet.delete")," ",t.board_name]}),s.jsx(sr,{children:s.jsxs(L,{direction:"column",gap:3,children:[c?s.jsx(C0,{children:s.jsx(L,{w:"full",h:32})}):s.jsx(Hb,{imageUsage:x,topMessage:o("boards.topMessage"),bottomMessage:o("boards.bottomMessage")}),s.jsx(pe,{children:o("boards.deletedBoardsCannotbeRestored")}),s.jsx(pe,{children:o(r?"gallery.deleteImageBin":"gallery.deleteImagePermanent")})]})}),s.jsx(El,{children:s.jsxs(L,{w:"full",gap:2,justifyContent:"end",children:[s.jsx(Ge,{ref:I,onClick:b,children:o("boards.cancel")}),s.jsx(Ge,{colorScheme:"warning",isLoading:M,onClick:y,children:o("boards.deleteBoardOnly")}),s.jsx(Ge,{colorScheme:"error",isLoading:M,onClick:S,children:o("boards.deleteBoardAndImages")})]})})]})})}):null},BE=u.memo(RE),OE=()=>{const{t:e}=R(),[t,{isLoading:n}]=d6(),o=e("boards.myBoard"),r=u.useCallback(()=>{t(o)},[t,o]);return s.jsx(je,{icon:s.jsx(kl,{}),isLoading:n,tooltip:e("boards.addBoard"),"aria-label":e("boards.addBoard"),onClick:r,size:"sm","data-testid":"add-board-button"})},NE=u.memo(OE),FE=()=>{const e=J(),t=j(d=>d.gallery.boardSearchText),{t:n}=R(),o=u.useCallback(d=>{e(Gx(d))},[e]),r=u.useCallback(()=>{e(Gx(""))},[e]),l=u.useCallback(d=>{d.key==="Escape"&&r()},[r]),c=u.useCallback(d=>{o(d.target.value)},[o]);return s.jsxs(y0,{children:[s.jsx(dt,{placeholder:n("boards.searchBoard"),value:t,onKeyDown:l,onChange:c,"data-testid":"board-search-input"}),t&&t.length&&s.jsx(b0,{h:"full",pe:2,children:s.jsx(je,{onClick:r,size:"sm",variant:"link","aria-label":n("boards.clearSearch"),icon:s.jsx(oo,{})})})]})},zE=u.memo(FE);function $j(e){return f6(e)}function HE(e){return m6(e)}const Vj=(e,t)=>{if(!e||!(t!=null&&t.data.current))return!1;const{actionType:n}=e,{payloadType:o}=t.data.current;if(e.id===t.data.current.id)return!1;switch(n){case"SET_CURRENT_IMAGE":return o==="IMAGE_DTO";case"SET_INITIAL_IMAGE":return o==="IMAGE_DTO";case"SET_CONTROL_ADAPTER_IMAGE":return o==="IMAGE_DTO";case"SET_CANVAS_INITIAL_IMAGE":return o==="IMAGE_DTO";case"SET_NODES_IMAGE":return o==="IMAGE_DTO";case"ADD_TO_BOARD":{if(!["IMAGE_DTO","GALLERY_SELECTION"].includes(o))return!1;if(o==="IMAGE_DTO"){const{imageDTO:l}=t.data.current.payload,c=l.board_id??"none",d=e.context.boardId;return c!==d}if(o==="GALLERY_SELECTION"){const l=t.data.current.payload.boardId,c=e.context.boardId;return l!==c}return!1}case"REMOVE_FROM_BOARD":{if(!["IMAGE_DTO","GALLERY_SELECTION"].includes(o))return!1;if(o==="IMAGE_DTO"){const{imageDTO:l}=t.data.current.payload;return(l.board_id??"none")!=="none"}return o==="GALLERY_SELECTION"?t.data.current.payload.boardId!=="none":!1}default:return!1}},$E={opacity:0},VE={opacity:1,transition:{duration:.1}},WE={opacity:0,transition:{duration:.1}},UE=e=>{const{t}=R(),{isOver:n,label:o=t("gallery.drop")}=e,r=u.useRef(Or());return s.jsx(_l.div,{initial:$E,animate:VE,exit:WE,children:s.jsxs(L,{position:"absolute",top:0,insetInlineStart:0,w:"full",h:"full",children:[s.jsx(L,{position:"absolute",top:0,insetInlineStart:0,w:"full",h:"full",bg:"base.900",opacity:.7,borderRadius:"base",alignItems:"center",justifyContent:"center",transitionProperty:"common",transitionDuration:"0.1s"}),s.jsx(L,{position:"absolute",top:.5,insetInlineStart:.5,insetInlineEnd:.5,bottom:.5,opacity:1,borderWidth:2,borderColor:n?"base.50":"base.300",borderRadius:"lg",borderStyle:"dashed",transitionProperty:"common",transitionDuration:"0.1s",alignItems:"center",justifyContent:"center",children:s.jsx(We,{fontSize:"2xl",fontWeight:"semibold",transform:n?"scale(1.1)":"scale(1)",color:n?"base.50":"base.300",transitionProperty:"common",transitionDuration:"0.1s",children:o})})]})},r.current)},Wj=u.memo(UE),GE=e=>{const{dropLabel:t,data:n,disabled:o}=e,r=u.useRef(Or()),{isOver:l,setNodeRef:c,active:d}=$j({id:r.current,disabled:o,data:n});return s.jsx(We,{ref:c,position:"absolute",top:0,insetInlineStart:0,w:"full",h:"full",pointerEvents:d?"auto":"none",children:s.jsx(Aa,{children:Vj(n,d)&&s.jsx(Wj,{isOver:l,label:t})})})},xg=u.memo(GE),ZE=({isSelected:e,isHovered:t})=>{const n=u.useMemo(()=>{if(e&&t)return"hoverSelected";if(e&&!t)return"selected";if(!e&&t)return"hoverUnselected"},[t,e]);return s.jsx(We,{className:"selection-box",position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,borderRadius:"base",opacity:e?1:.7,transitionProperty:"common",transitionDuration:"0.1s",pointerEvents:"none",shadow:n})},vg=u.memo(ZE),qE=()=>{const{t:e}=R();return s.jsx(L,{position:"absolute",insetInlineEnd:0,top:0,p:1,children:s.jsx(Yr,{variant:"solid",bg:"invokeBlue.500",children:e("common.auto")})})},Uj=u.memo(qE),Nf=e=>{const{boardName:t}=cc(void 0,{selectFromResult:({data:n})=>{const o=n==null?void 0:n.find(l=>l.board_id===e);return{boardName:(o==null?void 0:o.board_name)||Zo("boards.uncategorized")}}});return t},QE=({board:e,setBoardToDelete:t})=>{const{t:n}=R(),o=u.useCallback(()=>{t&&t(e)},[e,t]);return s.jsx(s.Fragment,{children:s.jsx(it,{color:"error.300",icon:s.jsx(Vs,{}),onClick:o,children:n("boards.deleteBoard")})})},KE=u.memo(QE),YE=({board:e,board_id:t,setBoardToDelete:n,children:o})=>{const{t:r}=R(),l=J(),c=j(b=>b.gallery.autoAssignBoardOnClick),d=u.useMemo(()=>ft(uc,b=>e&&e.board_id===b.autoAddBoardId),[e]),f=j(d),m=Nf(t),g=Kt("bulkDownload").isFeatureEnabled,[p]=sy(),x=u.useCallback(()=>{l(lf(t))},[t,l]),y=u.useCallback(async()=>{try{const b=await p({image_names:[],board_id:t}).unwrap();l(Qe({title:r("gallery.preparingDownload"),status:"success",...b.response?{description:b.response,duration:null,isClosable:!0}:{}}))}catch{l(Qe({title:r("gallery.preparingDownloadFailed"),status:"error"}))}},[r,t,p,l]),S=u.useCallback(()=>s.jsx(zr,{visibility:"visible",children:s.jsxs(Bi,{title:m,children:[s.jsx(it,{icon:s.jsx(kl,{}),isDisabled:f||c,onClick:x,children:r("boards.menuItemAutoAdd")}),g&&s.jsx(it,{icon:s.jsx(j7,{}),onClickCapture:y,children:r("boards.downloadBoard")}),e&&s.jsx(KE,{board:e,setBoardToDelete:n})]})}),[c,e,m,y,x,g,f,n,r]);return s.jsx(j0,{renderMenu:S,children:o})},Gj=u.memo(YE),XE={p:0,_focusVisible:{p:0,textAlign:"center"}},JE=({board:e,isSelected:t,setBoardToDelete:n})=>{const o=J(),r=j(G=>G.gallery.autoAssignBoardOnClick),l=u.useMemo(()=>ft(uc,G=>e.board_id===G.autoAddBoardId),[e.board_id]),c=j(l),[d,f]=u.useState(!1),m=u.useCallback(()=>{f(!0)},[]),g=u.useCallback(()=>{f(!1)},[]),{data:p}=af(e.board_id),{data:x}=cf(e.board_id),y=u.useMemo(()=>{if(!((p==null?void 0:p.total)===void 0||(x==null?void 0:x.total)===void 0))return`${p.total} image${p.total===1?"":"s"}, ${x.total} asset${x.total===1?"":"s"}`},[x,p]),{currentData:S}=zs(e.cover_image_name??ss),{board_name:b,board_id:I}=e,[M,w]=u.useState(b),_=u.useCallback(()=>{o(oy({boardId:I})),r&&o(lf(I))},[I,r,o]),[T,{isLoading:D}]=h6(),A=u.useMemo(()=>({id:I,actionType:"ADD_TO_BOARD",context:{boardId:I}}),[I]),F=u.useCallback(async G=>{if(!G.trim()){w(b);return}if(G!==b)try{const{board_name:Z}=await T({board_id:I,changes:{board_name:G}}).unwrap();w(Z)}catch{w(b)}},[I,b,T]),Q=u.useCallback(G=>{w(G)},[]),{t:q}=R();return s.jsx(We,{w:"full",h:"full",userSelect:"none",children:s.jsx(L,{onMouseOver:m,onMouseOut:g,position:"relative",justifyContent:"center",alignItems:"center",aspectRatio:"1/1",w:"full",h:"full",children:s.jsx(Gj,{board:e,board_id:I,setBoardToDelete:n,children:G=>s.jsx(jt,{label:y,openDelay:1e3,children:s.jsxs(L,{ref:G,onClick:_,w:"full",h:"full",position:"relative",justifyContent:"center",alignItems:"center",borderRadius:"base",cursor:"pointer",bg:"base.800",children:[S!=null&&S.thumbnail_url?s.jsx(ur,{src:S==null?void 0:S.thumbnail_url,draggable:!1,objectFit:"cover",w:"full",h:"full",maxH:"full",borderRadius:"base",borderBottomRadius:"lg"}):s.jsx(L,{w:"full",h:"full",justifyContent:"center",alignItems:"center",children:s.jsx(Vn,{boxSize:14,as:X7,mt:-6,opacity:.7,color:"base.500"})}),c&&s.jsx(Uj,{}),s.jsx(vg,{isSelected:t,isHovered:d}),s.jsx(L,{position:"absolute",bottom:0,left:0,p:1,justifyContent:"center",alignItems:"center",w:"full",maxW:"full",borderBottomRadius:"base",bg:t?"invokeBlue.500":"base.600",color:t?"base.50":"base.100",lineHeight:"short",fontSize:"xs",children:s.jsxs(uf,{value:M,isDisabled:D,submitOnBlur:!0,onChange:Q,onSubmit:F,w:"full",children:[s.jsx(df,{p:0,fontWeight:t?"bold":"normal",textAlign:"center",overflow:"hidden",textOverflow:"ellipsis",noOfLines:1}),s.jsx(ff,{sx:XE})]})}),s.jsx(xg,{data:A,dropLabel:s.jsx(pe,{fontSize:"md",children:q("unifiedCanvas.move")})})]})})})})})},eD=u.memo(JE),Zj=u.memo(({isSelected:e})=>{const t=J(),n=j(b=>b.gallery.autoAddBoardId),o=j(b=>b.gallery.autoAssignBoardOnClick),r=Nf("none"),l=u.useCallback(()=>{t(oy({boardId:"none"})),o&&t(lf("none"))},[t,o]),[c,d]=u.useState(!1),{data:f}=af("none"),{data:m}=cf("none"),g=u.useMemo(()=>{if(!((f==null?void 0:f.total)===void 0||(m==null?void 0:m.total)===void 0))return`${f.total} image${f.total===1?"":"s"}, ${m.total} asset${m.total===1?"":"s"}`},[m,f]),p=u.useCallback(()=>{d(!0)},[]),x=u.useCallback(()=>{d(!1)},[]),y=u.useMemo(()=>({id:"no_board",actionType:"REMOVE_FROM_BOARD"}),[]),{t:S}=R();return s.jsx(We,{w:"full",h:"full",userSelect:"none",children:s.jsx(L,{onMouseOver:p,onMouseOut:x,position:"relative",justifyContent:"center",alignItems:"center",aspectRatio:"1/1",borderRadius:"base",w:"full",h:"full",children:s.jsx(Gj,{board_id:"none",children:b=>s.jsx(jt,{label:g,openDelay:1e3,children:s.jsxs(L,{ref:b,onClick:l,w:"full",h:"full",position:"relative",justifyContent:"center",alignItems:"center",borderRadius:"base",cursor:"pointer",bg:"base.800",children:[s.jsx(L,{w:"full",h:"full",justifyContent:"center",alignItems:"center",children:s.jsx(ur,{src:p6,alt:"invoke-ai-logo",opacity:.7,mixBlendMode:"overlay",mt:-6,w:16,h:16,minW:16,minH:16,userSelect:"none"})}),n==="none"&&s.jsx(Uj,{}),s.jsx(L,{position:"absolute",bottom:0,left:0,p:1,justifyContent:"center",alignItems:"center",w:"full",maxW:"full",borderBottomRadius:"base",bg:e?"invokeBlue.500":"base.600",color:e?"base.50":"base.100",lineHeight:"short",fontSize:"xs",fontWeight:e?"bold":"normal",children:r}),s.jsx(vg,{isSelected:e,isHovered:c}),s.jsx(xg,{data:y,dropLabel:s.jsx(pe,{fontSize:"md",children:S("unifiedCanvas.move")})})]})})})})})});Zj.displayName="HoverableBoard";const tD=u.memo(Zj),nD={height:"100%",width:"100%"},sD=e=>{const{isOpen:t}=e,n=j(f=>f.gallery.selectedBoardId),o=j(f=>f.gallery.boardSearchText),{data:r}=cc(),l=o?r==null?void 0:r.filter(f=>f.board_name.toLowerCase().includes(o.toLowerCase())):r,[c,d]=u.useState();return s.jsxs(s.Fragment,{children:[s.jsx(ry,{in:t,animateOpacity:!0,children:s.jsxs(L,{layerStyle:"first",flexDir:"column",gap:2,p:2,mt:2,borderRadius:"base",children:[s.jsxs(L,{gap:2,alignItems:"center",children:[s.jsx(zE,{}),s.jsx(NE,{})]}),s.jsx(Of,{defer:!0,style:nD,options:kc.options,children:s.jsxs(Ca,{className:"list-container","data-testid":"boards-list",gridTemplateColumns:"repeat(auto-fill, minmax(90px, 1fr))",maxH:346,children:[s.jsx(Pr,{p:1.5,"data-testid":"no-board",children:s.jsx(tD,{isSelected:n==="none"})}),l&&l.map((f,m)=>s.jsx(Pr,{p:1.5,"data-testid":`board-${m}`,children:s.jsx(eD,{board:f,isSelected:n===f.board_id,setBoardToDelete:d})},f.board_id))]})})]})}),s.jsx(BE,{boardToDelete:c,setBoardToDelete:d})]})},oD=u.memo(sD),rD=e=>{const{isOpen:t,onToggle:n}=e,o=j(c=>c.gallery.selectedBoardId),r=Nf(o),l=u.useMemo(()=>r.length>20?`${r.substring(0,20)}...`:r,[r]);return s.jsxs(L,{as:Ge,onClick:n,size:"sm",position:"relative",gap:2,w:"full",justifyContent:"center",alignItems:"center",px:2,children:[s.jsx(Cs,{}),l,s.jsx(Cs,{}),s.jsx(Vn,{as:q0,boxSize:4,transform:t?"rotate(0deg)":"rotate(180deg)",transitionProperty:"common",transitionDuration:"normal"})]})},lD=u.memo(rD),aD=()=>{const e=J(),{t}=R(),n=j(m=>m.gallery.autoAddBoardId),o=j(m=>m.gallery.autoAssignBoardOnClick),{options:r,hasBoards:l}=cc(void 0,{selectFromResult:({data:m})=>{const g=[{label:t("controlnet.none"),value:"none"}].concat((m??[]).map(({board_id:p,board_name:x})=>({label:x,value:p})));return{options:g,hasBoards:g.length>1}}}),c=u.useCallback(m=>{m&&e(lf(m.value))},[e]),d=u.useMemo(()=>r.find(m=>m.value===n),[r,n]),f=u.useCallback(()=>t("boards.noMatching"),[t]);return s.jsxs(U,{isDisabled:!l||o,children:[s.jsx(Y,{children:t("boards.autoAddBoard")}),s.jsx(Xe,{value:d,options:r,onChange:c,placeholder:t("boards.selectBoard"),noOptionsMessage:f})]})},iD=u.memo(aD),cD={flexGrow:1},uD=()=>{const e=J(),{t}=R(),n=j(f=>f.gallery.galleryImageMinimumWidth),o=j(f=>f.gallery.shouldAutoSwitch),r=j(f=>f.gallery.autoAssignBoardOnClick),l=u.useCallback(f=>{e(g6(f))},[e]),c=u.useCallback(f=>{e(x6(f.target.checked))},[e]),d=u.useCallback(f=>e(v6(f.target.checked)),[e]);return s.jsxs(Zr,{isLazy:!0,children:[s.jsx(za,{children:s.jsx(je,{tooltip:t("gallery.gallerySettings"),"aria-label":t("gallery.gallerySettings"),size:"sm",icon:s.jsx(LE,{})})}),s.jsx(qr,{children:s.jsx(Qr,{children:s.jsxs(L,{direction:"column",gap:2,children:[s.jsxs(U,{children:[s.jsx(Y,{children:t("gallery.galleryImageSize")}),s.jsx(Ue,{value:n,onChange:l,min:45,max:256,defaultValue:90})]}),s.jsxs(wn,{formLabelProps:cD,children:[s.jsxs(U,{children:[s.jsx(Y,{children:t("gallery.autoSwitchNewImages")}),s.jsx(kt,{isChecked:o,onChange:c})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("gallery.autoAssignBoardOnClick")}),s.jsx(jn,{isChecked:r,onChange:d})]})]}),s.jsx(iD,{})]})})})]})},dD=u.memo(uD),Ud=Tl({}),ks=ft(rs,e=>e.batchIds.length>0||e.layerState.stagingArea.images.length>0);Fe(rs,e=>e.layerState.objects.find(ly));const Ff=()=>{const e=J(),t=j(g=>g.gallery.galleryView),n=j(C6),o=y6(n),r=j(g=>g.gallery.selectedBoardId),{data:l}=cf(r),{data:c}=af(r),d=u.useMemo(()=>t==="images"?c==null?void 0:c.total:l==null?void 0:l.total,[l==null?void 0:l.total,t,c==null?void 0:c.total]),f=u.useMemo(()=>!d||!o.data?!1:o.data.ids.length<d,[o.data,d]),m=u.useCallback(()=>{e(b6())},[e]);return{areMoreImagesAvailable:f,handleLoadMoreImages:m,queryResult:o}},qj=e=>`gallery-image-${e}`,Qj="image-item-container",fD=mf((e,t)=>s.jsx(We,{className:"item-container",ref:t,p:1.5,"data-testid":Qj,children:e.children})),mD=u.memo(fD),Kj="image-list-container",hD=mf((e,t)=>{const n=j(o=>o.gallery.galleryImageMinimumWidth);return s.jsx(Ca,{...e,className:"list-container",ref:t,gridTemplateColumns:`repeat(auto-fill, minmax(${n}px, 1fr))`,"data-testid":Kj,children:e.children})}),pD=u.memo(hD),Yj=(e,t)=>e.top>=t.top&&e.bottom<=t.bottom&&e.left>=t.left&&e.right<=t.right,Xj=(e,t)=>e>(t.endIndex-t.startIndex)/2+t.startIndex?"end":"start",Cg=()=>{var o,r;const e=((o=document.querySelector(`[data-testid="${Qj}"]`))==null?void 0:o.getBoundingClientRect().width)??1,t=((r=document.querySelector(`[data-testid="${Kj}"]`))==null?void 0:r.getBoundingClientRect().width)??0;return Math.round(t/e)},gD=(e,t)=>{var m,g,p;const n=Ud.get(),o=(m=n.virtuosoRangeRef)==null?void 0:m.current,r=(g=n.rootRef)==null?void 0:g.current,l=(p=n.virtuosoRef)==null?void 0:p.current;if(!o||!l||!r)return;const c=document.querySelector(`[data-testid="${qj(e)}"]`),d=c==null?void 0:c.getBoundingClientRect(),f=r.getBoundingClientRect();(!d||!Yj(d,f))&&l.scrollToIndex({index:t,align:Xj(t,o)})},xD=(e,t)=>{const n=Xo(t-1,0,e.length-1),o=e[n];return{index:n,image:o}},vD=(e,t)=>{const n=Xo(t+1,0,e.length-1),o=e[n];return{index:n,image:o}},CD=(e,t)=>{const n=Cg(),r=t<n?t:Xo(t-n,0,e.length-1),l=e[r];return{index:r,image:l}},yD=(e,t)=>{const n=Cg(),r=t<e.length-n?Xo(t+n,0,e.length-1):t,l=e[r];return{index:r,image:l}},bD={left:xD,right:vD,up:CD,down:yD},Jj=()=>{const e=J(),t=j(hf),{queryResult:{data:n}}=Ff(),o=u.useMemo(()=>(n==null?void 0:n.ids.length)??0,[n==null?void 0:n.ids.length]),r=u.useMemo(()=>!n||!t?0:Zx.selectAll(n).findIndex(y=>y.image_name===t.image_name),[t,n]),l=u.useCallback(y=>{if(!n)return;const{index:S,image:b}=bD[y](Zx.selectAll(n),r);!b||S===r||(e(j6(b)),gD(b.image_name,S))},[e,r,n]),c=u.useMemo(()=>r===0,[r]),d=u.useMemo(()=>r===o-1,[r,o]),f=u.useMemo(()=>{const y=Cg();return r+y<o},[r,o]),m=u.useCallback(()=>{l("left")},[l]),g=u.useCallback(()=>{l("right")},[l]),p=u.useCallback(()=>{l("up")},[l]),x=u.useCallback(()=>{l("down")},[l]);return{handleLeftImage:m,handleRightImage:g,handleUpImage:p,handleDownImage:x,isOnFirstImage:c,isOnLastImage:d,areImagesBelowCurrent:f}},jD=()=>{const e=j(js),t=j(ks),n=u.useMemo(()=>e!=="unifiedCanvas"||!t,[e,t]),{areMoreImagesAvailable:o,handleLoadMoreImages:r,queryResult:{isFetching:l}}=Ff(),{handleLeftImage:c,handleRightImage:d,handleUpImage:f,handleDownImage:m,isOnLastImage:g,areImagesBelowCurrent:p}=Jj();Oe("left",()=>{n&&c()},[c,n]),Oe("right",()=>{if(n){if(g&&o&&!l){r();return}g||d()}},[g,o,r,l,d,n]),Oe("up",()=>{f()},{preventDefault:!0},[f]),Oe("down",()=>{if(!p&&o&&!l){r();return}m()},{preventDefault:!0},[p,o,r,l,m])},zf=0,tl=1,qa=2,eS=4;function tS(e,t){return n=>e(t(n))}function SD(e,t){return t(e)}function nS(e,t){return n=>e(t,n)}function sv(e,t){return()=>e(t)}function Hf(e,t){return t(e),e}function Wt(...e){return e}function kD(e){e()}function ov(e){return()=>e}function wD(...e){return()=>{e.map(kD)}}function yg(e){return e!==void 0}function Qa(){}function At(e,t){return e(tl,t)}function ct(e,t){e(zf,t)}function bg(e){e(qa)}function ps(e){return e(eS)}function qe(e,t){return At(e,nS(t,zf))}function cr(e,t){const n=e(tl,o=>{n(),t(o)});return n}function pt(){const e=[];return(t,n)=>{switch(t){case qa:e.splice(0,e.length);return;case tl:return e.push(n),()=>{const o=e.indexOf(n);o>-1&&e.splice(o,1)};case zf:e.slice().forEach(o=>{o(n)});return;default:throw new Error(`unrecognized action ${t}`)}}}function Te(e){let t=e;const n=pt();return(o,r)=>{switch(o){case tl:r(t);break;case zf:t=r;break;case eS:return t}return n(o,r)}}function ID(e){let t,n;const o=()=>t&&t();return function(r,l){switch(r){case tl:return l?n===l?void 0:(o(),n=l,t=At(e,l),t):(o(),Qa);case qa:o(),n=null;return;default:throw new Error(`unrecognized action ${r}`)}}}function xs(e){return Hf(pt(),t=>qe(e,t))}function Hn(e,t){return Hf(Te(t),n=>qe(e,n))}function MD(...e){return t=>e.reduceRight(SD,t)}function we(e,...t){const n=MD(...t);return(o,r)=>{switch(o){case tl:return At(e,n(r));case qa:bg(e);return}}}function sS(e,t){return e===t}function Vt(e=sS){let t;return n=>o=>{e(t,o)||(t=o,n(o))}}function tt(e){return t=>n=>{e(n)&&t(n)}}function He(e){return t=>tS(t,e)}function qo(e){return t=>()=>t(e)}function _o(e,t){return n=>o=>n(t=e(t,o))}function La(e){return t=>n=>{e>0?e--:t(n)}}function Rr(e){let t=null,n;return o=>r=>{t=r,!n&&(n=setTimeout(()=>{n=void 0,o(t)},e))}}function rv(e){let t,n;return o=>r=>{t=r,n&&clearTimeout(n),n=setTimeout(()=>{o(t)},e)}}function mt(...e){const t=new Array(e.length);let n=0,o=null;const r=Math.pow(2,e.length)-1;return e.forEach((l,c)=>{const d=Math.pow(2,c);At(l,f=>{const m=n;n=n|d,t[c]=f,m!==r&&n===r&&o&&(o(),o=null)})}),l=>c=>{const d=()=>l([c].concat(t));n===r?d():o=d}}function lv(...e){return function(t,n){switch(t){case tl:return wD(...e.map(o=>At(o,n)));case qa:return;default:throw new Error(`unrecognized action ${t}`)}}}function et(e,t=sS){return we(e,Vt(t))}function kn(...e){const t=pt(),n=new Array(e.length);let o=0;const r=Math.pow(2,e.length)-1;return e.forEach((l,c)=>{const d=Math.pow(2,c);At(l,f=>{n[c]=f,o=o|d,o===r&&ct(t,n)})}),function(l,c){switch(l){case tl:return o===r&&c(n),At(t,c);case qa:return bg(t);default:throw new Error(`unrecognized action ${l}`)}}}function Mt(e,t=[],{singleton:n}={singleton:!0}){return{id:_D(),constructor:e,dependencies:t,singleton:n}}const _D=()=>Symbol();function AD(e){const t=new Map,n=({id:o,constructor:r,dependencies:l,singleton:c})=>{if(c&&t.has(o))return t.get(o);const d=r(l.map(f=>n(f)));return c&&t.set(o,d),d};return n(e)}function PD(e,t){const n={},o={};let r=0;const l=e.length;for(;r<l;)o[e[r]]=1,r+=1;for(const c in t)o.hasOwnProperty(c)||(n[c]=t[c]);return n}const $u=typeof document<"u"?te.useLayoutEffect:te.useEffect;function oS(e,t,n){const o=Object.keys(t.required||{}),r=Object.keys(t.optional||{}),l=Object.keys(t.methods||{}),c=Object.keys(t.events||{}),d=te.createContext({});function f(b,I){b.propsReady&&ct(b.propsReady,!1);for(const M of o){const w=b[t.required[M]];ct(w,I[M])}for(const M of r)if(M in I){const w=b[t.optional[M]];ct(w,I[M])}b.propsReady&&ct(b.propsReady,!0)}function m(b){return l.reduce((I,M)=>(I[M]=w=>{const _=b[t.methods[M]];ct(_,w)},I),{})}function g(b){return c.reduce((I,M)=>(I[M]=ID(b[t.events[M]]),I),{})}return{Component:te.forwardRef((b,I)=>{const{children:M,...w}=b,[_]=te.useState(()=>Hf(AD(e),D=>f(D,w))),[T]=te.useState(sv(g,_));return $u(()=>{for(const D of c)D in w&&At(T[D],w[D]);return()=>{Object.values(T).map(bg)}},[w,T,_]),$u(()=>{f(_,w)}),te.useImperativeHandle(I,ov(m(_))),te.createElement(d.Provider,{value:_},n?te.createElement(n,PD([...o,...r,...c],w),M):M)}),usePublisher:b=>te.useCallback(nS(ct,te.useContext(d)[b]),[b]),useEmitterValue:b=>{const M=te.useContext(d)[b],[w,_]=te.useState(sv(ps,M));return $u(()=>At(M,T=>{T!==w&&_(ov(T))}),[M,w]),w},useEmitter:(b,I)=>{const w=te.useContext(d)[b];$u(()=>At(w,I),[I,w])}}}const ED=typeof document<"u"?te.useLayoutEffect:te.useEffect,DD=ED;var vs=(e=>(e[e.DEBUG=0]="DEBUG",e[e.INFO=1]="INFO",e[e.WARN=2]="WARN",e[e.ERROR=3]="ERROR",e))(vs||{});const LD={0:"debug",1:"log",2:"warn",3:"error"},TD=()=>typeof globalThis>"u"?window:globalThis,nl=Mt(()=>{const e=Te(3);return{log:Te((n,o,r=1)=>{var l;const c=(l=TD().VIRTUOSO_LOG_LEVEL)!=null?l:ps(e);r>=c&&console[LD[r]]("%creact-virtuoso: %c%s %o","color: #0253b3; font-weight: bold","color: initial",n,o)}),logLevel:e}},[],{singleton:!0});function jg(e,t=!0){const n=te.useRef(null);let o=r=>{};if(typeof ResizeObserver<"u"){const r=te.useMemo(()=>new ResizeObserver(l=>{const c=l[0].target;c.offsetParent!==null&&e(c)}),[e]);o=l=>{l&&t?(r.observe(l),n.current=l):(n.current&&r.unobserve(n.current),n.current=null)}}return{ref:n,callbackRef:o}}function Ol(e,t=!0){return jg(e,t).callbackRef}function RD(e,t,n,o,r,l,c){const d=te.useCallback(f=>{const m=BD(f.children,t,"offsetHeight",r);let g=f.parentElement;for(;!g.dataset.virtuosoScroller;)g=g.parentElement;const p=g.lastElementChild.dataset.viewportType==="window",x=c?c.scrollTop:p?window.pageYOffset||document.documentElement.scrollTop:g.scrollTop,y=c?c.scrollHeight:p?document.documentElement.scrollHeight:g.scrollHeight,S=c?c.offsetHeight:p?window.innerHeight:g.offsetHeight;o({scrollTop:Math.max(x,0),scrollHeight:y,viewportHeight:S}),l==null||l(OD("row-gap",getComputedStyle(f).rowGap,r)),m!==null&&e(m)},[e,t,r,l,c,o]);return jg(d,n)}function BD(e,t,n,o){const r=e.length;if(r===0)return null;const l=[];for(let c=0;c<r;c++){const d=e.item(c);if(!d||d.dataset.index===void 0)continue;const f=parseInt(d.dataset.index),m=parseFloat(d.dataset.knownSize),g=t(d,n);if(g===0&&o("Zero-sized element, this should not happen",{child:d},vs.ERROR),g===m)continue;const p=l[l.length-1];l.length===0||p.size!==g||p.endIndex!==f-1?l.push({startIndex:f,endIndex:f,size:g}):l[l.length-1].endIndex++}return l}function OD(e,t,n){return t!=="normal"&&!(t!=null&&t.endsWith("px"))&&n(`${e} was not resolved to pixel value correctly`,t,vs.WARN),t==="normal"?0:parseInt(t??"0",10)}function Vr(e,t){return Math.round(e.getBoundingClientRect()[t])}function rS(e,t){return Math.abs(e-t)<1.01}function lS(e,t,n,o=Qa,r){const l=te.useRef(null),c=te.useRef(null),d=te.useRef(null),f=te.useCallback(p=>{const x=p.target,y=x===window||x===document,S=y?window.pageYOffset||document.documentElement.scrollTop:x.scrollTop,b=y?document.documentElement.scrollHeight:x.scrollHeight,I=y?window.innerHeight:x.offsetHeight,M=()=>{e({scrollTop:Math.max(S,0),scrollHeight:b,viewportHeight:I})};p.suppressFlushSync?M():S6.flushSync(M),c.current!==null&&(S===c.current||S<=0||S===b-I)&&(c.current=null,t(!0),d.current&&(clearTimeout(d.current),d.current=null))},[e,t]);te.useEffect(()=>{const p=r||l.current;return o(r||l.current),f({target:p,suppressFlushSync:!0}),p.addEventListener("scroll",f,{passive:!0}),()=>{o(null),p.removeEventListener("scroll",f)}},[l,f,n,o,r]);function m(p){const x=l.current;if(!x||"offsetHeight"in x&&x.offsetHeight===0)return;const y=p.behavior==="smooth";let S,b,I;x===window?(b=Math.max(Vr(document.documentElement,"height"),document.documentElement.scrollHeight),S=window.innerHeight,I=document.documentElement.scrollTop):(b=x.scrollHeight,S=Vr(x,"height"),I=x.scrollTop);const M=b-S;if(p.top=Math.ceil(Math.max(Math.min(M,p.top),0)),rS(S,b)||p.top===I){e({scrollTop:I,scrollHeight:b,viewportHeight:S}),y&&t(!0);return}y?(c.current=p.top,d.current&&clearTimeout(d.current),d.current=setTimeout(()=>{d.current=null,c.current=null,t(!0)},1e3)):c.current=null,x.scrollTo(p)}function g(p){l.current.scrollBy(p)}return{scrollerRef:l,scrollByCallback:g,scrollToCallback:m}}const Wn=Mt(()=>{const e=pt(),t=pt(),n=Te(0),o=pt(),r=Te(0),l=pt(),c=pt(),d=Te(0),f=Te(0),m=Te(0),g=Te(0),p=pt(),x=pt(),y=Te(!1);return qe(we(e,He(({scrollTop:S})=>S)),t),qe(we(e,He(({scrollHeight:S})=>S)),c),qe(t,r),{scrollContainerState:e,scrollTop:t,viewportHeight:l,headerHeight:d,fixedHeaderHeight:f,fixedFooterHeight:m,footerHeight:g,scrollHeight:c,smoothScrollTargetReached:o,scrollTo:p,scrollBy:x,statefulScrollTop:r,deviation:n,scrollingInProgress:y}},[],{singleton:!0}),Ji={lvl:0};function aS(e,t,n,o=Ji,r=Ji){return{k:e,v:t,lvl:n,l:o,r}}function Lt(e){return e===Ji}function wa(){return Ji}function Wp(e,t){if(Lt(e))return Ji;const{k:n,l:o,r}=e;if(t===n){if(Lt(o))return r;if(Lt(r))return o;{const[l,c]=iS(o);return hd(mn(e,{k:l,v:c,l:cS(o)}))}}else return t<n?hd(mn(e,{l:Wp(o,t)})):hd(mn(e,{r:Wp(r,t)}))}function ec(e,t){if(!Lt(e))return t===e.k?e.v:t<e.k?ec(e.l,t):ec(e.r,t)}function lo(e,t,n="k"){if(Lt(e))return[-1/0,void 0];if(Number(e[n])===t)return[e.k,e.v];if(Number(e[n])<t){const o=lo(e.r,t,n);return o[0]===-1/0?[e.k,e.v]:o}return lo(e.l,t,n)}function hs(e,t,n){return Lt(e)?aS(t,n,1):t===e.k?mn(e,{k:t,v:n}):t<e.k?av(mn(e,{l:hs(e.l,t,n)})):av(mn(e,{r:hs(e.r,t,n)}))}function Up(e,t,n){if(Lt(e))return[];const{k:o,v:r,l,r:c}=e;let d=[];return o>t&&(d=d.concat(Up(l,t,n))),o>=t&&o<=n&&d.push({k:o,v:r}),o<=n&&(d=d.concat(Up(c,t,n))),d}function bl(e){return Lt(e)?[]:[...bl(e.l),{k:e.k,v:e.v},...bl(e.r)]}function iS(e){return Lt(e.r)?[e.k,e.v]:iS(e.r)}function cS(e){return Lt(e.r)?e.l:hd(mn(e,{r:cS(e.r)}))}function mn(e,t){return aS(t.k!==void 0?t.k:e.k,t.v!==void 0?t.v:e.v,t.lvl!==void 0?t.lvl:e.lvl,t.l!==void 0?t.l:e.l,t.r!==void 0?t.r:e.r)}function Uh(e){return Lt(e)||e.lvl>e.r.lvl}function av(e){return Gp(dS(e))}function hd(e){const{l:t,r:n,lvl:o}=e;if(n.lvl>=o-1&&t.lvl>=o-1)return e;if(o>n.lvl+1){if(Uh(t))return dS(mn(e,{lvl:o-1}));if(!Lt(t)&&!Lt(t.r))return mn(t.r,{l:mn(t,{r:t.r.l}),r:mn(e,{l:t.r.r,lvl:o-1}),lvl:o});throw new Error("Unexpected empty nodes")}else{if(Uh(e))return Gp(mn(e,{lvl:o-1}));if(!Lt(n)&&!Lt(n.l)){const r=n.l,l=Uh(r)?n.lvl-1:n.lvl;return mn(r,{l:mn(e,{r:r.l,lvl:o-1}),r:Gp(mn(n,{l:r.r,lvl:l})),lvl:r.lvl+1})}else throw new Error("Unexpected empty nodes")}}function $f(e,t,n){if(Lt(e))return[];const o=lo(e,t)[0];return ND(Up(e,o,n))}function uS(e,t){const n=e.length;if(n===0)return[];let{index:o,value:r}=t(e[0]);const l=[];for(let c=1;c<n;c++){const{index:d,value:f}=t(e[c]);l.push({start:o,end:d-1,value:r}),o=d,r=f}return l.push({start:o,end:1/0,value:r}),l}function ND(e){return uS(e,({k:t,v:n})=>({index:t,value:n}))}function Gp(e){const{r:t,lvl:n}=e;return!Lt(t)&&!Lt(t.r)&&t.lvl===n&&t.r.lvl===n?mn(t,{l:mn(e,{r:t.l}),lvl:n+1}):e}function dS(e){const{l:t}=e;return!Lt(t)&&t.lvl===e.lvl?mn(t,{r:mn(e,{l:t.r})}):e}function Gd(e,t,n,o=0){let r=e.length-1;for(;o<=r;){const l=Math.floor((o+r)/2),c=e[l],d=n(c,t);if(d===0)return l;if(d===-1){if(r-o<2)return l-1;r=l-1}else{if(r===o)return l;o=l+1}}throw new Error(`Failed binary finding record in array - ${e.join(",")}, searched for ${t}`)}function fS(e,t,n){return e[Gd(e,t,n)]}function FD(e,t,n,o){const r=Gd(e,t,o),l=Gd(e,n,o,r);return e.slice(r,l+1)}const Sg=Mt(()=>({recalcInProgress:Te(!1)}),[],{singleton:!0});function zD(e){const{size:t,startIndex:n,endIndex:o}=e;return r=>r.start===n&&(r.end===o||r.end===1/0)&&r.value===t}function iv(e,t){let n=0,o=0;for(;n<e;)n+=t[o+1]-t[o]-1,o++;return o-(n===e?0:1)}function HD(e,t){let n=Lt(e)?0:1/0;for(const o of t){const{size:r,startIndex:l,endIndex:c}=o;if(n=Math.min(n,l),Lt(e)){e=hs(e,0,r);continue}const d=$f(e,l-1,c+1);if(d.some(zD(o)))continue;let f=!1,m=!1;for(const{start:g,end:p,value:x}of d)f?(c>=g||r===x)&&(e=Wp(e,g)):(m=x!==r,f=!0),p>c&&c>=g&&x!==r&&(e=hs(e,c+1,x));m&&(e=hs(e,l,r))}return[e,n]}function $D(){return{offsetTree:[],sizeTree:wa(),groupOffsetTree:wa(),lastIndex:0,lastOffset:0,lastSize:0,groupIndices:[]}}function kg({index:e},t){return t===e?0:t<e?-1:1}function VD({offset:e},t){return t===e?0:t<e?-1:1}function WD(e){return{index:e.index,value:e}}function UD(e,t,n,o=0){return o>0&&(t=Math.max(t,fS(e,o,kg).offset)),uS(FD(e,t,n,VD),WD)}function Zp(e,t,n,o){let r=e,l=0,c=0,d=0,f=0;if(t!==0){f=Gd(r,t-1,kg),d=r[f].offset;const g=lo(n,t-1);l=g[0],c=g[1],r.length&&r[f].size===lo(n,t)[1]&&(f-=1),r=r.slice(0,f+1)}else r=[];for(const{start:m,value:g}of $f(n,t,1/0)){const p=m-l,x=p*c+d+p*o;r.push({offset:x,size:g,index:m}),l=m,d=x,c=g}return{offsetTree:r,lastIndex:l,lastOffset:d,lastSize:c}}function GD(e,[t,n,o,r]){t.length>0&&o("received item sizes",t,vs.DEBUG);const l=e.sizeTree;let c=l,d=0;if(n.length>0&&Lt(l)&&t.length===2){const x=t[0].size,y=t[1].size;c=n.reduce((S,b)=>hs(hs(S,b,x),b+1,y),c)}else[c,d]=HD(c,t);if(c===l)return e;const{offsetTree:f,lastIndex:m,lastSize:g,lastOffset:p}=Zp(e.offsetTree,d,c,r);return{sizeTree:c,offsetTree:f,lastIndex:m,lastOffset:p,lastSize:g,groupOffsetTree:n.reduce((x,y)=>hs(x,y,tc(y,f,r)),wa()),groupIndices:n}}function tc(e,t,n){if(t.length===0)return 0;const{offset:o,index:r,size:l}=fS(t,e,kg),c=e-r,d=l*c+(c-1)*n+o;return d>0?d+n:d}function ZD(e){return typeof e.groupIndex<"u"}function mS(e,t,n){if(ZD(e))return t.groupIndices[e.groupIndex]+1;{const o=e.index==="LAST"?n:e.index;let r=hS(o,t);return r=Math.max(0,r,Math.min(n,r)),r}}function hS(e,t){if(!Vf(t))return e;let n=0;for(;t.groupIndices[n]<=e+n;)n++;return e+n}function Vf(e){return!Lt(e.groupOffsetTree)}function qD(e){return bl(e).map(({k:t,v:n},o,r)=>{const l=r[o+1],c=l?l.k-1:1/0;return{startIndex:t,endIndex:c,size:n}})}const QD={offsetHeight:"height",offsetWidth:"width"},Bo=Mt(([{log:e},{recalcInProgress:t}])=>{const n=pt(),o=pt(),r=Hn(o,0),l=pt(),c=pt(),d=Te(0),f=Te([]),m=Te(void 0),g=Te(void 0),p=Te((D,A)=>Vr(D,QD[A])),x=Te(void 0),y=Te(0),S=$D(),b=Hn(we(n,mt(f,e,y),_o(GD,S),Vt()),S),I=Hn(we(f,Vt(),_o((D,A)=>({prev:D.current,current:A}),{prev:[],current:[]}),He(({prev:D})=>D)),[]);qe(we(f,tt(D=>D.length>0),mt(b,y),He(([D,A,F])=>{const Q=D.reduce((q,G,Z)=>hs(q,G,tc(G,A.offsetTree,F)||Z),wa());return{...A,groupIndices:D,groupOffsetTree:Q}})),b),qe(we(o,mt(b),tt(([D,{lastIndex:A}])=>D<A),He(([D,{lastIndex:A,lastSize:F}])=>[{startIndex:D,endIndex:A,size:F}])),n),qe(m,g);const M=Hn(we(m,He(D=>D===void 0)),!0);qe(we(g,tt(D=>D!==void 0&&Lt(ps(b).sizeTree)),He(D=>[{startIndex:0,endIndex:0,size:D}])),n);const w=xs(we(n,mt(b),_o(({sizes:D},[A,F])=>({changed:F!==D,sizes:F}),{changed:!1,sizes:S}),He(D=>D.changed)));At(we(d,_o((D,A)=>({diff:D.prev-A,prev:A}),{diff:0,prev:0}),He(D=>D.diff)),D=>{const{groupIndices:A}=ps(b);if(D>0)ct(t,!0),ct(l,D+iv(D,A));else if(D<0){const F=ps(I);F.length>0&&(D-=iv(-D,F)),ct(c,D)}}),At(we(d,mt(e)),([D,A])=>{D<0&&A("`firstItemIndex` prop should not be set to less than zero. If you don't know the total count, just use a very high value",{firstItemIndex:d},vs.ERROR)});const _=xs(l);qe(we(l,mt(b),He(([D,A])=>{const F=A.groupIndices.length>0,Q=[],q=A.lastSize;if(F){const G=ec(A.sizeTree,0);let Z=0,N=0;for(;Z<D;){const se=A.groupIndices[N],he=A.groupIndices.length===N+1?1/0:A.groupIndices[N+1]-se-1;Q.push({startIndex:se,endIndex:se,size:G}),Q.push({startIndex:se+1,endIndex:se+1+he-1,size:q}),N++,Z+=he+1}const z=bl(A.sizeTree);return Z!==D&&z.shift(),z.reduce((se,{k:he,v:ke})=>{let Ce=se.ranges;return se.prevSize!==0&&(Ce=[...se.ranges,{startIndex:se.prevIndex,endIndex:he+D-1,size:se.prevSize}]),{ranges:Ce,prevIndex:he+D,prevSize:ke}},{ranges:Q,prevIndex:D,prevSize:0}).ranges}return bl(A.sizeTree).reduce((G,{k:Z,v:N})=>({ranges:[...G.ranges,{startIndex:G.prevIndex,endIndex:Z+D-1,size:G.prevSize}],prevIndex:Z+D,prevSize:N}),{ranges:[],prevIndex:0,prevSize:q}).ranges})),n);const T=xs(we(c,mt(b,y),He(([D,{offsetTree:A},F])=>{const Q=-D;return tc(Q,A,F)})));return qe(we(c,mt(b,y),He(([D,A,F])=>{if(A.groupIndices.length>0){if(Lt(A.sizeTree))return A;let q=wa();const G=ps(I);let Z=0,N=0,z=0;for(;Z<-D;){z=G[N];const se=G[N+1]-z-1;N++,Z+=se+1}if(q=bl(A.sizeTree).reduce((se,{k:he,v:ke})=>hs(se,Math.max(0,he+D),ke),q),Z!==-D){const se=ec(A.sizeTree,z);q=hs(q,0,se);const he=lo(A.sizeTree,-D+1)[1];q=hs(q,1,he)}return{...A,sizeTree:q,...Zp(A.offsetTree,0,q,F)}}else{const q=bl(A.sizeTree).reduce((G,{k:Z,v:N})=>hs(G,Math.max(0,Z+D),N),wa());return{...A,sizeTree:q,...Zp(A.offsetTree,0,q,F)}}})),b),{data:x,totalCount:o,sizeRanges:n,groupIndices:f,defaultItemSize:g,fixedItemSize:m,unshiftWith:l,shiftWith:c,shiftWithOffset:T,beforeUnshiftWith:_,firstItemIndex:d,gap:y,sizes:b,listRefresh:w,statefulTotalCount:r,trackItemSizes:M,itemSize:p}},Wt(nl,Sg),{singleton:!0}),KD=typeof document<"u"&&"scrollBehavior"in document.documentElement.style;function pS(e){const t=typeof e=="number"?{index:e}:e;return t.align||(t.align="start"),(!t.behavior||!KD)&&(t.behavior="auto"),t.offset||(t.offset=0),t}const wc=Mt(([{sizes:e,totalCount:t,listRefresh:n,gap:o},{scrollingInProgress:r,viewportHeight:l,scrollTo:c,smoothScrollTargetReached:d,headerHeight:f,footerHeight:m,fixedHeaderHeight:g,fixedFooterHeight:p},{log:x}])=>{const y=pt(),S=Te(0);let b=null,I=null,M=null;function w(){b&&(b(),b=null),M&&(M(),M=null),I&&(clearTimeout(I),I=null),ct(r,!1)}return qe(we(y,mt(e,l,t,S,f,m,x),mt(o,g,p),He(([[_,T,D,A,F,Q,q,G],Z,N,z])=>{const $=pS(_),{align:se,behavior:he,offset:ke}=$,Ce=A-1,ge=mS($,T,Ce);let De=tc(ge,T.offsetTree,Z)+Q;se==="end"?(De+=N+lo(T.sizeTree,ge)[1]-D+z,ge===Ce&&(De+=q)):se==="center"?De+=(N+lo(T.sizeTree,ge)[1]-D+z)/2:De-=F,ke&&(De+=ke);const Se=oe=>{w(),oe?(G("retrying to scroll to",{location:_},vs.DEBUG),ct(y,_)):G("list did not change, scroll successful",{},vs.DEBUG)};if(w(),he==="smooth"){let oe=!1;M=At(n,re=>{oe=oe||re}),b=cr(d,()=>{Se(oe)})}else b=cr(we(n,YD(150)),Se);return I=setTimeout(()=>{w()},1200),ct(r,!0),G("scrolling from index to",{index:ge,top:De,behavior:he},vs.DEBUG),{top:De,behavior:he}})),c),{scrollToIndex:y,topListHeight:S}},Wt(Bo,Wn,nl),{singleton:!0});function YD(e){return t=>{const n=setTimeout(()=>{t(!1)},e);return o=>{o&&(t(!0),clearTimeout(n))}}}const nc="up",Hi="down",XD="none",JD={atBottom:!1,notAtBottomBecause:"NOT_SHOWING_LAST_ITEM",state:{offsetBottom:0,scrollTop:0,viewportHeight:0,scrollHeight:0}},eL=0,Ic=Mt(([{scrollContainerState:e,scrollTop:t,viewportHeight:n,headerHeight:o,footerHeight:r,scrollBy:l}])=>{const c=Te(!1),d=Te(!0),f=pt(),m=pt(),g=Te(4),p=Te(eL),x=Hn(we(lv(we(et(t),La(1),qo(!0)),we(et(t),La(1),qo(!1),rv(100))),Vt()),!1),y=Hn(we(lv(we(l,qo(!0)),we(l,qo(!1),rv(200))),Vt()),!1);qe(we(kn(et(t),et(p)),He(([w,_])=>w<=_),Vt()),d),qe(we(d,Rr(50)),m);const S=xs(we(kn(e,et(n),et(o),et(r),et(g)),_o((w,[{scrollTop:_,scrollHeight:T},D,A,F,Q])=>{const q=_+D-T>-Q,G={viewportHeight:D,scrollTop:_,scrollHeight:T};if(q){let N,z;return _>w.state.scrollTop?(N="SCROLLED_DOWN",z=w.state.scrollTop-_):(N="SIZE_DECREASED",z=w.state.scrollTop-_||w.scrollTopDelta),{atBottom:!0,state:G,atBottomBecause:N,scrollTopDelta:z}}let Z;return G.scrollHeight>w.state.scrollHeight?Z="SIZE_INCREASED":D<w.state.viewportHeight?Z="VIEWPORT_HEIGHT_DECREASING":_<w.state.scrollTop?Z="SCROLLING_UPWARDS":Z="NOT_FULLY_SCROLLED_TO_LAST_ITEM_BOTTOM",{atBottom:!1,notAtBottomBecause:Z,state:G}},JD),Vt((w,_)=>w&&w.atBottom===_.atBottom))),b=Hn(we(e,_o((w,{scrollTop:_,scrollHeight:T,viewportHeight:D})=>{if(rS(w.scrollHeight,T))return{scrollTop:_,scrollHeight:T,jump:0,changed:!1};{const A=T-(_+D)<1;return w.scrollTop!==_&&A?{scrollHeight:T,scrollTop:_,jump:w.scrollTop-_,changed:!0}:{scrollHeight:T,scrollTop:_,jump:0,changed:!0}}},{scrollHeight:0,jump:0,scrollTop:0,changed:!1}),tt(w=>w.changed),He(w=>w.jump)),0);qe(we(S,He(w=>w.atBottom)),c),qe(we(c,Rr(50)),f);const I=Te(Hi);qe(we(e,He(({scrollTop:w})=>w),Vt(),_o((w,_)=>ps(y)?{direction:w.direction,prevScrollTop:_}:{direction:_<w.prevScrollTop?nc:Hi,prevScrollTop:_},{direction:Hi,prevScrollTop:0}),He(w=>w.direction)),I),qe(we(e,Rr(50),qo(XD)),I);const M=Te(0);return qe(we(x,tt(w=>!w),qo(0)),M),qe(we(t,Rr(100),mt(x),tt(([w,_])=>!!_),_o(([w,_],[T])=>[_,T],[0,0]),He(([w,_])=>_-w)),M),{isScrolling:x,isAtTop:d,isAtBottom:c,atBottomState:S,atTopStateChange:m,atBottomStateChange:f,scrollDirection:I,atBottomThreshold:g,atTopThreshold:p,scrollVelocity:M,lastJumpDueToItemResize:b}},Wt(Wn)),sl=Mt(([{log:e}])=>{const t=Te(!1),n=xs(we(t,tt(o=>o),Vt()));return At(t,o=>{o&&ps(e)("props updated",{},vs.DEBUG)}),{propsReady:t,didMount:n}},Wt(nl),{singleton:!0});function wg(e,t){e==0?t():requestAnimationFrame(()=>wg(e-1,t))}function Ig(e,t){const n=t-1;return typeof e=="number"?e:e.index==="LAST"?n:e.index}const Mc=Mt(([{sizes:e,listRefresh:t,defaultItemSize:n},{scrollTop:o},{scrollToIndex:r},{didMount:l}])=>{const c=Te(!0),d=Te(0),f=Te(!1);return qe(we(l,mt(d),tt(([m,g])=>!!g),qo(!1)),c),At(we(kn(t,l),mt(c,e,n,f),tt(([[,m],g,{sizeTree:p},x,y])=>m&&(!Lt(p)||yg(x))&&!g&&!y),mt(d)),([,m])=>{ct(f,!0),wg(3,()=>{cr(o,()=>ct(c,!0)),ct(r,m)})}),{scrolledToInitialItem:c,initialTopMostItemIndex:d}},Wt(Bo,Wn,wc,sl),{singleton:!0});function cv(e){return e?e==="smooth"?"smooth":"auto":!1}const tL=(e,t)=>typeof e=="function"?cv(e(t)):t&&cv(e),nL=Mt(([{totalCount:e,listRefresh:t},{isAtBottom:n,atBottomState:o},{scrollToIndex:r},{scrolledToInitialItem:l},{propsReady:c,didMount:d},{log:f},{scrollingInProgress:m}])=>{const g=Te(!1),p=pt();let x=null;function y(b){ct(r,{index:"LAST",align:"end",behavior:b})}At(we(kn(we(et(e),La(1)),d),mt(et(g),n,l,m),He(([[b,I],M,w,_,T])=>{let D=I&&_,A="auto";return D&&(A=tL(M,w||T),D=D&&!!A),{totalCount:b,shouldFollow:D,followOutputBehavior:A}}),tt(({shouldFollow:b})=>b)),({totalCount:b,followOutputBehavior:I})=>{x&&(x(),x=null),x=cr(t,()=>{ps(f)("following output to ",{totalCount:b},vs.DEBUG),y(I),x=null})});function S(b){const I=cr(o,M=>{b&&!M.atBottom&&M.notAtBottomBecause==="SIZE_INCREASED"&&!x&&(ps(f)("scrolling to bottom due to increased size",{},vs.DEBUG),y("auto"))});setTimeout(I,100)}return At(we(kn(et(g),e,c),tt(([b,,I])=>b&&I),_o(({value:b},[,I])=>({refreshed:b===I,value:I}),{refreshed:!1,value:0}),tt(({refreshed:b})=>b),mt(g,e)),([,b])=>{S(b!==!1)}),At(p,()=>{S(ps(g)!==!1)}),At(kn(et(g),o),([b,I])=>{b&&!I.atBottom&&I.notAtBottomBecause==="VIEWPORT_HEIGHT_DECREASING"&&y("auto")}),{followOutput:g,autoscrollToBottom:p}},Wt(Bo,Ic,wc,Mc,sl,nl,Wn));function sL(e){return e.reduce((t,n)=>(t.groupIndices.push(t.totalCount),t.totalCount+=n+1,t),{totalCount:0,groupIndices:[]})}const gS=Mt(([{totalCount:e,groupIndices:t,sizes:n},{scrollTop:o,headerHeight:r}])=>{const l=pt(),c=pt(),d=xs(we(l,He(sL)));return qe(we(d,He(f=>f.totalCount)),e),qe(we(d,He(f=>f.groupIndices)),t),qe(we(kn(o,n,r),tt(([f,m])=>Vf(m)),He(([f,m,g])=>lo(m.groupOffsetTree,Math.max(f-g,0),"v")[0]),Vt(),He(f=>[f])),c),{groupCounts:l,topItemsIndexes:c}},Wt(Bo,Wn));function sc(e,t){return!!(e&&e[0]===t[0]&&e[1]===t[1])}function xS(e,t){return!!(e&&e.startIndex===t.startIndex&&e.endIndex===t.endIndex)}const Zd="top",qd="bottom",uv="none";function dv(e,t,n){return typeof e=="number"?n===nc&&t===Zd||n===Hi&&t===qd?e:0:n===nc?t===Zd?e.main:e.reverse:t===qd?e.main:e.reverse}function fv(e,t){return typeof e=="number"?e:e[t]||0}const Mg=Mt(([{scrollTop:e,viewportHeight:t,deviation:n,headerHeight:o,fixedHeaderHeight:r}])=>{const l=pt(),c=Te(0),d=Te(0),f=Te(0),m=Hn(we(kn(et(e),et(t),et(o),et(l,sc),et(f),et(c),et(r),et(n),et(d)),He(([g,p,x,[y,S],b,I,M,w,_])=>{const T=g-w,D=I+M,A=Math.max(x-T,0);let F=uv;const Q=fv(_,Zd),q=fv(_,qd);return y-=w,y+=x+M,S+=x+M,S-=w,y>g+D-Q&&(F=nc),S<g-A+p+q&&(F=Hi),F!==uv?[Math.max(T-x-dv(b,Zd,F)-Q,0),T-A-M+p+dv(b,qd,F)+q]:null}),tt(g=>g!=null),Vt(sc)),[0,0]);return{listBoundary:l,overscan:f,topListHeight:c,increaseViewportBy:d,visibleRange:m}},Wt(Wn),{singleton:!0});function oL(e,t,n){if(Vf(t)){const o=hS(e,t);return[{index:lo(t.groupOffsetTree,o)[0],size:0,offset:0},{index:o,size:0,offset:0,data:n&&n[0]}]}return[{index:e,size:0,offset:0,data:n&&n[0]}]}const Gh={items:[],topItems:[],offsetTop:0,offsetBottom:0,top:0,bottom:0,topListHeight:0,totalCount:0,firstItemIndex:0};function mv(e,t,n){if(e.length===0)return[];if(!Vf(t))return e.map(m=>({...m,index:m.index+n,originalIndex:m.index}));const o=e[0].index,r=e[e.length-1].index,l=[],c=$f(t.groupOffsetTree,o,r);let d,f=0;for(const m of e){(!d||d.end<m.index)&&(d=c.shift(),f=t.groupIndices.indexOf(d.start));let g;m.index===d.start?g={type:"group",index:f}:g={index:m.index-(f+1)+n,groupIndex:f},l.push({...g,size:m.size,offset:m.offset,originalIndex:m.index,data:m.data})}return l}function pd(e,t,n,o,r,l){const{lastSize:c,lastOffset:d,lastIndex:f}=r;let m=0,g=0;if(e.length>0){m=e[0].offset;const b=e[e.length-1];g=b.offset+b.size}const p=n-f,x=d+p*c+(p-1)*o,y=m,S=x-g;return{items:mv(e,r,l),topItems:mv(t,r,l),topListHeight:t.reduce((b,I)=>I.size+b,0),offsetTop:m,offsetBottom:S,top:y,bottom:g,totalCount:n,firstItemIndex:l}}function vS(e,t,n,o,r,l){let c=0;if(n.groupIndices.length>0)for(const g of n.groupIndices){if(g-c>=e)break;c++}const d=e+c,f=Ig(t,d),m=Array.from({length:d}).map((g,p)=>({index:p+f,size:0,offset:0,data:l[p+f]}));return pd(m,[],d,r,n,o)}const Nl=Mt(([{sizes:e,totalCount:t,data:n,firstItemIndex:o,gap:r},l,{visibleRange:c,listBoundary:d,topListHeight:f},{scrolledToInitialItem:m,initialTopMostItemIndex:g},{topListHeight:p},x,{didMount:y},{recalcInProgress:S}])=>{const b=Te([]),I=Te(0),M=pt();qe(l.topItemsIndexes,b);const w=Hn(we(kn(y,S,et(c,sc),et(t),et(e),et(g),m,et(b),et(o),et(r),n),tt(([A,F,,Q,,,,,,,q])=>{const G=q&&q.length!==Q;return A&&!F&&!G}),He(([,,[A,F],Q,q,G,Z,N,z,$,se])=>{const he=q,{sizeTree:ke,offsetTree:Ce}=he,ge=ps(I);if(Q===0)return{...Gh,totalCount:Q};if(A===0&&F===0)return ge===0?{...Gh,totalCount:Q}:vS(ge,G,q,z,$,se||[]);if(Lt(ke))return ge>0?null:pd(oL(Ig(G,Q),he,se),[],Q,$,he,z);const De=[];if(N.length>0){const P=N[0],B=N[N.length-1];let H=0;for(const V of $f(ke,P,B)){const le=V.value,fe=Math.max(V.start,P),ue=Math.min(V.end,B);for(let xe=fe;xe<=ue;xe++)De.push({index:xe,size:le,offset:H,data:se&&se[xe]}),H+=le}}if(!Z)return pd([],De,Q,$,he,z);const Se=N.length>0?N[N.length-1]+1:0,oe=UD(Ce,A,F,Se);if(oe.length===0)return null;const re=Q-1,de=Hf([],P=>{for(const B of oe){const H=B.value;let V=H.offset,le=B.start;const fe=H.size;if(H.offset<A){le+=Math.floor((A-H.offset+$)/(fe+$));const xe=le-B.start;V+=xe*fe+xe*$}le<Se&&(V+=(Se-le)*fe,le=Se);const ue=Math.min(B.end,re);for(let xe=le;xe<=ue&&!(V>=F);xe++)P.push({index:xe,size:fe,offset:V,data:se&&se[xe]}),V+=fe+$}});return pd(de,De,Q,$,he,z)}),tt(A=>A!==null),Vt()),Gh);qe(we(n,tt(yg),He(A=>A==null?void 0:A.length)),t),qe(we(w,He(A=>A.topListHeight)),p),qe(p,f),qe(we(w,He(A=>[A.top,A.bottom])),d),qe(we(w,He(A=>A.items)),M);const _=xs(we(w,tt(({items:A})=>A.length>0),mt(t,n),tt(([{items:A},F])=>A[A.length-1].originalIndex===F-1),He(([,A,F])=>[A-1,F]),Vt(sc),He(([A])=>A))),T=xs(we(w,Rr(200),tt(({items:A,topItems:F})=>A.length>0&&A[0].originalIndex===F.length),He(({items:A})=>A[0].index),Vt())),D=xs(we(w,tt(({items:A})=>A.length>0),He(({items:A})=>{let F=0,Q=A.length-1;for(;A[F].type==="group"&&F<Q;)F++;for(;A[Q].type==="group"&&Q>F;)Q--;return{startIndex:A[F].index,endIndex:A[Q].index}}),Vt(xS)));return{listState:w,topItemsIndexes:b,endReached:_,startReached:T,rangeChanged:D,itemsRendered:M,initialItemCount:I,...x}},Wt(Bo,gS,Mg,Mc,wc,Ic,sl,Sg),{singleton:!0}),rL=Mt(([{sizes:e,firstItemIndex:t,data:n,gap:o},{initialTopMostItemIndex:r},{initialItemCount:l,listState:c},{didMount:d}])=>(qe(we(d,mt(l),tt(([,f])=>f!==0),mt(r,e,t,o,n),He(([[,f],m,g,p,x,y=[]])=>vS(f,m,g,p,x,y))),c),{}),Wt(Bo,Mc,Nl,sl),{singleton:!0}),CS=Mt(([{scrollVelocity:e}])=>{const t=Te(!1),n=pt(),o=Te(!1);return qe(we(e,mt(o,t,n),tt(([r,l])=>!!l),He(([r,l,c,d])=>{const{exit:f,enter:m}=l;if(c){if(f(r,d))return!1}else if(m(r,d))return!0;return c}),Vt()),t),At(we(kn(t,e,n),mt(o)),([[r,l,c],d])=>r&&d&&d.change&&d.change(l,c)),{isSeeking:t,scrollSeekConfiguration:o,scrollVelocity:e,scrollSeekRangeChanged:n}},Wt(Ic),{singleton:!0}),lL=Mt(([{topItemsIndexes:e}])=>{const t=Te(0);return qe(we(t,tt(n=>n>0),He(n=>Array.from({length:n}).map((o,r)=>r))),e),{topItemCount:t}},Wt(Nl)),yS=Mt(([{footerHeight:e,headerHeight:t,fixedHeaderHeight:n,fixedFooterHeight:o},{listState:r}])=>{const l=pt(),c=Hn(we(kn(e,o,t,n,r),He(([d,f,m,g,p])=>d+f+m+g+p.offsetBottom+p.bottom)),0);return qe(et(c),l),{totalListHeight:c,totalListHeightChanged:l}},Wt(Wn,Nl),{singleton:!0});function bS(e){let t=!1,n;return()=>(t||(t=!0,n=e()),n)}const aL=bS(()=>/iP(ad|od|hone)/i.test(navigator.userAgent)&&/WebKit/i.test(navigator.userAgent)),iL=Mt(([{scrollBy:e,scrollTop:t,deviation:n,scrollingInProgress:o},{isScrolling:r,isAtBottom:l,scrollDirection:c,lastJumpDueToItemResize:d},{listState:f},{beforeUnshiftWith:m,shiftWithOffset:g,sizes:p,gap:x},{log:y},{recalcInProgress:S}])=>{const b=xs(we(f,mt(d),_o(([,M,w,_],[{items:T,totalCount:D,bottom:A,offsetBottom:F},Q])=>{const q=A+F;let G=0;return w===D&&M.length>0&&T.length>0&&(T[0].originalIndex===0&&M[0].originalIndex===0||(G=q-_,G!==0&&(G+=Q))),[G,T,D,q]},[0,[],0,0]),tt(([M])=>M!==0),mt(t,c,o,l,y,S),tt(([,M,w,_,,,T])=>!T&&!_&&M!==0&&w===nc),He(([[M],,,,,w])=>(w("Upward scrolling compensation",{amount:M},vs.DEBUG),M))));function I(M){M>0?(ct(e,{top:-M,behavior:"auto"}),ct(n,0)):(ct(n,0),ct(e,{top:-M,behavior:"auto"}))}return At(we(b,mt(n,r)),([M,w,_])=>{_&&aL()?ct(n,w-M):I(-M)}),At(we(kn(Hn(r,!1),n,S),tt(([M,w,_])=>!M&&!_&&w!==0),He(([M,w])=>w),Rr(1)),I),qe(we(g,He(M=>({top:-M}))),e),At(we(m,mt(p,x),He(([M,{lastSize:w,groupIndices:_,sizeTree:T},D])=>{function A(F){return F*(w+D)}if(_.length===0)return A(M);{let F=0;const Q=ec(T,0);let q=0,G=0;for(;q<M;){q++,F+=Q;let Z=_.length===G+1?1/0:_[G+1]-_[G]-1;q+Z>M&&(F-=Q,Z=M-q+1),q+=Z,F+=A(Z),G++}return F}})),M=>{ct(n,M),requestAnimationFrame(()=>{ct(e,{top:M}),requestAnimationFrame(()=>{ct(n,0),ct(S,!1)})})}),{deviation:n}},Wt(Wn,Ic,Nl,Bo,nl,Sg)),cL=Mt(([{didMount:e},{scrollTo:t},{listState:n}])=>{const o=Te(0);return At(we(e,mt(o),tt(([,r])=>r!==0),He(([,r])=>({top:r}))),r=>{cr(we(n,La(1),tt(l=>l.items.length>1)),()=>{requestAnimationFrame(()=>{ct(t,r)})})}),{initialScrollTop:o}},Wt(sl,Wn,Nl),{singleton:!0}),uL=Mt(([{viewportHeight:e},{totalListHeight:t}])=>{const n=Te(!1),o=Hn(we(kn(n,e,t),tt(([r])=>r),He(([,r,l])=>Math.max(0,r-l)),Rr(0),Vt()),0);return{alignToBottom:n,paddingTopAddition:o}},Wt(Wn,yS),{singleton:!0}),_g=Mt(([{scrollTo:e,scrollContainerState:t}])=>{const n=pt(),o=pt(),r=pt(),l=Te(!1),c=Te(void 0);return qe(we(kn(n,o),He(([{viewportHeight:d,scrollTop:f,scrollHeight:m},{offsetTop:g}])=>({scrollTop:Math.max(0,f-g),scrollHeight:m,viewportHeight:d}))),t),qe(we(e,mt(o),He(([d,{offsetTop:f}])=>({...d,top:d.top+f}))),r),{useWindowScroll:l,customScrollParent:c,windowScrollContainerState:n,windowViewportRect:o,windowScrollTo:r}},Wt(Wn)),dL=({itemTop:e,itemBottom:t,viewportTop:n,viewportBottom:o,locationParams:{behavior:r,align:l,...c}})=>e<n?{...c,behavior:r,align:l??"start"}:t>o?{...c,behavior:r,align:l??"end"}:null,fL=Mt(([{sizes:e,totalCount:t,gap:n},{scrollTop:o,viewportHeight:r,headerHeight:l,fixedHeaderHeight:c,fixedFooterHeight:d,scrollingInProgress:f},{scrollToIndex:m}])=>{const g=pt();return qe(we(g,mt(e,r,t,l,c,d,o),mt(n),He(([[p,x,y,S,b,I,M,w],_])=>{const{done:T,behavior:D,align:A,calculateViewLocation:F=dL,...Q}=p,q=mS(p,x,S-1),G=tc(q,x.offsetTree,_)+b+I,Z=G+lo(x.sizeTree,q)[1],N=w+I,z=w+y-M,$=F({itemTop:G,itemBottom:Z,viewportTop:N,viewportBottom:z,locationParams:{behavior:D,align:A,...Q}});return $?T&&cr(we(f,tt(se=>se===!1),La(ps(f)?1:2)),T):T&&T(),$}),tt(p=>p!==null)),m),{scrollIntoView:g}},Wt(Bo,Wn,wc,Nl,nl),{singleton:!0}),mL=Mt(([{sizes:e,sizeRanges:t},{scrollTop:n},{initialTopMostItemIndex:o},{didMount:r},{useWindowScroll:l,windowScrollContainerState:c,windowViewportRect:d}])=>{const f=pt(),m=Te(void 0),g=Te(null),p=Te(null);return qe(c,g),qe(d,p),At(we(f,mt(e,n,l,g,p)),([x,y,S,b,I,M])=>{const w=qD(y.sizeTree);b&&I!==null&&M!==null&&(S=I.scrollTop-M.offsetTop),x({ranges:w,scrollTop:S})}),qe(we(m,tt(yg),He(hL)),o),qe(we(r,mt(m),tt(([,x])=>x!==void 0),Vt(),He(([,x])=>x.ranges)),t),{getState:f,restoreStateFrom:m}},Wt(Bo,Wn,Mc,sl,_g));function hL(e){return{offset:e.scrollTop,index:0,align:"start"}}const pL=Mt(([e,t,n,o,r,l,c,d,f,m])=>({...e,...t,...n,...o,...r,...l,...c,...d,...f,...m}),Wt(Mg,rL,sl,CS,yS,cL,uL,_g,fL,nl)),gL=Mt(([{totalCount:e,sizeRanges:t,fixedItemSize:n,defaultItemSize:o,trackItemSizes:r,itemSize:l,data:c,firstItemIndex:d,groupIndices:f,statefulTotalCount:m,gap:g,sizes:p},{initialTopMostItemIndex:x,scrolledToInitialItem:y},S,b,I,{listState:M,topItemsIndexes:w,..._},{scrollToIndex:T},D,{topItemCount:A},{groupCounts:F},Q])=>(qe(_.rangeChanged,Q.scrollSeekRangeChanged),qe(we(Q.windowViewportRect,He(q=>q.visibleHeight)),S.viewportHeight),{totalCount:e,data:c,firstItemIndex:d,sizeRanges:t,initialTopMostItemIndex:x,scrolledToInitialItem:y,topItemsIndexes:w,topItemCount:A,groupCounts:F,fixedItemHeight:n,defaultItemHeight:o,gap:g,...I,statefulTotalCount:m,listState:M,scrollToIndex:T,trackItemSizes:r,itemSize:l,groupIndices:f,..._,...Q,...S,sizes:p,...b}),Wt(Bo,Mc,Wn,mL,nL,Nl,wc,iL,lL,gS,pL)),Zh="-webkit-sticky",hv="sticky",jS=bS(()=>{if(typeof document>"u")return hv;const e=document.createElement("div");return e.style.position=Zh,e.style.position===Zh?Zh:hv});function SS(e,t){const n=te.useRef(null),o=te.useCallback(d=>{if(d===null||!d.offsetParent)return;const f=d.getBoundingClientRect(),m=f.width;let g,p;if(t){const x=t.getBoundingClientRect(),y=f.top-x.top;g=x.height-Math.max(0,y),p=y+t.scrollTop}else g=window.innerHeight-Math.max(0,f.top),p=f.top+window.pageYOffset;n.current={offsetTop:p,visibleHeight:g,visibleWidth:m},e(n.current)},[e,t]),{callbackRef:r,ref:l}=jg(o),c=te.useCallback(()=>{o(l.current)},[o,l]);return te.useEffect(()=>{if(t){t.addEventListener("scroll",c);const d=new ResizeObserver(c);return d.observe(t),()=>{t.removeEventListener("scroll",c),d.unobserve(t)}}else return window.addEventListener("scroll",c),window.addEventListener("resize",c),()=>{window.removeEventListener("scroll",c),window.removeEventListener("resize",c)}},[c,t]),r}const kS=te.createContext(void 0),wS=te.createContext(void 0);function IS(e){return e}const xL=Mt(()=>{const e=Te(f=>`Item ${f}`),t=Te(null),n=Te(f=>`Group ${f}`),o=Te({}),r=Te(IS),l=Te("div"),c=Te(Qa),d=(f,m=null)=>Hn(we(o,He(g=>g[f]),Vt()),m);return{context:t,itemContent:e,groupContent:n,components:o,computeItemKey:r,headerFooterTag:l,scrollerRef:c,FooterComponent:d("Footer"),HeaderComponent:d("Header"),TopItemListComponent:d("TopItemList"),ListComponent:d("List","div"),ItemComponent:d("Item","div"),GroupComponent:d("Group","div"),ScrollerComponent:d("Scroller","div"),EmptyPlaceholder:d("EmptyPlaceholder"),ScrollSeekPlaceholder:d("ScrollSeekPlaceholder")}}),vL=Mt(([e,t])=>({...e,...t}),Wt(gL,xL)),CL=({height:e})=>te.createElement("div",{style:{height:e}}),yL={position:jS(),zIndex:1,overflowAnchor:"none"},bL={overflowAnchor:"none"},pv=te.memo(function({showTopList:t=!1}){const n=ht("listState"),o=Fs("sizeRanges"),r=ht("useWindowScroll"),l=ht("customScrollParent"),c=Fs("windowScrollContainerState"),d=Fs("scrollContainerState"),f=l||r?c:d,m=ht("itemContent"),g=ht("context"),p=ht("groupContent"),x=ht("trackItemSizes"),y=ht("itemSize"),S=ht("log"),b=Fs("gap"),{callbackRef:I}=RD(o,y,x,t?Qa:f,S,b,l),[M,w]=te.useState(0);Ag("deviation",$=>{M!==$&&w($)});const _=ht("EmptyPlaceholder"),T=ht("ScrollSeekPlaceholder")||CL,D=ht("ListComponent"),A=ht("ItemComponent"),F=ht("GroupComponent"),Q=ht("computeItemKey"),q=ht("isSeeking"),G=ht("groupIndices").length>0,Z=ht("paddingTopAddition"),N=ht("scrolledToInitialItem"),z=t?{}:{boxSizing:"border-box",paddingTop:n.offsetTop+Z,paddingBottom:n.offsetBottom,marginTop:M,...N?{}:{visibility:"hidden"}};return!t&&n.totalCount===0&&_?te.createElement(_,ts(_,g)):te.createElement(D,{...ts(D,g),ref:I,style:z,"data-test-id":t?"virtuoso-top-item-list":"virtuoso-item-list"},(t?n.topItems:n.items).map($=>{const se=$.originalIndex,he=Q(se+n.firstItemIndex,$.data,g);return q?te.createElement(T,{...ts(T,g),key:he,index:$.index,height:$.size,type:$.type||"item",...$.type==="group"?{}:{groupIndex:$.groupIndex}}):$.type==="group"?te.createElement(F,{...ts(F,g),key:he,"data-index":se,"data-known-size":$.size,"data-item-index":$.index,style:yL},p($.index,g)):te.createElement(A,{...ts(A,g),...kL(A,$.data),key:he,"data-index":se,"data-known-size":$.size,"data-item-index":$.index,"data-item-group-index":$.groupIndex,style:bL},G?m($.index,$.groupIndex,$.data,g):m($.index,$.data,g))}))}),jL={height:"100%",outline:"none",overflowY:"auto",position:"relative",WebkitOverflowScrolling:"touch"},Wf={width:"100%",height:"100%",position:"absolute",top:0},SL={width:"100%",position:jS(),top:0,zIndex:1};function ts(e,t){if(typeof e!="string")return{context:t}}function kL(e,t){return{item:typeof e=="string"?void 0:t}}const wL=te.memo(function(){const t=ht("HeaderComponent"),n=Fs("headerHeight"),o=ht("headerFooterTag"),r=Ol(c=>n(Vr(c,"height"))),l=ht("context");return t?te.createElement(o,{ref:r},te.createElement(t,ts(t,l))):null}),IL=te.memo(function(){const t=ht("FooterComponent"),n=Fs("footerHeight"),o=ht("headerFooterTag"),r=Ol(c=>n(Vr(c,"height"))),l=ht("context");return t?te.createElement(o,{ref:r},te.createElement(t,ts(t,l))):null});function MS({usePublisher:e,useEmitter:t,useEmitterValue:n}){return te.memo(function({style:l,children:c,...d}){const f=e("scrollContainerState"),m=n("ScrollerComponent"),g=e("smoothScrollTargetReached"),p=n("scrollerRef"),x=n("context"),{scrollerRef:y,scrollByCallback:S,scrollToCallback:b}=lS(f,g,m,p);return t("scrollTo",b),t("scrollBy",S),te.createElement(m,{ref:y,style:{...jL,...l},"data-test-id":"virtuoso-scroller","data-virtuoso-scroller":!0,tabIndex:0,...d,...ts(m,x)},c)})}function _S({usePublisher:e,useEmitter:t,useEmitterValue:n}){return te.memo(function({style:l,children:c,...d}){const f=e("windowScrollContainerState"),m=n("ScrollerComponent"),g=e("smoothScrollTargetReached"),p=n("totalListHeight"),x=n("deviation"),y=n("customScrollParent"),S=n("context"),{scrollerRef:b,scrollByCallback:I,scrollToCallback:M}=lS(f,g,m,Qa,y);return DD(()=>(b.current=y||window,()=>{b.current=null}),[b,y]),t("windowScrollTo",M),t("scrollBy",I),te.createElement(m,{style:{position:"relative",...l,...p!==0?{height:p+x}:{}},"data-virtuoso-scroller":!0,...d,...ts(m,S)},c)})}const ML=({children:e})=>{const t=te.useContext(kS),n=Fs("viewportHeight"),o=Fs("fixedItemHeight"),r=Ol(tS(n,l=>Vr(l,"height")));return te.useEffect(()=>{t&&(n(t.viewportHeight),o(t.itemHeight))},[t,n,o]),te.createElement("div",{style:Wf,ref:r,"data-viewport-type":"element"},e)},_L=({children:e})=>{const t=te.useContext(kS),n=Fs("windowViewportRect"),o=Fs("fixedItemHeight"),r=ht("customScrollParent"),l=SS(n,r);return te.useEffect(()=>{t&&(o(t.itemHeight),n({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:100}))},[t,n,o]),te.createElement("div",{ref:l,style:Wf,"data-viewport-type":"window"},e)},AL=({children:e})=>{const t=ht("TopItemListComponent"),n=ht("headerHeight"),o={...SL,marginTop:`${n}px`},r=ht("context");return te.createElement(t||"div",{style:o,context:r},e)},PL=te.memo(function(t){const n=ht("useWindowScroll"),o=ht("topItemsIndexes").length>0,r=ht("customScrollParent"),l=r||n?LL:DL,c=r||n?_L:ML;return te.createElement(l,{...t},o&&te.createElement(AL,null,te.createElement(pv,{showTopList:!0})),te.createElement(c,null,te.createElement(wL,null),te.createElement(pv,null),te.createElement(IL,null)))}),{Component:EL,usePublisher:Fs,useEmitterValue:ht,useEmitter:Ag}=oS(vL,{required:{},optional:{restoreStateFrom:"restoreStateFrom",context:"context",followOutput:"followOutput",itemContent:"itemContent",groupContent:"groupContent",overscan:"overscan",increaseViewportBy:"increaseViewportBy",totalCount:"totalCount",groupCounts:"groupCounts",topItemCount:"topItemCount",firstItemIndex:"firstItemIndex",initialTopMostItemIndex:"initialTopMostItemIndex",components:"components",atBottomThreshold:"atBottomThreshold",atTopThreshold:"atTopThreshold",computeItemKey:"computeItemKey",defaultItemHeight:"defaultItemHeight",fixedItemHeight:"fixedItemHeight",itemSize:"itemSize",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",data:"data",initialItemCount:"initialItemCount",initialScrollTop:"initialScrollTop",alignToBottom:"alignToBottom",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel"},methods:{scrollToIndex:"scrollToIndex",scrollIntoView:"scrollIntoView",scrollTo:"scrollTo",scrollBy:"scrollBy",autoscrollToBottom:"autoscrollToBottom",getState:"getState"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",totalListHeightChanged:"totalListHeightChanged",itemsRendered:"itemsRendered",groupIndices:"groupIndices"}},PL),DL=MS({usePublisher:Fs,useEmitterValue:ht,useEmitter:Ag}),LL=_S({usePublisher:Fs,useEmitterValue:ht,useEmitter:Ag}),TL=EL,gv={items:[],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},RL={items:[{index:0}],offsetBottom:0,offsetTop:0,top:0,bottom:0,itemHeight:0,itemWidth:0},{round:xv,ceil:vv,floor:Qd,min:qh,max:$i}=Math;function BL(e){return{...RL,items:e}}function Cv(e,t,n){return Array.from({length:t-e+1}).map((o,r)=>{const l=n===null?null:n[r+e];return{index:r+e,data:l}})}function OL(e,t){return e&&e.column===t.column&&e.row===t.row}function Vu(e,t){return e&&e.width===t.width&&e.height===t.height}const NL=Mt(([{overscan:e,visibleRange:t,listBoundary:n},{scrollTop:o,viewportHeight:r,scrollBy:l,scrollTo:c,smoothScrollTargetReached:d,scrollContainerState:f,footerHeight:m,headerHeight:g},p,x,{propsReady:y,didMount:S},{windowViewportRect:b,useWindowScroll:I,customScrollParent:M,windowScrollContainerState:w,windowScrollTo:_},T])=>{const D=Te(0),A=Te(0),F=Te(gv),Q=Te({height:0,width:0}),q=Te({height:0,width:0}),G=pt(),Z=pt(),N=Te(0),z=Te(null),$=Te({row:0,column:0}),se=pt(),he=pt(),ke=Te(!1),Ce=Te(0),ge=Te(!0),De=Te(!1);At(we(S,mt(Ce),tt(([B,H])=>!!H)),()=>{ct(ge,!1),ct(A,0)}),At(we(kn(S,ge,q,Q,Ce,De),tt(([B,H,V,le,,fe])=>B&&!H&&V.height!==0&&le.height!==0&&!fe)),([,,,,B])=>{ct(De,!0),wg(1,()=>{ct(G,B)}),cr(we(o),()=>{ct(n,[0,0]),ct(ge,!0)})}),qe(we(he,tt(B=>B!=null&&B.scrollTop>0),qo(0)),A),At(we(S,mt(he),tt(([,B])=>B!=null)),([,B])=>{B&&(ct(Q,B.viewport),ct(q,B==null?void 0:B.item),ct($,B.gap),B.scrollTop>0&&(ct(ke,!0),cr(we(o,La(1)),H=>{ct(ke,!1)}),ct(c,{top:B.scrollTop})))}),qe(we(Q,He(({height:B})=>B)),r),qe(we(kn(et(Q,Vu),et(q,Vu),et($,(B,H)=>B&&B.column===H.column&&B.row===H.row),et(o)),He(([B,H,V,le])=>({viewport:B,item:H,gap:V,scrollTop:le}))),se),qe(we(kn(et(D),t,et($,OL),et(q,Vu),et(Q,Vu),et(z),et(A),et(ke),et(ge),et(Ce)),tt(([,,,,,,,B])=>!B),He(([B,[H,V],le,fe,ue,xe,W,,Me,ye])=>{const{row:Pe,column:Ve}=le,{height:Ye,width:O}=fe,{width:ne}=ue;if(W===0&&(B===0||ne===0))return gv;if(O===0){const Ot=Ig(ye,B),Xt=Ot===0?Math.max(W-1,0):Ot;return BL(Cv(Ot,Xt,xe))}const ce=AS(ne,O,Ve);let _e,be;Me?H===0&&V===0&&W>0?(_e=0,be=W-1):(_e=ce*Qd((H+Pe)/(Ye+Pe)),be=ce*vv((V+Pe)/(Ye+Pe))-1,be=qh(B-1,$i(be,ce-1)),_e=qh(be,$i(0,_e))):(_e=0,be=-1);const K=Cv(_e,be,xe),{top:ve,bottom:Ee}=yv(ue,le,fe,K),Ze=vv(B/ce),St=Ze*Ye+(Ze-1)*Pe-Ee;return{items:K,offsetTop:ve,offsetBottom:St,top:ve,bottom:Ee,itemHeight:Ye,itemWidth:O}})),F),qe(we(z,tt(B=>B!==null),He(B=>B.length)),D),qe(we(kn(Q,q,F,$),tt(([B,H,{items:V}])=>V.length>0&&H.height!==0&&B.height!==0),He(([B,H,{items:V},le])=>{const{top:fe,bottom:ue}=yv(B,le,H,V);return[fe,ue]}),Vt(sc)),n);const Se=Te(!1);qe(we(o,mt(Se),He(([B,H])=>H||B!==0)),Se);const oe=xs(we(et(F),tt(({items:B})=>B.length>0),mt(D,Se),tt(([{items:B},H,V])=>V&&B[B.length-1].index===H-1),He(([,B])=>B-1),Vt())),re=xs(we(et(F),tt(({items:B})=>B.length>0&&B[0].index===0),qo(0),Vt())),de=xs(we(et(F),mt(ke),tt(([{items:B},H])=>B.length>0&&!H),He(([{items:B}])=>({startIndex:B[0].index,endIndex:B[B.length-1].index})),Vt(xS),Rr(0)));qe(de,x.scrollSeekRangeChanged),qe(we(G,mt(Q,q,D,$),He(([B,H,V,le,fe])=>{const ue=pS(B),{align:xe,behavior:W,offset:Me}=ue;let ye=ue.index;ye==="LAST"&&(ye=le-1),ye=$i(0,ye,qh(le-1,ye));let Pe=qp(H,fe,V,ye);return xe==="end"?Pe=xv(Pe-H.height+V.height):xe==="center"&&(Pe=xv(Pe-H.height/2+V.height/2)),Me&&(Pe+=Me),{top:Pe,behavior:W}})),c);const P=Hn(we(F,He(B=>B.offsetBottom+B.bottom)),0);return qe(we(b,He(B=>({width:B.visibleWidth,height:B.visibleHeight}))),Q),{data:z,totalCount:D,viewportDimensions:Q,itemDimensions:q,scrollTop:o,scrollHeight:Z,overscan:e,scrollBy:l,scrollTo:c,scrollToIndex:G,smoothScrollTargetReached:d,windowViewportRect:b,windowScrollTo:_,useWindowScroll:I,customScrollParent:M,windowScrollContainerState:w,deviation:N,scrollContainerState:f,footerHeight:m,headerHeight:g,initialItemCount:A,gap:$,restoreStateFrom:he,...x,initialTopMostItemIndex:Ce,gridState:F,totalListHeight:P,...p,startReached:re,endReached:oe,rangeChanged:de,stateChanged:se,propsReady:y,stateRestoreInProgress:ke,...T}},Wt(Mg,Wn,Ic,CS,sl,_g,nl));function yv(e,t,n,o){const{height:r}=n;if(r===void 0||o.length===0)return{top:0,bottom:0};const l=qp(e,t,n,o[0].index),c=qp(e,t,n,o[o.length-1].index)+r;return{top:l,bottom:c}}function qp(e,t,n,o){const r=AS(e.width,n.width,t.column),l=Qd(o/r),c=l*n.height+$i(0,l-1)*t.row;return c>0?c+t.row:c}function AS(e,t,n){return $i(1,Qd((e+n)/(Qd(t)+n)))}const FL=Mt(()=>{const e=Te(m=>`Item ${m}`),t=Te({}),n=Te(null),o=Te("virtuoso-grid-item"),r=Te("virtuoso-grid-list"),l=Te(IS),c=Te("div"),d=Te(Qa),f=(m,g=null)=>Hn(we(t,He(p=>p[m]),Vt()),g);return{context:n,itemContent:e,components:t,computeItemKey:l,itemClassName:o,listClassName:r,headerFooterTag:c,scrollerRef:d,FooterComponent:f("Footer"),HeaderComponent:f("Header"),ListComponent:f("List","div"),ItemComponent:f("Item","div"),ScrollerComponent:f("Scroller","div"),ScrollSeekPlaceholder:f("ScrollSeekPlaceholder","div")}}),zL=Mt(([e,t])=>({...e,...t}),Wt(NL,FL)),HL=te.memo(function(){const t=Qt("gridState"),n=Qt("listClassName"),o=Qt("itemClassName"),r=Qt("itemContent"),l=Qt("computeItemKey"),c=Qt("isSeeking"),d=no("scrollHeight"),f=Qt("ItemComponent"),m=Qt("ListComponent"),g=Qt("ScrollSeekPlaceholder"),p=Qt("context"),x=no("itemDimensions"),y=no("gap"),S=Qt("log"),b=Qt("stateRestoreInProgress"),I=Ol(M=>{const w=M.parentElement.parentElement.scrollHeight;d(w);const _=M.firstChild;if(_){const{width:T,height:D}=_.getBoundingClientRect();x({width:T,height:D})}y({row:bv("row-gap",getComputedStyle(M).rowGap,S),column:bv("column-gap",getComputedStyle(M).columnGap,S)})});return b?null:te.createElement(m,{ref:I,className:n,...ts(m,p),style:{paddingTop:t.offsetTop,paddingBottom:t.offsetBottom},"data-test-id":"virtuoso-item-list"},t.items.map(M=>{const w=l(M.index,M.data,p);return c?te.createElement(g,{key:w,...ts(g,p),index:M.index,height:t.itemHeight,width:t.itemWidth}):te.createElement(f,{...ts(f,p),className:o,"data-index":M.index,key:w},r(M.index,M.data,p))}))}),$L=te.memo(function(){const t=Qt("HeaderComponent"),n=no("headerHeight"),o=Qt("headerFooterTag"),r=Ol(c=>n(Vr(c,"height"))),l=Qt("context");return t?te.createElement(o,{ref:r},te.createElement(t,ts(t,l))):null}),VL=te.memo(function(){const t=Qt("FooterComponent"),n=no("footerHeight"),o=Qt("headerFooterTag"),r=Ol(c=>n(Vr(c,"height"))),l=Qt("context");return t?te.createElement(o,{ref:r},te.createElement(t,ts(t,l))):null}),WL=({children:e})=>{const t=te.useContext(wS),n=no("itemDimensions"),o=no("viewportDimensions"),r=Ol(l=>{o(l.getBoundingClientRect())});return te.useEffect(()=>{t&&(o({height:t.viewportHeight,width:t.viewportWidth}),n({height:t.itemHeight,width:t.itemWidth}))},[t,o,n]),te.createElement("div",{style:Wf,ref:r},e)},UL=({children:e})=>{const t=te.useContext(wS),n=no("windowViewportRect"),o=no("itemDimensions"),r=Qt("customScrollParent"),l=SS(n,r);return te.useEffect(()=>{t&&(o({height:t.itemHeight,width:t.itemWidth}),n({offsetTop:0,visibleHeight:t.viewportHeight,visibleWidth:t.viewportWidth}))},[t,n,o]),te.createElement("div",{ref:l,style:Wf},e)},GL=te.memo(function({...t}){const n=Qt("useWindowScroll"),o=Qt("customScrollParent"),r=o||n?QL:qL,l=o||n?UL:WL;return te.createElement(r,{...t},te.createElement(l,null,te.createElement($L,null),te.createElement(HL,null),te.createElement(VL,null)))}),{Component:ZL,usePublisher:no,useEmitterValue:Qt,useEmitter:PS}=oS(zL,{optional:{context:"context",totalCount:"totalCount",overscan:"overscan",itemContent:"itemContent",components:"components",computeItemKey:"computeItemKey",data:"data",initialItemCount:"initialItemCount",scrollSeekConfiguration:"scrollSeekConfiguration",headerFooterTag:"headerFooterTag",listClassName:"listClassName",itemClassName:"itemClassName",useWindowScroll:"useWindowScroll",customScrollParent:"customScrollParent",scrollerRef:"scrollerRef",logLevel:"logLevel",restoreStateFrom:"restoreStateFrom",initialTopMostItemIndex:"initialTopMostItemIndex"},methods:{scrollTo:"scrollTo",scrollBy:"scrollBy",scrollToIndex:"scrollToIndex"},events:{isScrolling:"isScrolling",endReached:"endReached",startReached:"startReached",rangeChanged:"rangeChanged",atBottomStateChange:"atBottomStateChange",atTopStateChange:"atTopStateChange",stateChanged:"stateChanged"}},GL),qL=MS({usePublisher:no,useEmitterValue:Qt,useEmitter:PS}),QL=_S({usePublisher:no,useEmitterValue:Qt,useEmitter:PS});function bv(e,t,n){return t!=="normal"&&!(t!=null&&t.endsWith("px"))&&n(`${e} was not resolved to pixel value correctly`,t,vs.WARN),t==="normal"?0:parseInt(t??"0",10)}const KL=ZL,YL=e=>{const t=j(l=>l.gallery.galleryView),{data:n}=af(e),{data:o}=cf(e),r=u.useMemo(()=>t==="images"?n==null?void 0:n.total:o==null?void 0:o.total,[t,o,n]);return{totalImages:n,totalAssets:o,currentViewTotal:r}},XL=({imageDTO:e})=>s.jsx(L,{pointerEvents:"none",flexDirection:"column",position:"absolute",top:0,insetInlineStart:0,p:2,alignItems:"flex-start",gap:2,children:s.jsxs(Yr,{variant:"solid",colorScheme:"base",children:[e.width," × ",e.height]})}),JL=u.memo(XL),Pg=({postUploadAction:e,isDisabled:t})=>{const n=j(f=>f.gallery.autoAddBoardId),[o]=qC(),r=u.useCallback(f=>{const m=f[0];m&&o({file:m,image_category:"user",is_intermediate:!1,postUploadAction:e??{type:"TOAST"},board_id:n==="none"?void 0:n})},[n,e,o]),{getRootProps:l,getInputProps:c,open:d}=wf({accept:{"image/png":[".png"],"image/jpeg":[".jpg",".jpeg",".png"]},onDropAccepted:r,disabled:t,noDrag:!0,multiple:!1});return{getUploadButtonProps:l,getUploadInputProps:c,openUploader:d}},eT=()=>{const{t:e}=R(),t=J(),n=j(b=>b.gallery.selection),o=gt(w0),r=Kt("bulkDownload").isFeatureEnabled,[l]=S0(),[c]=k0(),[d]=sy(),f=u.useCallback(()=>{t(ay(n)),t(g0(!0))},[t,n]),m=u.useCallback(()=>{t(pf(n))},[t,n]),g=u.useCallback(()=>{l({imageDTOs:n})},[l,n]),p=u.useCallback(()=>{c({imageDTOs:n})},[c,n]),x=u.useCallback(async()=>{try{const b=await d({image_names:n.map(I=>I.image_name)}).unwrap();t(Qe({title:e("gallery.preparingDownload"),status:"success",...b.response?{description:b.response,duration:null,isClosable:!0}:{}}))}catch{t(Qe({title:e("gallery.preparingDownloadFailed"),status:"error"}))}},[e,n,d,t]),y=u.useMemo(()=>n.every(b=>b.starred),[n]),S=u.useMemo(()=>n.every(b=>!b.starred),[n]);return s.jsxs(s.Fragment,{children:[y&&s.jsx(it,{icon:o?o.on.icon:s.jsx(K0,{}),onClickCapture:p,children:o?o.off.text:"Unstar All"}),(S||!y&&!S)&&s.jsx(it,{icon:o?o.on.icon:s.jsx(J0,{}),onClickCapture:g,children:o?o.on.text:"Star All"}),r&&s.jsx(it,{icon:s.jsx(Cc,{}),onClickCapture:x,children:e("gallery.downloadSelection")}),s.jsx(it,{icon:s.jsx(Yb,{}),onClickCapture:f,children:e("boards.changeBoard")}),s.jsx(Er,{}),s.jsx(it,{color:"error.300",icon:s.jsx(Vs,{}),onClickCapture:m,children:e("gallery.deleteSelection")})]})},tT=u.memo(eT),ES=()=>u.useCallback(async t=>new Promise(n=>{const o=new Image;o.onload=()=>{const r=document.createElement("canvas");r.width=o.width,r.height=o.height;const l=r.getContext("2d");l&&(l.drawImage(o,0,0),n(new Promise(c=>{r.toBlob(function(d){c(d)},"image/png")})))},o.crossOrigin=iy.get()?"use-credentials":"anonymous",o.src=t}),[]),DS=()=>{const e=ao(),{t}=R(),n=ES(),o=u.useMemo(()=>!!navigator.clipboard&&!!window.ClipboardItem,[]),r=u.useCallback(async l=>{o||e({title:t("toast.problemCopyingImage"),description:"Your browser doesn't support the Clipboard API.",status:"error",duration:2500,isClosable:!0});try{const c=await n(l);if(!c)throw new Error("Unable to create Blob");k6(c),e({title:t("toast.imageCopied"),status:"success",duration:2500,isClosable:!0})}catch(c){e({title:t("toast.problemCopyingImage"),description:String(c),status:"error",duration:2500,isClosable:!0})}},[n,o,t,e]);return{isClipboardAPIAvailable:o,copyImageToClipboard:r}},nT=()=>{const e=ao(),{t}=R(),n=ES();return{downloadImage:u.useCallback(async(r,l)=>{try{const c=await n(r);if(!c)throw new Error("Unable to create Blob");const d=window.URL.createObjectURL(c),f=document.createElement("a");f.style.display="none",f.href=d,f.download=l,document.body.appendChild(f),f.click(),window.URL.revokeObjectURL(d)}catch(c){e({title:t("toast.problemDownloadingImage"),description:String(c),status:"error",duration:2500,isClosable:!0})}},[t,e,n])}};I0("gallery/requestedBoardImagesDeletion");const sT=I0("gallery/sentImageToCanvas"),LS=I0("gallery/sentImageToImg2Img"),oT=Fe(Ss,e=>e.model),_c=()=>{const e=J(),t=ao(),{t:n}=R(),o=j(oT),r=u.useCallback(()=>{t({title:n("toast.parameterSet"),status:"info",duration:2500,isClosable:!0})},[n,t]),l=u.useCallback(P=>{t({title:n("toast.parameterNotSet"),description:P,status:"warning",duration:2500,isClosable:!0})},[n,t]),c=u.useCallback(()=>{t({title:n("toast.parametersSet"),status:"info",duration:2500,isClosable:!0})},[n,t]),d=u.useCallback(P=>{t({title:n("toast.parametersNotSet"),status:"warning",description:P,duration:2500,isClosable:!0})},[n,t]),f=u.useCallback((P,B,H,V)=>{if(Eu(P)||Du(B)||Ci(H)||yh(V)){Eu(P)&&e(ld(P)),Du(B)&&e(ad(B)),Ci(H)&&e(id(H)),Ci(V)&&e(cd(V)),r();return}l()},[e,r,l]),m=u.useCallback(P=>{if(!Eu(P)){l();return}e(ld(P)),r()},[e,r,l]),g=u.useCallback(P=>{if(!Du(P)){l();return}e(ad(P)),r()},[e,r,l]),p=u.useCallback(P=>{if(!Ci(P)){l();return}e(id(P)),r()},[e,r,l]),x=u.useCallback(P=>{if(!yh(P)){l();return}e(cd(P)),r()},[e,r,l]),y=u.useCallback(P=>{if(!qx(P)){l();return}e(Sd(P)),r()},[e,r,l]),S=u.useCallback(P=>{if(!bh(P)){l();return}e(pp(P)),r()},[e,r,l]),b=u.useCallback(P=>{if(!Qx(P)){l();return}e(gp(P)),r()},[e,r,l]),I=u.useCallback(P=>{if(!Kx(P)){l();return}e(xp(P)),r()},[e,r,l]),M=u.useCallback(P=>{if(!ya(P)){l();return}e(vp(P)),r()},[e,r,l]),w=u.useCallback(P=>{if(!Yx(P)&&!zn(P)){l();return}zn(P)?e(Ii(null)):e(Ii(P)),r()},[e,r,l]),_=u.useCallback(P=>{if(!jh(P)){l();return}e(Cp(P)),r()},[e,r,l]),T=u.useCallback(P=>{if(!Sh(P)){l();return}e(kh(P)),r()},[e,r,l]),D=u.useCallback(P=>{if(!wh(P)){l();return}e(Ih(P)),r()},[e,r,l]),A=u.useCallback((P,B)=>{if(!Sh(P)){d();return}if(!wh(B)){d();return}e(Ih(B)),e(kh(P)),c()},[e,c,d]),F=u.useCallback(P=>{if(!Lu(P)){l();return}e(yp(P)),r()},[e,r,l]),Q=u.useCallback(P=>{if(!Xx(P)){l();return}e(bp(P)),r()},[e,r,l]),q=u.useCallback(P=>{if(!Lu(P)){l();return}e(jp(P)),r()},[e,r,l]),G=u.useCallback(P=>{if(!Sp(P)){l();return}e(kp(P)),r()},[e,r,l]),{data:Z}=dc(void 0),N=u.useCallback((P,B)=>{var ue;if(!cy(P.lora))return{lora:null,error:"Invalid LoRA model"};const{base_model:H,model_name:V}=P.lora,le=Z?w6.selectById(Z,`${H}/lora/${V}`):void 0;return le?(le==null?void 0:le.base_model)===((ue=B??o)==null?void 0:ue.base_model)?{lora:le,error:null}:{lora:null,error:"LoRA incompatible with currently-selected model"}:{lora:null,error:"LoRA model is not installed"}},[Z,o]),z=u.useCallback(P=>{const B=N(P);if(!B.lora){l(B.error);return}e(Jx({...B.lora,weight:P.weight})),r()},[N,e,r,l]),{data:$}=gf(void 0),se=u.useCallback((P,B)=>{var O;if(!kd(P.control_model))return{controlnet:null,error:"Invalid ControlNet model"};const{image:H,control_model:V,control_weight:le,begin_step_percent:fe,end_step_percent:ue,control_mode:xe,resize_mode:W}=P,Me=$?uy.selectById($,`${V.base_model}/controlnet/${V.model_name}`):void 0;if(!Me)return{controlnet:null,error:"ControlNet model is not installed"};if(!((Me==null?void 0:Me.base_model)===((O=B??o)==null?void 0:O.base_model)))return{controlnet:null,error:"ControlNet incompatible with currently-selected model"};const Pe="none",Ve=Bn.none.default;return{controlnet:{type:"controlnet",isEnabled:!0,model:Me,weight:typeof le=="number"?le:yi.weight,beginStepPct:fe||yi.beginStepPct,endStepPct:ue||yi.endStepPct,controlMode:xe||yi.controlMode,resizeMode:W||yi.resizeMode,controlImage:(H==null?void 0:H.image_name)||null,processedControlImage:(H==null?void 0:H.image_name)||null,processorType:Pe,processorNode:Ve,shouldAutoConfig:!0,id:Or()},error:null}},[$,o]),he=u.useCallback(P=>{const B=se(P);if(!B.controlnet){l(B.error);return}e(oa(B.controlnet)),r()},[se,e,r,l]),{data:ke}=xf(void 0),Ce=u.useCallback((P,B)=>{var Ye;if(!kd(P.t2i_adapter_model))return{controlnet:null,error:"Invalid ControlNet model"};const{image:H,t2i_adapter_model:V,weight:le,begin_step_percent:fe,end_step_percent:ue,resize_mode:xe}=P,W=ke?dy.selectById(ke,`${V.base_model}/t2i_adapter/${V.model_name}`):void 0;if(!W)return{controlnet:null,error:"ControlNet model is not installed"};if(!((W==null?void 0:W.base_model)===((Ye=B??o)==null?void 0:Ye.base_model)))return{t2iAdapter:null,error:"ControlNet incompatible with currently-selected model"};const ye="none",Pe=Bn.none.default;return{t2iAdapter:{type:"t2i_adapter",isEnabled:!0,model:W,weight:typeof le=="number"?le:Tu.weight,beginStepPct:fe||Tu.beginStepPct,endStepPct:ue||Tu.endStepPct,resizeMode:xe||Tu.resizeMode,controlImage:(H==null?void 0:H.image_name)||null,processedControlImage:(H==null?void 0:H.image_name)||null,processorType:ye,processorNode:Pe,shouldAutoConfig:!0,id:Or()},error:null}},[o,ke]),ge=u.useCallback(P=>{const B=Ce(P);if(!B.t2iAdapter){l(B.error);return}e(oa(B.t2iAdapter)),r()},[Ce,e,r,l]),{data:De}=vf(void 0),Se=u.useCallback((P,B)=>{var ye;if(!I6(P==null?void 0:P.ip_adapter_model))return{ipAdapter:null,error:"Invalid IP Adapter model"};const{image:H,ip_adapter_model:V,weight:le,begin_step_percent:fe,end_step_percent:ue}=P,xe=De?fy.selectById(De,`${V.base_model}/ip_adapter/${V.model_name}`):void 0;return xe?(xe==null?void 0:xe.base_model)===((ye=B??o)==null?void 0:ye.base_model)?{ipAdapter:{id:Or(),type:"ip_adapter",isEnabled:!0,controlImage:(H==null?void 0:H.image_name)??null,model:xe,weight:le??Mh.weight,beginStepPct:fe??Mh.beginStepPct,endStepPct:ue??Mh.endStepPct},error:null}:{ipAdapter:null,error:"IP Adapter incompatible with currently-selected model"}:{ipAdapter:null,error:"IP Adapter model is not installed"}},[De,o]),oe=u.useCallback(P=>{const B=Se(P);if(!B.ipAdapter){l(B.error);return}e(oa(B.ipAdapter)),r()},[Se,e,r,l]),re=u.useCallback(P=>{e(Cf(P))},[e]),de=u.useCallback(P=>{if(!P){d();return}const{cfg_scale:B,cfg_rescale_multiplier:H,height:V,model:le,positive_prompt:fe,negative_prompt:ue,scheduler:xe,vae:W,seed:Me,steps:ye,width:Pe,strength:Ve,hrf_enabled:Ye,hrf_strength:O,hrf_method:ne,positive_style_prompt:ce,negative_style_prompt:_e,refiner_model:be,refiner_cfg_scale:K,refiner_steps:ve,refiner_scheduler:Ee,refiner_positive_aesthetic_score:Ze,refiner_negative_aesthetic_score:lt,refiner_start:St,loras:Ot,controlnets:Xt,ipAdapters:Jt,t2iAdapters:xn}=P;let on;Kx(le)&&(on=le,e(xp(le))),bh(B)&&e(pp(B)),Qx(H)&&e(gp(H)),Eu(fe)&&e(ld(fe)),Du(ue)&&e(ad(ue)),ya(xe)&&e(vp(xe)),(Yx(W)||zn(W))&&(zn(W)?e(Ii(null)):e(Ii(W))),qx(Me)&&e(Sd(Me)),jh(ye)&&e(Cp(ye)),Sh(Pe)&&e(kh(Pe)),wh(V)&&e(Ih(V)),Lu(Ve)&&e(yp(Ve)),Xx(Ye)&&e(bp(Ye)),Lu(O)&&e(jp(O)),Sp(ne)&&e(kp(ne)),Ci(ce)&&e(id(ce)),yh(_e)&&e(cd(_e)),M6(be)&&e(wp(be)),jh(ve)&&e(my(ve)),bh(K)&&e(hy(K)),ya(Ee)&&e(py(Ee)),_6(Ze)&&e(gy(Ze)),A6(lt)&&e(xy(lt)),P6(St)&&e(vy(St)),e(E6()),Ot==null||Ot.forEach(en=>{const Tt=N(en,on);Tt.lora&&e(Jx({...Tt.lora,weight:en.weight}))}),e(Cy()),Xt==null||Xt.forEach(en=>{const Tt=se(en,on);Tt.controlnet&&e(oa(Tt.controlnet))}),Jt==null||Jt.forEach(en=>{const Tt=Se(en,on);Tt.ipAdapter&&e(oa(Tt.ipAdapter))}),xn==null||xn.forEach(en=>{const Tt=Ce(en,on);Tt.t2iAdapter&&e(oa(Tt.t2iAdapter))}),c()},[e,c,d,N,se,Se,Ce]);return{recallBothPrompts:f,recallPositivePrompt:m,recallNegativePrompt:g,recallSDXLPositiveStylePrompt:p,recallSDXLNegativeStylePrompt:x,recallSeed:y,recallCfgScale:S,recallCfgRescaleMultiplier:b,recallModel:I,recallScheduler:M,recallVaeModel:w,recallSteps:_,recallWidth:T,recallHeight:D,recallWidthAndHeight:A,recallStrength:F,recallHrfEnabled:Q,recallHrfStrength:q,recallHrfMethod:G,recallLoRA:z,recallControlNet:he,recallIPAdapter:oe,recallT2IAdapter:ge,recallAllParameters:de,sendToImageToImage:re}},TS=({onSuccess:e,onError:t})=>{const n=J(),o=ao(),{t:r}=R(),[l,c]=D6();return{getAndLoadEmbeddedWorkflow:u.useCallback(async f=>{try{const m=await l(f);n(M0({workflow:m.data,asCopy:!0})),e&&e()}catch{o({title:r("toast.problemRetrievingWorkflow"),status:"error"}),t&&t()}},[l,n,e,o,r,t]),getAndLoadEmbeddedWorkflowResult:c}};function rT(e,t,n){var o=this,r=u.useRef(null),l=u.useRef(0),c=u.useRef(null),d=u.useRef([]),f=u.useRef(),m=u.useRef(),g=u.useRef(e),p=u.useRef(!0);g.current=e;var x=typeof window<"u",y=!t&&t!==0&&x;if(typeof e!="function")throw new TypeError("Expected a function");t=+t||0;var S=!!(n=n||{}).leading,b=!("trailing"in n)||!!n.trailing,I="maxWait"in n,M="debounceOnServer"in n&&!!n.debounceOnServer,w=I?Math.max(+n.maxWait||0,t):null;u.useEffect(function(){return p.current=!0,function(){p.current=!1}},[]);var _=u.useMemo(function(){var T=function(G){var Z=d.current,N=f.current;return d.current=f.current=null,l.current=G,m.current=g.current.apply(N,Z)},D=function(G,Z){y&&cancelAnimationFrame(c.current),c.current=y?requestAnimationFrame(G):setTimeout(G,Z)},A=function(G){if(!p.current)return!1;var Z=G-r.current;return!r.current||Z>=t||Z<0||I&&G-l.current>=w},F=function(G){return c.current=null,b&&d.current?T(G):(d.current=f.current=null,m.current)},Q=function G(){var Z=Date.now();if(A(Z))return F(Z);if(p.current){var N=t-(Z-r.current),z=I?Math.min(N,w-(Z-l.current)):N;D(G,z)}},q=function(){if(x||M){var G=Date.now(),Z=A(G);if(d.current=[].slice.call(arguments),f.current=o,r.current=G,Z){if(!c.current&&p.current)return l.current=r.current,D(Q,t),S?T(r.current):m.current;if(I)return D(Q,t),T(r.current)}return c.current||D(Q,t),m.current}};return q.cancel=function(){c.current&&(y?cancelAnimationFrame(c.current):clearTimeout(c.current)),l.current=0,d.current=r.current=f.current=c.current=null},q.isPending=function(){return!!c.current},q.flush=function(){return c.current?F(Date.now()):m.current},q},[S,I,t,w,b,y,x,M]);return _}function lT(e,t){return e===t}function aT(e,t){return t}function Eg(e,t,n){var o=n&&n.equalityFn||lT,r=u.useReducer(aT,e),l=r[0],c=r[1],d=rT(u.useCallback(function(m){return c(m)},[c]),t,n),f=u.useRef(e);return o(f.current,e)||(d(e),f.current=e),[l,d]}const Dg=e=>{const t=j(l=>l.config.metadataFetchDebounce??300),[n]=Eg(e,t),{data:o,isLoading:r}=yy(n??ss);return{metadata:o,isLoading:r}},iT=e=>{const{imageDTO:t}=e,n=j(ls),o=J(),{t:r}=R(),l=ao(),c=Kt("unifiedCanvas").isFeatureEnabled,d=gt(w0),{downloadImage:f}=nT(),{metadata:m,isLoading:g}=Dg(t==null?void 0:t.image_name),{getAndLoadEmbeddedWorkflow:p,getAndLoadEmbeddedWorkflowResult:x}=TS({}),y=u.useCallback(()=>{p(t.image_name)},[p,t.image_name]),[S]=S0(),[b]=k0(),{isClipboardAPIAvailable:I,copyImageToClipboard:M}=DS(),w=u.useCallback(()=>{t&&o(pf([t]))},[o,t]),{recallBothPrompts:_,recallSeed:T,recallAllParameters:D}=_c(),A=u.useCallback(()=>{_(m==null?void 0:m.positive_prompt,m==null?void 0:m.negative_prompt,m==null?void 0:m.positive_style_prompt,m==null?void 0:m.negative_style_prompt)},[m==null?void 0:m.negative_prompt,m==null?void 0:m.positive_prompt,m==null?void 0:m.positive_style_prompt,m==null?void 0:m.negative_style_prompt,_]),F=u.useCallback(()=>{T(m==null?void 0:m.seed)},[m==null?void 0:m.seed,T]),Q=u.useCallback(()=>{o(LS()),o(Cf(t))},[o,t]),q=u.useCallback(()=>{o(sT()),_0.flushSync(()=>{o(jo("unifiedCanvas"))}),o(by(t,n)),l({title:r("toast.sentToUnifiedCanvas"),status:"success",duration:2500,isClosable:!0})},[o,t,r,l,n]),G=u.useCallback(()=>{D(m)},[m,D]),Z=u.useCallback(()=>{D({...m,seed:void 0})},[m,D]),N=u.useCallback(()=>{o(ay([t])),o(g0(!0))},[o,t]),z=u.useCallback(()=>{M(t.image_url)},[M,t.image_url]),$=u.useCallback(()=>{t&&S({imageDTOs:[t]})},[S,t]),se=u.useCallback(()=>{t&&b({imageDTOs:[t]})},[b,t]),he=u.useCallback(()=>{f(t.image_url,t.image_name)},[f,t.image_name,t.image_url]);return s.jsxs(s.Fragment,{children:[s.jsx(it,{as:"a",href:t.image_url,target:"_blank",icon:s.jsx(Oh,{}),children:r("common.openInNewTab")}),I&&s.jsx(it,{icon:s.jsx(el,{}),onClickCapture:z,children:r("parameters.copyImage")}),s.jsx(it,{icon:s.jsx(Cc,{}),onClickCapture:he,children:r("parameters.downloadImage")}),s.jsx(Er,{}),s.jsx(it,{icon:x.isLoading?s.jsx(Si,{}):s.jsx(If,{}),onClickCapture:y,isDisabled:!t.has_workflow,children:r("nodes.loadWorkflow")}),s.jsx(it,{icon:g?s.jsx(Si,{}):s.jsx(Z0,{}),onClickCapture:Z,isDisabled:g||(m==null?void 0:m.positive_prompt)===void 0&&(m==null?void 0:m.negative_prompt)===void 0,children:r("parameters.remixImage")}),s.jsx(it,{icon:g?s.jsx(Si,{}):s.jsx(ej,{}),onClickCapture:A,isDisabled:g||(m==null?void 0:m.positive_prompt)===void 0&&(m==null?void 0:m.negative_prompt)===void 0,children:r("parameters.usePrompt")}),s.jsx(it,{icon:g?s.jsx(Si,{}):s.jsx(Jb,{}),onClickCapture:F,isDisabled:g||(m==null?void 0:m.seed)===void 0,children:r("parameters.useSeed")}),s.jsx(it,{icon:g?s.jsx(Si,{}):s.jsx(Gb,{}),onClickCapture:G,isDisabled:g||!m,children:r("parameters.useAll")}),s.jsx(Er,{}),s.jsx(it,{icon:s.jsx(Oh,{}),onClickCapture:Q,id:"send-to-img2img",children:r("parameters.sendToImg2Img")}),c&&s.jsx(it,{icon:s.jsx(Oh,{}),onClickCapture:q,id:"send-to-canvas",children:r("parameters.sendToUnifiedCanvas")}),s.jsx(Er,{}),s.jsx(it,{icon:s.jsx(Yb,{}),onClickCapture:N,children:r("boards.changeBoard")}),t.starred?s.jsx(it,{icon:d?d.off.icon:s.jsx(J0,{}),onClickCapture:se,children:d?d.off.text:r("gallery.unstarImage")}):s.jsx(it,{icon:d?d.on.icon:s.jsx(K0,{}),onClickCapture:$,children:d?d.on.text:r("gallery.starImage")}),s.jsx(Er,{}),s.jsx(it,{color:"error.300",icon:s.jsx(Vs,{}),onClickCapture:w,children:r("gallery.deleteImage")})]})},RS=u.memo(iT),Si=()=>s.jsx(L,{w:"14px",alignItems:"center",justifyContent:"center",children:s.jsx(Kr,{size:"xs"})}),cT=({imageDTO:e,children:t})=>{const n=j(r=>r.gallery.selection.length),o=u.useCallback(()=>e?n>1?s.jsx(zr,{visibility:"visible",children:s.jsx(tT,{})}):s.jsx(zr,{visibility:"visible",children:s.jsx(RS,{imageDTO:e})}):null,[e,n]);return s.jsx(j0,{renderMenu:o,children:t})},uT=u.memo(cT),dT=e=>{const{data:t,disabled:n,...o}=e,r=u.useRef(Or()),{attributes:l,listeners:c,setNodeRef:d}=HE({id:r.current,disabled:n,data:t});return s.jsx(We,{ref:d,position:"absolute",w:"full",h:"full",top:0,insetInlineStart:0,...l,...c,...o})},fT=u.memo(dT),mT=s.jsx(Vn,{as:_f,boxSize:16}),hT=s.jsx(Yt,{icon:Qi}),pT=e=>{const{imageDTO:t,onError:n,onClick:o,withMetadataOverlay:r=!1,isDropDisabled:l=!1,isDragDisabled:c=!1,isUploadDisabled:d=!1,minSize:f=24,postUploadAction:m,imageSx:g,fitContainer:p=!1,droppableData:x,draggableData:y,dropLabel:S,isSelected:b=!1,thumbnail:I=!1,noContentFallback:M=hT,uploadElement:w=mT,useThumbailFallback:_,withHoverOverlay:T=!1,children:D,onMouseOver:A,onMouseOut:F,dataTestId:Q}=e,[q,G]=u.useState(!1),Z=u.useCallback(he=>{A&&A(he),G(!0)},[A]),N=u.useCallback(he=>{F&&F(he),G(!1)},[F]),{getUploadButtonProps:z,getUploadInputProps:$}=Pg({postUploadAction:m,isDisabled:d}),se=u.useMemo(()=>{const he={minH:f,w:"full",h:"full",alignItems:"center",justifyContent:"center",borderRadius:"base",transitionProperty:"common",transitionDuration:"0.1s",color:"base.500"};return d||Object.assign(he,{cursor:"pointer",bg:"base.700",_hover:{bg:"base.650",color:"base.300"}}),he},[d,f]);return s.jsx(uT,{imageDTO:t,children:he=>s.jsxs(L,{ref:he,onMouseOver:Z,onMouseOut:N,width:"full",height:"full",alignItems:"center",justifyContent:"center",position:"relative",minW:f||void 0,minH:f||void 0,userSelect:"none",cursor:c||!t?"default":"pointer",children:[t&&s.jsxs(L,{w:"full",h:"full",position:p?"absolute":"relative",alignItems:"center",justifyContent:"center",children:[s.jsx(ur,{src:I?t.thumbnail_url:t.image_url,fallbackStrategy:"beforeLoadOrError",fallbackSrc:_?t.thumbnail_url:void 0,fallback:_?void 0:s.jsx(rj,{image:t}),onError:n,draggable:!1,w:t.width,objectFit:"contain",maxW:"full",maxH:"full",borderRadius:"base",sx:g,"data-testid":Q}),r&&s.jsx(JL,{imageDTO:t}),s.jsx(vg,{isSelected:b,isHovered:T?q:!1})]}),!t&&!d&&s.jsx(s.Fragment,{children:s.jsxs(L,{sx:se,...z(),children:[s.jsx("input",{...$()}),w]})}),!t&&d&&M,t&&!c&&s.jsx(fT,{data:y,disabled:c||!t,onClick:o}),D,!l&&s.jsx(xg,{data:x,disabled:l,dropLabel:S})]})})},Wr=u.memo(pT),gT=e=>{const{onClick:t,tooltip:n,icon:o,styleOverrides:r}=e,l=u.useMemo(()=>({position:"absolute",top:1,insetInlineEnd:1,p:0,minW:0,svg:{transitionProperty:"common",transitionDuration:"normal",fill:"base.100",_hover:{fill:"base.50"},filter:"drop-shadow(0px 0px 0.1rem var(--invoke-colors-base-800))"},...r}),[r]);return s.jsx(je,{onClick:t,"aria-label":n,tooltip:n,icon:o,size:"sm",variant:"link",sx:l,"data-testid":n})},Ia=u.memo(gT),xT={position:"relative",height:"full",width:"full","::before":{content:"''",display:"block",pt:"100%"}},vT=()=>s.jsx(C0,{sx:xT,children:s.jsx(We,{position:"absolute",top:0,insetInlineStart:0,height:"full",width:"full"})}),CT=u.memo(vT),yT=e=>{const t=J(),n=j(d=>d.gallery.selection.length>1),o=u.useMemo(()=>ft(uc,d=>d.selection.some(f=>f.image_name===(e==null?void 0:e.image_name))),[e==null?void 0:e.image_name]),r=j(o),l=Kt("multiselect").isFeatureEnabled,c=u.useCallback(d=>{if(e){if(!l){t(L6([e]));return}t(T6({imageDTO:e,shiftKey:d.shiftKey,ctrlKey:d.ctrlKey,metaKey:d.metaKey}))}},[t,e,l]);return{areMultiplesSelected:n,isSelected:r,handleClick:c}},bT=(e,t,n)=>{const o=u.useRef(null);return u.useEffect(()=>{var g,p,x,y;if(!e||n)return;const r=Ud.get(),l=(g=r.virtuosoRangeRef)==null?void 0:g.current,c=(p=r.rootRef)==null?void 0:p.current,d=(x=r.virtuosoRef)==null?void 0:x.current;if(!l||!d||!c)return;const f=(y=o.current)==null?void 0:y.getBoundingClientRect(),m=c.getBoundingClientRect();(!f||!Yj(f,m))&&d.scrollToIndex({index:t,align:Xj(t,l)})},[e,t,n]),o},jT={w:"full",h:"full"},ST={bottom:2,top:"auto"},kT=e=>{const t=J(),{imageName:n}=e,{currentData:o}=zs(n),r=A0(),{t:l}=R(),c=j(Q=>Q.gallery.selectedBoardId),{handleClick:d,isSelected:f,areMultiplesSelected:m}=yT(o),g=gt(w0),p=bT(f,e.index,m),x=u.useCallback(Q=>{Q.stopPropagation(),o&&t(pf([o]))},[t,o]),y=u.useMemo(()=>{if(m)return{id:"gallery-image",payloadType:"GALLERY_SELECTION",payload:{boardId:c}};if(o)return{id:"gallery-image",payloadType:"IMAGE_DTO",payload:{imageDTO:o}}},[o,c,m]),[S]=S0(),[b]=k0(),I=u.useCallback(()=>{o&&(o.starred&&b({imageDTOs:[o]}),o.starred||S({imageDTOs:[o]}))},[S,b,o]),[M,w]=u.useState(!1),_=u.useCallback(()=>{w(!0)},[]),T=u.useCallback(()=>{w(!1)},[]),D=u.useMemo(()=>{if(o!=null&&o.starred)return g?g.on.icon:s.jsx(J0,{size:"20"});if(!(o!=null&&o.starred)&&M)return g?g.off.icon:s.jsx(K0,{size:"20"})},[o==null?void 0:o.starred,M,g]),A=u.useMemo(()=>o!=null&&o.starred?g?g.off.text:"Unstar":o!=null&&o.starred?"":g?g.on.text:"Star",[o==null?void 0:o.starred,g]),F=u.useMemo(()=>qj(o==null?void 0:o.image_name),[o==null?void 0:o.image_name]);return o?s.jsx(We,{w:"full",h:"full",className:"gallerygrid-image","data-testid":F,children:s.jsx(L,{ref:p,userSelect:"none",position:"relative",justifyContent:"center",alignItems:"center",aspectRatio:"1/1",children:s.jsx(Wr,{onClick:d,imageDTO:o,draggableData:y,isSelected:f,minSize:0,imageSx:jT,isDropDisabled:!0,isUploadDisabled:!0,thumbnail:!0,withHoverOverlay:!0,onMouseOver:_,onMouseOut:T,children:s.jsxs(s.Fragment,{children:[s.jsx(Ia,{onClick:I,icon:D,tooltip:A}),M&&r&&s.jsx(Ia,{onClick:x,icon:s.jsx(bc,{size:"16px"}),tooltip:l("gallery.deleteImage"),styleOverrides:ST})]})})})}):s.jsx(CT,{})},wT=u.memo(kT),IT={Item:mD,List:pD},MT={height:"100%"},_T=()=>{const{t:e}=R(),t=u.useRef(null),[n,o]=u.useState(null),[r,l]=pg(kc),c=j(w=>w.gallery.selectedBoardId),{currentViewTotal:d}=YL(c),f=u.useRef(null),m=u.useRef(null),{areMoreImagesAvailable:g,handleLoadMoreImages:p,queryResult:{currentData:x,isFetching:y,isSuccess:S,isError:b}}=Ff();jD();const I=u.useCallback((w,_)=>s.jsx(wT,{index:w,imageName:_},_),[]);u.useEffect(()=>{const{current:w}=t;return n&&w&&r({target:w,elements:{viewport:n}}),()=>{var _;return(_=l())==null?void 0:_.destroy()}},[n,r,l]);const M=u.useCallback(w=>{f.current=w},[]);return u.useEffect(()=>(Ud.set({rootRef:t,virtuosoRangeRef:f,virtuosoRef:m}),()=>{Ud.set({})}),[]),x?S&&(x==null?void 0:x.ids.length)===0?s.jsx(L,{w:"full",h:"full",alignItems:"center",justifyContent:"center",children:s.jsx(Yt,{label:e("gallery.noImagesInGallery"),icon:Qi})}):S&&x?s.jsxs(s.Fragment,{children:[s.jsx(We,{ref:t,"data-overlayscrollbars":"",h:"100%",id:"gallery-grid",children:s.jsx(KL,{style:MT,data:x.ids,endReached:p,components:IT,scrollerRef:o,itemContent:I,ref:m,rangeChanged:M,overscan:10})}),s.jsx(Ge,{onClick:p,isDisabled:!g,isLoading:y,loadingText:e("gallery.loading"),flexShrink:0,children:`${e("accessibility.loadMore")} (${x.ids.length} / ${d})`})]}):b?s.jsx(We,{w:"full",h:"full",children:s.jsx(Yt,{label:e("gallery.unableToLoad"),icon:nj})}):null:s.jsx(L,{w:"full",h:"full",alignItems:"center",justifyContent:"center",children:s.jsx(Yt,{label:e("gallery.loading"),icon:Qi})})},AT=u.memo(_T),PT=()=>{const{t:e}=R(),t=u.useRef(null),n=u.useRef(null),o=j(g=>g.gallery.galleryView),r=J(),l=gt(B6),{isOpen:c,onToggle:d}=an({defaultIsOpen:!0}),f=u.useCallback(()=>{r(e2("images"))},[r]),m=u.useCallback(()=>{r(e2("assets"))},[r]);return s.jsxs(R6,{layerStyle:"first",flexDirection:"column",h:"full",w:"full",borderRadius:"base",p:2,children:[l,s.jsxs(We,{w:"full",children:[s.jsxs(L,{ref:t,alignItems:"center",justifyContent:"space-between",gap:2,children:[s.jsx(lD,{isOpen:c,onToggle:d}),s.jsx(dD,{})]}),s.jsx(We,{children:s.jsx(oD,{isOpen:c})})]}),s.jsxs(L,{ref:n,direction:"column",gap:2,h:"full",w:"full",children:[s.jsx(L,{alignItems:"center",justifyContent:"space-between",gap:2,children:s.jsx(Xr,{index:o==="images"?0:1,variant:"unstyled",size:"sm",w:"full",children:s.jsx(Jr,{children:s.jsxs(wt,{w:"full",children:[s.jsx(hn,{as:Ge,size:"sm",isChecked:o==="images",onClick:f,w:"full",leftIcon:s.jsx(L7,{size:"16px"}),"data-testid":"images-tab",children:e("parameters.images")}),s.jsx(hn,{as:Ge,size:"sm",isChecked:o==="assets",onClick:m,w:"full",leftIcon:s.jsx(ME,{size:"16px"}),"data-testid":"assets-tab",children:e("gallery.assets")})]})})})}),s.jsx(AT,{})]})]})},ET=u.memo(PT),DT=({disclosure:e})=>{const{t}=R(),{clearQueue:n}=xc();return s.jsxs(Gr,{isOpen:e.isOpen,onClose:e.onClose,title:t("queue.clearTooltip"),acceptCallback:n,acceptButtonText:t("queue.clear"),children:[s.jsx(pe,{children:t("queue.clearQueueAlertDialog")}),s.jsx("br",{}),s.jsx(pe,{children:t("queue.clearQueueAlertDialog2")})]})},Uf=u.memo(DT),BS=({onOpen:e,...t})=>{const{t:n}=R(),{isLoading:o,isDisabled:r}=xc();return s.jsx(je,{isDisabled:r,isLoading:o,"aria-label":n("queue.clear"),tooltip:n("queue.clearTooltip"),icon:s.jsx(Vs,{size:"16px"}),colorScheme:"error",onClick:e,"data-testid":n("queue.clear"),...t})},LT=e=>{const{t}=R(),{cancelQueueItem:n,isLoading:o,isDisabled:r}=V0();return s.jsx(je,{isDisabled:r,isLoading:o,"aria-label":t("queue.cancel"),tooltip:t("queue.cancelTooltip"),icon:s.jsx(oo,{size:"16px"}),colorScheme:"error",onClick:n,"data-testid":t("queue.cancel"),...e})},TT=e=>{const t=A0(),n=an();return s.jsxs(s.Fragment,{children:[t?s.jsx(BS,{...e,onOpen:n.onOpen}):s.jsx(LT,{...e}),s.jsx(Uf,{disclosure:n})]})};function RT(e){return Ie({tag:"svg",attr:{viewBox:"0 0 1024 1024"},child:[{tag:"path",attr:{d:"M848 359.3H627.7L825.8 109c4.1-5.3.4-13-6.3-13H436c-2.8 0-5.5 1.5-6.9 4L170 547.5c-3.1 5.3.7 12 6.9 12h174.4l-89.4 357.6c-1.9 7.8 7.5 13.3 13.3 7.7L853.5 373c5.2-4.9 1.7-13.7-5.5-13.7z"},child:[]}]})(e)}const BT=ft(Ss,h0,(e,t)=>KC(e.positivePrompt)?t.prompts.length:1),Gf=u.memo(({prepend:e=!1})=>{const{t}=R(),{isReady:n,reasons:o}=W0(),r=j(x=>x.dynamicPrompts.isLoading),l=j(BT),c=j(x=>x.generation.iterations),d=j(x=>x.gallery.autoAddBoardId),f=Nf(d),[m,{isLoading:g}]=rf({fixedCacheKey:"enqueueBatch"}),p=u.useMemo(()=>t(g?"queue.enqueueing":r?"dynamicPrompts.loading":n?e?"queue.queueFront":"queue.queueBack":"queue.notReady"),[g,r,n,e,t]);return s.jsxs(L,{flexDir:"column",gap:1,children:[s.jsx(pe,{fontWeight:"semibold",children:p}),s.jsx(pe,{children:t("queue.queueCountPrediction",{promptsCount:l,iterations:c,count:Math.min(l*c,1e4)})}),o.length>0&&s.jsxs(s.Fragment,{children:[s.jsx(Sn,{opacity:.2,borderColor:"base.900"}),s.jsx(x0,{children:o.map((x,y)=>s.jsx(wo,{children:s.jsx(pe,{children:x})},`${x}.${y}`))})]}),s.jsx(Sn,{opacity:.2,borderColor:"base.900"}),s.jsxs(pe,{fontStyle:"oblique 10deg",children:[t("parameters.invoke.addingImagesTo")," ",s.jsx(pe,{as:"span",fontWeight:"semibold",children:f||t("boards.uncategorized")})]})]})});Gf.displayName="QueueButtonTooltip";const OT=()=>{const{t:e}=R(),{queueFront:t,isLoading:n,isDisabled:o}=zb();return s.jsx(je,{"aria-label":e("queue.queueFront"),isDisabled:o,isLoading:n,onClick:t,tooltip:s.jsx(Gf,{prepend:!0}),icon:s.jsx(RT,{}),size:"lg"})},NT=u.memo(OT),FT=ft(Na,e=>{var t;return(((t=e.denoiseProgress)==null?void 0:t.percentage)??0)*100}),zT=()=>{const{t:e}=R(),{data:t}=Ro(),n=j(l=>l.system.isConnected),o=j(l=>!!l.system.denoiseProgress),r=j(FT);return s.jsx(O6,{value:r,"aria-label":e("accessibility.invokeProgressBar"),isIndeterminate:n&&!!(t!=null&&t.queue.in_progress)&&!o,h:2,w:"full",colorScheme:"invokeBlue"})},HT=u.memo(zT),OS=u.memo(()=>{const e=j(l=>l.generation.iterations),t=j(l=>l.config.sd.iterations.coarseStep),n=j(l=>l.config.sd.iterations.fineStep),o=J(),r=u.useCallback(l=>{o(N6(l))},[o]);return s.jsx(zt,{feature:"paramIterations",children:s.jsx($e,{step:t,fineStep:n,min:1,max:999,onChange:r,value:e,defaultValue:1,pos:"absolute",insetInlineEnd:0,h:"full",ps:0,w:"72px",flexShrink:0,variant:"iterations"})})});OS.displayName="QueueIterationsNumberInput";const jv="Invoke",NS=u.memo(()=>{const{queueBack:e,isLoading:t,isDisabled:n}=U0(),o=j(r=>r.dynamicPrompts.isLoading);return s.jsxs(L,{pos:"relative",flexGrow:1,minW:"240px",children:[s.jsx(OS,{}),s.jsxs(Ge,{onClick:e,isLoading:t||o,loadingText:jv,isDisabled:n,rightIcon:s.jsx(TE,{}),tooltip:s.jsx(Gf,{}),variant:"solid",zIndex:1,colorScheme:"invokeYellow",size:"lg",w:"calc(100% - 60px)",flexShrink:0,justifyContent:"space-between",spinnerPlacement:"end",children:[s.jsx("span",{children:jv}),s.jsx(Cs,{})]})]})});NS.displayName="InvokeQueueBackButton";const FS=()=>{const e=J(),{t}=R(),n=j(m=>m.system.isConnected),{data:o}=Ro(),[r,{isLoading:l}]=jy({fixedCacheKey:"pauseProcessor"}),c=u.useMemo(()=>!!(o!=null&&o.processor.is_started),[o==null?void 0:o.processor.is_started]),d=u.useCallback(async()=>{if(c)try{await r().unwrap(),e(Qe({title:t("queue.pauseSucceeded"),status:"success"}))}catch{e(Qe({title:t("queue.pauseFailed"),status:"error"}))}},[c,r,e,t]),f=u.useMemo(()=>!n||!c,[n,c]);return{pauseProcessor:d,isLoading:l,isStarted:c,isDisabled:f}},zS=()=>{const e=J(),t=j(m=>m.system.isConnected),{data:n}=Ro(),{t:o}=R(),[r,{isLoading:l}]=Sy({fixedCacheKey:"resumeProcessor"}),c=u.useMemo(()=>!!(n!=null&&n.processor.is_started),[n==null?void 0:n.processor.is_started]),d=u.useCallback(async()=>{if(!c)try{await r().unwrap(),e(Qe({title:o("queue.resumeSucceeded"),status:"success"}))}catch{e(Qe({title:o("queue.resumeFailed"),status:"error"}))}},[c,r,e,o]),f=u.useMemo(()=>!t||c,[t,c]);return{resumeProcessor:d,isLoading:l,isStarted:c,isDisabled:f}},HS=u.memo(()=>{const{isOpen:e,onOpen:t,onClose:n}=an(),o=J(),{t:r}=R(),l=an(),c=Kt("pauseQueue").isFeatureEnabled,d=Kt("resumeQueue").isFeatureEnabled,{queueSize:f}=Ro(void 0,{selectFromResult:w=>({queueSize:w.data?w.data.queue.pending+w.data.queue.in_progress:0})}),{isLoading:m,isDisabled:g}=xc(),{resumeProcessor:p,isLoading:x,isDisabled:y}=zS(),{pauseProcessor:S,isLoading:b,isDisabled:I}=FS(),M=u.useCallback(()=>{o(jo("queue"))},[o]);return s.jsxs(We,{pos:"relative",children:[s.jsx(Uf,{disclosure:l}),s.jsxs(yf,{isOpen:e,onOpen:t,onClose:n,placement:"bottom-end",children:[s.jsx(bf,{as:je,"aria-label":"Queue Actions Menu",icon:s.jsx(_E,{})}),s.jsxs(zr,{children:[s.jsx(it,{isDestructive:!0,icon:s.jsx(Vs,{size:"16px"}),onClick:l.onOpen,isLoading:m,isDisabled:g,children:r("queue.clearTooltip")}),d&&s.jsx(it,{icon:s.jsx(oj,{size:"14px"}),onClick:p,isLoading:x,isDisabled:y,children:r("queue.resumeTooltip")}),c&&s.jsx(it,{icon:s.jsx(sj,{size:"14px"}),onClick:S,isLoading:b,isDisabled:I,children:r("queue.pauseTooltip")}),s.jsx(Er,{}),s.jsx(it,{icon:s.jsx(zj,{}),onClick:M,children:r("queue.openQueue")})]})]}),f>0&&s.jsx(Yr,{pos:"absolute",insetInlineStart:-3,insetBlockStart:-1.5,colorScheme:"invokeYellow",zIndex:"docked",children:f})]})});HS.displayName="QueueActionsMenuButton";const $T=()=>{const e=Kt("prependQueue").isFeatureEnabled;return s.jsxs(L,{w:"full",position:"relative",borderRadius:"base",gap:2,pt:2,flexDir:"column",children:[s.jsxs(wt,{size:"lg",isAttached:!1,children:[e&&s.jsx(NT,{}),s.jsx(NS,{}),s.jsx(Cs,{}),s.jsx(HS,{}),s.jsx(TT,{})]}),s.jsx(HT,{})]})},$S=u.memo($T),{createElement:Ta,createContext:VT,createRef:vK,forwardRef:VS,useCallback:Xn,useContext:WS,useEffect:Ml,useImperativeHandle:US,useLayoutEffect:WT,useMemo:UT,useRef:ms,useState:Kd}=ky,Sv=ky.useId,Zf=VT(null);Zf.displayName="PanelGroupContext";const oc=WT,GT=typeof Sv=="function"?Sv:()=>null;let ZT=0;function Lg(e=null){const t=GT(),n=ms(e||t||null);return n.current===null&&(n.current=""+ZT++),e??n.current}function GS({children:e,className:t="",collapsedSize:n,collapsible:o,defaultSize:r,forwardedRef:l,id:c,maxSize:d,minSize:f,onCollapse:m,onExpand:g,onResize:p,order:x,style:y,tagName:S="div",...b}){const I=WS(Zf);if(I===null)throw Error("Panel components must be rendered within a PanelGroup container");const{collapsePanel:M,expandPanel:w,getPanelSize:_,getPanelStyle:T,groupId:D,isPanelCollapsed:A,reevaluatePanelConstraints:F,registerPanel:Q,resizePanel:q,unregisterPanel:G}=I,Z=Lg(c),N=ms({callbacks:{onCollapse:m,onExpand:g,onResize:p},constraints:{collapsedSize:n,collapsible:o,defaultSize:r,maxSize:d,minSize:f},id:Z,idIsFromProps:c!==void 0,order:x});ms({didLogMissingDefaultSizeWarning:!1}),oc(()=>{const{callbacks:$,constraints:se}=N.current,he={...se};N.current.id=Z,N.current.idIsFromProps=c!==void 0,N.current.order=x,$.onCollapse=m,$.onExpand=g,$.onResize=p,se.collapsedSize=n,se.collapsible=o,se.defaultSize=r,se.maxSize=d,se.minSize=f,(he.collapsedSize!==se.collapsedSize||he.collapsible!==se.collapsible||he.maxSize!==se.maxSize||he.minSize!==se.minSize)&&F(N.current,he)}),oc(()=>{const $=N.current;return Q($),()=>{G($)}},[x,Z,Q,G]),US(l,()=>({collapse:()=>{M(N.current)},expand:()=>{w(N.current)},getId(){return Z},getSize(){return _(N.current)},isCollapsed(){return A(N.current)},isExpanded(){return!A(N.current)},resize:$=>{q(N.current,$)}}),[M,w,_,A,Z,q]);const z=T(N.current,r);return Ta(S,{...b,children:e,className:t,style:{...z,...y},"data-panel":"","data-panel-id":Z,"data-panel-group-id":D,"data-panel-collapsible":void 0,"data-panel-size":void 0})}const Fr=VS((e,t)=>Ta(GS,{...e,forwardedRef:t}));GS.displayName="Panel";Fr.displayName="forwardRef(Panel)";function rt(e,t="Assertion failed!"){if(!e)throw console.error(t),Error(t)}const ZS=10;function rc(e,t,n=ZS){e=parseFloat(e.toFixed(n)),t=parseFloat(t.toFixed(n));const o=e-t;return o===0?0:o>0?1:-1}function fs(e,t,n){return rc(e,t,n)===0}function ha({panelConstraints:e,panelIndex:t,size:n}){const o=e[t];rt(o!=null);let{collapsedSize:r=0,collapsible:l,maxSize:c=100,minSize:d=0}=o;if(rc(n,d)<0)if(l){const f=(r+d)/2;rc(n,f)<0?n=r:n=d}else n=d;return n=Math.min(c,n),n=parseFloat(n.toFixed(ZS)),n}function Li({delta:e,layout:t,panelConstraints:n,pivotIndices:o,trigger:r}){if(fs(e,0))return t;const l=[...t],[c,d]=o;rt(c!=null),rt(d!=null);let f=0;if(r==="keyboard"){{const g=e<0?d:c,p=n[g];if(rt(p),p.collapsible){const x=t[g];rt(x!=null);const y=n[g];rt(y);const{collapsedSize:S=0,minSize:b=0}=y;if(fs(x,S)){const I=b-x;rc(I,Math.abs(e))>0&&(e=e<0?0-I:I)}}}{const g=e<0?c:d,p=n[g];rt(p);const{collapsible:x}=p;if(x){const y=t[g];rt(y!=null);const S=n[g];rt(S);const{collapsedSize:b=0,minSize:I=0}=S;if(fs(y,I)){const M=y-b;rc(M,Math.abs(e))>0&&(e=e<0?0-M:M)}}}}{const g=e<0?1:-1;let p=e<0?d:c,x=0;for(;;){const S=t[p];rt(S!=null);const I=ha({panelConstraints:n,panelIndex:p,size:100})-S;if(x+=I,p+=g,p<0||p>=n.length)break}const y=Math.min(Math.abs(e),Math.abs(x));e=e<0?0-y:y}{let p=e<0?c:d;for(;p>=0&&p<n.length;){const x=Math.abs(e)-Math.abs(f),y=t[p];rt(y!=null);const S=y-x,b=ha({panelConstraints:n,panelIndex:p,size:S});if(!fs(y,b)&&(f+=y-b,l[p]=b,f.toPrecision(3).localeCompare(Math.abs(e).toPrecision(3),void 0,{numeric:!0})>=0))break;e<0?p--:p++}}if(fs(f,0))return t;{const g=e<0?d:c,p=t[g];rt(p!=null);const x=p+f,y=ha({panelConstraints:n,panelIndex:g,size:x});if(l[g]=y,!fs(y,x)){let S=x-y,I=e<0?d:c;for(;I>=0&&I<n.length;){const M=l[I];rt(M!=null);const w=M+S,_=ha({panelConstraints:n,panelIndex:I,size:w});if(fs(M,_)||(S-=_-M,l[I]=_),fs(S,0))break;e>0?I--:I++}}}const m=l.reduce((g,p)=>p+g,0);return fs(m,100)?l:t}function qT({layout:e,panelsArray:t,pivotIndices:n}){let o=0,r=100,l=0,c=0;const d=n[0];rt(d!=null),t.forEach((p,x)=>{const{constraints:y}=p,{maxSize:S=100,minSize:b=0}=y;x===d?(o=b,r=S):(l+=b,c+=S)});const f=Math.min(r,100-l),m=Math.max(o,100-c),g=e[d];return{valueMax:f,valueMin:m,valueNow:g}}function Dl(e,t=document){return Array.from(t.querySelectorAll(`[data-panel-resize-handle-id][data-panel-group-id="${e}"]`))}function qS(e,t,n=document){const r=Dl(e,n).findIndex(l=>l.getAttribute("data-panel-resize-handle-id")===t);return r??null}function QS(e,t,n){const o=qS(e,t,n);return o!=null?[o,o+1]:[-1,-1]}function qf(e,t=document){var n;if(t instanceof HTMLElement&&(t==null||(n=t.dataset)===null||n===void 0?void 0:n.panelGroupId)==e)return t;const o=t.querySelector(`[data-panel-group][data-panel-group-id="${e}"]`);return o||null}function Qf(e,t=document){const n=t.querySelector(`[data-panel-resize-handle-id="${e}"]`);return n||null}function QT(e,t,n,o=document){var r,l,c,d;const f=Qf(t,o),m=Dl(e,o),g=f?m.indexOf(f):-1,p=(r=(l=n[g])===null||l===void 0?void 0:l.id)!==null&&r!==void 0?r:null,x=(c=(d=n[g+1])===null||d===void 0?void 0:d.id)!==null&&c!==void 0?c:null;return[p,x]}function KT({committedValuesRef:e,eagerValuesRef:t,groupId:n,layout:o,panelDataArray:r,panelGroupElement:l,setLayout:c}){ms({didWarnAboutMissingResizeHandle:!1}),oc(()=>{if(!l)return;const d=Dl(n,l);for(let f=0;f<r.length-1;f++){const{valueMax:m,valueMin:g,valueNow:p}=qT({layout:o,panelsArray:r,pivotIndices:[f,f+1]}),x=d[f];if(x!=null){const y=r[f];rt(y),x.setAttribute("aria-controls",y.id),x.setAttribute("aria-valuemax",""+Math.round(m)),x.setAttribute("aria-valuemin",""+Math.round(g)),x.setAttribute("aria-valuenow",p!=null?""+Math.round(p):"")}}return()=>{d.forEach((f,m)=>{f.removeAttribute("aria-controls"),f.removeAttribute("aria-valuemax"),f.removeAttribute("aria-valuemin"),f.removeAttribute("aria-valuenow")})}},[n,o,r,l]),Ml(()=>{if(!l)return;const d=t.current;rt(d);const{panelDataArray:f}=d,m=qf(n,l);rt(m!=null,`No group found for id "${n}"`);const g=Dl(n,l);rt(g);const p=g.map(x=>{const y=x.getAttribute("data-panel-resize-handle-id");rt(y);const[S,b]=QT(n,y,f,l);if(S==null||b==null)return()=>{};const I=M=>{if(!M.defaultPrevented)switch(M.key){case"Enter":{M.preventDefault();const w=f.findIndex(_=>_.id===S);if(w>=0){const _=f[w];rt(_);const T=o[w],{collapsedSize:D=0,collapsible:A,minSize:F=0}=_.constraints;if(T!=null&&A){const Q=Li({delta:fs(T,D)?F-D:D-T,layout:o,panelConstraints:f.map(q=>q.constraints),pivotIndices:QS(n,y,l),trigger:"keyboard"});o!==Q&&c(Q)}}break}}};return x.addEventListener("keydown",I),()=>{x.removeEventListener("keydown",I)}});return()=>{p.forEach(x=>x())}},[l,e,t,n,o,r,c])}function kv(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function KS(e){return e.type==="keydown"}function YS(e){return e.type.startsWith("mouse")}function XS(e){return e.type.startsWith("touch")}function JS(e,t){const n=e==="horizontal";if(YS(t))return n?t.clientX:t.clientY;if(XS(t)){const o=t.touches[0];return rt(o),n?o.screenX:o.screenY}else throw Error(`Unsupported event type "${t.type}"`)}function YT(e,t,n,o,r){const l=n==="horizontal",c=Qf(t,r);rt(c);const d=c.getAttribute("data-panel-group-id");rt(d);let{initialCursorPosition:f}=o;const m=JS(n,e),g=qf(d,r);rt(g);const p=g.getBoundingClientRect(),x=l?p.width:p.height;return(m-f)/x*100}function XT(e,t,n,o,r,l){if(KS(e)){const c=n==="horizontal";let d=0;e.shiftKey?d=100:r!=null?d=r:d=10;let f=0;switch(e.key){case"ArrowDown":f=c?0:d;break;case"ArrowLeft":f=c?-d:0;break;case"ArrowRight":f=c?d:0;break;case"ArrowUp":f=c?0:-d;break;case"End":f=100;break;case"Home":f=-100;break}return f}else return o==null?0:YT(e,t,n,o,l)}function JT({panelDataArray:e}){const t=Array(e.length),n=e.map(l=>l.constraints);let o=0,r=100;for(let l=0;l<e.length;l++){const c=n[l];rt(c);const{defaultSize:d}=c;d!=null&&(o++,t[l]=d,r-=d)}for(let l=0;l<e.length;l++){const c=n[l];rt(c);const{defaultSize:d}=c;if(d!=null)continue;const f=e.length-o,m=r/f;o++,t[l]=m,r-=m}return t}function aa(e,t,n){t.forEach((o,r)=>{const l=e[r];rt(l);const{callbacks:c,constraints:d,id:f}=l,{collapsedSize:m=0,collapsible:g}=d,p=n[f];if(p==null||o!==p){n[f]=o;const{onCollapse:x,onExpand:y,onResize:S}=c;S&&S(o,p),g&&(x||y)&&(y&&(p==null||p===m)&&o!==m&&y(),x&&(p==null||p!==m)&&o===m&&x())}})}function Wu(e,t){if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!=t[n])return!1;return!0}function eR({defaultSize:e,dragState:t,layout:n,panelData:o,panelIndex:r,precision:l=3}){const c=n[r];let d;return c==null?d=e??"1":o.length===1?d="1":d=c.toPrecision(l),{flexBasis:0,flexGrow:d,flexShrink:1,overflow:"hidden",pointerEvents:t!==null?"none":void 0}}let Qp=null,jl=null;function ek(e){switch(e){case"horizontal":return"ew-resize";case"horizontal-max":return"w-resize";case"horizontal-min":return"e-resize";case"vertical":return"ns-resize";case"vertical-max":return"n-resize";case"vertical-min":return"s-resize"}}function tR(){jl!==null&&(document.head.removeChild(jl),Qp=null,jl=null)}function Qh(e){if(Qp===e)return;Qp=e;const t=ek(e);jl===null&&(jl=document.createElement("style"),document.head.appendChild(jl)),jl.innerHTML=`*{cursor: ${t}!important;}`}function nR(e,t=10){let n=null;return(...r)=>{n!==null&&clearTimeout(n),n=setTimeout(()=>{e(...r)},t)}}function wv(e){try{if(typeof localStorage<"u")e.getItem=t=>localStorage.getItem(t),e.setItem=(t,n)=>{localStorage.setItem(t,n)};else throw new Error("localStorage not supported in this environment")}catch(t){console.error(t),e.getItem=()=>null,e.setItem=()=>{}}}function tk(e){return`react-resizable-panels:${e}`}function nk(e){return e.map(t=>{const{constraints:n,id:o,idIsFromProps:r,order:l}=t;return r?o:l?`${l}:${JSON.stringify(n)}`:JSON.stringify(n)}).sort((t,n)=>t.localeCompare(n)).join(",")}function sk(e,t){try{const n=tk(e),o=t.getItem(n);if(o){const r=JSON.parse(o);if(typeof r=="object"&&r!=null)return r}}catch{}return null}function sR(e,t,n){var o,r;const l=(o=sk(e,n))!==null&&o!==void 0?o:{},c=nk(t);return(r=l[c])!==null&&r!==void 0?r:null}function oR(e,t,n,o,r){var l;const c=tk(e),d=nk(t),f=(l=sk(e,r))!==null&&l!==void 0?l:{};f[d]={expandToSizes:Object.fromEntries(n.entries()),layout:o};try{r.setItem(c,JSON.stringify(f))}catch(m){console.error(m)}}function Iv({layout:e,panelConstraints:t}){const n=[...e],o=n.reduce((l,c)=>l+c,0);if(n.length!==t.length)throw Error(`Invalid ${t.length} panel layout: ${n.map(l=>`${l}%`).join(", ")}`);if(!fs(o,100))for(let l=0;l<t.length;l++){const c=n[l];rt(c!=null);const d=100/o*c;n[l]=d}let r=0;for(let l=0;l<t.length;l++){const c=n[l];rt(c!=null);const d=ha({panelConstraints:t,panelIndex:l,size:c});c!=d&&(r+=c-d,n[l]=d)}if(!fs(r,0))for(let l=0;l<t.length;l++){const c=n[l];rt(c!=null);const d=c+r,f=ha({panelConstraints:t,panelIndex:l,size:d});if(c!==f&&(r-=f-c,n[l]=f,fs(r,0)))break}return n}const rR=100,Ti={getItem:e=>(wv(Ti),Ti.getItem(e)),setItem:(e,t)=>{wv(Ti),Ti.setItem(e,t)}},Mv={};function ok({autoSaveId:e=null,children:t,className:n="",direction:o,forwardedRef:r,id:l=null,onLayout:c=null,keyboardResizeBy:d=null,storage:f=Ti,style:m,tagName:g="div",...p}){const x=Lg(l),y=ms(null),[S,b]=Kd(null),[I,M]=Kd([]),w=ms({}),_=ms(new Map),T=ms(0),D=ms({autoSaveId:e,direction:o,dragState:S,id:x,keyboardResizeBy:d,onLayout:c,storage:f}),A=ms({layout:I,panelDataArray:[],panelDataArrayChanged:!1});ms({didLogIdAndOrderWarning:!1,didLogPanelConstraintsWarning:!1,prevPanelIds:[]}),US(r,()=>({getId:()=>D.current.id,getLayout:()=>{const{layout:oe}=A.current;return oe},setLayout:oe=>{const{onLayout:re}=D.current,{layout:de,panelDataArray:P}=A.current,B=Iv({layout:oe,panelConstraints:P.map(H=>H.constraints)});kv(de,B)||(M(B),A.current.layout=B,re&&re(B),aa(P,B,w.current))}}),[]),oc(()=>{D.current.autoSaveId=e,D.current.direction=o,D.current.dragState=S,D.current.id=x,D.current.onLayout=c,D.current.storage=f}),KT({committedValuesRef:D,eagerValuesRef:A,groupId:x,layout:I,panelDataArray:A.current.panelDataArray,setLayout:M,panelGroupElement:y.current}),Ml(()=>{const{panelDataArray:oe}=A.current;if(e){if(I.length===0||I.length!==oe.length)return;let re=Mv[e];re==null&&(re=nR(oR,rR),Mv[e]=re);const de=[...oe],P=new Map(_.current);re(e,de,P,I,f)}},[e,I,f]),Ml(()=>{});const F=Xn(oe=>{const{onLayout:re}=D.current,{layout:de,panelDataArray:P}=A.current;if(oe.constraints.collapsible){const B=P.map(fe=>fe.constraints),{collapsedSize:H=0,panelSize:V,pivotIndices:le}=pl(P,oe,de);if(rt(V!=null),V!==H){_.current.set(oe.id,V);const ue=ua(P,oe)===P.length-1?V-H:H-V,xe=Li({delta:ue,layout:de,panelConstraints:B,pivotIndices:le,trigger:"imperative-api"});Wu(de,xe)||(M(xe),A.current.layout=xe,re&&re(xe),aa(P,xe,w.current))}}},[]),Q=Xn(oe=>{const{onLayout:re}=D.current,{layout:de,panelDataArray:P}=A.current;if(oe.constraints.collapsible){const B=P.map(ue=>ue.constraints),{collapsedSize:H=0,panelSize:V,minSize:le=0,pivotIndices:fe}=pl(P,oe,de);if(V===H){const ue=_.current.get(oe.id),xe=ue!=null&&ue>=le?ue:le,Me=ua(P,oe)===P.length-1?V-xe:xe-V,ye=Li({delta:Me,layout:de,panelConstraints:B,pivotIndices:fe,trigger:"imperative-api"});Wu(de,ye)||(M(ye),A.current.layout=ye,re&&re(ye),aa(P,ye,w.current))}}},[]),q=Xn(oe=>{const{layout:re,panelDataArray:de}=A.current,{panelSize:P}=pl(de,oe,re);return rt(P!=null),P},[]),G=Xn((oe,re)=>{const{panelDataArray:de}=A.current,P=ua(de,oe);return eR({defaultSize:re,dragState:S,layout:I,panelData:de,panelIndex:P})},[S,I]),Z=Xn(oe=>{const{layout:re,panelDataArray:de}=A.current,{collapsedSize:P=0,collapsible:B,panelSize:H}=pl(de,oe,re);return B===!0&&H===P},[]),N=Xn(oe=>{const{layout:re,panelDataArray:de}=A.current,{collapsedSize:P=0,collapsible:B,panelSize:H}=pl(de,oe,re);return rt(H!=null),!B||H>P},[]),z=Xn(oe=>{const{panelDataArray:re}=A.current;re.push(oe),re.sort((de,P)=>{const B=de.order,H=P.order;return B==null&&H==null?0:B==null?-1:H==null?1:B-H}),A.current.panelDataArrayChanged=!0},[]);oc(()=>{if(A.current.panelDataArrayChanged){A.current.panelDataArrayChanged=!1;const{autoSaveId:oe,onLayout:re,storage:de}=D.current,{layout:P,panelDataArray:B}=A.current;let H=null;if(oe){const le=sR(oe,B,de);le&&(_.current=new Map(Object.entries(le.expandToSizes)),H=le.layout)}H==null&&(H=JT({panelDataArray:B}));const V=Iv({layout:H,panelConstraints:B.map(le=>le.constraints)});kv(P,V)||(M(V),A.current.layout=V,re&&re(V),aa(B,V,w.current))}});const $=Xn(oe=>function(de){de.preventDefault();const P=y.current;if(!P)return()=>null;const{direction:B,dragState:H,id:V,keyboardResizeBy:le,onLayout:fe}=D.current,{layout:ue,panelDataArray:xe}=A.current,{initialLayout:W}=H??{},Me=QS(V,oe,P);let ye=XT(de,oe,B,H,le,P);if(ye===0)return;const Pe=B==="horizontal";document.dir==="rtl"&&Pe&&(ye=-ye);const Ve=xe.map(ne=>ne.constraints),Ye=Li({delta:ye,layout:W??ue,panelConstraints:Ve,pivotIndices:Me,trigger:KS(de)?"keyboard":"mouse-or-touch"}),O=!Wu(ue,Ye);(YS(de)||XS(de))&&T.current!=ye&&(T.current=ye,Qh(O?Pe?"horizontal":"vertical":Pe?ye<0?"horizontal-min":"horizontal-max":ye<0?"vertical-min":"vertical-max")),O&&(M(Ye),A.current.layout=Ye,fe&&fe(Ye),aa(xe,Ye,w.current))},[]),se=Xn((oe,re)=>{const{onLayout:de}=D.current,{layout:P,panelDataArray:B}=A.current,H=B.map(W=>W.constraints),{panelSize:V,pivotIndices:le}=pl(B,oe,P);rt(V!=null);const ue=ua(B,oe)===B.length-1?V-re:re-V,xe=Li({delta:ue,layout:P,panelConstraints:H,pivotIndices:le,trigger:"imperative-api"});Wu(P,xe)||(M(xe),A.current.layout=xe,de&&de(xe),aa(B,xe,w.current))},[]),he=Xn((oe,re)=>{const{layout:de,panelDataArray:P}=A.current,{collapsedSize:B=0,collapsible:H,defaultSize:V,maxSize:le=100,minSize:fe=0}=re,{collapsedSize:ue=0,collapsible:xe,defaultSize:W,maxSize:Me=100,minSize:ye=0}=oe.constraints,{panelSize:Pe}=pl(P,oe,de);rt(Pe!=null),H&&xe&&B!==ue&&Pe===B?se(oe,ue):Pe<ye?se(oe,ye):Pe>Me&&se(oe,Me)},[se]),ke=Xn((oe,re)=>{const{direction:de}=D.current,{layout:P}=A.current;if(!y.current)return;const B=Qf(oe,y.current);rt(B);const H=JS(de,re);b({dragHandleId:oe,dragHandleRect:B.getBoundingClientRect(),initialCursorPosition:H,initialLayout:P})},[]),Ce=Xn(()=>{tR(),b(null)},[]),ge=Xn(oe=>{const{panelDataArray:re}=A.current,de=ua(re,oe);de>=0&&(re.splice(de,1),delete w.current[oe.id],A.current.panelDataArrayChanged=!0)},[]),De=UT(()=>({collapsePanel:F,direction:o,dragState:S,expandPanel:Q,getPanelSize:q,getPanelStyle:G,groupId:x,isPanelCollapsed:Z,isPanelExpanded:N,reevaluatePanelConstraints:he,registerPanel:z,registerResizeHandle:$,resizePanel:se,startDragging:ke,stopDragging:Ce,unregisterPanel:ge,panelGroupElement:y.current}),[F,S,o,Q,q,G,x,Z,N,he,z,$,se,ke,Ce,ge]),Se={display:"flex",flexDirection:o==="horizontal"?"row":"column",height:"100%",overflow:"hidden",width:"100%"};return Ta(Zf.Provider,{value:De},Ta(g,{...p,children:t,className:n,style:{...Se,...m},ref:y,"data-panel-group":"","data-panel-group-direction":o,"data-panel-group-id":x}))}const Kf=VS((e,t)=>Ta(ok,{...e,forwardedRef:t}));ok.displayName="PanelGroup";Kf.displayName="forwardRef(PanelGroup)";function ua(e,t){return e.findIndex(n=>n===t||n.id===t.id)}function pl(e,t,n){const o=ua(e,t),l=o===e.length-1?[o-1,o]:[o,o+1],c=n[o];return{...t.constraints,panelSize:c,pivotIndices:l}}function lR({disabled:e,handleId:t,resizeHandler:n,panelGroupElement:o}){Ml(()=>{if(e||n==null||o==null)return;const r=Qf(t,o);if(r==null)return;const l=c=>{if(!c.defaultPrevented)switch(c.key){case"ArrowDown":case"ArrowLeft":case"ArrowRight":case"ArrowUp":case"End":case"Home":{c.preventDefault(),n(c);break}case"F6":{c.preventDefault();const d=r.getAttribute("data-panel-group-id");rt(d);const f=Dl(d,o),m=qS(d,t,o);rt(m!==null);const g=c.shiftKey?m>0?m-1:f.length-1:m+1<f.length?m+1:0;f[g].focus();break}}};return r.addEventListener("keydown",l),()=>{r.removeEventListener("keydown",l)}},[o,e,t,n])}function rk({children:e=null,className:t="",disabled:n=!1,id:o,onDragging:r,style:l={},tabIndex:c=0,tagName:d="div",...f}){const m=ms(null),g=ms({onDragging:r});Ml(()=>{g.current.onDragging=r});const p=WS(Zf);if(p===null)throw Error("PanelResizeHandle components must be rendered within a PanelGroup container");const{direction:x,dragState:y,groupId:S,registerResizeHandle:b,startDragging:I,stopDragging:M,panelGroupElement:w}=p,_=Lg(o),T=(y==null?void 0:y.dragHandleId)===_,[D,A]=Kd(!1),[F,Q]=Kd(null),q=Xn(()=>{const Z=m.current;rt(Z),Z.blur(),M();const{onDragging:N}=g.current;N&&N(!1)},[M]);Ml(()=>{if(n)Q(null);else{const Z=b(_);Q(()=>Z)}},[n,_,b]),Ml(()=>{if(n||F==null||!T)return;const Z=se=>{F(se)},N=se=>{F(se)},z=m.current;rt(z);const $=z.ownerDocument;return $.body.addEventListener("contextmenu",q),$.body.addEventListener("mousemove",Z),$.body.addEventListener("touchmove",Z),$.body.addEventListener("mouseleave",N),window.addEventListener("mouseup",q),window.addEventListener("touchend",q),()=>{$.body.removeEventListener("contextmenu",q),$.body.removeEventListener("mousemove",Z),$.body.removeEventListener("touchmove",Z),$.body.removeEventListener("mouseleave",N),window.removeEventListener("mouseup",q),window.removeEventListener("touchend",q)}},[x,n,T,F,q]),lR({disabled:n,handleId:_,resizeHandler:F,panelGroupElement:w});const G={cursor:ek(x),touchAction:"none",userSelect:"none"};return Ta(d,{...f,children:e,className:t,onBlur:()=>A(!1),onFocus:()=>A(!0),onMouseDown:Z=>{I(_,Z.nativeEvent);const N=g.current;rt(N);const{onDragging:z}=N;z&&z(!0)},onMouseUp:q,onTouchCancel:q,onTouchEnd:q,onTouchStart:Z=>{I(_,Z.nativeEvent);const N=g.current;rt(N);const{onDragging:z}=N;z&&z(!0)},ref:m,role:"separator",style:{...G,...l},tabIndex:c,"data-panel-group-direction":x,"data-panel-group-id":S,"data-resize-handle":"","data-resize-handle-active":T?"pointer":D?"keyboard":void 0,"data-panel-resize-handle-enabled":!n,"data-panel-resize-handle-id":_})}rk.displayName="PanelResizeHandle";const aR=P0(rk),iR=e=>{const{orientation:t,...n}=e;return s.jsx(aR,{...n,children:s.jsxs(L,{sx:cR,"data-orientation":t,children:[s.jsx(We,{className:"resize-handle-inner","data-orientation":t}),s.jsx(We,{className:"resize-handle-drag-handle","data-orientation":t})]})})},Yd=u.memo(iR),cR={display:"flex",pos:"relative",'&[data-orientation="horizontal"]':{w:"full",h:5},'&[data-orientation="vertical"]':{w:5,h:"full"},alignItems:"center",justifyContent:"center",div:{bg:"base.800"},_hover:{div:{bg:"base.700"}},_active:{div:{bg:"base.600"}},transitionProperty:"common",transitionDuration:"normal",".resize-handle-inner":{'&[data-orientation="horizontal"]':{w:"calc(100% - 1rem)",h:"2px"},'&[data-orientation="vertical"]':{w:"2px",h:"calc(100% - 1rem)"},borderRadius:"base",transitionProperty:"inherit",transitionDuration:"inherit"},".resize-handle-drag-handle":{pos:"absolute",borderRadius:"1px",transitionProperty:"inherit",transitionDuration:"inherit",'&[data-orientation="horizontal"]':{w:"30px",h:"6px",insetInlineStart:"50%",transform:"translate(-50%, 0)"},'&[data-orientation="vertical"]':{w:"6px",h:"30px",insetBlockStart:"50%",transform:"translate(0, -50%)"}}},Tg=()=>{const e=J(),t=j(r=>r.ui.panels),n=u.useCallback(r=>t[r]??"",[t]),o=u.useCallback((r,l)=>{e(F6({name:r,value:l}))},[e]);return{getItem:n,setItem:o}},uR=Nj("scroll","scroll").options,dR=e=>{const{label:t,data:n,fileName:o,withDownload:r=!0,withCopy:l=!0}=e,c=u.useMemo(()=>z6(n)?n:JSON.stringify(n,null,2),[n]),d=u.useCallback(()=>{navigator.clipboard.writeText(c)},[c]),f=u.useCallback(()=>{const g=new Blob([c]),p=document.createElement("a");p.href=URL.createObjectURL(g),p.download=`${o||t}.json`,document.body.appendChild(p),p.click(),p.remove()},[c,t,o]),{t:m}=R();return s.jsxs(L,{layerStyle:"second",borderRadius:"base",flexGrow:1,w:"full",h:"full",position:"relative",children:[s.jsx(We,{position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"auto",p:4,fontSize:"sm",children:s.jsx(Of,{defer:!0,style:fR,options:uR,children:s.jsx("pre",{children:c})})}),s.jsxs(L,{position:"absolute",top:0,insetInlineEnd:0,p:2,children:[r&&s.jsx(jt,{label:`${m("gallery.download")} ${t} JSON`,children:s.jsx(je,{"aria-label":`${m("gallery.download")} ${t} JSON`,icon:s.jsx(Cc,{size:16}),variant:"ghost",opacity:.7,onClick:f})}),l&&s.jsx(jt,{label:`${m("gallery.copy")} ${t} JSON`,children:s.jsx(je,{"aria-label":`${m("gallery.copy")} ${t} JSON`,icon:s.jsx(el,{size:16}),variant:"ghost",opacity:.7,onClick:d})})]})]})},Ur=u.memo(dR),fR={height:"100%",width:"100%"},mR=Fe(ot,e=>{const t=e.selectedNodes[e.selectedNodes.length-1],n=e.nodes.find(o=>o.id===t);return{data:n==null?void 0:n.data}}),hR=()=>{const{data:e}=j(mR);return e?s.jsx(Ur,{data:e,label:"Node Data"}):s.jsx(Yt,{label:"No node selected",icon:null})},pR=u.memo(hR),Rg=e=>{const t=u.useMemo(()=>Fe(ot,o=>{const r=o.nodes.find(l=>l.id===e);return r==null?void 0:r.data}),[e]);return j(t)},gR=({nodeId:e})=>{const t=J(),n=Rg(e),{t:o}=R(),r=u.useCallback(l=>{t(H6({nodeId:e,notes:l.target.value}))},[t,e]);return wd(n)?s.jsxs(U,{orientation:"vertical",h:"full",children:[s.jsx(Y,{children:o("nodes.notes")}),s.jsx(or,{value:n==null?void 0:n.notes,onChange:r,rows:10,resize:"none"})]}):null},xR=u.memo(gR),lk=e=>{const t=u.useMemo(()=>Fe(ot,gn,(o,r)=>{const l=o.nodes.find(d=>d.id===e),c=r.templates[(l==null?void 0:l.data.type)??""];return Pt(l)&&c?wy(l,c):!1}),[e]);return j(t)},ak=e=>{const t=u.useMemo(()=>ft(ot,o=>{const r=o.nodes.find(l=>l.id===e);return Pt(r)?r.data.label:!1}),[e]);return j(t)},ik=e=>{const t=u.useMemo(()=>ft(ot,gn,(o,r)=>{const l=o.nodes.find(d=>d.id===e);if(!Pt(l))return!1;const c=l?r.templates[l.data.type]:void 0;return c==null?void 0:c.title}),[e]);return j(t)},vR=({nodeId:e,title:t})=>{const n=J(),o=ak(e),r=ik(e),{t:l}=R(),[c,d]=u.useState(""),f=u.useCallback(async g=>{n(Iy({nodeId:e,label:g})),d(o||t||r||l("nodes.problemSettingTitle"))},[n,e,t,r,o,l]),m=u.useCallback(g=>{d(g)},[]);return u.useEffect(()=>{d(o||t||r||l("nodes.problemSettingTitle"))},[o,r,t,l]),s.jsx(L,{w:"full",alignItems:"center",justifyContent:"center",children:s.jsxs(uf,{as:L,value:c,onChange:m,onSubmit:f,w:"full",fontWeight:"semibold",children:[s.jsx(df,{noOfLines:1}),s.jsx(ff,{className:"nodrag"})]})})},CR=u.memo(vR),yR=Fe(ot,gn,(e,t)=>{const n=e.selectedNodes[e.selectedNodes.length-1],o=e.nodes.find(l=>l.id===n),r=o?t.templates[o.data.type]:void 0;if(!(!Pt(o)||!r))return{nodeId:o.data.id,nodeVersion:o.data.version,templateTitle:r.title}}),bR=()=>{const e=j(yR),{t}=R();return e?s.jsx(ck,{nodeId:e.nodeId,nodeVersion:e.nodeVersion,templateTitle:e.templateTitle}):s.jsx(Yt,{label:t("nodes.noNodeSelected"),icon:null})},jR=u.memo(bR),ck=u.memo(e=>{const{t}=R(),n=lk(e.nodeId);return s.jsx(We,{position:"relative",w:"full",h:"full",children:s.jsx(io,{children:s.jsxs(L,{flexDir:"column",position:"relative",w:"full",h:"full",p:1,gap:2,children:[s.jsx(CR,{nodeId:e.nodeId}),s.jsxs($6,{children:[s.jsxs(U,{children:[s.jsx(Y,{children:t("nodes.nodeType")}),s.jsx(pe,{fontSize:"sm",fontWeight:"semibold",children:e.templateTitle})]}),s.jsxs(U,{isInvalid:n,children:[s.jsx(Y,{children:t("nodes.nodeVersion")}),s.jsx(pe,{fontSize:"sm",fontWeight:"semibold",children:e.nodeVersion})]})]}),s.jsx(xR,{nodeId:e.nodeId})]})})})});ck.displayName="Content";const SR=({output:e})=>{const{image:t}=e,{data:n}=zs(t.image_name);return s.jsx(Wr,{imageDTO:n})},kR=u.memo(SR),wR=Fe(ot,gn,(e,t)=>{const n=e.selectedNodes[e.selectedNodes.length-1],o=e.nodes.find(c=>c.id===n),r=o?t.templates[o.data.type]:void 0,l=e.nodeExecutionStates[n??"__UNKNOWN_NODE__"];if(!(!Pt(o)||!l||!r))return{outputs:l.outputs,outputType:r.outputType}}),IR=()=>{const e=j(wR),{t}=R();return e?e.outputs.length===0?s.jsx(Yt,{label:t("nodes.noOutputRecorded"),icon:null}):s.jsx(We,{position:"relative",w:"full",h:"full",children:s.jsx(io,{children:s.jsx(L,{position:"relative",flexDir:"column",alignItems:"flex-start",p:1,gap:2,h:"full",w:"full",children:e.outputType==="image_output"?e.outputs.map((n,o)=>s.jsx(kR,{output:n},_R(n,o))):s.jsx(Ur,{data:e.outputs,label:t("nodes.nodeOutputs")})})})}):s.jsx(Yt,{label:t("nodes.noNodeSelected"),icon:null})},MR=u.memo(IR),_R=(e,t)=>`${e.type}-${t}`,AR=Fe(ot,gn,(e,t)=>{const n=e.selectedNodes[e.selectedNodes.length-1],o=e.nodes.find(l=>l.id===n);return{template:o?t.templates[o.data.type]:void 0}}),PR=()=>{const{template:e}=j(AR),{t}=R();return e?s.jsx(Ur,{data:e,label:t("nodes.nodeTemplate")}):s.jsx(Yt,{label:t("nodes.noNodeSelected"),icon:null})},ER=u.memo(PR),DR=()=>{const{t:e}=R();return s.jsx(L,{layerStyle:"first",flexDir:"column",w:"full",h:"full",borderRadius:"base",p:2,gap:2,children:s.jsxs(Xr,{variant:"line",display:"flex",flexDir:"column",w:"full",h:"full",children:[s.jsxs(Jr,{children:[s.jsx(hn,{children:e("common.details")}),s.jsx(hn,{children:e("common.outputs")}),s.jsx(hn,{children:e("common.data")}),s.jsx(hn,{children:e("common.template")})]}),s.jsxs(Rl,{children:[s.jsx(An,{children:s.jsx(jR,{})}),s.jsx(An,{children:s.jsx(MR,{})}),s.jsx(An,{children:s.jsx(pR,{})}),s.jsx(An,{children:s.jsx(ER,{})})]})]})})},LR=u.memo(DR),TR=Fe(fc,e=>{const{author:t,name:n,description:o,tags:r,version:l,contact:c,notes:d}=e;return{name:n,author:t,description:o,tags:r,version:l,contact:c,notes:d}}),RR=()=>{const{author:e,name:t,description:n,tags:o,version:r,contact:l,notes:c}=j(TR),d=J(),f=u.useCallback(I=>{d(My(I.target.value))},[d]),m=u.useCallback(I=>{d(V6(I.target.value))},[d]),g=u.useCallback(I=>{d(W6(I.target.value))},[d]),p=u.useCallback(I=>{d(U6(I.target.value))},[d]),x=u.useCallback(I=>{d(G6(I.target.value))},[d]),y=u.useCallback(I=>{d(Z6(I.target.value))},[d]),S=u.useCallback(I=>{d(q6(I.target.value))},[d]),{t:b}=R();return s.jsx(io,{children:s.jsx(L,{flexDir:"column",alignItems:"flex-start",gap:2,h:"full",children:s.jsxs(wn,{orientation:"vertical",formControlProps:OR,children:[s.jsxs(L,{gap:2,w:"full",children:[s.jsxs(U,{children:[s.jsx(Y,{children:b("nodes.workflowName")}),s.jsx(dt,{value:t,onChange:f})]}),s.jsxs(U,{children:[s.jsx(Y,{children:b("nodes.workflowVersion")}),s.jsx(dt,{value:r,onChange:p})]})]}),s.jsxs(L,{gap:2,w:"full",children:[s.jsxs(U,{children:[s.jsx(Y,{children:b("nodes.workflowAuthor")}),s.jsx(dt,{value:e,onChange:m})]}),s.jsxs(U,{children:[s.jsx(Y,{children:b("nodes.workflowContact")}),s.jsx(dt,{value:l,onChange:g})]})]}),s.jsxs(U,{children:[s.jsx(Y,{children:b("nodes.workflowTags")}),s.jsx(dt,{value:o,onChange:y})]}),s.jsxs(U,{children:[s.jsx(Y,{children:b("nodes.workflowDescription")}),s.jsx(or,{onChange:x,value:n,fontSize:"sm",resize:"none",rows:3})]}),s.jsxs(U,{children:[s.jsx(Y,{children:b("nodes.workflowNotes")}),s.jsx(or,{onChange:S,value:c,fontSize:"sm",resize:"none",rows:10})]})]})})})},BR=u.memo(RR),OR={flexShrink:0},Fl=Tl(null),NR=X9(e=>{Fl.set(Q6(e))},300),FR=ft(ot,fc,(e,t)=>({nodes:e.nodes,edges:e.edges,workflow:t})),zR=()=>{const e=j(FR);u.useEffect(()=>{NR(e)},[e])},HR=()=>{const e=gt(Fl),{t}=R();return s.jsx(L,{flexDir:"column",alignItems:"flex-start",gap:2,h:"full",children:s.jsx(Ur,{data:e??{},label:t("nodes.workflow")})})},$R=u.memo(HR),VR=({isSelected:e,isHovered:t})=>{const n=u.useMemo(()=>{if(e&&t)return"nodeHoveredSelected";if(e)return"nodeSelected";if(t)return"nodeHovered"},[t,e]);return s.jsx(We,{className:"selection-box",position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,borderRadius:"base",opacity:e||t?1:.5,transitionProperty:"common",transitionDuration:"0.1s",pointerEvents:"none",shadow:n})},uk=u.memo(VR),gd=Tl(null),dk=e=>{const[t,n]=u.useState(!1);u.useEffect(()=>gd.subscribe(c=>{n(c===e)}),[t,e]);const o=u.useCallback(()=>{gd.set(e)},[e]),r=u.useCallback(()=>{gd.set(null)},[]);return{isMouseOverNode:t,handleMouseOver:o,handleMouseOut:r}},fk=(e,t)=>{const n=u.useMemo(()=>ft(ot,r=>{var c;const l=r.nodes.find(d=>d.id===e);if(Pt(l))return(c=l==null?void 0:l.data.inputs[t])==null?void 0:c.label}),[t,e]);return j(n)},mk=(e,t,n)=>{const o=u.useMemo(()=>ft(ot,gn,(l,c)=>{var m;const d=l.nodes.find(g=>g.id===e);if(!Pt(d))return;const f=c.templates[(d==null?void 0:d.data.type)??""];return(m=f==null?void 0:f[E0[n]][t])==null?void 0:m.title}),[t,n,e]);return j(o)},hk=(e,t)=>{const n=u.useMemo(()=>Fe(ot,r=>{const l=r.nodes.find(c=>c.id===e);if(Pt(l))return l==null?void 0:l.data.inputs[t]}),[t,e]);return j(n)},pk=(e,t,n)=>{const o=u.useMemo(()=>Fe(ot,gn,(l,c)=>{const d=l.nodes.find(m=>m.id===e);if(!Pt(d))return;const f=c.templates[(d==null?void 0:d.data.type)??""];return f==null?void 0:f[E0[n]][t]}),[t,n,e]);return j(o)},gk=e=>{const{t}=R();return u.useMemo(()=>{if(!e)return"";const{name:o}=e;return e.isCollection?t("nodes.collectionFieldType",{name:o}):e.isCollectionOrScalar?t("nodes.collectionOrScalarFieldType",{name:o}):o},[e,t])},WR=({nodeId:e,fieldName:t,kind:n})=>{const o=hk(e,t),r=pk(e,t,n),l=K6(r),c=gk(r==null?void 0:r.type),{t:d}=R(),f=u.useMemo(()=>Y6(o)?o.label&&(r!=null&&r.title)?`${o.label} (${r.title})`:o.label&&!r?o.label:!o.label&&r?r.title:d("nodes.unknownField"):(r==null?void 0:r.title)||d("nodes.unknownField"),[o,r,d]);return s.jsxs(L,{flexDir:"column",children:[s.jsx(pe,{fontWeight:"semibold",children:f}),r&&s.jsx(pe,{opacity:.7,fontStyle:"oblique 5deg",children:r.description}),c&&s.jsxs(pe,{children:[d("parameters.type"),": ",c]}),l&&s.jsxs(pe,{children:[d("common.input"),": ",X6(r.input)]})]})},Bg=u.memo(WR),UR=mf((e,t)=>{const{nodeId:n,fieldName:o,kind:r,isMissingInput:l=!1,withTooltip:c=!1}=e,d=fk(n,o),f=mk(n,o,r),{t:m}=R(),g=J(),[p,x]=u.useState(d||f||m("nodes.unknownField")),y=u.useCallback(async b=>{b&&(b===d||b===f)||(x(b||f||m("nodes.unknownField")),g(J6({nodeId:n,fieldName:o,label:b})))},[d,f,g,n,o,m]),S=u.useCallback(b=>{x(b)},[]);return u.useEffect(()=>{x(d||f||m("nodes.unknownField"))},[d,f,m]),s.jsx(jt,{label:c?s.jsx(Bg,{nodeId:n,fieldName:o,kind:"input"}):void 0,openDelay:jf,children:s.jsxs(uf,{value:p,onChange:S,onSubmit:y,as:L,ref:t,position:"relative",overflow:"hidden",alignItems:"center",justifyContent:"flex-start",gap:1,w:"full",children:[s.jsx(df,{fontWeight:"semibold",sx:ZR,noOfLines:1,color:l?"error.300":"base.300"}),s.jsx(ff,{className:"nodrag",sx:GR}),s.jsx(xk,{})]})})}),GR={p:0,w:"full",fontWeight:"semibold",color:"base.100",_focusVisible:{p:0,textAlign:"left",boxShadow:"none"}},ZR={p:0,textAlign:"left",_hover:{fontWeight:"semibold !important"}},Kp=u.memo(UR),xk=u.memo(()=>{const{isEditing:e,getEditButtonProps:t}=_y(),n=u.useCallback(o=>{const{onClick:r}=t();r&&(r(o),o.preventDefault())},[t]);return e?null:s.jsx(L,{onClick:n,position:"absolute",w:"full",h:"full",top:0,insetInlineStart:0,cursor:"text"})});xk.displayName="EditableControls";const qR=e=>{const{nodeId:t,field:n}=e,o=J(),{t:r}=R(),{options:l,hasBoards:c}=cc(void 0,{selectFromResult:({data:g})=>{const p=[{label:"None",value:"none"}].concat((g??[]).map(({board_id:x,board_name:y})=>({label:y,value:x})));return{options:p,hasBoards:p.length>1}}}),d=u.useCallback(g=>{g&&o(eI({nodeId:t,fieldName:n.name,value:g.value!=="none"?{board_id:g.value}:void 0}))},[o,n.name,t]),f=u.useMemo(()=>l.find(g=>{var p;return g.value===((p=n.value)==null?void 0:p.board_id)}),[l,n.value]),m=u.useCallback(()=>r("boards.noMatching"),[r]);return s.jsx(U,{className:"nowheel nodrag",isDisabled:!c,children:s.jsx(Xe,{value:f,options:l,onChange:d,placeholder:r("boards.selectBoard"),noOptionsMessage:m})})},QR=u.memo(qR),KR=e=>{const{nodeId:t,field:n}=e,o=J(),r=u.useCallback(l=>{o(tI({nodeId:t,fieldName:n.name,value:l.target.checked}))},[o,n.name,t]);return s.jsx(kt,{className:"nodrag",onChange:r,isChecked:n.value})},YR=u.memo(KR);function Yf(){return(Yf=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var o in n)Object.prototype.hasOwnProperty.call(n,o)&&(e[o]=n[o])}return e}).apply(this,arguments)}function vk(e,t){if(e==null)return{};var n,o,r={},l=Object.keys(e);for(o=0;o<l.length;o++)t.indexOf(n=l[o])>=0||(r[n]=e[n]);return r}function Yp(e){var t=u.useRef(e),n=u.useRef(function(o){t.current&&t.current(o)});return t.current=e,n.current}var Ra=function(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=1),e>n?n:e<t?t:e},Vi=function(e){return"touches"in e},Xp=function(e){return e&&e.ownerDocument.defaultView||self},_v=function(e,t,n){var o=e.getBoundingClientRect(),r=Vi(t)?function(l,c){for(var d=0;d<l.length;d++)if(l[d].identifier===c)return l[d];return l[0]}(t.touches,n):t;return{left:Ra((r.pageX-(o.left+Xp(e).pageXOffset))/o.width),top:Ra((r.pageY-(o.top+Xp(e).pageYOffset))/o.height)}},Av=function(e){!Vi(e)&&e.preventDefault()},Og=te.memo(function(e){var t=e.onMove,n=e.onKey,o=vk(e,["onMove","onKey"]),r=u.useRef(null),l=Yp(t),c=Yp(n),d=u.useRef(null),f=u.useRef(!1),m=u.useMemo(function(){var y=function(I){Av(I),(Vi(I)?I.touches.length>0:I.buttons>0)&&r.current?l(_v(r.current,I,d.current)):b(!1)},S=function(){return b(!1)};function b(I){var M=f.current,w=Xp(r.current),_=I?w.addEventListener:w.removeEventListener;_(M?"touchmove":"mousemove",y),_(M?"touchend":"mouseup",S)}return[function(I){var M=I.nativeEvent,w=r.current;if(w&&(Av(M),!function(T,D){return D&&!Vi(T)}(M,f.current)&&w)){if(Vi(M)){f.current=!0;var _=M.changedTouches||[];_.length&&(d.current=_[0].identifier)}w.focus(),l(_v(w,M,d.current)),b(!0)}},function(I){var M=I.which||I.keyCode;M<37||M>40||(I.preventDefault(),c({left:M===39?.05:M===37?-.05:0,top:M===40?.05:M===38?-.05:0}))},b]},[c,l]),g=m[0],p=m[1],x=m[2];return u.useEffect(function(){return x},[x]),te.createElement("div",Yf({},o,{onTouchStart:g,onMouseDown:g,className:"react-colorful__interactive",ref:r,onKeyDown:p,tabIndex:0,role:"slider"}))}),Xf=function(e){return e.filter(Boolean).join(" ")},Ng=function(e){var t=e.color,n=e.left,o=e.top,r=o===void 0?.5:o,l=Xf(["react-colorful__pointer",e.className]);return te.createElement("div",{className:l,style:{top:100*r+"%",left:100*n+"%"}},te.createElement("div",{className:"react-colorful__pointer-fill",style:{backgroundColor:t}}))},$n=function(e,t,n){return t===void 0&&(t=0),n===void 0&&(n=Math.pow(10,t)),Math.round(n*e)/n},Ck=function(e){var t=e.s,n=e.v,o=e.a,r=(200-t)*n/100;return{h:$n(e.h),s:$n(r>0&&r<200?t*n/100/(r<=100?r:200-r)*100:0),l:$n(r/2),a:$n(o,2)}},Jp=function(e){var t=Ck(e);return"hsl("+t.h+", "+t.s+"%, "+t.l+"%)"},Kh=function(e){var t=Ck(e);return"hsla("+t.h+", "+t.s+"%, "+t.l+"%, "+t.a+")"},XR=function(e){var t=e.h,n=e.s,o=e.v,r=e.a;t=t/360*6,n/=100,o/=100;var l=Math.floor(t),c=o*(1-n),d=o*(1-(t-l)*n),f=o*(1-(1-t+l)*n),m=l%6;return{r:$n(255*[o,d,c,c,f,o][m]),g:$n(255*[f,o,o,d,c,c][m]),b:$n(255*[c,c,f,o,o,d][m]),a:$n(r,2)}},JR=function(e){var t=e.r,n=e.g,o=e.b,r=e.a,l=Math.max(t,n,o),c=l-Math.min(t,n,o),d=c?l===t?(n-o)/c:l===n?2+(o-t)/c:4+(t-n)/c:0;return{h:$n(60*(d<0?d+6:d)),s:$n(l?c/l*100:0),v:$n(l/255*100),a:r}},eB=te.memo(function(e){var t=e.hue,n=e.onChange,o=Xf(["react-colorful__hue",e.className]);return te.createElement("div",{className:o},te.createElement(Og,{onMove:function(r){n({h:360*r.left})},onKey:function(r){n({h:Ra(t+360*r.left,0,360)})},"aria-label":"Hue","aria-valuenow":$n(t),"aria-valuemax":"360","aria-valuemin":"0"},te.createElement(Ng,{className:"react-colorful__hue-pointer",left:t/360,color:Jp({h:t,s:100,v:100,a:1})})))}),tB=te.memo(function(e){var t=e.hsva,n=e.onChange,o={backgroundColor:Jp({h:t.h,s:100,v:100,a:1})};return te.createElement("div",{className:"react-colorful__saturation",style:o},te.createElement(Og,{onMove:function(r){n({s:100*r.left,v:100-100*r.top})},onKey:function(r){n({s:Ra(t.s+100*r.left,0,100),v:Ra(t.v-100*r.top,0,100)})},"aria-label":"Color","aria-valuetext":"Saturation "+$n(t.s)+"%, Brightness "+$n(t.v)+"%"},te.createElement(Ng,{className:"react-colorful__saturation-pointer",top:1-t.v/100,left:t.s/100,color:Jp(t)})))}),yk=function(e,t){if(e===t)return!0;for(var n in e)if(e[n]!==t[n])return!1;return!0};function nB(e,t,n){var o=Yp(n),r=u.useState(function(){return e.toHsva(t)}),l=r[0],c=r[1],d=u.useRef({color:t,hsva:l});u.useEffect(function(){if(!e.equal(t,d.current.color)){var m=e.toHsva(t);d.current={hsva:m,color:t},c(m)}},[t,e]),u.useEffect(function(){var m;yk(l,d.current.hsva)||e.equal(m=e.fromHsva(l),d.current.color)||(d.current={hsva:l,color:m},o(m))},[l,e,o]);var f=u.useCallback(function(m){c(function(g){return Object.assign({},g,m)})},[]);return[l,f]}var sB=typeof window<"u"?u.useLayoutEffect:u.useEffect,oB=function(){return typeof __webpack_nonce__<"u"?__webpack_nonce__:void 0},Pv=new Map,rB=function(e){sB(function(){var t=e.current?e.current.ownerDocument:document;if(t!==void 0&&!Pv.has(t)){var n=t.createElement("style");n.innerHTML=`.react-colorful{position:relative;display:flex;flex-direction:column;width:200px;height:200px;-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;cursor:default}.react-colorful__saturation{position:relative;flex-grow:1;border-color:transparent;border-bottom:12px solid #000;border-radius:8px 8px 0 0;background-image:linear-gradient(0deg,#000,transparent),linear-gradient(90deg,#fff,hsla(0,0%,100%,0))}.react-colorful__alpha-gradient,.react-colorful__pointer-fill{content:"";position:absolute;left:0;top:0;right:0;bottom:0;pointer-events:none;border-radius:inherit}.react-colorful__alpha-gradient,.react-colorful__saturation{box-shadow:inset 0 0 0 1px rgba(0,0,0,.05)}.react-colorful__alpha,.react-colorful__hue{position:relative;height:24px}.react-colorful__hue{background:linear-gradient(90deg,red 0,#ff0 17%,#0f0 33%,#0ff 50%,#00f 67%,#f0f 83%,red)}.react-colorful__last-control{border-radius:0 0 8px 8px}.react-colorful__interactive{position:absolute;left:0;top:0;right:0;bottom:0;border-radius:inherit;outline:none;touch-action:none}.react-colorful__pointer{position:absolute;z-index:1;box-sizing:border-box;width:28px;height:28px;transform:translate(-50%,-50%);background-color:#fff;border:2px solid #fff;border-radius:50%;box-shadow:0 2px 4px rgba(0,0,0,.2)}.react-colorful__interactive:focus .react-colorful__pointer{transform:translate(-50%,-50%) scale(1.1)}.react-colorful__alpha,.react-colorful__alpha-pointer{background-color:#fff;background-image:url('data:image/svg+xml;charset=utf-8,<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill-opacity=".05"><path d="M8 0h8v8H8zM0 8h8v8H0z"/></svg>')}.react-colorful__saturation-pointer{z-index:3}.react-colorful__hue-pointer{z-index:2}`,Pv.set(t,n);var o=oB();o&&n.setAttribute("nonce",o),t.head.appendChild(n)}},[])},lB=function(e){var t=e.className,n=e.hsva,o=e.onChange,r={backgroundImage:"linear-gradient(90deg, "+Kh(Object.assign({},n,{a:0}))+", "+Kh(Object.assign({},n,{a:1}))+")"},l=Xf(["react-colorful__alpha",t]),c=$n(100*n.a);return te.createElement("div",{className:l},te.createElement("div",{className:"react-colorful__alpha-gradient",style:r}),te.createElement(Og,{onMove:function(d){o({a:d.left})},onKey:function(d){o({a:Ra(n.a+d.left)})},"aria-label":"Alpha","aria-valuetext":c+"%","aria-valuenow":c,"aria-valuemin":"0","aria-valuemax":"100"},te.createElement(Ng,{className:"react-colorful__alpha-pointer",left:n.a,color:Kh(n)})))},aB=function(e){var t=e.className,n=e.colorModel,o=e.color,r=o===void 0?n.defaultColor:o,l=e.onChange,c=vk(e,["className","colorModel","color","onChange"]),d=u.useRef(null);rB(d);var f=nB(n,r,l),m=f[0],g=f[1],p=Xf(["react-colorful",t]);return te.createElement("div",Yf({},c,{ref:d,className:p}),te.createElement(tB,{hsva:m,onChange:g}),te.createElement(eB,{hue:m.h,onChange:g}),te.createElement(lB,{hsva:m,onChange:g,className:"react-colorful__last-control"}))},iB={defaultColor:{r:0,g:0,b:0,a:1},toHsva:JR,fromHsva:XR,equal:yk},bk=function(e){return te.createElement(aB,Yf({},e,{colorModel:iB}))};const cB=e=>{const{nodeId:t,field:n}=e,o=J(),r=u.useCallback(l=>{o(nI({nodeId:t,fieldName:n.name,value:l}))},[o,n.name,t]);return s.jsx(bk,{className:"nodrag",color:n.value,onChange:r})},uB=u.memo(cB),ws=e=>{const{t}=R(),n=j(y=>{var S;return((S=y.generation.model)==null?void 0:S.base_model)??"sdxl"}),{modelEntities:o,selectedModel:r,getIsDisabled:l,onChange:c,isLoading:d}=e,f=u.useMemo(()=>{if(!o)return[];const y=ys(o.entities),S=r_(y,"base_model"),b=sI(S,(I,M,w)=>(I.push({label:w,options:M.map(_=>({label:_.model_name,value:_.id,isDisabled:l?l(_):!1}))}),I),[]);return b.sort(I=>I.label===n?-1:1),b},[l,o,n]),m=u.useMemo(()=>f.flatMap(y=>y.options).find(y=>r?y.value===D0(r):!1)??null,[f,r]),g=u.useCallback(y=>{if(!y){c(null);return}const S=o==null?void 0:o.entities[y.value];if(!S){c(null);return}c(S)},[o==null?void 0:o.entities,c]),p=u.useMemo(()=>d?t("common.loading"):f.length===0?t("models.noModelsAvailable"):t("models.selectModel"),[d,f,t]),x=u.useCallback(()=>t("models.noMatchingModels"),[t]);return{options:f,value:m,onChange:g,placeholder:p,noOptionsMessage:x}},dB=e=>{const{nodeId:t,field:n}=e,o=J(),{data:r,isLoading:l}=gf(),c=u.useCallback(x=>{x&&o(oI({nodeId:t,fieldName:n.name,value:x}))},[o,n.name,t]),{options:d,value:f,onChange:m,placeholder:g,noOptionsMessage:p}=ws({modelEntities:r,onChange:c,selectedModel:n.value?{...n.value,model_type:"controlnet"}:void 0,isLoading:l});return s.jsx(jt,{label:f==null?void 0:f.description,children:s.jsx(U,{className:"nowheel nodrag",isInvalid:!f,children:s.jsx(Xe,{value:f,placeholder:g,options:d,onChange:m,noOptionsMessage:p})})})},fB=u.memo(dB),mB=e=>{const{nodeId:t,field:n,fieldTemplate:o}=e,r=J(),l=u.useCallback(c=>{r(rI({nodeId:t,fieldName:n.name,value:c.target.value}))},[r,n.name,t]);return s.jsx(lI,{className:"nowheel nodrag",onChange:l,value:n.value,children:o.options.map(c=>s.jsx("option",{value:c,children:o.ui_choice_labels?o.ui_choice_labels[c]:c},c))})},hB=u.memo(mB),pB=e=>{var p;const{nodeId:t,field:n}=e,o=J(),r=j(x=>x.system.isConnected),{currentData:l,isError:c}=zs(((p=n.value)==null?void 0:p.image_name)??ss),d=u.useCallback(()=>{o(aI({nodeId:t,fieldName:n.name,value:void 0}))},[o,n.name,t]),f=u.useMemo(()=>{if(l)return{id:`node-${t}-${n.name}`,payloadType:"IMAGE_DTO",payload:{imageDTO:l}}},[n.name,l,t]),m=u.useMemo(()=>({id:`node-${t}-${n.name}`,actionType:"SET_NODES_IMAGE",context:{nodeId:t,fieldName:n.name}}),[n.name,t]),g=u.useMemo(()=>({type:"SET_NODES_IMAGE",nodeId:t,fieldName:n.name}),[t,n.name]);return u.useEffect(()=>{r&&c&&d()},[d,r,c]),s.jsx(L,{className:"nodrag",w:"full",h:"full",alignItems:"center",justifyContent:"center",children:s.jsx(Wr,{imageDTO:l,droppableData:m,draggableData:f,postUploadAction:g,useThumbailFallback:!0,uploadElement:s.jsx(jk,{}),dropLabel:s.jsx(Sk,{}),minSize:8,children:s.jsx(Ia,{onClick:d,icon:l?s.jsx(vc,{}):void 0,tooltip:"Reset Image"})})})},gB=u.memo(pB),jk=u.memo(()=>{const{t:e}=R();return s.jsx(pe,{fontSize:16,fontWeight:"semibold",children:e("gallery.dropOrUpload")})});jk.displayName="UploadElement";const Sk=u.memo(()=>{const{t:e}=R();return s.jsx(pe,{fontSize:16,fontWeight:"semibold",children:e("gallery.drop")})});Sk.displayName="DropLabel";const xB=e=>{const{nodeId:t,field:n}=e,o=J(),{data:r}=vf(),l=u.useCallback(m=>{m&&o(iI({nodeId:t,fieldName:n.name,value:m}))},[o,n.name,t]),{options:c,value:d,onChange:f}=ws({modelEntities:r,onChange:l,selectedModel:n.value?{...n.value,model_type:"ip_adapter"}:void 0});return s.jsx(jt,{label:d==null?void 0:d.description,children:s.jsx(U,{className:"nowheel nodrag",isInvalid:!d,children:s.jsx(Xe,{value:d,placeholder:"Pick one",options:c,onChange:f})})})},vB=u.memo(xB),CB=e=>{const{nodeId:t,field:n}=e,o=J(),{data:r,isLoading:l}=dc(),c=u.useCallback(x=>{x&&o(cI({nodeId:t,fieldName:n.name,value:x}))},[o,n.name,t]),{options:d,value:f,onChange:m,placeholder:g,noOptionsMessage:p}=ws({modelEntities:r,onChange:c,selectedModel:n.value?{...n.value,model_type:"lora"}:void 0,isLoading:l});return s.jsx(U,{className:"nowheel nodrag",isInvalid:!f,isDisabled:!d.length,children:s.jsx(Xe,{value:f,placeholder:g,noOptionsMessage:p,options:d,onChange:m})})},yB=u.memo(CB),kk=()=>{const e=J(),{t}=R(),[n,{isLoading:o}]=uI();return{syncModels:u.useCallback(()=>{n().unwrap().then(l=>{e(Qe(_t({title:`${t("modelManager.modelsSynced")}`,status:"success"})))}).catch(l=>{l&&e(Qe(_t({title:`${t("modelManager.modelSyncFailed")}`,status:"error"})))})},[e,n,t]),isLoading:o}},Ka=u.memo(e=>{const{t}=R(),{syncModels:n,isLoading:o}=kk();return Kt("syncModels").isFeatureEnabled?s.jsx(je,{icon:s.jsx(G0,{}),tooltip:t("modelManager.syncModels"),"aria-label":t("modelManager.syncModels"),isLoading:o,onClick:n,size:"sm",variant:"ghost",...e}):null});Ka.displayName="SyncModelsIconButton";const lc=["sd-1","sd-2","sdxl","sdxl-refiner"],bB=["sd-1","sd-2","sdxl"],jB=["sdxl"],SB=["sd-1","sd-2"],Fg=["sdxl-refiner"],kB=e=>{const{nodeId:t,field:n}=e,o=J(),{data:r,isLoading:l}=so(SB),c=u.useCallback(x=>{x&&o(Ay({nodeId:t,fieldName:n.name,value:x}))},[o,n.name,t]),{options:d,value:f,onChange:m,placeholder:g,noOptionsMessage:p}=ws({modelEntities:r,onChange:c,isLoading:l,selectedModel:n.value});return s.jsxs(L,{w:"full",alignItems:"center",gap:2,children:[s.jsx(U,{className:"nowheel nodrag",isDisabled:!d.length,isInvalid:!f,children:s.jsx(Xe,{value:f,placeholder:g,options:d,onChange:m,noOptionsMessage:p})}),s.jsx(Ka,{className:"nodrag"})]})},wB=u.memo(kB),IB=e=>{const{nodeId:t,field:n,fieldTemplate:o}=e,r=J(),l=u.useMemo(()=>o.type.name==="IntegerField",[o.type]),c=u.useCallback(m=>{r(dI({nodeId:t,fieldName:n.name,value:l?Math.floor(Number(m)):Number(m)}))},[r,n.name,l,t]),d=u.useMemo(()=>{if(!zn(o.minimum))return o.minimum;if(!zn(o.exclusiveMinimum))return o.exclusiveMinimum+.01},[o.exclusiveMinimum,o.minimum]),f=u.useMemo(()=>{if(!zn(o.maximum))return o.maximum;if(!zn(o.exclusiveMaximum))return o.exclusiveMaximum-.01},[o.exclusiveMaximum,o.maximum]);return s.jsx($e,{defaultValue:o.default,onChange:c,value:n.value,min:d??-Id,max:f??Id,step:l?1:.1,fineStep:l?1:.01,className:"nodrag"})},MB=u.memo(IB),_B=e=>{const{nodeId:t,field:n}=e,o=J(),{data:r,isLoading:l}=so(Fg),c=u.useCallback(x=>{x&&o(fI({nodeId:t,fieldName:n.name,value:x}))},[o,n.name,t]),{options:d,value:f,onChange:m,placeholder:g,noOptionsMessage:p}=ws({modelEntities:r,onChange:c,isLoading:l,selectedModel:n.value});return s.jsxs(L,{w:"full",alignItems:"center",gap:2,children:[s.jsx(U,{className:"nowheel nodrag",isDisabled:!d.length,isInvalid:!f,children:s.jsx(Xe,{value:f,placeholder:g,options:d,onChange:m,noOptionsMessage:p})}),s.jsx(Ka,{className:"nodrag"})]})},AB=u.memo(_B),PB=e=>{const{nodeId:t,field:n}=e,o=J(),r=u.useCallback(c=>{ya(c==null?void 0:c.value)&&o(mI({nodeId:t,fieldName:n.name,value:c.value}))},[o,n.name,t]),l=u.useMemo(()=>Pa.find(c=>c.value===(n==null?void 0:n.value)),[n==null?void 0:n.value]);return s.jsx(U,{className:"nowheel nodrag",children:s.jsx(Xe,{value:l,options:Pa,onChange:r})})},EB=u.memo(PB),DB=e=>{const{nodeId:t,field:n}=e,o=J(),{data:r,isLoading:l}=so(jB),c=u.useCallback(x=>{x&&o(Ay({nodeId:t,fieldName:n.name,value:x}))},[o,n.name,t]),{options:d,value:f,onChange:m,placeholder:g,noOptionsMessage:p}=ws({modelEntities:r,onChange:c,isLoading:l,selectedModel:n.value});return s.jsxs(L,{w:"full",alignItems:"center",gap:2,children:[s.jsx(U,{className:"nowheel nodrag",isDisabled:!d.length,isInvalid:!f,children:s.jsx(Xe,{value:f,placeholder:g,options:d,onChange:m,noOptionsMessage:p})}),s.jsx(Ka,{className:"nodrag"})]})},LB=u.memo(DB),TB=e=>{const{nodeId:t,field:n,fieldTemplate:o}=e,r=J(),l=u.useCallback(c=>{r(hI({nodeId:t,fieldName:n.name,value:c.target.value}))},[r,n.name,t]);return o.ui_component==="textarea"?s.jsx(or,{className:"nodrag",onChange:l,value:n.value,rows:5,resize:"none"}):s.jsx(dt,{className:"nodrag",onChange:l,value:n.value})},RB=u.memo(TB),BB=e=>{const{nodeId:t,field:n}=e,o=J(),{data:r}=xf(),l=u.useCallback(m=>{m&&o(pI({nodeId:t,fieldName:n.name,value:m}))},[o,n.name,t]),{options:c,value:d,onChange:f}=ws({modelEntities:r,onChange:l,selectedModel:n.value?{...n.value,model_type:"t2i_adapter"}:void 0});return s.jsx(jt,{label:d==null?void 0:d.description,children:s.jsx(U,{className:"nowheel nodrag",isInvalid:!d,children:s.jsx(Xe,{value:d,placeholder:"Pick one",options:c,onChange:f})})})},OB=u.memo(BB),NB=e=>{const{nodeId:t,field:n}=e,o=J(),{data:r,isLoading:l}=Py(),c=u.useCallback(x=>{x&&o(gI({nodeId:t,fieldName:n.name,value:x}))},[o,n.name,t]),{options:d,value:f,onChange:m,placeholder:g,noOptionsMessage:p}=ws({modelEntities:r,onChange:c,selectedModel:n.value?{...n.value,model_type:"vae"}:null,isLoading:l});return s.jsxs(L,{w:"full",alignItems:"center",gap:2,children:[s.jsx(U,{className:"nowheel nodrag",isDisabled:!d.length,isInvalid:!f,children:s.jsx(Xe,{value:f,placeholder:g,options:d,onChange:m,noOptionsMessage:p})}),s.jsx(Ka,{className:"nodrag"})]})},FB=u.memo(NB),zB=({nodeId:e,fieldName:t})=>{const{t:n}=R(),o=hk(e,t),r=pk(e,t,"input");return(r==null?void 0:r.fieldKind)==="output"?s.jsxs(We,{p:2,children:[n("nodes.outputFieldInInput"),": ",o==null?void 0:o.type.name]}):xI(o)&&vI(r)?s.jsx(RB,{nodeId:e,field:o,fieldTemplate:r}):CI(o)&&yI(r)?s.jsx(YR,{nodeId:e,field:o,fieldTemplate:r}):bI(o)&&jI(r)||SI(o)&&kI(r)?s.jsx(MB,{nodeId:e,field:o,fieldTemplate:r}):wI(o)&&II(r)?s.jsx(hB,{nodeId:e,field:o,fieldTemplate:r}):MI(o)&&_I(r)?s.jsx(gB,{nodeId:e,field:o,fieldTemplate:r}):AI(o)&&PI(r)?s.jsx(QR,{nodeId:e,field:o,fieldTemplate:r}):EI(o)&&DI(r)?s.jsx(wB,{nodeId:e,field:o,fieldTemplate:r}):LI(o)&&TI(r)?s.jsx(AB,{nodeId:e,field:o,fieldTemplate:r}):RI(o)&&BI(r)?s.jsx(FB,{nodeId:e,field:o,fieldTemplate:r}):OI(o)&&NI(r)?s.jsx(yB,{nodeId:e,field:o,fieldTemplate:r}):FI(o)&&zI(r)?s.jsx(fB,{nodeId:e,field:o,fieldTemplate:r}):HI(o)&&$I(r)?s.jsx(vB,{nodeId:e,field:o,fieldTemplate:r}):VI(o)&&WI(r)?s.jsx(OB,{nodeId:e,field:o,fieldTemplate:r}):UI(o)&&GI(r)?s.jsx(uB,{nodeId:e,field:o,fieldTemplate:r}):ZI(o)&&qI(r)?s.jsx(LB,{nodeId:e,field:o,fieldTemplate:r}):QI(o)&&KI(r)?s.jsx(EB,{nodeId:e,field:o,fieldTemplate:r}):o&&r?null:s.jsx(We,{p:1,children:s.jsx(pe,{fontSize:"sm",fontWeight:"semibold",color:"error.300",children:n("nodes.unknownFieldType",{type:o==null?void 0:o.type.name})})})},wk=u.memo(zB),HB=({nodeId:e,fieldName:t})=>{const n=J(),{isMouseOverNode:o,handleMouseOut:r,handleMouseOver:l}=dk(e),{t:c}=R(),d=u.useCallback(()=>{n(Ey({nodeId:e,fieldName:t}))},[n,t,e]);return s.jsxs(L,{onMouseEnter:l,onMouseLeave:r,layerStyle:"second",position:"relative",borderRadius:"base",w:"full",p:4,flexDir:"column",children:[s.jsxs(L,{children:[s.jsx(Kp,{nodeId:e,fieldName:t,kind:"input"}),s.jsx(Cs,{}),s.jsx(jt,{label:s.jsx(Bg,{nodeId:e,fieldName:t,kind:"input"}),openDelay:jf,placement:"top",children:s.jsx(L,{h:"full",alignItems:"center",children:s.jsx(Vn,{fontSize:"sm",color:"base.300",as:Mf})})}),s.jsx(je,{"aria-label":c("nodes.removeLinearView"),tooltip:c("nodes.removeLinearView"),variant:"ghost",size:"sm",onClick:d,icon:s.jsx(Vs,{})})]}),s.jsx(wk,{nodeId:e,fieldName:t}),s.jsx(uk,{isSelected:!1,isHovered:o})]})},$B=u.memo(HB),VB=Fe(fc,e=>e.exposedFields),WB=()=>{const e=j(VB),{t}=R();return s.jsx(We,{position:"relative",w:"full",h:"full",children:s.jsx(io,{children:s.jsx(L,{position:"relative",flexDir:"column",alignItems:"flex-start",p:1,gap:2,h:"full",w:"full",children:e.length?e.map(({nodeId:n,fieldName:o})=>s.jsx($B,{nodeId:n,fieldName:o},`${n}.${o}`)):s.jsx(Yt,{label:t("nodes.noFieldsLinearview"),icon:null})})})})},UB=u.memo(WB),GB=()=>{const{t:e}=R();return s.jsx(L,{layerStyle:"first",flexDir:"column",w:"full",h:"full",borderRadius:"base",p:2,gap:2,children:s.jsxs(Xr,{variant:"line",display:"flex",w:"full",h:"full",flexDir:"column",children:[s.jsxs(Jr,{children:[s.jsx(hn,{children:e("common.linear")}),s.jsx(hn,{children:e("common.details")}),s.jsx(hn,{children:"JSON"})]}),s.jsxs(Rl,{children:[s.jsx(An,{children:s.jsx(UB,{})}),s.jsx(An,{children:s.jsx(BR,{})}),s.jsx(An,{children:s.jsx($R,{})})]})]})})},ZB=u.memo(GB),qB={height:"100%",width:"100%"},QB=()=>{const e=u.useRef(null),t=Tg(),n=u.useCallback(()=>{e.current&&e.current.setLayout([50,50])},[]);return s.jsxs(L,{w:"full",h:"full",gap:2,flexDir:"column",children:[s.jsx($S,{}),s.jsxs(Kf,{ref:e,id:"workflow-panel-group",autoSaveId:"workflow-panel-group",direction:"vertical",style:qB,storage:t,children:[s.jsx(Fr,{id:"workflow",collapsible:!0,minSize:25,children:s.jsx(ZB,{})}),s.jsx(Yd,{orientation:"horizontal",onDoubleClick:n}),s.jsx(Fr,{id:"inspector",collapsible:!0,minSize:25,children:s.jsx(LR,{})})]})]})},KB=u.memo(QB),YB="data:image/svg+xml,%3csvg%20width='44'%20height='44'%20viewBox='0%200%2044%2044'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cpath%20d='M29.1951%2010.6667H42V2H2V10.6667H14.8049L29.1951%2033.3333H42V42H2V33.3333H14.8049'%20stroke='%23E6FD13'%20stroke-width='2.8'/%3e%3c/svg%3e",XB=()=>{const{data:e}=Dy(),t=u.useRef(null),n=gt(YI),o=u.useMemo(()=>e?s.jsxs(pe,{fontWeight:"semibold",children:["v",e.version]}):null,[e]);return n||s.jsx(jt,{placement:"right",label:o,p:1,px:2,gutter:16,children:s.jsx(ur,{ref:t,src:YB,alt:"invoke-logo",w:"24px",h:"24px",minW:"24px",minH:"24px",userSelect:"none"})})},JB=u.memo(XB),e0="http://github.com/invoke-ai/InvokeAI",Ik="https://discord.gg/ZmtBAhwWhy",Ev="https://www.invoke.com/",eO="data:image/svg+xml,%3csvg%20width='231'%20height='100'%20viewBox='0%200%20231%20100'%20fill='none'%20xmlns='http://www.w3.org/2000/svg'%3e%3cg%20clip-path='url(%23clip0_659_3578)'%3e%3crect%20width='100'%20height='100'%20fill='%23E6FD13'/%3e%3cpath%20d='M57.1951%2038.6667H70V30H30V38.6667H42.8049L57.1951%2061.3333H70V70H30V61.3333H42.8049'%20stroke='%23181818'%20stroke-width='2.8'/%3e%3crect%20width='131'%20height='100'%20transform='translate(100)'%20fill='%23E6FD13'/%3e%3cpath%20d='M111.37%2043.34H107.89V39.65H111.37V43.34ZM116.38%2060.5H102.76V58.16H108.22V47.84H103.36V45.5H111.07V58.16H116.38V60.5ZM120.538%2060.5V45.5H123.388V47.6C124.288%2046.25%20125.788%2045.2%20128.188%2045.2C131.638%2045.2%20133.588%2047.3%20133.588%2050.45V60.5H130.738V51.05C130.738%2048.95%20129.838%2047.6%20127.708%2047.6H127.468C125.338%2047.6%20123.388%2049.25%20123.388%2052.1V60.5H120.538ZM141.786%2060.5L136.236%2045.5H139.176L143.526%2057.71L147.876%2045.5H150.786L145.236%2060.5H141.786ZM159.723%2060.8C155.673%2060.8%20152.523%2057.65%20152.523%2053C152.523%2048.35%20155.673%2045.2%20159.723%2045.2C163.773%2045.2%20166.923%2048.35%20166.923%2053C166.923%2057.65%20163.773%2060.8%20159.723%2060.8ZM155.373%2053C155.373%2056.45%20157.173%2058.4%20159.603%2058.4H159.843C162.273%2058.4%20164.073%2056.45%20164.073%2053C164.073%2049.55%20162.273%2047.6%20159.843%2047.6H159.603C157.173%2047.6%20155.373%2049.55%20155.373%2053ZM170.804%2060.5V39.5H173.654V51.98L180.254%2045.5H184.004L177.764%2051.47L184.304%2060.5H180.794L175.724%2053.42L173.654%2055.43V60.5H170.804ZM192.459%2060.8C188.739%2060.8%20185.379%2058.22%20185.379%2052.97C185.379%2047.78%20188.829%2045.2%20192.369%2045.2C196.269%2045.2%20198.729%2047.9%20198.729%2051.8V53.45H188.229C188.409%2056.87%20190.599%2058.4%20192.429%2058.4H192.669C194.139%2058.4%20195.549%2057.65%20195.849%2056.06H198.699C198.159%2059.09%20195.549%2060.8%20192.459%2060.8ZM188.409%2051.2H195.879C195.759%2048.59%20194.199%2047.6%20192.489%2047.6H192.249C190.689%2047.6%20188.949%2048.53%20188.409%2051.2Z'%20fill='%23181818'/%3e%3c/g%3e%3cdefs%3e%3cclipPath%20id='clip0_659_3578'%3e%3crect%20width='231'%20height='100'%20rx='5'%20fill='white'/%3e%3c/clipPath%3e%3c/defs%3e%3c/svg%3e",tO=({children:e})=>{const{isOpen:t,onOpen:n,onClose:o}=an(),{t:r}=R(),{depsArray:l,depsObject:c}=XI(void 0,{selectFromResult:({data:m})=>({depsObject:m,depsArray:m?ys(m,(g,p)=>({name:p,version:g})):[]})}),{data:d}=Dy(),f=u.useCallback(()=>{navigator.clipboard.writeText(JSON.stringify(c,null,2))},[c]);return s.jsxs(s.Fragment,{children:[u.cloneElement(e,{onClick:n}),s.jsxs(Al,{isOpen:t,onClose:o,isCentered:!0,size:"2xl",children:[s.jsx(tr,{}),s.jsxs(Pl,{maxH:"80vh",h:"34rem",children:[s.jsx(nr,{children:r("accessibility.about")}),s.jsx(Ha,{}),s.jsx(sr,{display:"flex",flexDir:"column",gap:4,children:s.jsxs(Ca,{templateColumns:"repeat(2, 1fr)",h:"full",children:[s.jsx(Pr,{backgroundColor:"base.750",borderRadius:"base",p:"4",h:"full",children:s.jsxs(io,{children:[s.jsxs(L,{position:"sticky",top:"0",backgroundColor:"base.750",p:1,alignItems:"center",children:[s.jsx(ns,{size:"md",children:r("common.localSystem")}),s.jsx(Cs,{}),s.jsx(jt,{label:r("common.copy"),children:s.jsx(je,{onClick:f,isDisabled:!c,"aria-label":r("common.copy"),icon:s.jsx(el,{}),variant:"ghost"})})]}),l.map(({name:m,version:g},p)=>s.jsxs(Ca,{py:"2",px:"1",w:"full",templateColumns:"repeat(2, 1fr)",children:[s.jsx(pe,{children:m}),s.jsx(pe,{children:g||r("common.notInstalled")})]},p))]})}),s.jsx(Pr,{children:s.jsxs(L,{flexDir:"column",gap:3,justifyContent:"center",alignItems:"center",h:"full",children:[s.jsx(ur,{src:eO,alt:"invoke-logo",w:"120px"}),d&&s.jsx(pe,{children:`v${d==null?void 0:d.version}`}),s.jsxs(Ca,{templateColumns:"repeat(2, 1fr)",gap:"3",children:[s.jsx(Pr,{children:s.jsx(Oi,{href:e0,label:r("common.githubLabel")})}),s.jsx(Pr,{children:s.jsx(Oi,{href:Ik,label:r("common.discordLabel")})})]}),s.jsx(ns,{fontSize:"large",children:r("common.aboutHeading")}),s.jsx(pe,{fontSize:"sm",children:r("common.aboutDesc")}),s.jsx(Oi,{href:Ev,label:Ev})]})})]})}),s.jsx(El,{})]})]})]})},nO=u.memo(tO),sO=()=>{const{t:e}=R(),t=u.useMemo(()=>({title:e("hotkeys.appHotkeys"),hotkeyListItems:[{title:e("hotkeys.invoke.title"),desc:e("hotkeys.invoke.desc"),hotkeys:[["Ctrl","Enter"]]},{title:e("hotkeys.cancel.title"),desc:e("hotkeys.cancel.desc"),hotkeys:[["Shift","X"]]},{title:e("hotkeys.cancelAndClear.title"),desc:e("hotkeys.cancelAndClear.desc"),hotkeys:[["Shift","Ctrl","X"],["Shift","Cmd","X"]]},{title:e("hotkeys.focusPrompt.title"),desc:e("hotkeys.focusPrompt.desc"),hotkeys:[["Alt","A"]]},{title:e("hotkeys.toggleOptions.title"),desc:e("hotkeys.toggleOptions.desc"),hotkeys:[["T"],["O"]]},{title:e("hotkeys.toggleGallery.title"),desc:e("hotkeys.toggleGallery.desc"),hotkeys:[["G"]]},{title:e("hotkeys.toggleOptionsAndGallery.title"),desc:e("hotkeys.toggleOptionsAndGallery.desc"),hotkeys:[["F"]]},{title:e("hotkeys.resetOptionsAndGallery.title"),desc:e("hotkeys.resetOptionsAndGallery.desc"),hotkeys:[["Shift","R"]]},{title:e("hotkeys.maximizeWorkSpace.title"),desc:e("hotkeys.maximizeWorkSpace.desc"),hotkeys:[["F"]]},{title:e("hotkeys.changeTabs.title"),desc:e("hotkeys.changeTabs.desc"),hotkeys:[["1 - 6"]]}]}),[e]),n=u.useMemo(()=>({title:e("hotkeys.generalHotkeys"),hotkeyListItems:[{title:e("hotkeys.remixImage.title"),desc:e("hotkeys.remixImage.desc"),hotkeys:[["R"]]},{title:e("hotkeys.setPrompt.title"),desc:e("hotkeys.setPrompt.desc"),hotkeys:[["P"]]},{title:e("hotkeys.setSeed.title"),desc:e("hotkeys.setSeed.desc"),hotkeys:[["S"]]},{title:e("hotkeys.setParameters.title"),desc:e("hotkeys.setParameters.desc"),hotkeys:[["A"]]},{title:e("hotkeys.upscale.title"),desc:e("hotkeys.upscale.desc"),hotkeys:[["Shift","U"]]},{title:e("hotkeys.showInfo.title"),desc:e("hotkeys.showInfo.desc"),hotkeys:[["I"]]},{title:e("hotkeys.sendToImageToImage.title"),desc:e("hotkeys.sendToImageToImage.desc"),hotkeys:[["Shift","I"]]},{title:e("hotkeys.deleteImage.title"),desc:e("hotkeys.deleteImage.desc"),hotkeys:[["Del"]]}]}),[e]),o=u.useMemo(()=>({title:e("hotkeys.galleryHotkeys"),hotkeyListItems:[{title:e("hotkeys.previousImage.title"),desc:e("hotkeys.previousImage.desc"),hotkeys:[["Arrow Left"]]},{title:e("hotkeys.nextImage.title"),desc:e("hotkeys.nextImage.desc"),hotkeys:[["Arrow Right"]]},{title:e("hotkeys.increaseGalleryThumbSize.title"),desc:e("hotkeys.increaseGalleryThumbSize.desc"),hotkeys:[["Shift","Up"]]},{title:e("hotkeys.decreaseGalleryThumbSize.title"),desc:e("hotkeys.decreaseGalleryThumbSize.desc"),hotkeys:[["Shift","Down"]]}]}),[e]),r=u.useMemo(()=>({title:e("hotkeys.unifiedCanvasHotkeys"),hotkeyListItems:[{title:e("hotkeys.selectBrush.title"),desc:e("hotkeys.selectBrush.desc"),hotkeys:[["B"]]},{title:e("hotkeys.selectEraser.title"),desc:e("hotkeys.selectEraser.desc"),hotkeys:[["E"]]},{title:e("hotkeys.decreaseBrushSize.title"),desc:e("hotkeys.decreaseBrushSize.desc"),hotkeys:[["["]]},{title:e("hotkeys.increaseBrushSize.title"),desc:e("hotkeys.increaseBrushSize.desc"),hotkeys:[["]"]]},{title:e("hotkeys.decreaseBrushOpacity.title"),desc:e("hotkeys.decreaseBrushOpacity.desc"),hotkeys:[["Shift","["]]},{title:e("hotkeys.increaseBrushOpacity.title"),desc:e("hotkeys.increaseBrushOpacity.desc"),hotkeys:[["Shift","]"]]},{title:e("hotkeys.moveTool.title"),desc:e("hotkeys.moveTool.desc"),hotkeys:[["V"]]},{title:e("hotkeys.fillBoundingBox.title"),desc:e("hotkeys.fillBoundingBox.desc"),hotkeys:[["Shift","F"]]},{title:e("hotkeys.eraseBoundingBox.title"),desc:e("hotkeys.eraseBoundingBox.desc"),hotkeys:[["Delete","Backspace"]]},{title:e("hotkeys.colorPicker.title"),desc:e("hotkeys.colorPicker.desc"),hotkeys:[["C"]]},{title:e("hotkeys.toggleSnap.title"),desc:e("hotkeys.toggleSnap.desc"),hotkeys:[["N"]]},{title:e("hotkeys.quickToggleMove.title"),desc:e("hotkeys.quickToggleMove.desc"),hotkeys:[["Hold Space"]]},{title:e("hotkeys.toggleLayer.title"),desc:e("hotkeys.toggleLayer.desc"),hotkeys:[["Q"]]},{title:e("hotkeys.clearMask.title"),desc:e("hotkeys.clearMask.desc"),hotkeys:[["Shift","C"]]},{title:e("hotkeys.hideMask.title"),desc:e("hotkeys.hideMask.desc"),hotkeys:[["H"]]},{title:e("hotkeys.showHideBoundingBox.title"),desc:e("hotkeys.showHideBoundingBox.desc"),hotkeys:[["Shift","H"]]},{title:e("hotkeys.mergeVisible.title"),desc:e("hotkeys.mergeVisible.desc"),hotkeys:[["Shift","M"]]},{title:e("hotkeys.saveToGallery.title"),desc:e("hotkeys.saveToGallery.desc"),hotkeys:[["Shift","S"]]},{title:e("hotkeys.copyToClipboard.title"),desc:e("hotkeys.copyToClipboard.desc"),hotkeys:[["Ctrl","C"]]},{title:e("hotkeys.downloadImage.title"),desc:e("hotkeys.downloadImage.desc"),hotkeys:[["Shift","D"]]},{title:e("hotkeys.undoStroke.title"),desc:e("hotkeys.undoStroke.desc"),hotkeys:[["Ctrl","Z"]]},{title:e("hotkeys.redoStroke.title"),desc:e("hotkeys.redoStroke.desc"),hotkeys:[["Ctrl","Shift","Z"],["Ctrl","Y"]]},{title:e("hotkeys.resetView.title"),desc:e("hotkeys.resetView.desc"),hotkeys:[["R"]]},{title:e("hotkeys.previousStagingImage.title"),desc:e("hotkeys.previousStagingImage.desc"),hotkeys:[["Arrow Left"]]},{title:e("hotkeys.nextStagingImage.title"),desc:e("hotkeys.nextStagingImage.desc"),hotkeys:[["Arrow Right"]]},{title:e("hotkeys.acceptStagingImage.title"),desc:e("hotkeys.acceptStagingImage.desc"),hotkeys:[["Enter"]]}]}),[e]),l=u.useMemo(()=>({title:e("hotkeys.nodesHotkeys"),hotkeyListItems:[{title:e("hotkeys.addNodes.title"),desc:e("hotkeys.addNodes.desc"),hotkeys:[["Shift","A"],["Space"]]}]}),[e]);return u.useMemo(()=>[t,n,o,r,l],[t,n,o,r,l])},Mk=u.memo(e=>s.jsx(L,{ps:2,pb:4,position:"sticky",zIndex:1,top:0,bg:"base.800",children:s.jsx(ns,{size:"sm",children:e.title})}));Mk.displayName="StickyScrollableHeading";const _k=u.memo(e=>s.jsx(L,{p:4,borderRadius:"base",bg:"base.750",flexDir:"column",gap:4,children:e.children}));_k.displayName="StickyScrollableContent";const Ar=u.memo(e=>s.jsxs(L,{flexDir:"column",children:[s.jsx(Mk,{title:e.title}),s.jsx(_k,{children:e.children})]},e.title));Ar.displayName="StickyScrollable";const oO=e=>{const{t}=R(),{title:n,hotkeys:o,description:r}=e;return s.jsxs(L,{flexDir:"column",gap:2,px:2,children:[s.jsxs(L,{lineHeight:1,gap:1,alignItems:"center",children:[s.jsx(pe,{fontWeight:"semibold",children:n}),s.jsx(Cs,{}),o.map((l,c)=>s.jsxs(u.Fragment,{children:[l.map((d,f)=>s.jsxs(s.Fragment,{children:[s.jsx(JI,{textTransform:"lowercase",children:d},`${l}-${d}-${f}`),f!==l.length-1&&s.jsx(pe,{as:"span",fontWeight:"semibold",children:"+"})]})),c!==o.length-1&&s.jsx(pe,{as:"span",px:2,variant:"subtext",fontWeight:"semibold",children:t("common.or")})]},`${l}-${c}`))]}),s.jsx(pe,{variant:"subtext",children:r})]})},rO=u.memo(oO),lO=({children:e})=>{const{isOpen:t,onOpen:n,onClose:o}=an(),{t:r}=R(),[l,c]=u.useState(""),d=u.useCallback(()=>c(""),[]),f=u.useCallback(p=>c(p.target.value),[]),m=sO(),g=u.useMemo(()=>{if(!l.trim().length)return m;const p=l.trim().toLowerCase(),x=[];return m.forEach(y=>{const S={title:y.title,hotkeyListItems:[]};y.hotkeyListItems.forEach(b=>{(b.title.toLowerCase().includes(p)||b.desc.toLowerCase().includes(p)||b.hotkeys.some(I=>I.some(M=>M.toLowerCase().includes(p))))&&S.hotkeyListItems.push(b)}),S.hotkeyListItems.length&&x.push(S)}),x},[m,l]);return s.jsxs(s.Fragment,{children:[u.cloneElement(e,{onClick:n}),s.jsxs(Al,{isOpen:t,onClose:o,isCentered:!0,size:"2xl",children:[s.jsx(tr,{}),s.jsxs(Pl,{maxH:"80vh",h:"80vh",children:[s.jsx(nr,{children:r("hotkeys.keyboardShortcuts")}),s.jsx(Ha,{}),s.jsxs(sr,{display:"flex",flexDir:"column",gap:4,children:[s.jsxs(y0,{children:[s.jsx(dt,{placeholder:r("hotkeys.searchHotkeys"),value:l,onChange:f}),l.length&&s.jsx(b0,{h:"full",pe:2,children:s.jsx(je,{onClick:d,size:"sm",variant:"ghost","aria-label":r("hotkeys.clearSearch"),boxSize:4,icon:s.jsx(oo,{})})})]}),s.jsx(io,{children:s.jsxs(L,{flexDir:"column",gap:4,children:[g.map(p=>s.jsx(Ar,{title:p.title,children:p.hotkeyListItems.map((x,y)=>s.jsxs(u.Fragment,{children:[s.jsx(rO,{title:x.title,description:x.desc,hotkeys:x.hotkeys}),y<p.hotkeyListItems.length-1&&s.jsx(Sn,{})]},y))},p.title)),!g.length&&s.jsx(Yt,{label:r("hotkeys.noHotkeysFound"),icon:null})]})})]}),s.jsx(El,{})]})]})]})},aO=u.memo(lO),iO=e=>{const{t}=R(),n=J(),{data:o,refetch:r}=eM(void 0,{refetchOnMountOrArgChange:!0,skip:!e}),[l,{isLoading:c}]=tM(),{data:d}=Ro(),f=u.useMemo(()=>!!(d&&(d.queue.in_progress>0||d.queue.pending>0)),[d]),m=u.useCallback(()=>{f||l().unwrap().then(g=>{n(Cy()),n(Ly()),n(Qe({title:t("settings.intermediatesCleared",{count:g}),status:"info"}))}).catch(()=>{n(Qe({title:t("settings.intermediatesClearedFailed"),status:"error"}))})},[t,l,n,f]);return{intermediatesCount:o,clearIntermediates:m,isLoading:c,hasPendingItems:f,refetchIntermediatesCount:r}},cO=mc.enum(["ar","nl","en","fr","de","he","it","ja","ko","pl","pt_BR","pt","ru","zh_CN","es","uk"]),uO=e=>cO.safeParse(e).success,Ak=u.memo(()=>{const{t:e}=R(),t=J(),n=j(d=>d.system.language),o=u.useMemo(()=>[{label:e("common.langArabic",{lng:"ar"}),value:"ar"},{label:e("common.langDutch",{lng:"nl"}),value:"nl"},{label:e("common.langEnglish",{lng:"en"}),value:"en"},{label:e("common.langFrench",{lng:"fr"}),value:"fr"},{label:e("common.langGerman",{lng:"de"}),value:"de"},{label:e("common.langHebrew",{lng:"he"}),value:"he"},{label:e("common.langItalian",{lng:"it"}),value:"it"},{label:e("common.langJapanese",{lng:"ja"}),value:"ja"},{label:e("common.langKorean",{lng:"ko"}),value:"ko"},{label:e("common.langPolish",{lng:"pl"}),value:"pl"},{label:e("common.langBrPortuguese",{lng:"pt_BR"}),value:"pt_BR"},{label:e("common.langPortuguese",{lng:"pt"}),value:"pt"},{label:e("common.langRussian",{lng:"ru"}),value:"ru"},{label:e("common.langSimplifiedChinese",{lng:"zh_CN"}),value:"zh_CN"},{label:e("common.langSpanish",{lng:"es"}),value:"es"},{label:e("common.langUkranian",{lng:"ua"}),value:"ua"}],[e]),r=Kt("localization").isFeatureEnabled,l=u.useMemo(()=>o.find(d=>d.value===n),[n,o]),c=u.useCallback(d=>{uO(d==null?void 0:d.value)&&t(nM(d.value))},[t]);return s.jsxs(U,{isDisabled:!r,children:[s.jsx(Y,{children:e("common.languagePickerLabel")}),s.jsx(Xe,{value:l,options:o,onChange:c})]})});Ak.displayName="SettingsLanguageSelect";const Pk=u.memo(()=>{const{t:e}=R(),t=J(),n=j(d=>d.system.consoleLogLevel),o=j(d=>d.system.shouldLogToConsole),r=u.useMemo(()=>sM.options.map(d=>({label:d,value:d})),[]),l=u.useMemo(()=>r.find(d=>d.value===n),[n,r]),c=u.useCallback(d=>{oM(d==null?void 0:d.value)&&t(rM(d.value))},[t]);return s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:e("common.languagePickerLabel")}),s.jsx(Xe,{value:l,options:r,onChange:c})]})});Pk.displayName="SettingsLogLevelSelect";const dO=({children:e,config:t})=>{const n=J(),{t:o}=R(),[r,l]=u.useState(3),c=(t==null?void 0:t.shouldShowDeveloperSettings)??!0,d=(t==null?void 0:t.shouldShowResetWebUiText)??!0,f=(t==null?void 0:t.shouldShowClearIntermediates)??!0,m=(t==null?void 0:t.shouldShowLocalizationToggle)??!0;u.useEffect(()=>{c||n(t2(!1))},[c,n]);const{isNSFWCheckerAvailable:g,isWatermarkerAvailable:p}=Ty(void 0,{selectFromResult:({data:V})=>({isNSFWCheckerAvailable:(V==null?void 0:V.nsfw_methods.includes("nsfw_checker"))??!1,isWatermarkerAvailable:(V==null?void 0:V.watermarking_methods.includes("invisible_watermark"))??!1})}),{clearIntermediates:x,hasPendingItems:y,intermediatesCount:S,isLoading:b,refetchIntermediatesCount:I}=iO(f),{isOpen:M,onOpen:w,onClose:_}=an(),{isOpen:T,onOpen:D,onClose:A}=an(),F=j(V=>V.generation.shouldUseCpuNoise),Q=j(V=>V.system.shouldConfirmOnDelete),q=j(V=>V.system.enableImageDebugging),G=j(V=>V.ui.shouldShowProgressInViewer),Z=j(V=>V.system.shouldLogToConsole),N=j(V=>V.system.shouldAntialiasProgressImage),z=j(V=>V.system.shouldUseNSFWChecker),$=j(V=>V.system.shouldUseWatermarker),se=j(V=>V.system.shouldEnableInformationalPopovers),he=Ib(),ke=u.useCallback(()=>{I(),w()},[w,I]),Ce=u.useCallback(()=>{he(),_(),D(),setInterval(()=>l(V=>V-1),1e3)},[he,_,D]);u.useEffect(()=>{r<=0&&window.location.reload()},[r]);const ge=u.useCallback(V=>{n(t2(V.target.checked))},[n]),De=u.useCallback(V=>{n(JC(V.target.checked))},[n]),Se=u.useCallback(V=>{n(lM(V.target.checked))},[n]),oe=u.useCallback(V=>{n(aM(V.target.checked))},[n]),re=u.useCallback(V=>{n(Ry(V.target.checked))},[n]),de=u.useCallback(V=>{n(iM(V.target.checked))},[n]),P=u.useCallback(V=>{n(cM(V.target.checked))},[n]),B=u.useCallback(V=>{n(uM(V.target.checked))},[n]),H=u.useCallback(V=>{n(dM(V.target.checked))},[n]);return s.jsxs(s.Fragment,{children:[u.cloneElement(e,{onClick:ke}),s.jsxs(Al,{isOpen:M,onClose:_,size:"2xl",isCentered:!0,children:[s.jsx(tr,{}),s.jsxs(Pl,{maxH:"80vh",h:"68rem",children:[s.jsx(nr,{bg:"none",children:o("common.settingsLabel")}),s.jsx(Ha,{}),s.jsx(sr,{display:"flex",flexDir:"column",gap:4,children:s.jsx(io,{children:s.jsx(L,{flexDir:"column",gap:4,children:s.jsxs(wn,{formLabelProps:{flexGrow:1},children:[s.jsx(Ar,{title:o("settings.general"),children:s.jsxs(U,{children:[s.jsx(Y,{children:o("settings.confirmOnDelete")}),s.jsx(kt,{isChecked:Q,onChange:De})]})}),s.jsxs(Ar,{title:o("settings.generation"),children:[s.jsxs(U,{isDisabled:!g,children:[s.jsx(Y,{children:o("settings.enableNSFWChecker")}),s.jsx(kt,{isChecked:z,onChange:Se})]}),s.jsxs(U,{isDisabled:!p,children:[s.jsx(Y,{children:o("settings.enableInvisibleWatermark")}),s.jsx(kt,{isChecked:$,onChange:oe})]})]}),s.jsxs(Ar,{title:o("settings.ui"),children:[s.jsxs(U,{children:[s.jsx(Y,{children:o("settings.showProgressInViewer")}),s.jsx(kt,{isChecked:G,onChange:re})]}),s.jsxs(U,{children:[s.jsx(Y,{children:o("settings.antialiasProgressImages")}),s.jsx(kt,{isChecked:N,onChange:de})]}),s.jsxs(U,{children:[s.jsx(zt,{feature:"noiseUseCPU",inPortal:!1,children:s.jsx(Y,{children:o("parameters.useCpuNoise")})}),s.jsx(kt,{isChecked:F,onChange:H})]}),m&&s.jsx(Ak,{}),s.jsxs(U,{children:[s.jsx(Y,{children:o("settings.enableInformationalPopovers")}),s.jsx(kt,{isChecked:se,onChange:P})]})]}),c&&s.jsxs(Ar,{title:o("settings.developer"),children:[s.jsxs(U,{children:[s.jsx(Y,{children:o("settings.shouldLogToConsole")}),s.jsx(kt,{isChecked:Z,onChange:ge})]}),s.jsx(Pk,{}),s.jsxs(U,{children:[s.jsx(Y,{children:o("settings.enableImageDebugging")}),s.jsx(kt,{isChecked:q,onChange:B})]})]}),f&&s.jsxs(Ar,{title:o("settings.clearIntermediates"),children:[s.jsx(Ge,{tooltip:y?o("settings.clearIntermediatesDisabled"):void 0,colorScheme:"warning",onClick:x,isLoading:b,isDisabled:!S||y,children:o("settings.clearIntermediatesWithCount",{count:S??0})}),s.jsx(pe,{fontWeight:"bold",children:o("settings.clearIntermediatesDesc1")}),s.jsx(pe,{variant:"subtext",children:o("settings.clearIntermediatesDesc2")}),s.jsx(pe,{variant:"subtext",children:o("settings.clearIntermediatesDesc3")})]}),s.jsxs(Ar,{title:o("settings.resetWebUI"),children:[s.jsx(Ge,{colorScheme:"error",onClick:Ce,children:o("settings.resetWebUI")}),d&&s.jsxs(s.Fragment,{children:[s.jsx(pe,{variant:"subtext",children:o("settings.resetWebUIDesc1")}),s.jsx(pe,{variant:"subtext",children:o("settings.resetWebUIDesc2")})]})]})]})})})}),s.jsx(El,{})]})]}),s.jsxs(Al,{closeOnOverlayClick:!1,isOpen:T,onClose:A,isCentered:!0,closeOnEsc:!1,children:[s.jsx(tr,{backdropFilter:"blur(40px)"}),s.jsxs(Pl,{children:[s.jsx(nr,{}),s.jsx(sr,{children:s.jsx(L,{justifyContent:"center",children:s.jsx(pe,{fontSize:"lg",children:s.jsxs(pe,{children:[o("settings.resetComplete")," ",o("settings.reloadingIn")," ",r,"..."]})})})}),s.jsx(El,{})]})]})]})},fO=u.memo(dO),mO=()=>{const{t:e}=R(),{isOpen:t,onOpen:n,onClose:o}=an();Sf(o);const r=Kt("bugLink").isFeatureEnabled,l=Kt("discordLink").isFeatureEnabled,c=Kt("githubLink").isFeatureEnabled;return s.jsxs(yf,{isOpen:t,onOpen:n,onClose:o,children:[s.jsx(bf,{as:je,variant:"link","aria-label":e("accessibility.menu"),icon:s.jsx(Hj,{fontSize:20}),boxSize:8}),s.jsxs(zr,{children:[s.jsxs(Bi,{title:e("common.communityLabel"),children:[c&&s.jsx(it,{as:"a",href:e0,target:"_blank",icon:s.jsx(PE,{}),children:e("common.githubLabel")}),r&&s.jsx(it,{as:"a",href:`${e0}/issues`,target:"_blank",icon:s.jsx(x7,{}),children:e("common.reportBugLabel")}),l&&s.jsx(it,{as:"a",href:Ik,target:"_blank",icon:s.jsx(AE,{}),children:e("common.discordLabel")})]}),s.jsxs(Bi,{title:e("common.settingsLabel"),children:[s.jsx(aO,{children:s.jsx(it,{as:"button",icon:s.jsx(R7,{}),children:e("common.hotkeysLabel")})}),s.jsx(fO,{children:s.jsx(it,{as:"button",icon:s.jsx(K7,{}),children:e("common.settingsLabel")})})]}),s.jsx(Bi,{title:e("accessibility.about"),children:s.jsx(nO,{children:s.jsx(it,{as:"button",icon:s.jsx(Mf,{}),children:e("accessibility.about")})})})]})]})},hO=u.memo(mO),pO=()=>{const e=j(n=>n.system.isConnected),{t}=R();return e?null:s.jsx(jt,{label:t("common.statusDisconnected"),placement:"end",shouldWrapChildren:!0,gutter:10,children:s.jsx(Vn,{as:Y0,color:"error.300"})})},gO=u.memo(pO),xO=e=>{const{t}=R();return e.panelApi.isCollapsed?s.jsx(v0,{children:s.jsx(L,{pos:"absolute",transform:"translate(0, -50%)",minW:8,top:"50%",insetInlineEnd:"21px",children:s.jsx(jt,{label:t("accessibility.showGalleryPanel"),placement:"start",children:s.jsx(je,{"aria-label":t("accessibility.showGalleryPanel"),onClick:e.panelApi.expand,icon:s.jsx(T7,{size:"20px"}),p:0,h:48,borderEndRadius:0})})})}):null},vO=u.memo(xO),CO=({sx:e})=>{const{t}=R(),{cancelQueueItem:n,isLoading:o,isDisabled:r}=V0();return s.jsx(je,{isDisabled:r,isLoading:o,"aria-label":t("queue.cancel"),tooltip:t("queue.cancelTooltip"),icon:s.jsx(oo,{size:"16px"}),onClick:n,colorScheme:"error",sx:e})},yO=u.memo(CO),Uu={borderStartRadius:0,flexGrow:1},bO=e=>{const{t}=R(),{queueBack:n,isLoading:o,isDisabled:r}=U0(),{data:l}=Ro(),c=u.useMemo(()=>!r&&(l!=null&&l.processor.is_processing)?s.jsx(Vn,{boxSize:6,as:C7,animation:By}):s.jsx(gg,{size:"16px"}),[r,l==null?void 0:l.processor.is_processing]),d=an();return e.panelApi.isCollapsed?s.jsx(v0,{children:s.jsxs(L,{pos:"absolute",transform:"translate(0, -50%)",minW:8,top:"50%",insetInlineStart:"63px",direction:"column",gap:2,h:48,children:[s.jsxs(wt,{orientation:"vertical",flexGrow:3,children:[s.jsx(je,{tooltip:t("accessibility.showOptionsPanel"),"aria-label":t("accessibility.showOptionsPanel"),onClick:e.panelApi.expand,sx:Uu,icon:s.jsx(tj,{size:"16px"})}),s.jsx(je,{"aria-label":t("queue.queueBack"),onClick:n,isLoading:o,isDisabled:r,icon:c,colorScheme:"invokeYellow",tooltip:s.jsx(Gf,{}),sx:Uu}),s.jsx(yO,{sx:Uu})]}),s.jsx(BS,{sx:Uu,onOpen:d.onOpen}),s.jsx(Uf,{disclosure:d})]})}):null},jO=u.memo(bO),Dv=e=>{const t=u.useRef(null),[n,o]=u.useState(e.unit==="percentages"?e.minSize:0);u.useLayoutEffect(()=>{var _;if(e.unit==="percentages"||!e.panelGroupRef.current)return;const S=e.panelGroupRef.current.getId(),b=qf(S),I=Dl(S);if(!b)return;const M=new ResizeObserver(()=>{if(!(t!=null&&t.current))return;const T=Yh(e.minSize,e.panelGroupRef,e.panelGroupDirection);o(T),t.current.resize(T)});M.observe(b),I.forEach(T=>M.observe(T));const w=Yh(e.minSize,e.panelGroupRef,e.panelGroupDirection);return(_=t.current)==null||_.resize(w),()=>{M.disconnect()}},[e]);const[r,l]=u.useState(()=>{var S;return!!((S=t.current)!=null&&S.isCollapsed())}),c=u.useCallback(()=>{l(!0)},[]),d=u.useCallback(()=>{l(!1)},[]),f=u.useCallback(()=>{var S,b,I;(S=t.current)!=null&&S.isCollapsed()?(b=t.current)==null||b.expand():(I=t.current)==null||I.collapse()},[]),m=u.useCallback(()=>{var S;(S=t.current)==null||S.expand()},[]),g=u.useCallback(()=>{var S;(S=t.current)==null||S.collapse()},[]),p=u.useCallback(S=>{var I,M;if(e.unit==="percentages"){(I=t.current)==null||I.resize(S);return}const b=Yh(S,e.panelGroupRef,e.panelGroupDirection);(M=t.current)==null||M.resize(b)},[e]),x=u.useCallback(()=>{var S;(S=t.current)==null||S.resize(n)},[n]),y=u.useCallback(()=>{var S,b;if(Math.abs((((S=t.current)==null?void 0:S.getSize())??0)-n)<.01){g();return}(b=t.current)==null||b.resize(n)},[n,g]);return{ref:t,minSize:n,isCollapsed:r,onCollapse:c,onExpand:d,reset:x,toggle:f,expand:m,collapse:g,resize:p,onDoubleClickHandle:y}},Yh=(e,t,n)=>{if(!t.current)return 0;const o=t.current.getId(),r=qf(o);if(!r)return 0;let l=n==="horizontal"?r.offsetWidth:r.offsetHeight;return Dl(o).forEach(c=>{l-=n==="horizontal"?c.offsetWidth:c.offsetHeight}),e/l*100},Ac=u.memo(e=>{const{onOpen:t,isOpen:n}=e,{t:o}=R();return s.jsx(jt,{label:o("embedding.addEmbedding"),children:s.jsx(je,{variant:"promptOverlay",isDisabled:n,"aria-label":o("embedding.addEmbedding"),icon:s.jsx(y7,{}),onClick:t})})});Ac.displayName="AddEmbeddingButton";const SO=()=>Zo("embedding.noMatchingEmbedding"),Ek=u.memo(({onSelect:e,onClose:t})=>{const{t:n}=R(),o=j(g=>{var p;return(p=g.generation.model)==null?void 0:p.base_model}),r=u.useCallback(g=>{const p=o===g.base_model;return!!!o||!p},[o]),{data:l,isLoading:c}=fM(),d=u.useCallback(g=>{g&&e(g.model_name)},[e]),{options:f,onChange:m}=ws({modelEntities:l,getIsDisabled:r,onChange:d});return s.jsx(U,{children:s.jsx(Xe,{placeholder:n(c?"common.loading":"embedding.addEmbedding"),defaultMenuIsOpen:!0,autoFocus:!0,value:null,options:f,noOptionsMessage:SO,onChange:m,onMenuClose:t,"data-testid":"add-embedding",sx:kO})})});Ek.displayName="EmbeddingSelect";const kO={w:"full"},Pc=u.memo(e=>{const{onSelect:t,isOpen:n,onClose:o,width:r,children:l}=e;return s.jsxs(Zr,{isOpen:n,onClose:o,placement:"bottom",openDelay:0,closeDelay:0,closeOnBlur:!0,returnFocusOnClose:!0,isLazy:!0,children:[s.jsx(Oy,{children:l}),s.jsx(qr,{p:0,insetBlockStart:-1,shadow:"dark-lg",borderColor:"invokeBlue.300",borderWidth:"2px",borderStyle:"solid",children:s.jsx(Qr,{p:0,width:`calc(${r}px - 0.25rem)`,children:s.jsx(Ek,{onClose:o,onSelect:t})})})]})});Pc.displayName="EmbeddingPopover";const Jf=({prompt:e,textareaRef:t,onChange:n})=>{const{isOpen:o,onClose:r,onOpen:l}=an(),c=u.useCallback(x=>{n(x.target.value)},[n]),d=u.useCallback(x=>{if(!t.current)return;const y=t.current.selectionStart;if(zn(y))return;let S=e.slice(0,y);S[S.length-1]!=="<"&&(S+="<"),S+=`${x}>`;const b=S.length;S+=e.slice(y),_0.flushSync(()=>{n(S)}),t.current.selectionStart=b,t.current.selectionEnd=b},[t,n,e]),f=u.useCallback(()=>{var x;(x=t.current)==null||x.focus()},[t]),m=u.useCallback(()=>{r(),f()},[f,r]),g=u.useCallback(x=>{d(x),m()},[m,d]),p=u.useCallback(x=>{x.key==="<"&&(l(),x.preventDefault())},[l]);return{onChange:c,isOpen:o,onClose:r,onOpen:l,onSelectEmbedding:g,onKeyDown:p,onFocus:f}},Ec=u.memo(e=>s.jsx(L,{pos:"absolute",insetBlockStart:0,insetInlineEnd:0,flexDir:"column",p:2,gap:2,alignItems:"center",justifyContent:"center",children:e.children}));Ec.displayName="PromptOverlayButtonWrapper";const zg=u.memo(()=>{var p;const e=J(),t=j(x=>x.generation.negativePrompt),n=u.useRef(null),{t:o}=R(),r=u.useCallback(x=>{e(ad(x))},[e]),{onChange:l,isOpen:c,onClose:d,onOpen:f,onSelectEmbedding:m,onKeyDown:g}=Jf({prompt:t,textareaRef:n,onChange:r});return s.jsx(Pc,{isOpen:c,onClose:d,onSelect:m,width:(p=n.current)==null?void 0:p.clientWidth,children:s.jsxs(We,{pos:"relative",children:[s.jsx(or,{id:"negativePrompt",name:"negativePrompt",ref:n,value:t,placeholder:o("parameters.negativePromptPlaceholder"),onChange:l,onKeyDown:g,fontSize:"sm",variant:"darkFilled"}),s.jsx(Ec,{children:s.jsx(Ac,{isOpen:c,onOpen:f})})]})})});zg.displayName="ParamNegativePrompt";function wO(e){return Ie({tag:"svg",attr:{fill:"currentColor",viewBox:"0 0 16 16"},child:[{tag:"path",attr:{fillRule:"evenodd",d:"M1.114 8.063V7.9c1.005-.102 1.497-.615 1.497-1.6V4.503c0-1.094.39-1.538 1.354-1.538h.273V2h-.376C2.25 2 1.49 2.759 1.49 4.352v1.524c0 1.094-.376 1.456-1.49 1.456v1.299c1.114 0 1.49.362 1.49 1.456v1.524c0 1.593.759 2.352 2.372 2.352h.376v-.964h-.273c-.964 0-1.354-.444-1.354-1.538V9.663c0-.984-.492-1.497-1.497-1.6ZM14.886 7.9v.164c-1.005.103-1.497.616-1.497 1.6v1.798c0 1.094-.39 1.538-1.354 1.538h-.273v.964h.376c1.613 0 2.372-.759 2.372-2.352v-1.524c0-1.094.376-1.456 1.49-1.456v-1.3c-1.114 0-1.49-.362-1.49-1.456V4.352C14.51 2.759 13.75 2 12.138 2h-.376v.964h.273c.964 0 1.354.444 1.354 1.538V6.3c0 .984.492 1.497 1.497 1.6ZM7.5 11.5V9.207l-1.621 1.621-.707-.707L6.792 8.5H4.5v-1h2.293L5.172 5.879l.707-.707L7.5 6.792V4.5h1v2.293l1.621-1.621.707.707L9.208 7.5H11.5v1H9.207l1.621 1.621-.707.707L8.5 9.208V11.5h-1Z"},child:[]}]})(e)}const IO={svg:{animation:By}},Dk=u.memo(()=>{const{t:e}=R(),t=j(l=>l.dynamicPrompts.isLoading),n=j(l=>!!(l.dynamicPrompts.isError||l.dynamicPrompts.parsingError)),{isOpen:o,onOpen:r}=$b();return s.jsx(jt,{label:e(t?"dynamicPrompts.loading":"dynamicPrompts.showDynamicPrompts"),children:s.jsx(je,{size:"sm",variant:"promptOverlay",isDisabled:o,"aria-label":e("dynamicPrompts.showDynamicPrompts"),icon:s.jsx(wO,{}),onClick:r,sx:t?IO:void 0,colorScheme:n&&!t?"error":"base"})})});Dk.displayName="ShowDynamicPromptsPreviewButton";const Lk=u.memo(()=>{const e=j(l=>l.sdxl.shouldConcatSDXLStylePrompt),t=J(),{t:n}=R(),o=u.useCallback(()=>{t(mM(!e))},[t,e]),r=u.useMemo(()=>n(e?"sdxl.concatPromptStyle":"sdxl.freePromptStyle"),[e,n]);return s.jsx(jt,{label:r,children:s.jsx(je,{"aria-label":r,onClick:o,icon:e?s.jsx(B7,{size:14}):s.jsx(O7,{size:14}),variant:"promptOverlay",fontSize:12,px:.5})})});Lk.displayName="SDXLConcatButton";const Hg=u.memo(()=>{var S,b;const e=J(),t=j(I=>I.generation.positivePrompt),n=(S=j(I=>I.generation.model))==null?void 0:S.base_model,o=u.useRef(null),{t:r}=R(),l=u.useCallback(I=>{e(ld(I))},[e]),{onChange:c,isOpen:d,onClose:f,onOpen:m,onSelectEmbedding:g,onKeyDown:p,onFocus:x}=Jf({prompt:t,textareaRef:o,onChange:l}),y=u.useCallback(I=>{x(),I.preventDefault()},[x]);return Oe("alt+a",y,[]),s.jsx(Pc,{isOpen:d,onClose:f,onSelect:g,width:(b=o.current)==null?void 0:b.clientWidth,children:s.jsxs(We,{pos:"relative",children:[s.jsx(or,{id:"prompt",name:"prompt",ref:o,value:t,placeholder:r("parameters.positivePromptPlaceholder"),onChange:c,minH:28,onKeyDown:p,variant:"darkFilled"}),s.jsxs(Ec,{children:[s.jsx(Ac,{isOpen:d,onOpen:m}),n==="sdxl"&&s.jsx(Lk,{}),s.jsx(Dk,{})]})]})})});Hg.displayName="ParamPositivePrompt";const Tk=u.memo(()=>s.jsxs(L,{flexDir:"column",gap:2,children:[s.jsx(Hg,{}),s.jsx(zg,{})]}));Tk.displayName="Prompts";const Rk=u.memo(()=>{var x;const e=J(),t=j(y=>y.sdxl.negativeStylePrompt),n=u.useRef(null),{t:o}=R(),r=u.useCallback(y=>{e(cd(y))},[e]),{onChange:l,isOpen:c,onClose:d,onOpen:f,onSelectEmbedding:m,onKeyDown:g,onFocus:p}=Jf({prompt:t,textareaRef:n,onChange:r});return Oe("alt+a",p,[]),s.jsx(Pc,{isOpen:c,onClose:d,onSelect:m,width:(x=n.current)==null?void 0:x.clientWidth,children:s.jsxs(We,{pos:"relative",children:[s.jsx(or,{id:"prompt",name:"prompt",ref:n,value:t,placeholder:o("sdxl.negStylePrompt"),onChange:l,onKeyDown:g,fontSize:"sm",variant:"darkFilled"}),s.jsx(Ec,{children:s.jsx(Ac,{isOpen:c,onOpen:f})})]})})});Rk.displayName="ParamSDXLNegativeStylePrompt";const Bk=u.memo(()=>{var p;const e=J(),t=j(x=>x.sdxl.positiveStylePrompt),n=u.useRef(null),{t:o}=R(),r=u.useCallback(x=>{e(id(x))},[e]),{onChange:l,isOpen:c,onClose:d,onOpen:f,onSelectEmbedding:m,onKeyDown:g}=Jf({prompt:t,textareaRef:n,onChange:r});return s.jsx(Pc,{isOpen:c,onClose:d,onSelect:m,width:(p=n.current)==null?void 0:p.clientWidth,children:s.jsxs(We,{pos:"relative",children:[s.jsx(or,{id:"prompt",name:"prompt",ref:n,value:t,placeholder:o("sdxl.posStylePrompt"),onChange:l,onKeyDown:g,fontSize:"sm",variant:"darkFilled"}),s.jsx(Ec,{children:s.jsx(Ac,{isOpen:c,onOpen:f})})]})})});Bk.displayName="ParamSDXLPositiveStylePrompt";const Ok=u.memo(()=>{const e=j(t=>t.sdxl.shouldConcatSDXLStylePrompt);return s.jsxs(L,{flexDir:"column",gap:2,pos:"relative",children:[s.jsx(Hg,{}),!e&&s.jsx(Bk,{}),s.jsx(zg,{}),!e&&s.jsx(Rk,{})]})});Ok.displayName="SDXLPrompts";const MO=()=>{const e=j(p=>p.generation.cfgRescaleMultiplier),t=j(p=>p.config.sd.cfgRescaleMultiplier.initial),n=j(p=>p.config.sd.cfgRescaleMultiplier.sliderMin),o=j(p=>p.config.sd.cfgRescaleMultiplier.sliderMax),r=j(p=>p.config.sd.cfgRescaleMultiplier.numberInputMin),l=j(p=>p.config.sd.cfgRescaleMultiplier.numberInputMax),c=j(p=>p.config.sd.cfgRescaleMultiplier.coarseStep),d=j(p=>p.config.sd.cfgRescaleMultiplier.fineStep),f=J(),{t:m}=R(),g=u.useCallback(p=>f(gp(p)),[f]);return s.jsxs(U,{children:[s.jsx(zt,{feature:"paramCFGRescaleMultiplier",children:s.jsx(Y,{children:m("parameters.cfgRescaleMultiplier")})}),s.jsx(Ue,{value:e,defaultValue:t,min:n,max:o,step:c,fineStep:d,onChange:g,marks:!0}),s.jsx($e,{value:e,defaultValue:t,min:r,max:l,step:c,fineStep:d,onChange:g})]})},_O=u.memo(MO),AO=()=>{const e=j(x=>x.generation.clipSkip),t=j(x=>x.config.sd.clipSkip.initial),n=j(x=>x.config.sd.clipSkip.sliderMin),o=j(x=>x.config.sd.clipSkip.numberInputMin),r=j(x=>x.config.sd.clipSkip.coarseStep),l=j(x=>x.config.sd.clipSkip.fineStep),{model:c}=j(x=>x.generation),d=J(),{t:f}=R(),m=u.useCallback(x=>{d(hM(x))},[d]),g=u.useMemo(()=>c?Ru[c.base_model].maxClip:Ru["sd-1"].maxClip,[c]),p=u.useMemo(()=>c?Ru[c.base_model].markers:Ru["sd-1"].markers,[c]);return(c==null?void 0:c.base_model)==="sdxl"?null:s.jsxs(U,{children:[s.jsx(zt,{feature:"clipSkip",children:s.jsx(Y,{children:f("parameters.clipSkip")})}),s.jsx(Ue,{value:e,defaultValue:t,min:n,max:g,step:r,fineStep:l,onChange:m,marks:p}),s.jsx($e,{value:e,defaultValue:t,min:o,max:g,step:r,fineStep:l,onChange:m})]})},PO=u.memo(AO),EO=()=>{const{t:e}=R(),t=j(r=>r.generation.seamlessXAxis),n=J(),o=u.useCallback(r=>{n(pM(r.target.checked))},[n]);return s.jsxs(U,{children:[s.jsx(Y,{children:e("parameters.seamlessXAxis")}),s.jsx(kt,{isChecked:t,onChange:o})]})},DO=u.memo(EO),LO=()=>{const{t:e}=R(),t=j(r=>r.generation.seamlessYAxis),n=J(),o=u.useCallback(r=>{n(gM(r.target.checked))},[n]);return s.jsxs(U,{children:[s.jsx(Y,{children:e("parameters.seamlessYAxis")}),s.jsx(kt,{isChecked:t,onChange:o})]})},TO=u.memo(LO),RO=Fe(Ss,e=>{const{model:t,vae:n}=e;return{model:t,vae:n}}),BO=()=>{const e=J(),{t}=R(),{model:n,vae:o}=j(RO),{data:r,isLoading:l}=Py(),c=u.useCallback(y=>{const S=(n==null?void 0:n.base_model)===y.base_model;return!!!(n!=null&&n.base_model)||!S},[n==null?void 0:n.base_model]),d=u.useCallback(y=>{e(Ii(y?L0(y,"base_model","model_name"):null))},[e]),{options:f,value:m,onChange:g,placeholder:p,noOptionsMessage:x}=ws({modelEntities:r,onChange:d,selectedModel:o?{...o,model_type:"vae"}:null,isLoading:l,getIsDisabled:c});return s.jsxs(U,{isDisabled:!f.length,isInvalid:!f.length,children:[s.jsx(zt,{feature:"paramVAE",children:s.jsx(Y,{children:t("modelManager.vae")})}),s.jsx(Xe,{isClearable:!0,value:m,placeholder:m?p:t("models.defaultVAE"),options:f,onChange:g,noOptionsMessage:x})]})},OO=u.memo(BO),Lv=[{label:"FP16",value:"fp16"},{label:"FP32",value:"fp32"}],NO=()=>{const{t:e}=R(),t=J(),n=j(l=>l.generation.vaePrecision),o=u.useCallback(l=>{xM(l==null?void 0:l.value)&&t(vM(l.value))},[t]),r=u.useMemo(()=>Lv.find(l=>l.value===n),[n]);return s.jsxs(U,{w:"14rem",flexShrink:0,children:[s.jsx(zt,{feature:"paramVAEPrecision",children:s.jsx(Y,{children:e("modelManager.vaePrecision")})}),s.jsx(Xe,{value:r,options:Lv,onChange:o})]})},FO=u.memo(NO),Ya=e=>{const t=J(),n=u.useMemo(()=>ft(Ny,l=>l.accordions[e.id]??e.defaultIsOpen),[e]),o=j(n),r=u.useCallback(()=>{t(CM({id:e.id,isOpen:!o}))},[e.id,t,o]);return{isOpen:o,onToggle:r}},zO={minW:"9.2rem"},HO={flexGrow:1},$O=Fe(Ss,e=>{const t=[];if(e.vae){let n=e.vae.model_name;e.vaePrecision==="fp16"&&(n+=` ${e.vaePrecision}`),t.push(n)}else e.vaePrecision==="fp16"&&t.push(`VAE ${e.vaePrecision}`);return e.clipSkip&&t.push(`Skip ${e.clipSkip}`),e.cfgRescaleMultiplier&&t.push(`Rescale ${e.cfgRescaleMultiplier}`),(e.seamlessXAxis||e.seamlessYAxis)&&t.push("seamless"),t}),Nk=u.memo(()=>{const e=j($O),{t}=R(),{isOpen:n,onToggle:o}=Ya({id:"advanced-settings",defaultIsOpen:!1});return s.jsx($a,{label:t("accordions.advanced.title"),badges:e,isOpen:n,onToggle:o,children:s.jsxs(L,{gap:4,alignItems:"center",p:4,flexDir:"column",children:[s.jsxs(L,{gap:4,w:"full",children:[s.jsx(OO,{}),s.jsx(FO,{})]}),s.jsxs(wn,{formLabelProps:zO,children:[s.jsx(PO,{}),s.jsx(_O,{})]}),s.jsx(L,{gap:4,w:"full",children:s.jsxs(wn,{formLabelProps:HO,children:[s.jsx(DO,{}),s.jsx(TO,{})]})})]})})});Nk.displayName="AdvancedSettingsAccordion";const VO=()=>{const e=J(),t=j(c=>c.generation.canvasCoherenceMode),{t:n}=R(),o=u.useMemo(()=>[{label:n("parameters.unmasked"),value:"unmasked"},{label:n("unifiedCanvas.mask"),value:"mask"},{label:n("parameters.maskEdge"),value:"edge"}],[n]),r=u.useCallback(c=>{yM(c==null?void 0:c.value)&&e(bM(c.value))},[e]),l=u.useMemo(()=>o.find(c=>c.value===t),[t,o]);return s.jsxs(U,{children:[s.jsx(zt,{feature:"compositingCoherenceMode",children:s.jsx(Y,{children:n("parameters.coherenceMode")})}),s.jsx(Xe,{options:o,value:l,onChange:r})]})},WO=u.memo(VO),UO=()=>{const e=J(),t=j(p=>p.generation.canvasCoherenceSteps),n=j(p=>p.config.sd.canvasCoherenceSteps.initial),o=j(p=>p.config.sd.canvasCoherenceSteps.sliderMin),r=j(p=>p.config.sd.canvasCoherenceSteps.sliderMax),l=j(p=>p.config.sd.canvasCoherenceSteps.numberInputMin),c=j(p=>p.config.sd.canvasCoherenceSteps.numberInputMax),d=j(p=>p.config.sd.canvasCoherenceSteps.coarseStep),f=j(p=>p.config.sd.canvasCoherenceSteps.fineStep),{t:m}=R(),g=u.useCallback(p=>{e(jM(p))},[e]);return s.jsxs(U,{children:[s.jsx(zt,{feature:"compositingCoherenceSteps",children:s.jsx(Y,{children:m("parameters.coherenceSteps")})}),s.jsx(Ue,{min:o,max:r,step:d,fineStep:f,value:t,defaultValue:n,onChange:g,marks:!0}),s.jsx($e,{min:l,max:c,step:d,fineStep:f,value:t,defaultValue:n,onChange:g})]})},GO=u.memo(UO),ZO=()=>{const e=J(),t=j(r=>r.generation.canvasCoherenceStrength),{t:n}=R(),o=u.useCallback(r=>{e(SM(r))},[e]);return s.jsxs(U,{children:[s.jsx(zt,{feature:"compositingStrength",children:s.jsx(Y,{children:n("parameters.coherenceStrength")})}),s.jsx(Ue,{min:0,max:1,step:.01,value:t,defaultValue:.75,onChange:o}),s.jsx($e,{min:0,max:1,step:.01,value:t,defaultValue:.75,onChange:o})]})},qO=u.memo(ZO),QO=()=>{const{t:e}=R(),t=J(),n=j(p=>p.generation.maskBlur),o=j(p=>p.config.sd.maskBlur.initial),r=j(p=>p.config.sd.maskBlur.sliderMin),l=j(p=>p.config.sd.maskBlur.sliderMax),c=j(p=>p.config.sd.maskBlur.numberInputMin),d=j(p=>p.config.sd.maskBlur.numberInputMax),f=j(p=>p.config.sd.maskBlur.coarseStep),m=j(p=>p.config.sd.maskBlur.fineStep),g=u.useCallback(p=>{t(kM(p))},[t]);return s.jsxs(U,{children:[s.jsx(zt,{feature:"compositingBlur",children:s.jsx(Y,{children:e("parameters.maskBlur")})}),s.jsx(Ue,{min:r,max:l,value:n,defaultValue:o,onChange:g,step:f,fineStep:m,marks:!0}),s.jsx($e,{min:c,max:d,value:n,defaultValue:o,onChange:g,step:f,fineStep:m})]})},KO=u.memo(QO),YO=()=>{const e=j(c=>c.generation.maskBlurMethod),t=J(),{t:n}=R(),o=u.useMemo(()=>[{label:n("parameters.boxBlur"),value:"box"},{label:n("parameters.gaussianBlur"),value:"gaussian"}],[n]),r=u.useCallback(c=>{wM(c==null?void 0:c.value)&&t(IM(c.value))},[t]),l=u.useMemo(()=>o.find(c=>c.value===e),[e,o]);return s.jsxs(U,{children:[s.jsx(zt,{feature:"compositingBlurMethod",children:s.jsx(Y,{children:n("parameters.maskBlurMethod")})}),s.jsx(Xe,{value:l,onChange:r,options:o})]})},XO=u.memo(YO),JO=()=>{const{t:e}=R(),t=J(),n=j(d=>d.generation.infillMethod),{data:o}=Ty(),r=u.useMemo(()=>o?o.infill_methods.map(d=>({label:d,value:d})):[],[o]),l=u.useCallback(d=>{!d||!r.find(f=>f.value===d.value)||t(MM(d.value))},[t,r]),c=u.useMemo(()=>r.find(d=>d.value===n),[r,n]);return s.jsxs(U,{isDisabled:r.length===0,children:[s.jsx(zt,{feature:"infillMethod",children:s.jsx(Y,{children:e("parameters.infillMethod")})}),s.jsx(Xe,{value:c,options:r,onChange:l})]})},eN=u.memo(JO),tN=()=>{const e=J(),t=j(x=>x.generation.infillMethod),n=j(x=>x.generation.infillPatchmatchDownscaleSize),o=j(x=>x.config.sd.infillPatchmatchDownscaleSize.initial),r=j(x=>x.config.sd.infillPatchmatchDownscaleSize.sliderMin),l=j(x=>x.config.sd.infillPatchmatchDownscaleSize.sliderMax),c=j(x=>x.config.sd.infillPatchmatchDownscaleSize.numberInputMin),d=j(x=>x.config.sd.infillPatchmatchDownscaleSize.numberInputMax),f=j(x=>x.config.sd.infillPatchmatchDownscaleSize.coarseStep),m=j(x=>x.config.sd.infillPatchmatchDownscaleSize.fineStep),{t:g}=R(),p=u.useCallback(x=>{e(_M(x))},[e]);return s.jsxs(U,{isDisabled:t!=="patchmatch",children:[s.jsx(Y,{children:g("parameters.patchmatchDownScaleSize")}),s.jsx(Ue,{min:r,max:l,step:f,fineStep:m,value:n,defaultValue:o,onChange:p,marks:!0}),s.jsx($e,{min:c,max:d,step:f,fineStep:m,value:n,defaultValue:o,onChange:p})]})},nN=u.memo(tN),sN=()=>{const e=J(),t=j(x=>x.generation.infillTileSize),n=j(x=>x.config.sd.infillTileSize.initial),o=j(x=>x.config.sd.infillTileSize.sliderMin),r=j(x=>x.config.sd.infillTileSize.sliderMax),l=j(x=>x.config.sd.infillTileSize.numberInputMin),c=j(x=>x.config.sd.infillTileSize.numberInputMax),d=j(x=>x.config.sd.infillTileSize.coarseStep),f=j(x=>x.config.sd.infillTileSize.fineStep),m=j(x=>x.generation.infillMethod),{t:g}=R(),p=u.useCallback(x=>{e(AM(x))},[e]);return s.jsxs(U,{isDisabled:m!=="tile",children:[s.jsx(Y,{children:g("parameters.tileSize")}),s.jsx(Ue,{min:o,max:r,value:t,defaultValue:n,onChange:p,step:d,fineStep:f,marks:!0}),s.jsx($e,{min:l,max:c,value:t,defaultValue:n,onChange:p,step:d,fineStep:f})]})},oN=u.memo(sN),rN=()=>{const e=j(t=>t.generation.infillMethod);return e==="tile"?s.jsx(oN,{}):e==="patchmatch"?s.jsx(nN,{}):null},lN=u.memo(rN),Tv={minW:"4.5rem"},Fk=u.memo(()=>{const{t:e}=R(),{isOpen:t,onToggle:n}=Ya({id:"compositing-settings",defaultIsOpen:!1});return s.jsx($a,{isOpen:t,onToggle:n,label:e("accordions.compositing.title"),children:s.jsxs(Xr,{variant:"collapse",children:[s.jsxs(Jr,{children:[s.jsx(hn,{children:e("accordions.compositing.coherenceTab")}),s.jsx(hn,{children:e("accordions.compositing.infillTab")})]}),s.jsxs(Rl,{children:[s.jsx(An,{children:s.jsx(L,{gap:4,p:4,flexDir:"column",children:s.jsxs(wn,{formLabelProps:Tv,children:[s.jsx(WO,{}),s.jsx(GO,{}),s.jsx(qO,{}),s.jsx(XO,{}),s.jsx(KO,{})]})})}),s.jsx(An,{children:s.jsx(L,{gap:4,p:4,flexDir:"column",children:s.jsxs(wn,{formLabelProps:Tv,children:[s.jsx(eN,{}),s.jsx(lN,{})]})})})]})]})})});Fk.displayName="CompositingSettingsAccordion";const dr=e=>{const t=u.useMemo(()=>ft(Pn,o=>{var r;return((r=$s(o,e))==null?void 0:r.isEnabled)??!1}),[e]);return j(t)},zk=e=>{const t=u.useMemo(()=>Fe(Pn,o=>{var r;return(r=$s(o,e))==null?void 0:r.type}),[e]);return j(t)};var aN=function(e,t){return typeof t=="boolean"?t:!e},iN=function(e){return u.useReducer(aN,e)};function cN(e,t){t===void 0&&(t=0);var n=u.useRef(!1),o=u.useRef(),r=u.useRef(e),l=u.useCallback(function(){return n.current},[]),c=u.useCallback(function(){n.current=!1,o.current&&clearTimeout(o.current),o.current=setTimeout(function(){n.current=!0,r.current()},t)},[t]),d=u.useCallback(function(){n.current=null,o.current&&clearTimeout(o.current)},[]);return u.useEffect(function(){r.current=e},[e]),u.useEffect(function(){return c(),d},[t]),[l,d,c]}function uN(e,t,n){t===void 0&&(t=0),n===void 0&&(n=[]);var o=cN(e,t),r=o[0],l=o[1],c=o[2];return u.useEffect(c,n),[r,l]}const dN=e=>{const t=u.useMemo(()=>ft(Pn,o=>{var r;return(r=$s(o,e))==null?void 0:r.controlImage}),[e]);return j(t)},fN=e=>{const t=u.useMemo(()=>ft(Pn,o=>{const r=$s(o,e);return r&&Fa(r)?r.processedControlImage:void 0}),[e]);return j(t)},mN=e=>{const t=u.useMemo(()=>ft(Pn,o=>{const r=$s(o,e);return r&&Fa(r)?r.processorType:void 0}),[e]);return j(t)},hN=Fe(Pn,e=>e.pendingControlImages),pN=({isSmall:e,id:t})=>{const{t:n}=R(),o=J(),r=dN(t),l=fN(t),c=mN(t),d=j($=>$.gallery.autoAddBoardId),f=j($=>$.system.isConnected),m=j(js),g=j(ls),p=j(hN),[x,y]=u.useState(!1),{currentData:S,isError:b}=zs(r??ss),{currentData:I,isError:M}=zs(l??ss),[w]=PM(),[_]=EM(),[T]=DM(),D=u.useCallback(()=>{o(LM({id:t,controlImage:null}))},[t,o]),A=u.useCallback(async()=>{I&&(await w({imageDTO:I,is_intermediate:!1}).unwrap(),d!=="none"?_({imageDTO:I,board_id:d}):T({imageDTO:I}))},[I,w,d,_,T]),F=u.useCallback(()=>{S&&(m==="unifiedCanvas"?o(Ui({width:S.width,height:S.height},g)):(o(Fy(S.width)),o(zy(S.height))))},[S,m,o,g]),Q=u.useCallback(()=>{y(!0)},[]),q=u.useCallback(()=>{y(!1)},[]),G=u.useMemo(()=>{if(S)return{id:t,payloadType:"IMAGE_DTO",payload:{imageDTO:S}}},[S,t]),Z=u.useMemo(()=>({id:t,actionType:"SET_CONTROL_ADAPTER_IMAGE",context:{id:t}}),[t]),N=u.useMemo(()=>({type:"SET_CONTROL_ADAPTER_IMAGE",id:t}),[t]),z=S&&I&&!x&&!p.includes(t)&&c!=="none";return u.useEffect(()=>{f&&(b||M)&&D()},[D,f,b,M]),s.jsxs(L,{onMouseEnter:Q,onMouseLeave:q,position:"relative",w:"full",h:e?32:366,alignItems:"center",justifyContent:"center",children:[s.jsx(Wr,{draggableData:G,droppableData:Z,imageDTO:S,isDropDisabled:z,postUploadAction:N}),s.jsx(We,{position:"absolute",top:0,insetInlineStart:0,w:"full",h:"full",opacity:z?1:0,transitionProperty:"common",transitionDuration:"normal",pointerEvents:"none",children:s.jsx(Wr,{draggableData:G,droppableData:Z,imageDTO:I,isUploadDisabled:!0})}),s.jsxs(s.Fragment,{children:[s.jsx(Ia,{onClick:D,icon:S?s.jsx(vc,{size:16}):void 0,tooltip:n("controlnet.resetControlImage")}),s.jsx(Ia,{onClick:A,icon:S?s.jsx(yc,{size:16}):void 0,tooltip:n("controlnet.saveControlImage"),styleOverrides:gN}),s.jsx(Ia,{onClick:F,icon:S?s.jsx(Q0,{size:16}):void 0,tooltip:n("controlnet.setControlImageDimensions"),styleOverrides:xN})]}),p.includes(t)&&s.jsx(L,{position:"absolute",top:0,insetInlineStart:0,w:"full",h:"full",alignItems:"center",justifyContent:"center",opacity:.8,borderRadius:"base",bg:"base.900",children:s.jsx(Kr,{size:"xl",color:"base.400"})})]})},Rv=u.memo(pN),gN={mt:6},xN={mt:12},Hk=e=>{const t=u.useMemo(()=>Fe(Pn,o=>{const r=$s(o,e);return r&&Fa(r)?r.processorNode:void 0}),[e]);return j(t)},Is=()=>{const e=J();return u.useCallback((n,o)=>{e(TM({id:n,params:o}))},[e])},vN=e=>s.jsx(L,{flexDir:"column",gap:4,children:e.children}),Ms=u.memo(vN),Gu=Bn.canny_image_processor.default,CN=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{low_threshold:r,high_threshold:l}=n,c=Is(),{t:d}=R(),f=u.useCallback(g=>{c(t,{low_threshold:g})},[t,c]),m=u.useCallback(g=>{c(t,{high_threshold:g})},[t,c]);return s.jsxs(Ms,{children:[s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.lowThreshold")}),s.jsx(Ue,{value:r,onChange:f,defaultValue:Gu.low_threshold,min:0,max:255}),s.jsx($e,{value:r,onChange:f,defaultValue:Gu.low_threshold,min:0,max:255})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.highThreshold")}),s.jsx(Ue,{value:l,onChange:m,defaultValue:Gu.high_threshold,min:0,max:255}),s.jsx($e,{value:l,onChange:m,defaultValue:Gu.high_threshold,min:0,max:255})]})]})},yN=u.memo(CN),Bv=Bn.color_map_image_processor.default,bN=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{color_map_tile_size:r}=n,l=Is(),{t:c}=R(),d=u.useCallback(f=>{l(t,{color_map_tile_size:f})},[t,l]);return s.jsx(Ms,{children:s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:c("controlnet.colorMapTileSize")}),s.jsx(Ue,{value:r,defaultValue:Bv.color_map_tile_size,onChange:d,min:1,max:256,step:1,marks:!0}),s.jsx($e,{value:r,defaultValue:Bv.color_map_tile_size,onChange:d,min:1,max:4096,step:1})]})})},jN=u.memo(bN),bo=Bn.content_shuffle_image_processor.default,SN=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{image_resolution:r,detect_resolution:l,w:c,h:d,f}=n,m=Is(),{t:g}=R(),p=u.useCallback(I=>{m(t,{detect_resolution:I})},[t,m]),x=u.useCallback(I=>{m(t,{image_resolution:I})},[t,m]),y=u.useCallback(I=>{m(t,{w:I})},[t,m]),S=u.useCallback(I=>{m(t,{h:I})},[t,m]),b=u.useCallback(I=>{m(t,{f:I})},[t,m]);return s.jsxs(Ms,{children:[s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:g("controlnet.detectResolution")}),s.jsx(Ue,{value:l,defaultValue:bo.detect_resolution,onChange:p,min:0,max:4096,marks:!0}),s.jsx($e,{value:l,defaultValue:bo.detect_resolution,onChange:p,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:g("controlnet.imageResolution")}),s.jsx(Ue,{value:r,defaultValue:bo.image_resolution,onChange:x,min:0,max:4096,marks:!0}),s.jsx($e,{value:r,defaultValue:bo.image_resolution,onChange:x,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:g("controlnet.w")}),s.jsx(Ue,{value:c,defaultValue:bo.w,onChange:y,min:0,max:4096,marks:!0}),s.jsx($e,{value:c,defaultValue:bo.w,onChange:y,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:g("controlnet.h")}),s.jsx(Ue,{value:d,defaultValue:bo.h,onChange:S,min:0,max:4096,marks:!0}),s.jsx($e,{value:d,defaultValue:bo.h,onChange:S,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:g("controlnet.f")}),s.jsx(Ue,{value:f,defaultValue:bo.f,onChange:b,min:0,max:4096,marks:!0}),s.jsx($e,{value:f,defaultValue:bo.f,onChange:b,min:0,max:4096})]})]})},kN=u.memo(SN),Xh=Bn.midas_depth_image_processor.default,wN=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{model_size:r,resolution:l}=n,c=Is(),{t:d}=R(),f=u.useCallback(y=>{RM(y==null?void 0:y.value)&&c(t,{model_size:y.value})},[t,c]),m=u.useMemo(()=>[{label:d("controlnet.small"),value:"small"},{label:d("controlnet.base"),value:"base"},{label:d("controlnet.large"),value:"large"}],[d]),g=u.useMemo(()=>m.filter(y=>y.value===r)[0],[m,r]),p=u.useCallback(y=>{c(t,{resolution:y})},[t,c]),x=u.useCallback(()=>{c(t,{resolution:512})},[t,c]);return s.jsxs(Ms,{children:[s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.modelSize")}),s.jsx(Xe,{value:g,defaultInputValue:Xh.model_size,options:m,onChange:f})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.imageResolution")}),s.jsx(Ue,{value:l,onChange:p,defaultValue:Xh.resolution,min:64,max:4096,step:64,marks:!0,onReset:x}),s.jsx($e,{value:l,onChange:p,defaultValue:Xh.resolution,min:64,max:4096,step:64})]})]})},IN=u.memo(wN),Zu=Bn.hed_image_processor.default,MN=e=>{const{controlNetId:t,processorNode:{detect_resolution:n,image_resolution:o,scribble:r},isEnabled:l}=e,c=Is(),{t:d}=R(),f=u.useCallback(p=>{c(t,{detect_resolution:p})},[t,c]),m=u.useCallback(p=>{c(t,{image_resolution:p})},[t,c]),g=u.useCallback(p=>{c(t,{scribble:p.target.checked})},[t,c]);return s.jsxs(Ms,{children:[s.jsxs(U,{isDisabled:!l,children:[s.jsx(Y,{children:d("controlnet.detectResolution")}),s.jsx(Ue,{value:n,defaultValue:Zu.detect_resolution,onChange:f,min:0,max:4096,marks:!0}),s.jsx($e,{value:n,defaultValue:Zu.detect_resolution,onChange:f,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!l,children:[s.jsx(Y,{children:d("controlnet.imageResolution")}),s.jsx(Ue,{value:o,onChange:m,defaultValue:Zu.image_resolution,min:0,max:4096,marks:!0}),s.jsx($e,{value:o,onChange:m,defaultValue:Zu.image_resolution,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!l,children:[s.jsx(Y,{children:d("controlnet.scribble")}),s.jsx(kt,{isChecked:r,onChange:g})]})]})},_N=u.memo(MN),qu=Bn.lineart_anime_image_processor.default,AN=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{image_resolution:r,detect_resolution:l}=n,c=Is(),{t:d}=R(),f=u.useCallback(g=>{c(t,{detect_resolution:g})},[t,c]),m=u.useCallback(g=>{c(t,{image_resolution:g})},[t,c]);return s.jsxs(Ms,{children:[s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.detectResolution")}),s.jsx(Ue,{value:l,defaultValue:qu.detect_resolution,onChange:f,min:0,max:4096,marks:!0}),s.jsx($e,{value:l,defaultValue:qu.detect_resolution,onChange:f,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.imageResolution")}),s.jsx(Ue,{value:r,onChange:m,defaultValue:qu.image_resolution,min:0,max:4096,marks:!0}),s.jsx($e,{value:r,onChange:m,defaultValue:qu.image_resolution,min:0,max:4096})]})]})},PN=u.memo(AN),Qu=Bn.lineart_image_processor.default,EN=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{image_resolution:r,detect_resolution:l,coarse:c}=n,d=Is(),{t:f}=R(),m=u.useCallback(x=>{d(t,{detect_resolution:x})},[t,d]),g=u.useCallback(x=>{d(t,{image_resolution:x})},[t,d]),p=u.useCallback(x=>{d(t,{coarse:x.target.checked})},[t,d]);return s.jsxs(Ms,{children:[s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:f("controlnet.detectResolution")}),s.jsx(Ue,{value:l,onChange:m,defaultValue:Qu.detect_resolution,min:0,max:4096,marks:!0}),s.jsx($e,{value:l,onChange:m,defaultValue:Qu.detect_resolution,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:f("controlnet.imageResolution")}),s.jsx(Ue,{value:r,onChange:g,defaultValue:Qu.image_resolution,min:0,max:4096,marks:!0}),s.jsx($e,{value:r,onChange:g,defaultValue:Qu.image_resolution,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:f("controlnet.coarse")}),s.jsx(kt,{isChecked:c,onChange:p})]})]})},DN=u.memo(EN),Ku=Bn.mediapipe_face_processor.default,LN=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{max_faces:r,min_confidence:l}=n,c=Is(),{t:d}=R(),f=u.useCallback(g=>{c(t,{max_faces:g})},[t,c]),m=u.useCallback(g=>{c(t,{min_confidence:g})},[t,c]);return s.jsxs(Ms,{children:[s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.maxFaces")}),s.jsx(Ue,{value:r,onChange:f,defaultValue:Ku.max_faces,min:1,max:20,marks:!0}),s.jsx($e,{value:r,onChange:f,defaultValue:Ku.max_faces,min:1,max:20})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.minConfidence")}),s.jsx(Ue,{value:l,onChange:m,defaultValue:Ku.min_confidence,min:0,max:1,step:.01,marks:!0}),s.jsx($e,{value:l,onChange:m,defaultValue:Ku.min_confidence,min:0,max:1,step:.01})]})]})},TN=u.memo(LN),Yu=Bn.midas_depth_image_processor.default,RN=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{a_mult:r,bg_th:l}=n,c=Is(),{t:d}=R(),f=u.useCallback(g=>{c(t,{a_mult:g})},[t,c]),m=u.useCallback(g=>{c(t,{bg_th:g})},[t,c]);return s.jsxs(Ms,{children:[s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.amult")}),s.jsx(Ue,{value:r,onChange:f,defaultValue:Yu.a_mult,min:0,max:20,step:.01,marks:!0}),s.jsx($e,{value:r,onChange:f,defaultValue:Yu.a_mult,min:0,max:20,step:.01})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.bgth")}),s.jsx(Ue,{value:l,onChange:m,defaultValue:Yu.bg_th,min:0,max:20,step:.01,marks:!0}),s.jsx($e,{value:l,onChange:m,defaultValue:Yu.bg_th,min:0,max:20,step:.01})]})]})},BN=u.memo(RN),kr=Bn.mlsd_image_processor.default,ON=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{image_resolution:r,detect_resolution:l,thr_d:c,thr_v:d}=n,f=Is(),{t:m}=R(),g=u.useCallback(S=>{f(t,{detect_resolution:S})},[t,f]),p=u.useCallback(S=>{f(t,{image_resolution:S})},[t,f]),x=u.useCallback(S=>{f(t,{thr_d:S})},[t,f]),y=u.useCallback(S=>{f(t,{thr_v:S})},[t,f]);return s.jsxs(Ms,{children:[s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.detectResolution")}),s.jsx(Ue,{value:l,onChange:g,defaultValue:kr.detect_resolution,min:0,max:4096,marks:Ov}),s.jsx($e,{value:l,onChange:g,defaultValue:kr.detect_resolution,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.imageResolution")}),s.jsx(Ue,{value:r,onChange:p,defaultValue:kr.image_resolution,min:0,max:4096,marks:Ov}),s.jsx($e,{value:r,onChange:p,defaultValue:kr.image_resolution,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsxs(Y,{children:[m("controlnet.w")," "]}),s.jsx(Ue,{value:c,onChange:x,defaultValue:kr.thr_d,min:0,max:1,step:.01,marks:Nv}),s.jsx($e,{value:c,onChange:x,defaultValue:kr.thr_d,min:0,max:1,step:.01})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsxs(Y,{children:[m("controlnet.h")," "]}),s.jsx(Ue,{value:d,onChange:y,defaultValue:kr.thr_v,min:0,max:1,step:.01,marks:Nv}),s.jsx($e,{value:d,onChange:y,defaultValue:kr.thr_v,min:0,max:1,step:.01})]})]})},NN=u.memo(ON),Ov=[0,4096],Nv=[0,1],Xu=Bn.normalbae_image_processor.default,FN=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{image_resolution:r,detect_resolution:l}=n,c=Is(),{t:d}=R(),f=u.useCallback(g=>{c(t,{detect_resolution:g})},[t,c]),m=u.useCallback(g=>{c(t,{image_resolution:g})},[t,c]);return s.jsxs(Ms,{children:[s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.detectResolution")}),s.jsx(Ue,{value:l,onChange:f,defaultValue:Xu.detect_resolution,min:0,max:4096,marks:!0}),s.jsx($e,{value:l,onChange:f,defaultValue:Xu.detect_resolution,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:d("controlnet.imageResolution")}),s.jsx(Ue,{value:r,onChange:m,defaultValue:Xu.image_resolution,min:0,max:4096,marks:!0}),s.jsx($e,{value:r,onChange:m,defaultValue:Xu.image_resolution,min:0,max:4096})]})]})},zN=u.memo(FN),Ju=Bn.openpose_image_processor.default,HN=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{image_resolution:r,detect_resolution:l,hand_and_face:c}=n,d=Is(),{t:f}=R(),m=u.useCallback(x=>{d(t,{detect_resolution:x})},[t,d]),g=u.useCallback(x=>{d(t,{image_resolution:x})},[t,d]),p=u.useCallback(x=>{d(t,{hand_and_face:x.target.checked})},[t,d]);return s.jsxs(Ms,{children:[s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:f("controlnet.detectResolution")}),s.jsx(Ue,{value:l,onChange:m,defaultValue:Ju.detect_resolution,min:0,max:4096,marks:!0}),s.jsx($e,{value:l,onChange:m,defaultValue:Ju.detect_resolution,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:f("controlnet.imageResolution")}),s.jsx(Ue,{value:r,onChange:g,defaultValue:Ju.image_resolution,min:0,max:4096,marks:!0}),s.jsx($e,{value:r,onChange:g,defaultValue:Ju.image_resolution,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:f("controlnet.handAndFace")}),s.jsx(kt,{isChecked:c,onChange:p})]})]})},$N=u.memo(HN),ed=Bn.pidi_image_processor.default,VN=e=>{const{controlNetId:t,processorNode:n,isEnabled:o}=e,{image_resolution:r,detect_resolution:l,scribble:c,safe:d}=n,f=Is(),{t:m}=R(),g=u.useCallback(S=>{f(t,{detect_resolution:S})},[t,f]),p=u.useCallback(S=>{f(t,{image_resolution:S})},[t,f]),x=u.useCallback(S=>{f(t,{scribble:S.target.checked})},[t,f]),y=u.useCallback(S=>{f(t,{safe:S.target.checked})},[t,f]);return s.jsxs(Ms,{children:[s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.detectResolution")}),s.jsx(Ue,{value:l,onChange:g,defaultValue:ed.detect_resolution,min:0,max:4096,marks:!0}),s.jsx($e,{value:l,onChange:g,defaultValue:ed.detect_resolution,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.imageResolution")}),s.jsx(Ue,{value:r,onChange:p,defaultValue:ed.image_resolution,min:0,max:4096,marks:!0}),s.jsx($e,{value:r,onChange:p,defaultValue:ed.image_resolution,min:0,max:4096})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.scribble")}),s.jsx(kt,{isChecked:c,onChange:x})]}),s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:m("controlnet.safe")}),s.jsx(kt,{isChecked:d,onChange:y})]})]})},WN=u.memo(VN),UN=e=>null,GN=u.memo(UN),ZN=({id:e})=>{const t=dr(e),n=Hk(e);return n?n.type==="canny_image_processor"?s.jsx(yN,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="color_map_image_processor"?s.jsx(jN,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="depth_anything_image_processor"?s.jsx(IN,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="hed_image_processor"?s.jsx(_N,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="lineart_image_processor"?s.jsx(DN,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="content_shuffle_image_processor"?s.jsx(kN,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="lineart_anime_image_processor"?s.jsx(PN,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="mediapipe_face_processor"?s.jsx(TN,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="midas_depth_image_processor"?s.jsx(BN,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="mlsd_image_processor"?s.jsx(NN,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="normalbae_image_processor"?s.jsx(zN,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="openpose_image_processor"?s.jsx($N,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="pidi_image_processor"?s.jsx(WN,{controlNetId:e,processorNode:n,isEnabled:t}):n.type==="zoe_depth_image_processor"?s.jsx(GN,{controlNetId:e,processorNode:n,isEnabled:t}):null:null},qN=u.memo(ZN),QN=e=>{const t=u.useMemo(()=>ft(Pn,o=>{const r=$s(o,e);if(r&&Fa(r))return r.shouldAutoConfig}),[e]);return j(t)},KN=({id:e})=>{const t=dr(e),n=QN(e),o=J(),{t:r}=R(),l=u.useCallback(()=>{o(BM({id:e}))},[e,o]);return zn(n)?null:s.jsxs(U,{isDisabled:!t,children:[s.jsx(Y,{flexGrow:1,children:r("controlnet.autoConfigure")}),s.jsx(kt,{isChecked:n,onChange:l})]})},YN=u.memo(KN),XN=e=>{const{id:t}=e,n=J(),{t:o}=R(),r=u.useCallback(()=>{n(OM({id:t}))},[t,n]),l=u.useCallback(()=>{n(NM({id:t}))},[t,n]);return s.jsxs(L,{gap:4,children:[s.jsx(je,{size:"sm",icon:s.jsx(D7,{}),tooltip:o("controlnet.importImageFromCanvas"),"aria-label":o("controlnet.importImageFromCanvas"),onClick:r}),s.jsx(je,{size:"sm",icon:s.jsx(Kb,{}),tooltip:o("controlnet.importMaskFromCanvas"),"aria-label":o("controlnet.importMaskFromCanvas"),onClick:l})]})},JN=u.memo(XN),eF=e=>{const t=u.useMemo(()=>Fe(Pn,o=>{const r=$s(o,e);return r?{beginStepPct:r.beginStepPct,endStepPct:r.endStepPct}:void 0}),[e]);return j(t)},tF=e=>`${Math.round(e*100)}%`,$k=u.memo(({id:e})=>{const t=dr(e),n=eF(e),o=J(),{t:r}=R(),l=u.useCallback(f=>{o(n2({id:e,beginStepPct:f[0]})),o(s2({id:e,endStepPct:f[1]}))},[o,e]),c=u.useCallback(()=>{o(n2({id:e,beginStepPct:0})),o(s2({id:e,endStepPct:1}))},[o,e]),d=u.useMemo(()=>[(n==null?void 0:n.beginStepPct)??0,(n==null?void 0:n.endStepPct)??1],[n]);return n?s.jsxs(U,{isDisabled:!t,orientation:"vertical",children:[s.jsx(Y,{children:r("controlnet.beginEndStepPercent")}),s.jsx(FM,{"aria-label":nF,value:d,onChange:l,onReset:c,min:0,max:1,step:.05,fineStep:.01,minStepsBetweenThumbs:1,formatValue:tF,marks:!0,withThumbTooltip:!0})]}):null});$k.displayName="ParamControlAdapterBeginEnd";const nF=["Begin Step %","End Step %"],sF=e=>{const t=u.useMemo(()=>ft(Pn,o=>{const r=$s(o,e);if(r&&zM(r))return r.controlMode}),[e]);return j(t)},oF=({id:e})=>{const t=dr(e),n=sF(e),o=J(),{t:r}=R(),l=u.useMemo(()=>[{label:r("controlnet.balanced"),value:"balanced"},{label:r("controlnet.prompt"),value:"more_prompt"},{label:r("controlnet.control"),value:"more_control"},{label:r("controlnet.megaControl"),value:"unbalanced"}],[r]),c=u.useCallback(f=>{f&&o(HM({id:e,controlMode:f.value}))},[e,o]),d=u.useMemo(()=>l.filter(f=>f.value===n)[0],[l,n]);return n?s.jsxs(U,{isDisabled:!t,children:[s.jsx(zt,{feature:"controlNetControlMode",children:s.jsx(Y,{children:r("controlnet.controlMode")})}),s.jsx(Xe,{value:d,options:l,onChange:c})]}):null},rF=u.memo(oF),lF=e=>{const t=u.useMemo(()=>Fe(Pn,o=>{var r;return(r=$s(o,e))==null?void 0:r.model}),[e]);return j(t)},aF=e=>{const{data:t}=gf(),{data:n}=xf(),{data:o}=vf();if(e==="controlnet")return t;if(e==="t2i_adapter")return n;if(e==="ip_adapter")return o},iF=Fe(Ss,e=>e.model),cF=({id:e})=>{const t=dr(e),n=zk(e),o=lF(e),r=J(),l=j(I=>{var M;return(M=I.generation.model)==null?void 0:M.base_model}),c=j(iF),{t:d}=R(),f=aF(n),m=u.useCallback(I=>{I&&r($M({id:e,model:L0(I,"base_model","model_name")}))},[r,e]),g=u.useMemo(()=>o&&n?{...o,model_type:n}:null,[n,o]),p=u.useCallback(I=>{const M=l===I.base_model;return!!!l||!M},[l]),{options:x,value:y,onChange:S,noOptionsMessage:b}=ws({modelEntities:f,onChange:m,selectedModel:g,getIsDisabled:p});return s.jsx(jt,{label:y==null?void 0:y.description,children:s.jsx(U,{isDisabled:!t,isInvalid:!y||(c==null?void 0:c.base_model)!==(o==null?void 0:o.base_model),children:s.jsx(Xe,{options:x,placeholder:d("controlnet.selectModel"),value:y,onChange:S,noOptionsMessage:b})})})},uF=u.memo(cF),dF=e=>e.config,fF=Fe(dF,e=>ys(Bn,n=>({value:n.type,label:n.label})).sort((n,o)=>n.value==="none"?-1:o.value==="none"?1:n.label.localeCompare(o.label)).filter(n=>!e.sd.disabledControlNetProcessors.includes(n.value))),mF=({id:e})=>{const t=dr(e),n=Hk(e),o=J(),r=j(fF),{t:l}=R(),c=u.useCallback(f=>{f&&o(VM({id:e,processorType:f.value}))},[e,o]),d=u.useMemo(()=>r.find(f=>f.value===(n==null?void 0:n.type)),[r,n]);return n?s.jsxs(U,{isDisabled:!t,children:[s.jsx(Y,{children:l("controlnet.processor")}),s.jsx(Xe,{value:d,options:r,onChange:c})]}):null},hF=u.memo(mF),pF=e=>{const t=u.useMemo(()=>Fe(Pn,o=>{const r=$s(o,e);if(r&&Fa(r))return r.resizeMode}),[e]);return j(t)},gF=({id:e})=>{const t=dr(e),n=pF(e),o=J(),{t:r}=R(),l=u.useMemo(()=>[{label:r("controlnet.resize"),value:"just_resize"},{label:r("controlnet.crop"),value:"crop_resize"},{label:r("controlnet.fill"),value:"fill_resize"},{label:r("controlnet.resizeSimple"),value:"just_resize_simple"}],[r]),c=u.useCallback(f=>{WM(f==null?void 0:f.value)&&o(UM({id:e,resizeMode:f.value}))},[e,o]),d=u.useMemo(()=>l.find(f=>f.value===n),[l,n]);return n?s.jsxs(U,{children:[s.jsx(zt,{feature:"controlNetResizeMode",children:s.jsx(Y,{children:r("controlnet.resizeMode")})}),s.jsx(Xe,{value:d,options:l,isDisabled:!t,onChange:c})]}):null},xF=u.memo(gF),vF=e=>{const t=u.useMemo(()=>ft(Pn,o=>{var r;return(r=$s(o,e))==null?void 0:r.weight}),[e]);return j(t)},CF=e=>e.toFixed(2),yF=({id:e})=>{const{t}=R(),n=J(),o=dr(e),r=vF(e),l=j(y=>y.config.sd.ca.weight.initial),c=j(y=>y.config.sd.ca.weight.sliderMin),d=j(y=>y.config.sd.ca.weight.sliderMax),f=j(y=>y.config.sd.ca.weight.numberInputMin),m=j(y=>y.config.sd.ca.weight.numberInputMax),g=j(y=>y.config.sd.ca.weight.coarseStep),p=j(y=>y.config.sd.ca.weight.fineStep),x=u.useCallback(y=>{n(GM({id:e,weight:y}))},[n,e]);return zn(r)?null:s.jsxs(U,{isDisabled:!o,children:[s.jsx(zt,{feature:"controlNetWeight",children:s.jsx(Y,{children:t("controlnet.weight")})}),s.jsx(Ue,{value:r,onChange:x,defaultValue:l,min:c,max:d,step:g,fineStep:p,marks:jF,formatValue:CF}),s.jsx($e,{value:r,onChange:x,min:f,max:m,step:g,fineStep:p,maxW:20,defaultValue:l})]})},bF=u.memo(yF),jF=[0,1,2],SF=e=>{const{id:t,number:n}=e,o=zk(t),r=J(),{t:l}=R(),c=j(js),d=dr(t),[f,m]=iN(!1),g=u.useCallback(()=>{r(ZM({id:t}))},[t,r]),p=u.useCallback(()=>{r(qM(t))},[t,r]),x=u.useCallback(y=>{r(QM({id:t,isEnabled:y.target.checked}))},[t,r]);return o?s.jsxs(L,{flexDir:"column",gap:4,p:4,borderRadius:"base",position:"relative",bg:"base.750",children:[s.jsx(L,{gap:2,alignItems:"center",justifyContent:"space-between",children:s.jsxs(U,{children:[s.jsx(Y,{flexGrow:1,children:l(`controlnet.${o}`,{number:n})}),s.jsx(kt,{"aria-label":l("controlnet.toggleControlNet"),isChecked:d,onChange:x})]})}),s.jsxs(L,{gap:4,alignItems:"center",children:[s.jsx(We,{minW:0,w:"full",transitionProperty:"common",transitionDuration:"0.1s",children:s.jsx(uF,{id:t})}),c==="unifiedCanvas"&&s.jsx(JN,{id:t}),s.jsx(je,{size:"sm",tooltip:l("controlnet.duplicate"),"aria-label":l("controlnet.duplicate"),onClick:p,icon:s.jsx(el,{})}),s.jsx(je,{size:"sm",tooltip:l("controlnet.delete"),"aria-label":l("controlnet.delete"),colorScheme:"error",onClick:g,icon:s.jsx(Vs,{})}),s.jsx(je,{size:"sm",tooltip:l(f?"controlnet.hideAdvanced":"controlnet.showAdvanced"),"aria-label":l(f?"controlnet.hideAdvanced":"controlnet.showAdvanced"),onClick:m,variant:"ghost",icon:s.jsx(Vn,{boxSize:4,as:q0,transform:f?"rotate(0deg)":"rotate(180deg)",transitionProperty:"common",transitionDuration:"normal"})})]}),s.jsx(L,{w:"full",flexDir:"column",gap:4,children:s.jsxs(L,{gap:8,w:"full",alignItems:"center",children:[s.jsxs(L,{flexDir:"column",gap:2,h:32,w:"full",children:[s.jsx(bF,{id:t}),s.jsx($k,{id:t})]}),!f&&s.jsx(L,{alignItems:"center",justifyContent:"center",h:32,w:32,aspectRatio:"1/1",children:s.jsx(Rv,{id:t,isSmall:!0})})]})}),f&&s.jsxs(s.Fragment,{children:[s.jsxs(L,{gap:2,children:[s.jsx(rF,{id:t}),s.jsx(xF,{id:t})]}),s.jsx(hF,{id:t}),s.jsx(Rv,{id:t}),s.jsx(YN,{id:t}),s.jsx(qN,{id:t})]})]}):null},kF=u.memo(SF),wF=e=>{const{data:t}=gf(),n=u.useMemo(()=>t?uy.selectAll(t):[],[t]),{data:o}=xf(),r=u.useMemo(()=>o?dy.selectAll(o):[],[o]),{data:l}=vf(),c=u.useMemo(()=>l?fy.selectAll(l):[],[l]);return e==="controlnet"?n:e==="t2i_adapter"?r:e==="ip_adapter"?c:[]},Jh=e=>{const t=j(d=>{var f;return(f=d.generation.model)==null?void 0:f.base_model}),n=J(),o=wF(e),r=u.useMemo(()=>{const d=o.filter(f=>t?f.base_model===t:!0)[0];return d||o[0]},[t,o]),l=u.useMemo(()=>!r,[r]);return[u.useCallback(()=>{l||n(KM({type:e,overrides:{model:r}}))},[n,r,l,e]),l]},IF=Fe(Pn,e=>{const t=[];let n=!1;const o=YM(e).filter(g=>g.isEnabled).length,r=XM(e).length;o>0&&t.push(`${o} IP`),o>r&&(n=!0);const l=JM(e).filter(g=>g.isEnabled).length,c=e8(e).length;l>0&&t.push(`${l} ControlNet`),l>c&&(n=!0);const d=t8(e).filter(g=>g.isEnabled).length,f=n8(e).length;return d>0&&t.push(`${d} T2I`),d>f&&(n=!0),{controlAdapterIds:s8(e),badges:t,isError:n}}),Vk=u.memo(()=>{const{t:e}=R(),{controlAdapterIds:t,badges:n}=j(IF),o=Kt("controlNet").isFeatureDisabled,{isOpen:r,onToggle:l}=Ya({id:"control-settings",defaultIsOpen:!0}),[c,d]=Jh("controlnet"),[f,m]=Jh("ip_adapter"),[g,p]=Jh("t2i_adapter");return o?null:s.jsx($a,{label:e("accordions.control.title"),badges:n,isOpen:r,onToggle:l,children:s.jsxs(L,{gap:2,p:4,flexDir:"column",children:[s.jsxs(wt,{size:"sm",w:"full",justifyContent:"space-between",variant:"ghost",isAttached:!1,children:[s.jsx(Ge,{tooltip:e("controlnet.addControlNet"),leftIcon:s.jsx(kl,{}),onClick:c,"data-testid":"add controlnet",flexGrow:1,isDisabled:d,children:e("common.controlNet")}),s.jsx(Ge,{tooltip:e("controlnet.addIPAdapter"),leftIcon:s.jsx(kl,{}),onClick:f,"data-testid":"add ip adapter",flexGrow:1,isDisabled:m,children:e("common.ipAdapter")}),s.jsx(Ge,{tooltip:e("controlnet.addT2IAdapter"),leftIcon:s.jsx(kl,{}),onClick:g,"data-testid":"add t2i adapter",flexGrow:1,isDisabled:p,children:e("common.t2iAdapter")})]}),t.map((x,y)=>s.jsxs(u.Fragment,{children:[s.jsx(Sn,{}),s.jsx(kF,{id:x,number:y+1})]},x))]})})});Vk.displayName="ControlAdaptersSettingsAccordion";const Wk=u.memo(e=>{const t=J(),{lora:n}=e,o=u.useCallback(c=>{t(o8({id:n.id,weight:c}))},[t,n.id]),r=u.useCallback(()=>{t(r8({id:n.id,isEnabled:!n.isEnabled}))},[t,n.id,n.isEnabled]),l=u.useCallback(()=>{t(l8(n.id))},[t,n.id]);return s.jsxs(a8,{variant:"lora",children:[s.jsx(i8,{children:s.jsxs(L,{alignItems:"center",justifyContent:"space-between",width:"100%",gap:2,children:[s.jsx(pe,{noOfLines:1,wordBreak:"break-all",color:n.isEnabled?"base.200":"base.500",children:n.model_name}),s.jsxs(L,{alignItems:"center",gap:2,children:[s.jsx(kt,{size:"sm",onChange:r,isChecked:n.isEnabled}),s.jsx(je,{"aria-label":"Remove LoRA",variant:"ghost",size:"sm",onClick:l,icon:s.jsx(Vs,{})})]})]})}),s.jsxs(c8,{children:[s.jsx(Ue,{value:n.weight,onChange:o,min:-1,max:2,step:.01,marks:MF,defaultValue:.75,isDisabled:!n.isEnabled}),s.jsx($e,{value:n.weight,onChange:o,min:-5,max:5,step:.01,w:20,flexShrink:0,defaultValue:.75,isDisabled:!n.isEnabled})]})]})});Wk.displayName="LoRACard";const MF=[-1,0,1,2],_F=Fe(T0,e=>ys(e.loras)),Uk=u.memo(()=>{const e=j(_F);return e.length?s.jsx(L,{flexWrap:"wrap",gap:2,children:e.map(t=>s.jsx(Wk,{lora:t},t.model_name))}):null});Uk.displayName="LoRAList";const AF=Fe(T0,e=>e.loras),PF=()=>{const e=J(),{data:t,isLoading:n}=dc(),{t:o}=R(),r=j(AF),l=j(x=>{var y;return(y=x.generation.model)==null?void 0:y.base_model}),c=x=>{const y=l===x.base_model,S=!!r[x.id];return!!!l||!y||S},d=u.useCallback(x=>{x&&e(u8(x))},[e]),{options:f,onChange:m}=ws({modelEntities:t,getIsDisabled:c,onChange:d}),g=u.useMemo(()=>n?o("common.loading"):f.length===0?o("models.noLoRAsInstalled"):o("models.addLora"),[n,f.length,o]),p=u.useCallback(()=>o("models.noMatchingLoRAs"),[o]);return s.jsxs(U,{isDisabled:!f.length,children:[s.jsxs(Y,{children:[o("models.lora")," "]}),s.jsx(Xe,{placeholder:g,value:null,options:f,noOptionsMessage:p,onChange:m,"data-testid":"add-lora",sx:DF})]})},EF=u.memo(PF),DF={w:"full"},LF=()=>{const e=j(x=>x.generation.cfgScale),t=j(x=>x.config.sd.guidance.sliderMin),n=j(x=>x.config.sd.guidance.sliderMax),o=j(x=>x.config.sd.guidance.numberInputMin),r=j(x=>x.config.sd.guidance.numberInputMax),l=j(x=>x.config.sd.guidance.coarseStep),c=j(x=>x.config.sd.guidance.fineStep),d=j(x=>x.config.sd.guidance.initial),f=J(),{t:m}=R(),g=u.useMemo(()=>[t,Math.floor(n/2),n],[n,t]),p=u.useCallback(x=>f(pp(x)),[f]);return s.jsxs(U,{children:[s.jsx(zt,{feature:"paramCFGScale",children:s.jsx(Y,{children:m("parameters.cfgScale")})}),s.jsx(Ue,{value:e,defaultValue:d,min:t,max:n,step:l,fineStep:c,onChange:p,marks:g}),s.jsx($e,{value:e,defaultValue:d,min:o,max:r,step:l,fineStep:c,onChange:p})]})},TF=u.memo(LF),RF=()=>{const e=J(),{t}=R(),n=j(l=>l.generation.scheduler),o=u.useCallback(l=>{ya(l==null?void 0:l.value)&&e(vp(l.value))},[e]),r=u.useMemo(()=>Pa.find(l=>l.value===n),[n]);return s.jsxs(U,{children:[s.jsx(zt,{feature:"paramScheduler",children:s.jsx(Y,{children:t("parameters.scheduler")})}),s.jsx(Xe,{value:r,options:Pa,onChange:o})]})},BF=u.memo(RF),OF=()=>{const e=j(x=>x.generation.steps),t=j(x=>x.config.sd.steps.initial),n=j(x=>x.config.sd.steps.sliderMin),o=j(x=>x.config.sd.steps.sliderMax),r=j(x=>x.config.sd.steps.numberInputMin),l=j(x=>x.config.sd.steps.numberInputMax),c=j(x=>x.config.sd.steps.coarseStep),d=j(x=>x.config.sd.steps.fineStep),f=J(),{t:m}=R(),g=u.useMemo(()=>[n,Math.floor(o/2),o],[o,n]),p=u.useCallback(x=>{f(Cp(x))},[f]);return s.jsxs(U,{children:[s.jsx(zt,{feature:"paramSteps",children:s.jsx(Y,{children:m("parameters.steps")})}),s.jsx(Ue,{value:e,defaultValue:t,min:n,max:o,step:c,fineStep:d,onChange:p,marks:g}),s.jsx($e,{value:e,defaultValue:t,min:r,max:l,step:c,fineStep:d,onChange:p})]})},NF=u.memo(OF),FF=Fe(Ss,e=>e.model),zF=()=>{const e=J(),{t}=R(),n=j(FF),{data:o,isLoading:r}=so(bB),l=u.useMemo(()=>{var x;if(!(!o||!n))return(x=d8.selectById(o,D0(n)))==null?void 0:x.description},[o,n]),c=u.useCallback(x=>{x&&e(xp(L0(x,["base_model","model_name","model_type"])))},[e]),{options:d,value:f,onChange:m,placeholder:g,noOptionsMessage:p}=ws({modelEntities:o,onChange:c,selectedModel:n,isLoading:r});return s.jsx(jt,{label:l,children:s.jsxs(U,{isDisabled:!d.length,isInvalid:!d.length,children:[s.jsx(Y,{children:t("modelManager.model")}),s.jsx(Xe,{value:f,placeholder:g,options:d,onChange:m,noOptionsMessage:p})]})})},HF=u.memo(zF),Gk=e=>{const t=J(),n=u.useMemo(()=>ft(Ny,l=>l.expanders[e.id]??e.defaultIsOpen),[e]),o=j(n),r=u.useCallback(()=>{t(f8({id:e.id,isOpen:!o}))},[t,e.id,o]);return{isOpen:o,onToggle:r}},$F={minW:"4rem"},VF=Fe(T0,Ss,(e,t)=>{const n=Hy(e.loras,l=>!!l.isEnabled).length,o=$y(e.loras)?[n]:[],r=[];return t.model&&(r.push(t.model.model_name),r.push(t.model.base_model)),{loraTabBadges:o,accordionBadges:r}}),Zk=u.memo(()=>{const{t:e}=R(),{loraTabBadges:t,accordionBadges:n}=j(VF),{isOpen:o,onToggle:r}=Gk({id:"generation-settings-advanced",defaultIsOpen:!1}),{isOpen:l,onToggle:c}=Ya({id:"generation-settings",defaultIsOpen:!0});return s.jsx($a,{label:e("accordions.generation.title"),badges:n,isOpen:l,onToggle:c,children:s.jsxs(Xr,{variant:"collapse",children:[s.jsxs(Jr,{children:[s.jsx(hn,{children:e("accordions.generation.modelTab")}),s.jsx(hn,{badges:t,children:e("accordions.generation.conceptsTab")})]}),s.jsxs(Rl,{children:[s.jsxs(An,{overflow:"visible",px:4,pt:4,children:[s.jsxs(L,{gap:4,alignItems:"center",children:[s.jsx(HF,{}),s.jsx(Ka,{})]}),s.jsx(Vy,{isOpen:o,onToggle:r,children:s.jsx(L,{gap:4,flexDir:"column",pb:4,children:s.jsxs(wn,{formLabelProps:$F,children:[s.jsx(BF,{}),s.jsx(NF,{}),s.jsx(TF,{})]})})})]}),s.jsx(An,{children:s.jsxs(L,{gap:4,p:4,flexDir:"column",children:[s.jsx(EF,{}),s.jsx(Uk,{})]})})]})]})})});Zk.displayName="GenerationSettingsAccordion";const Fv=[{label:"ESRGAN",value:"ESRGAN"},{label:"bilinear",value:"bilinear"}],WF=()=>{const e=J(),{t}=R(),n=j(l=>l.hrf.hrfMethod),o=u.useCallback(l=>{Sp(l==null?void 0:l.value)&&e(kp(l.value))},[e]),r=u.useMemo(()=>Fv.find(l=>l.value===n),[n]);return s.jsxs(U,{children:[s.jsx(Y,{children:t("hrf.upscaleMethod")}),s.jsx(Xe,{value:r,options:Fv,onChange:o})]})},UF=u.memo(WF),GF=()=>{const e=j(p=>p.hrf.hrfStrength),t=j(p=>p.config.sd.hrfStrength.initial),n=j(p=>p.config.sd.hrfStrength.sliderMin),o=j(p=>p.config.sd.hrfStrength.sliderMax),r=j(p=>p.config.sd.hrfStrength.numberInputMin),l=j(p=>p.config.sd.hrfStrength.numberInputMax),c=j(p=>p.config.sd.hrfStrength.coarseStep),d=j(p=>p.config.sd.hrfStrength.fineStep),f=J(),{t:m}=R(),g=u.useCallback(p=>{f(jp(p))},[f]);return s.jsxs(U,{children:[s.jsx(Y,{children:m("parameters.denoisingStrength")}),s.jsx(Ue,{min:n,max:o,step:c,fineStep:d,value:e,defaultValue:t,onChange:g,marks:!0}),s.jsx($e,{min:r,max:l,step:c,fineStep:d,value:e,defaultValue:t,onChange:g})]})},ZF=u.memo(GF),qF=()=>{const e=J(),{t}=R(),n=j(r=>r.hrf.hrfEnabled),o=u.useCallback(r=>e(bp(r.target.checked)),[e]);return s.jsxs(U,{w:"full",children:[s.jsx(Y,{flexGrow:1,children:t("hrf.enableHrf")}),s.jsx(kt,{isChecked:n,onChange:o})]})},QF=u.memo(qF),qk=u.memo(()=>{const e=Kt("hrf").isFeatureEnabled,t=j(n=>n.hrf.hrfEnabled);return e?s.jsxs(s.Fragment,{children:[s.jsx(QF,{}),s.jsxs(wn,{isDisabled:!t,children:[s.jsx(ZF,{}),s.jsx(UF,{})]})]}):null});qk.displayName="HrfSettings";const zv=[{label:"None",value:"none"},{label:"Auto",value:"auto"},{label:"Manual",value:"manual"}],KF=()=>{const e=J(),{t}=R(),n=j(c=>c.canvas.boundingBoxScaleMethod),o=j(ls),r=u.useCallback(c=>{m8(c==null?void 0:c.value)&&e(h8(c.value,o))},[e,o]),l=u.useMemo(()=>zv.find(c=>c.value===n),[n]);return s.jsxs(U,{children:[s.jsx(zt,{feature:"scaleBeforeProcessing",children:s.jsx(Y,{children:t("parameters.scaleBeforeProcessing")})}),s.jsx(Xe,{value:l,options:zv,onChange:r})]})},YF=u.memo(KF),XF=()=>{const{t:e}=R(),t=J(),n=j(ls),o=j(x=>x.canvas.boundingBoxScaleMethod==="manual"),r=j(x=>x.canvas.scaledBoundingBoxDimensions.height),l=j(x=>x.config.sd.scaledBoundingBoxHeight.sliderMin),c=j(x=>x.config.sd.scaledBoundingBoxHeight.sliderMax),d=j(x=>x.config.sd.scaledBoundingBoxHeight.numberInputMin),f=j(x=>x.config.sd.scaledBoundingBoxHeight.numberInputMax),m=j(x=>x.config.sd.scaledBoundingBoxHeight.coarseStep),g=j(x=>x.config.sd.scaledBoundingBoxHeight.fineStep),p=u.useCallback(x=>{t(Wy({height:x}))},[t]);return s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:e("parameters.scaledHeight")}),s.jsx(Ue,{min:l,max:c,step:m,fineStep:g,value:r,onChange:p,marks:!0,defaultValue:n}),s.jsx($e,{min:d,max:f,step:m,fineStep:g,value:r,onChange:p,defaultValue:n})]})},JF=u.memo(XF),ez=()=>{const{t:e}=R(),t=J(),n=j(ls),o=j(x=>x.canvas.boundingBoxScaleMethod==="manual"),r=j(x=>x.canvas.scaledBoundingBoxDimensions.width),l=j(x=>x.config.sd.scaledBoundingBoxWidth.sliderMin),c=j(x=>x.config.sd.scaledBoundingBoxWidth.sliderMax),d=j(x=>x.config.sd.scaledBoundingBoxWidth.numberInputMin),f=j(x=>x.config.sd.scaledBoundingBoxWidth.numberInputMax),m=j(x=>x.config.sd.scaledBoundingBoxWidth.coarseStep),g=j(x=>x.config.sd.scaledBoundingBoxWidth.fineStep),p=u.useCallback(x=>{t(Wy({width:x}))},[t]);return s.jsxs(U,{isDisabled:!o,children:[s.jsx(Y,{children:e("parameters.scaledWidth")}),s.jsx(Ue,{min:l,max:c,step:m,fineStep:g,value:r,onChange:p,defaultValue:n,marks:!0}),s.jsx($e,{min:d,max:f,step:m,fineStep:g,value:r,onChange:p,defaultValue:n})]})},tz=u.memo(ez),nz=()=>{const e=J(),t=j(r=>r.generation.shouldFitToWidthHeight),n=u.useCallback(r=>{e(p8(r.target.checked))},[e]),{t:o}=R();return s.jsxs(U,{w:"full",children:[s.jsx(Y,{flexGrow:1,children:o("parameters.imageFit")}),s.jsx(kt,{isChecked:t,onChange:n})]})},sz=u.memo(nz),oz=[0,.5,1],rz=()=>{const e=j(p=>p.generation.img2imgStrength),t=j(p=>p.config.sd.img2imgStrength.initial),n=j(p=>p.config.sd.img2imgStrength.sliderMin),o=j(p=>p.config.sd.img2imgStrength.sliderMax),r=j(p=>p.config.sd.img2imgStrength.numberInputMin),l=j(p=>p.config.sd.img2imgStrength.numberInputMax),c=j(p=>p.config.sd.img2imgStrength.coarseStep),d=j(p=>p.config.sd.img2imgStrength.fineStep),f=J(),{t:m}=R(),g=u.useCallback(p=>f(yp(p)),[f]);return s.jsxs(U,{children:[s.jsx(zt,{feature:"paramDenoisingStrength",children:s.jsx(Y,{children:`${m("parameters.denoisingStrength")}`})}),s.jsx(Ue,{step:c,fineStep:d,min:n,max:o,onChange:g,value:e,defaultValue:t,marks:oz}),s.jsx($e,{step:c,fineStep:d,min:r,max:l,onChange:g,value:e,defaultValue:t})]})},lz=u.memo(rz),Qk=u.memo(()=>{const e=j(l=>l.generation.seed),t=j(l=>l.generation.shouldRandomizeSeed),{t:n}=R(),o=J(),r=u.useCallback(l=>o(Sd(l)),[o]);return s.jsxs(U,{flexGrow:1,children:[s.jsx(zt,{feature:"paramSeed",children:s.jsx(Y,{children:n("parameters.seed")})}),s.jsx($e,{step:1,min:Uy,max:Id,isDisabled:t,onChange:r,value:e,flexGrow:1,defaultValue:0})]})});Qk.displayName="ParamSeedNumberInput";const Kk=u.memo(()=>{const e=J(),{t}=R(),n=j(r=>r.generation.shouldRandomizeSeed),o=u.useCallback(r=>e(g8(r.target.checked)),[e]);return s.jsxs(U,{w:"min-content",children:[s.jsx(Y,{children:t("common.random")}),s.jsx(kt,{isChecked:n,onChange:o})]})});Kk.displayName="ParamSeedRandomize";const az=(e,t)=>Math.floor(Math.random()*(t-e+1)+e),Yk=u.memo(()=>{const e=J(),t=j(r=>r.generation.shouldRandomizeSeed),{t:n}=R(),o=u.useCallback(()=>e(Sd(az(Uy,Id))),[e]);return s.jsx(Ge,{size:"sm",isDisabled:t,onClick:o,leftIcon:s.jsx(G7,{}),flexShrink:0,children:n("parameters.shuffle")})});Yk.displayName="ParamSeedShuffle";const Xk=u.createContext(null),fr=()=>{const e=u.useContext(Xk),t=j(ls);if(!e)throw new Error("useImageSizeContext must be used within a ImageSizeContext.Provider");const n=u.useCallback(m=>{const g={...e.aspectRatioState,id:m};if(g.id==="Free")g.isLocked=!1;else{g.isLocked=!0,g.value=o2[g.id].ratio;const{width:p,height:x}=ud(g.value,e.width*e.height);e.onChangeWidth(p),e.onChangeHeight(x)}e.onChangeAspectRatioState(g)},[e]),o=u.useCallback(()=>{const m={...e.aspectRatioState};if(m.value=1/m.value,m.id==="Free"){const g=e.height,p=e.width;e.onChangeWidth(g),e.onChangeHeight(p)}else{const{width:g,height:p}=ud(m.value,e.width*e.height);e.onChangeWidth(g),e.onChangeHeight(p),m.id=o2[m.id].inverseID}e.onChangeAspectRatioState(m)},[e]),r=u.useCallback(m=>{let g=e.height;const p={...e.aspectRatioState};p.isLocked?g=Md(m/p.value,8):(p.isLocked=!1,p.id="Free",p.value=m/g),e.onChangeWidth(m),e.onChangeHeight(g),e.onChangeAspectRatioState(p)},[e]),l=u.useCallback(m=>{let g=e.width;const p={...e.aspectRatioState};p.isLocked?g=Md(m*p.value,8):(p.isLocked=!1,p.id="Free",p.value=g/m),e.onChangeWidth(g),e.onChangeHeight(m),e.onChangeAspectRatioState(p)},[e]),c=u.useCallback(()=>{const m={...e.aspectRatioState};m.isLocked=!m.isLocked,e.onChangeAspectRatioState(m)},[e]),d=u.useCallback(()=>{if(e.aspectRatioState.isLocked){const{width:m,height:g}=ud(e.aspectRatioState.value,t*t);e.onChangeWidth(m),e.onChangeHeight(g)}else e.onChangeAspectRatioState({...x8}),e.onChangeWidth(t),e.onChangeHeight(t)},[e,t]);return u.useMemo(()=>({...e,aspectRatioSelected:n,dimensionsSwapped:o,widthChanged:r,heightChanged:l,isLockedToggled:c,setOptimalSize:d}),[e,n,o,l,c,d,r])},iz=()=>{const{t:e}=R(),t=fr(),n=j(ks),o=j(ls),r=j(p=>p.config.sd.boundingBoxHeight.sliderMin),l=j(p=>p.config.sd.boundingBoxHeight.sliderMax),c=j(p=>p.config.sd.boundingBoxHeight.numberInputMin),d=j(p=>p.config.sd.boundingBoxHeight.numberInputMax),f=j(p=>p.config.sd.boundingBoxHeight.coarseStep),m=j(p=>p.config.sd.boundingBoxHeight.fineStep),g=u.useCallback(p=>{t.heightChanged(p)},[t]);return s.jsxs(U,{isDisabled:n,children:[s.jsx(Y,{children:e("parameters.height")}),s.jsx(Ue,{min:r,max:l,step:f,fineStep:m,value:t.height,defaultValue:o,onChange:g,marks:!0}),s.jsx($e,{min:c,max:d,step:f,fineStep:m,value:t.height,defaultValue:o,onChange:g})]})},cz=u.memo(iz),uz=()=>{const{t:e}=R(),t=fr(),n=j(ks),o=j(ls),r=j(p=>p.config.sd.boundingBoxWidth.sliderMin),l=j(p=>p.config.sd.boundingBoxWidth.sliderMax),c=j(p=>p.config.sd.boundingBoxWidth.numberInputMin),d=j(p=>p.config.sd.boundingBoxWidth.numberInputMax),f=j(p=>p.config.sd.boundingBoxWidth.coarseStep),m=j(p=>p.config.sd.boundingBoxWidth.fineStep),g=u.useCallback(p=>{t.widthChanged(p)},[t]);return s.jsxs(U,{isDisabled:n,children:[s.jsx(Y,{children:e("parameters.width")}),s.jsx(Ue,{min:r,max:l,step:f,fineStep:m,value:t.width,defaultValue:o,onChange:g,marks:!0}),s.jsx($e,{min:c,max:d,step:f,fineStep:m,value:t.width,defaultValue:o,onChange:g})]})},dz=u.memo(uz);function fz(e,t){if(!e){t(void 0);return}t({width:e.offsetWidth,height:e.offsetHeight});const n=e.ownerDocument.defaultView??window,o=new n.ResizeObserver(r=>{if(!Array.isArray(r)||!r.length)return;const[l]=r;let c,d;if("borderBoxSize"in l){const f=l.borderBoxSize,m=Array.isArray(f)?f[0]:f;c=m.inlineSize,d=m.blockSize}else c=e.offsetWidth,d=e.offsetHeight;t({width:c,height:d})});return o.observe(e,{box:"border-box"}),()=>o.unobserve(e)}var mz=globalThis!=null&&globalThis.document?u.useLayoutEffect:u.useEffect;function hz(e,t){var n,o;if(!e||!e.parentElement)return;const r=(o=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?o:window,l=new r.MutationObserver(()=>{t()});return l.observe(e.parentElement,{childList:!0}),()=>{l.disconnect()}}function pz({getNodes:e,observeMutation:t=!0}){const[n,o]=u.useState([]),[r,l]=u.useState(0);return mz(()=>{const c=e(),d=c.map((f,m)=>fz(f,g=>{o(p=>[...p.slice(0,m),g,...p.slice(m+1)])}));if(t){const f=c[0];d.push(hz(f,()=>{l(m=>m+1)}))}return()=>{d.forEach(f=>{f==null||f()})}},[r]),n}function gz(e){return typeof e=="object"&&e!==null&&"current"in e}function xz(e){const[t]=pz({observeMutation:!1,getNodes(){return[gz(e)?e.current:e]}});return t}const vz=()=>{const e=fr(),t=u.useRef(null),n=xz(t),o=u.useMemo(()=>e.aspectRatioState.value<v8&&e.aspectRatioState.value>C8,[e.aspectRatioState.value]),{width:r,height:l}=u.useMemo(()=>{if(!n)return{width:0,height:0};let c=e.width,d=e.height;return e.width>e.height?(c=n.width,d=c/e.aspectRatioState.value):(d=n.height,c=d*e.aspectRatioState.value),{width:c,height:d}},[n,e.width,e.height,e.aspectRatioState.value]);return s.jsx(L,{w:"full",h:"full",alignItems:"center",justifyContent:"center",ref:t,children:s.jsx(L,{bg:"blackAlpha.400",borderRadius:"base",width:`${r}px`,height:`${l}px`,alignItems:"center",justifyContent:"center",children:s.jsx(Aa,{children:o&&s.jsx(L,{as:_l.div,initial:y8,animate:b8,exit:j8,style:S8,children:s.jsx(Vn,{as:Y7,color:"base.700",boxSize:k8})})})})})},Cz=mc.enum(["Free","16:9","3:2","4:3","1:1","3:4","2:3","9:16"]),yz=e=>Cz.safeParse(e).success,Jk=u.memo(()=>{const{t:e}=R(),t=fr(),n=u.useCallback(r=>{!r||!yz(r.value)||t.aspectRatioSelected(r.value)},[t]),o=u.useMemo(()=>r2.filter(r=>r.value===t.aspectRatioState.id)[0],[t.aspectRatioState.id]);return s.jsxs(U,{children:[s.jsx(Y,{children:e("parameters.aspect")}),s.jsx(Xe,{value:o,onChange:n,options:r2,sx:bz})]})});Jk.displayName="AspectRatioSelect";const bz={minW:24},ew=u.memo(()=>{const{t:e}=R(),t=fr(),n=u.useCallback(()=>{t.isLockedToggled()},[t]);return s.jsx(je,{tooltip:e("parameters.lockAspectRatio"),"aria-label":e("parameters.lockAspectRatio"),onClick:n,variant:t.aspectRatioState.isLocked?"outline":"ghost",size:"sm",icon:t.aspectRatioState.isLocked?s.jsx(Q7,{}):s.jsx(N7,{})})});ew.displayName="LockAspectRatioButton";const tw=u.memo(()=>{const{t:e}=R(),t=fr(),n=j(ls),o=u.useMemo(()=>w8(t.width,t.height,n),[t.height,t.width,n]),r=u.useMemo(()=>I8(t.width,t.height,n),[t.height,t.width,n]),l=u.useCallback(()=>{t.setOptimalSize()},[t]),c=u.useMemo(()=>e(o?"parameters.setToOptimalSizeTooSmall":r?"parameters.setToOptimalSizeTooLarge":"parameters.setToOptimalSize"),[r,o,e]);return s.jsx(je,{tooltip:c,"aria-label":e("parameters.setToOptimalSize"),onClick:l,variant:"ghost",size:"sm",icon:s.jsx(gg,{}),colorScheme:o||r?"warning":"base"})});tw.displayName="SetOptimalSizeButton";const nw=u.memo(()=>{const{t:e}=R(),t=fr(),n=u.useCallback(()=>{t.dimensionsSwapped()},[t]);return s.jsx(je,{tooltip:e("parameters.swapDimensions"),"aria-label":e("parameters.swapDimensions"),onClick:n,variant:"ghost",size:"sm",icon:s.jsx(p7,{})})});nw.displayName="SwapDimensionsButton";const $g=u.memo(e=>{const{widthComponent:t,heightComponent:n,...o}=e;return s.jsx(Xk.Provider,{value:o,children:s.jsxs(L,{gap:4,alignItems:"center",children:[s.jsx(L,{gap:4,flexDirection:"column",width:"full",children:s.jsxs(wn,{formLabelProps:jz,children:[s.jsxs(L,{gap:4,children:[s.jsx(Jk,{}),s.jsx(nw,{}),s.jsx(ew,{}),s.jsx(tw,{})]}),t,n]})}),s.jsx(L,{w:"108px",h:"108px",flexShrink:0,flexGrow:0,children:s.jsx(vz,{})})]})})});$g.displayName="ImageSize";const jz={minW:14},sw=u.memo(()=>{const e=J(),{width:t,height:n}=j(f=>f.canvas.boundingBoxDimensions),o=j(f=>f.canvas.aspectRatio),r=j(ls),l=u.useCallback(f=>{e(Ui({width:f},r))},[e,r]),c=u.useCallback(f=>{e(Ui({height:f},r))},[e,r]),d=u.useCallback(f=>{e(Gy(f))},[e]);return s.jsx($g,{width:t,height:n,aspectRatioState:o,heightComponent:s.jsx(cz,{}),widthComponent:s.jsx(dz,{}),onChangeAspectRatioState:d,onChangeWidth:l,onChangeHeight:c})});sw.displayName="ImageSizeCanvas";const ow=u.memo(()=>{const{t:e}=R(),t=fr(),n=j(ls),o=j(p=>p.config.sd.height.sliderMin),r=j(p=>p.config.sd.height.sliderMax),l=j(p=>p.config.sd.height.numberInputMin),c=j(p=>p.config.sd.height.numberInputMax),d=j(p=>p.config.sd.height.coarseStep),f=j(p=>p.config.sd.height.fineStep),m=u.useCallback(p=>{t.heightChanged(p)},[t]),g=u.useMemo(()=>[o,n,r],[o,n,r]);return s.jsxs(U,{children:[s.jsx(Y,{children:e("parameters.height")}),s.jsx(Ue,{value:t.height,defaultValue:n,onChange:m,min:o,max:r,step:d,fineStep:f,marks:g}),s.jsx($e,{value:t.height,defaultValue:n,onChange:m,min:l,max:c,step:d,fineStep:f})]})});ow.displayName="ParamHeight";const rw=u.memo(()=>{const{t:e}=R(),t=fr(),n=j(ls),o=j(p=>p.config.sd.width.sliderMin),r=j(p=>p.config.sd.width.sliderMax),l=j(p=>p.config.sd.width.numberInputMin),c=j(p=>p.config.sd.width.numberInputMax),d=j(p=>p.config.sd.width.coarseStep),f=j(p=>p.config.sd.width.fineStep),m=u.useCallback(p=>{t.widthChanged(p)},[t]),g=u.useMemo(()=>[o,n,r],[o,n,r]);return s.jsxs(U,{children:[s.jsx(Y,{children:e("parameters.width")}),s.jsx(Ue,{value:t.width,onChange:m,defaultValue:n,min:o,max:r,step:d,fineStep:f,marks:g}),s.jsx($e,{value:t.width,onChange:m,defaultValue:n,min:l,max:c,step:d,fineStep:f})]})});rw.displayName="ParamWidth";const lw=u.memo(()=>{const e=J(),t=j(d=>d.generation.width),n=j(d=>d.generation.height),o=j(d=>d.generation.aspectRatio),r=u.useCallback(d=>{e(Fy(d))},[e]),l=u.useCallback(d=>{e(zy(d))},[e]),c=u.useCallback(d=>{e(M8(d))},[e]);return s.jsx($g,{width:t,height:n,aspectRatioState:o,heightComponent:s.jsx(ow,{}),widthComponent:s.jsx(rw,{}),onChangeAspectRatioState:c,onChangeWidth:r,onChangeHeight:l})});lw.displayName="ImageSizeLinear";const Sz=Fe([Ss,rs,_8,js],(e,t,n,o)=>{const{shouldRandomizeSeed:r,model:l}=e,{hrfEnabled:c}=n,d=[];if(o==="unifiedCanvas"){const{aspectRatio:f,boundingBoxDimensions:{width:m,height:g}}=t;d.push(`${m}×${g}`),d.push(f.id),f.isLocked&&d.push("locked")}else{const{aspectRatio:f,width:m,height:g}=e;d.push(`${m}×${g}`),d.push(f.id),f.isLocked&&d.push("locked")}return r||d.push("Manual Seed"),c&&d.push("HiRes Fix"),{badges:d,activeTabName:o,isSDXL:(l==null?void 0:l.base_model)==="sdxl"}}),kz={minW:"4.5rem"},aw=u.memo(()=>{const{t:e}=R(),{badges:t,activeTabName:n,isSDXL:o}=j(Sz),{isOpen:r,onToggle:l}=Ya({id:"image-settings",defaultIsOpen:!0}),{isOpen:c,onToggle:d}=Gk({id:"image-settings-advanced",defaultIsOpen:!1});return s.jsx($a,{label:e("accordions.image.title"),badges:t,isOpen:r,onToggle:l,children:s.jsxs(L,{px:4,pt:4,w:"full",h:"full",flexDir:"column",children:[n==="unifiedCanvas"?s.jsx(sw,{}):s.jsx(lw,{}),s.jsx(Vy,{isOpen:c,onToggle:d,children:s.jsxs(L,{gap:4,pb:4,flexDir:"column",children:[s.jsxs(L,{gap:4,alignItems:"center",children:[s.jsx(Qk,{}),s.jsx(Yk,{}),s.jsx(Kk,{})]}),(n==="img2img"||n==="unifiedCanvas")&&s.jsx(lz,{}),n==="img2img"&&s.jsx(sz,{}),n==="txt2img"&&!o&&s.jsx(qk,{}),n==="unifiedCanvas"&&s.jsxs(s.Fragment,{children:[s.jsx(YF,{}),s.jsxs(wn,{formLabelProps:kz,children:[s.jsx(tz,{}),s.jsx(JF,{})]})]})]})})]})})});aw.displayName="ImageSettingsAccordion";const wz=()=>{const{t:e}=R(),t=J(),n=j(x=>x.sdxl.refinerCFGScale),o=j(x=>x.config.sd.guidance.sliderMin),r=j(x=>x.config.sd.guidance.sliderMax),l=j(x=>x.config.sd.guidance.numberInputMin),c=j(x=>x.config.sd.guidance.numberInputMax),d=j(x=>x.config.sd.guidance.coarseStep),f=j(x=>x.config.sd.guidance.fineStep),m=j(x=>x.config.sd.guidance.initial),g=u.useMemo(()=>[o,Math.floor(r/2),r],[r,o]),p=u.useCallback(x=>t(hy(x)),[t]);return s.jsxs(U,{children:[s.jsx(Y,{children:e("sdxl.cfgScale")}),s.jsx(Ue,{value:n,defaultValue:m,min:o,max:r,step:d,fineStep:f,onChange:p,marks:g}),s.jsx($e,{value:n,defaultValue:m,min:l,max:c,step:d,fineStep:f,onChange:p})]})},Iz=u.memo(wz),Mz=e=>{const{t}=R(),{modelEntities:n,selectedModel:o,getIsDisabled:r,onChange:l,isLoading:c,optionsFilter:d=()=>!0}=e,f=u.useMemo(()=>n?ys(n.entities).filter(d).map(y=>({label:y.model_name,value:y.id,isDisabled:r?r(y):!1})):[],[d,r,n]),m=u.useMemo(()=>f.find(y=>o?y.value===D0(o):!1),[f,o]),g=u.useCallback(y=>{if(!y){l(null);return}const S=n==null?void 0:n.entities[y.value];if(!S){l(null);return}l(S)},[n==null?void 0:n.entities,l]),p=u.useMemo(()=>c?t("common.loading"):f.length===0?t("models.noModelsAvailable"):t("models.selectModel"),[c,f,t]),x=u.useCallback(()=>t("models.noMatchingModels"),[t]);return{options:f,value:m,onChange:g,placeholder:p,noOptionsMessage:x}},_z=Fe(Zy,e=>e.refinerModel),Az=e=>e.base_model==="sdxl-refiner",Pz=()=>{const e=J(),t=j(_z),{t:n}=R(),{data:o,isLoading:r}=so(Fg),l=u.useCallback(p=>{if(!p){e(wp(null));return}e(wp({base_model:"sdxl-refiner",model_name:p.model_name,model_type:p.model_type}))},[e]),{options:c,value:d,onChange:f,placeholder:m,noOptionsMessage:g}=Mz({modelEntities:o,onChange:l,selectedModel:t,isLoading:r,optionsFilter:Az});return s.jsxs(U,{isDisabled:!c.length,isInvalid:!c.length,children:[s.jsx(Y,{children:n("sdxl.refinermodel")}),s.jsx(Xe,{value:d,placeholder:m,options:c,onChange:f,noOptionsMessage:g,isClearable:!0})]})},Ez=u.memo(Pz),Dz=()=>{const e=j(r=>r.sdxl.refinerNegativeAestheticScore),t=J(),{t:n}=R(),o=u.useCallback(r=>t(xy(r)),[t]);return s.jsxs(U,{children:[s.jsx(Y,{children:n("sdxl.negAestheticScore")}),s.jsx(Ue,{min:1,max:10,step:.5,fineStep:.1,onChange:o,value:e,defaultValue:2.5,marks:!0}),s.jsx($e,{min:1,max:10,step:.5,fineStep:.1,onChange:o,value:e,defaultValue:2.5})]})},Lz=u.memo(Dz),Tz=()=>{const e=j(r=>r.sdxl.refinerPositiveAestheticScore),t=J(),{t:n}=R(),o=u.useCallback(r=>t(gy(r)),[t]);return s.jsxs(U,{children:[s.jsx(Y,{children:n("sdxl.posAestheticScore")}),s.jsx(Ue,{step:.5,min:1,max:10,fineStep:.1,onChange:o,value:e,defaultValue:6,marks:!0}),s.jsx($e,{step:.5,min:1,max:10,fineStep:.1,onChange:o,value:e,defaultValue:6})]})},Rz=u.memo(Tz),Bz=()=>{const e=J(),{t}=R(),n=j(l=>l.sdxl.refinerScheduler),o=u.useCallback(l=>{ya(l==null?void 0:l.value)&&e(py(l.value))},[e]),r=u.useMemo(()=>Pa.find(l=>l.value===n),[n]);return s.jsxs(U,{children:[s.jsx(Y,{children:t("sdxl.scheduler")}),s.jsx(Xe,{value:r,options:Pa,onChange:o})]})},Oz=u.memo(Bz),Nz=()=>{const e=j(r=>r.sdxl.refinerStart),t=J(),n=u.useCallback(r=>t(vy(r)),[t]),{t:o}=R();return s.jsxs(U,{children:[s.jsx(Y,{children:o("sdxl.refinerStart")}),s.jsx(Ue,{step:.01,min:0,max:1,onChange:n,defaultValue:.8,value:e,marks:!0}),s.jsx($e,{step:.01,min:0,max:1,onChange:n,defaultValue:.8,value:e})]})},Fz=u.memo(Nz),zz=()=>{const{t:e}=R(),t=J(),n=j(x=>x.sdxl.refinerSteps),o=j(x=>x.config.sd.steps.initial),r=j(x=>x.config.sd.steps.sliderMin),l=j(x=>x.config.sd.steps.sliderMax),c=j(x=>x.config.sd.steps.numberInputMin),d=j(x=>x.config.sd.steps.numberInputMax),f=j(x=>x.config.sd.steps.coarseStep),m=j(x=>x.config.sd.steps.fineStep),g=u.useMemo(()=>[r,Math.floor(l/2),l],[l,r]),p=u.useCallback(x=>{t(my(x))},[t]);return s.jsxs(U,{children:[s.jsx(Y,{children:e("sdxl.steps")}),s.jsx(Ue,{value:n,defaultValue:o,min:r,max:l,step:f,fineStep:m,onChange:p,marks:g}),s.jsx($e,{value:n,defaultValue:o,min:c,max:d,step:f,fineStep:m,onChange:p})]})},Hz=u.memo(zz),$z=()=>{const{isRefinerAvailable:e}=so(Fg,{selectFromResult:({data:t})=>({isRefinerAvailable:t?t.ids.length>0:!1})});return e},Vz={minW:"9.2rem"},Wz={minW:"5rem"},Uz=Fe(Zy,e=>e.refinerModel?["Enabled"]:void 0),iw=u.memo(()=>{const{t:e}=R(),t=$z(),n=j(Uz),{isOpen:o,onToggle:r}=Ya({id:"refiner-settings",defaultIsOpen:!1});return s.jsx($a,{label:e("sdxl.refiner"),badges:n,isOpen:o,onToggle:r,children:t?s.jsx(uw,{}):s.jsx(cw,{})})});iw.displayName="RefinerSettingsAccordion";const cw=u.memo(()=>{const{t:e}=R();return s.jsx(L,{justifyContent:"center",p:4,children:s.jsx(pe,{fontSize:"sm",color:"base.500",children:e("models.noRefinerModelsInstalled")})})});cw.displayName="RefinerSettingsAccordionNoRefiner";const uw=u.memo(()=>{const e=j(t=>!zn(t.sdxl.refinerModel));return s.jsx(wn,{isDisabled:!e,children:s.jsxs(L,{p:4,gap:4,flexDir:"column",children:[s.jsx(Ez,{}),s.jsxs(wn,{formLabelProps:Wz,isDisabled:!e,children:[s.jsx(Oz,{}),s.jsx(Hz,{}),s.jsx(Iz,{}),s.jsx(Fz,{})]}),s.jsxs(wn,{formLabelProps:Vz,isDisabled:!e,children:[s.jsx(Rz,{}),s.jsx(Lz,{})]})]})})});uw.displayName="RefinerSettingsAccordionContent";const Gz={height:"100%",width:"100%"},Zz=()=>{const e=j(js),t=j(n=>{var o;return((o=n.generation.model)==null?void 0:o.base_model)==="sdxl"});return s.jsxs(L,{w:"full",h:"full",flexDir:"column",gap:2,children:[s.jsx($S,{}),s.jsx(L,{w:"full",h:"full",position:"relative",children:s.jsx(We,{position:"absolute",top:0,left:0,right:0,bottom:0,children:s.jsx(Of,{defer:!0,style:Gz,options:kc.options,children:s.jsxs(L,{gap:2,flexDirection:"column",h:"full",w:"full",children:[t?s.jsx(Ok,{}):s.jsx(Tk,{}),s.jsx(aw,{}),s.jsx(Zk,{}),s.jsx(Vk,{}),e==="unifiedCanvas"&&s.jsx(Fk,{}),t&&s.jsx(iw,{}),s.jsx(Nk,{})]})})})})]})},qz=u.memo(Zz),Qz=Fe(Ss,e=>e.initialImage),Kz=()=>{const{t:e}=R(),t=J(),n=j(Qz),o=j(f=>f.system.isConnected),{currentData:r,isError:l}=zs((n==null?void 0:n.imageName)??ss),c=u.useMemo(()=>{if(r)return{id:"initial-image",payloadType:"IMAGE_DTO",payload:{imageDTO:r}}},[r]),d=u.useMemo(()=>({id:"initial-image",actionType:"SET_INITIAL_IMAGE"}),[]);return u.useEffect(()=>{l&&o&&t(qy())},[t,o,l]),s.jsx(Wr,{imageDTO:r,droppableData:d,draggableData:c,isUploadDisabled:!0,fitContainer:!0,dropLabel:e("toast.setInitialImage"),noContentFallback:s.jsx(Yt,{label:e("parameters.invoke.noInitialImageSelected")}),dataTestId:"initial-image"})},Yz=u.memo(Kz),Xz=Fe(Ss,e=>e.initialImage),Jz={type:"SET_INITIAL_IMAGE"},eH=()=>{const{recallWidthAndHeight:e}=_c(),{t}=R(),n=j(Xz),o=J(),{getUploadButtonProps:r,getUploadInputProps:l}=Pg({postUploadAction:Jz}),c=u.useCallback(()=>{o(qy())},[o]),d=u.useCallback(()=>{n&&e(n.width,n.height)},[n,e]);return Oe("shift+d",d,[n]),s.jsxs(L,{layerStyle:"first",position:"relative",flexDirection:"column",height:"full",width:"full",alignItems:"center",justifyContent:"center",borderRadius:"base",p:2,gap:4,children:[s.jsxs(L,{w:"full",flexWrap:"wrap",justifyContent:"center",alignItems:"center",gap:2,children:[s.jsx(pe,{ps:2,fontWeight:"semibold",userSelect:"none",color:"base.200",children:t("metadata.initImage")}),s.jsx(Cs,{}),s.jsx(je,{tooltip:t("toast.uploadInitialImage"),"aria-label":t("toast.uploadInitialImage"),icon:s.jsx(_f,{}),...r()}),s.jsx(je,{tooltip:`${t("parameters.useSize")} (Shift+D)`,"aria-label":`${t("parameters.useSize")} (Shift+D)`,icon:s.jsx(Q0,{}),onClick:d,isDisabled:!n}),s.jsx(je,{tooltip:t("toast.resetInitialImage"),"aria-label":t("toast.resetInitialImage"),icon:s.jsx(vc,{}),onClick:c,isDisabled:!n})]}),s.jsx(Yz,{}),s.jsx("input",{...l()})]})},tH=u.memo(eH),dw=u.memo(e=>{const{onClick:t,isDisabled:n}=e,{t:o}=R(),r=j(l=>l.system.isConnected);return s.jsx(je,{onClick:t,icon:s.jsx(Vs,{}),tooltip:`${o("gallery.deleteImage")} (Del)`,"aria-label":`${o("gallery.deleteImage")} (Del)`,isDisabled:n||!r,colorScheme:"error"})});dw.displayName="DeleteImageButton";const fw=()=>{const[e,{isLoading:t}]=rf({fixedCacheKey:"enqueueBatch"}),[n,{isLoading:o}]=Sy({fixedCacheKey:"resumeProcessor"}),[r,{isLoading:l}]=jy({fixedCacheKey:"pauseProcessor"}),[c,{isLoading:d}]=d0({fixedCacheKey:"cancelQueueItem"}),[f,{isLoading:m}]=QC({fixedCacheKey:"clearQueue"}),[g,{isLoading:p}]=Qy({fixedCacheKey:"pruneQueue"});return t||o||l||d||m||p},Hv=[{label:"x2 Upscalers",options:[{label:"RealESRGAN x2 Plus",value:"RealESRGAN_x2plus.pth",description:"Attempts to retain sharpness, low smoothing"}]},{label:"x4 Upscalers",options:[{label:"RealESRGAN x4 Plus",value:"RealESRGAN_x4plus.pth",description:"Best for photos and highly detailed images, medium smoothing"},{label:"RealESRGAN x4 Plus (anime 6B)",value:"RealESRGAN_x4plus_anime_6B.pth",description:"Best for anime/manga, high smoothing"},{label:"ESRGAN SRx4",value:"ESRGAN_SRx4_DF2KOST_official-ff704c30.pth",description:"Retains sharpness, low smoothing"}]}],nH=()=>{const{t:e}=R(),t=j(l=>l.postprocessing.esrganModelName),n=J(),o=u.useCallback(l=>{A8(l==null?void 0:l.value)&&n(P8(l.value))},[n]),r=u.useMemo(()=>Hv.flatMap(l=>l.options).find(l=>l.value===t),[t]);return s.jsxs(U,{orientation:"vertical",children:[s.jsxs(Y,{children:[e("models.esrganModel")," "]}),s.jsx(Xe,{value:r,onChange:o,options:Hv})]})},sH=u.memo(nH),oH=e=>{const{imageDTO:t}=e,n=J(),o=fw(),{t:r}=R(),{isOpen:l,onOpen:c,onClose:d}=an(),{isAllowedToUpscale:f,detail:m}=E8(t),g=u.useCallback(()=>{d(),!(!t||!f)&&n(Ky({imageDTO:t}))},[n,t,f,d]);return s.jsxs(Zr,{isOpen:l,onClose:d,isLazy:!0,children:[s.jsx(za,{children:s.jsx(je,{tooltip:r("parameters.upscale"),onClick:c,icon:s.jsx(Xb,{}),"aria-label":r("parameters.upscale")})}),s.jsx(qr,{children:s.jsx(Qr,{minW:96,children:s.jsxs(L,{flexDirection:"column",gap:4,children:[s.jsx(sH,{}),s.jsx(Ge,{tooltip:m,size:"sm",isDisabled:!t||o||!f,onClick:g,children:r("parameters.upscaleImage")})]})})})]})},rH=u.memo(oH),lH=ft(Na,uc,hf,(e,t,n)=>{var r;return!!((r=e.denoiseProgress)!=null&&r.progress_image)||!n}),aH=()=>{const e=J(),t=j($=>$.system.isConnected),n=j($=>$.ui.shouldShowImageDetails),o=j($=>$.ui.shouldShowProgressInViewer),r=j(hf),l=j(lH),c=Kt("upscaling").isFeatureEnabled,d=fw(),f=ao(),{t:m}=R(),{recallBothPrompts:g,recallSeed:p,recallWidthAndHeight:x,recallAllParameters:y}=_c(),{currentData:S}=zs((r==null?void 0:r.image_name)??ss),{metadata:b,isLoading:I}=Dg(r==null?void 0:r.image_name),{getAndLoadEmbeddedWorkflow:M,getAndLoadEmbeddedWorkflowResult:w}=TS({}),_=u.useCallback(()=>{!r||!r.has_workflow||M(r.image_name)},[M,r]);Oe("w",_,[r]);const T=u.useCallback(()=>{y(b)},[b,y]);Oe("a",T,[b]);const D=u.useCallback(()=>{p(b==null?void 0:b.seed)},[b==null?void 0:b.seed,p]);Oe("s",D,[b]);const A=u.useCallback(()=>{g(b==null?void 0:b.positive_prompt,b==null?void 0:b.negative_prompt,b==null?void 0:b.positive_style_prompt,b==null?void 0:b.negative_style_prompt)},[b==null?void 0:b.negative_prompt,b==null?void 0:b.positive_prompt,b==null?void 0:b.positive_style_prompt,b==null?void 0:b.negative_style_prompt,g]);Oe("p",A,[b]);const F=u.useCallback(()=>{y({...b,seed:void 0})},[b,y]);Oe("r",F,[b]);const Q=u.useCallback(()=>{x(b==null?void 0:b.width,b==null?void 0:b.height)},[b==null?void 0:b.width,b==null?void 0:b.height,x]);Oe("d",Q,[b]);const q=u.useCallback(()=>{e(LS()),e(Cf(S))},[e,S]);Oe("shift+i",q,[S]);const G=u.useCallback(()=>{S&&e(Ky({imageDTO:S}))},[e,S]),Z=u.useCallback(()=>{S&&e(pf([S]))},[e,S]);Oe("Shift+U",()=>{G()},{enabled:()=>!!(c&&!l&&t)},[c,S,l,t]);const N=u.useCallback(()=>e(D8(!n)),[e,n]);Oe("i",()=>{S?N():f({title:m("toast.metadataLoadFailed"),status:"error",duration:2500,isClosable:!0})},[S,n,f]),Oe("delete",()=>{Z()},[e,S]);const z=u.useCallback(()=>{e(Ry(!o))},[e,o]);return s.jsx(s.Fragment,{children:s.jsxs(L,{flexWrap:"wrap",justifyContent:"center",alignItems:"center",gap:2,children:[s.jsx(wt,{isDisabled:l,children:s.jsxs(yf,{isLazy:!0,children:[s.jsx(bf,{as:je,"aria-label":m("parameters.imageActions"),tooltip:m("parameters.imageActions"),isDisabled:!S,icon:s.jsx(X0,{})}),s.jsx(zr,{children:S&&s.jsx(RS,{imageDTO:S})})]})}),s.jsxs(wt,{isDisabled:l,children:[s.jsx(je,{icon:s.jsx(If,{}),tooltip:`${m("nodes.loadWorkflow")} (W)`,"aria-label":`${m("nodes.loadWorkflow")} (W)`,isDisabled:!(S!=null&&S.has_workflow),onClick:_,isLoading:w.isLoading}),s.jsx(je,{isLoading:I,icon:s.jsx(Z0,{}),tooltip:`${m("parameters.remixImage")} (R)`,"aria-label":`${m("parameters.remixImage")} (R)`,isDisabled:!(b!=null&&b.positive_prompt),onClick:F}),s.jsx(je,{isLoading:I,icon:s.jsx(ej,{}),tooltip:`${m("parameters.usePrompt")} (P)`,"aria-label":`${m("parameters.usePrompt")} (P)`,isDisabled:!(b!=null&&b.positive_prompt),onClick:A}),s.jsx(je,{isLoading:I,icon:s.jsx(Jb,{}),tooltip:`${m("parameters.useSeed")} (S)`,"aria-label":`${m("parameters.useSeed")} (S)`,isDisabled:(b==null?void 0:b.seed)===null||(b==null?void 0:b.seed)===void 0,onClick:D}),s.jsx(je,{isLoading:I,icon:s.jsx(Q0,{}),tooltip:`${m("parameters.useSize")} (D)`,"aria-label":`${m("parameters.useSize")} (D)`,isDisabled:(b==null?void 0:b.height)===null||(b==null?void 0:b.height)===void 0||(b==null?void 0:b.width)===null||(b==null?void 0:b.width)===void 0,onClick:Q}),s.jsx(je,{isLoading:I,icon:s.jsx(Gb,{}),tooltip:`${m("parameters.useAll")} (A)`,"aria-label":`${m("parameters.useAll")} (A)`,isDisabled:!b,onClick:T})]}),c&&s.jsx(wt,{isDisabled:d,children:c&&s.jsx(rH,{imageDTO:S})}),s.jsx(wt,{children:s.jsx(je,{icon:s.jsx(Mf,{}),tooltip:`${m("parameters.info")} (I)`,"aria-label":`${m("parameters.info")} (I)`,isChecked:n,onClick:N})}),s.jsx(wt,{children:s.jsx(je,{"aria-label":m("settings.displayInProgress"),tooltip:m("settings.displayInProgress"),icon:s.jsx(E7,{}),isChecked:o,onClick:z})}),s.jsx(wt,{children:s.jsx(dw,{onClick:Z})})]})})},iH=u.memo(aH),cH=()=>{const e=j(o=>{var r;return(r=o.system.denoiseProgress)==null?void 0:r.progress_image}),t=j(o=>o.system.shouldAntialiasProgressImage),n=u.useMemo(()=>({imageRendering:t?"auto":"pixelated"}),[t]);return e?s.jsx(ur,{src:e.dataURL,width:e.width,height:e.height,draggable:!1,"data-testid":"progress-image",objectFit:"contain",maxWidth:"full",maxHeight:"full",position:"absolute",borderRadius:"base",sx:n}):null},uH=u.memo(cH);function dH(e){return Ie({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M245.09 327.74v-37.32c57.07 0 84.51 13.47 108.58 38.68 5.4 5.65 15 1.32 14.29-6.43-5.45-61.45-34.14-117.09-122.87-117.09v-37.32a8.32 8.32 0 0 0-14.05-6L146.58 242a8.2 8.2 0 0 0 0 11.94L231 333.71a8.32 8.32 0 0 0 14.09-5.97z"},child:[]},{tag:"path",attr:{fill:"none",strokeMiterlimit:"10",strokeWidth:"32",d:"M256 64C150 64 64 150 64 256s86 192 192 192 192-86 192-192S362 64 256 64z"},child:[]}]})(e)}const fH=({label:e,value:t,onClick:n,isLink:o,labelPosition:r,withCopy:l=!1})=>{const{t:c}=R(),d=u.useCallback(()=>navigator.clipboard.writeText(t.toString()),[t]);return t?s.jsxs(L,{gap:2,children:[n&&s.jsx(jt,{label:`Recall ${e}`,children:s.jsx(je,{"aria-label":c("accessibility.useThisParameter"),icon:s.jsx(dH,{}),size:"xs",variant:"ghost",fontSize:20,onClick:n})}),l&&s.jsx(jt,{label:`Copy ${e}`,children:s.jsx(je,{"aria-label":`Copy ${e}`,icon:s.jsx(el,{}),size:"xs",variant:"ghost",fontSize:14,onClick:d})}),s.jsxs(L,{direction:r?"column":"row",children:[s.jsxs(pe,{fontWeight:"semibold",whiteSpace:"pre-wrap",pr:2,children:[e,":"]}),o?s.jsx(Oi,{href:t.toString(),label:t.toString()}):s.jsx(pe,{overflowY:"scroll",wordBreak:"break-all",children:t.toString()})]})]}):null},Zt=u.memo(fH),mH=e=>{var xe;const{metadata:t}=e,{t:n}=R(),{recallPositivePrompt:o,recallNegativePrompt:r,recallSeed:l,recallCfgScale:c,recallCfgRescaleMultiplier:d,recallModel:f,recallScheduler:m,recallVaeModel:g,recallSteps:p,recallWidth:x,recallHeight:y,recallStrength:S,recallHrfEnabled:b,recallHrfStrength:I,recallHrfMethod:M,recallLoRA:w,recallControlNet:_,recallIPAdapter:T,recallT2IAdapter:D,recallSDXLPositiveStylePrompt:A,recallSDXLNegativeStylePrompt:F}=_c(),Q=u.useCallback(()=>{o(t==null?void 0:t.positive_prompt)},[t==null?void 0:t.positive_prompt,o]),q=u.useCallback(()=>{r(t==null?void 0:t.negative_prompt)},[t==null?void 0:t.negative_prompt,r]),G=u.useCallback(()=>{A(t==null?void 0:t.positive_style_prompt)},[t==null?void 0:t.positive_style_prompt,A]),Z=u.useCallback(()=>{F(t==null?void 0:t.negative__style_prompt)},[t==null?void 0:t.negative__style_prompt,F]),N=u.useCallback(()=>{l(t==null?void 0:t.seed)},[t==null?void 0:t.seed,l]),z=u.useCallback(()=>{f(t==null?void 0:t.model)},[t==null?void 0:t.model,f]),$=u.useCallback(()=>{x(t==null?void 0:t.width)},[t==null?void 0:t.width,x]),se=u.useCallback(()=>{y(t==null?void 0:t.height)},[t==null?void 0:t.height,y]),he=u.useCallback(()=>{m(t==null?void 0:t.scheduler)},[t==null?void 0:t.scheduler,m]),ke=u.useCallback(()=>{g(t==null?void 0:t.vae)},[t==null?void 0:t.vae,g]),Ce=u.useCallback(()=>{p(t==null?void 0:t.steps)},[t==null?void 0:t.steps,p]),ge=u.useCallback(()=>{c(t==null?void 0:t.cfg_scale)},[t==null?void 0:t.cfg_scale,c]),De=u.useCallback(()=>{d(t==null?void 0:t.cfg_rescale_multiplier)},[t==null?void 0:t.cfg_rescale_multiplier,d]),Se=u.useCallback(()=>{S(t==null?void 0:t.strength)},[t==null?void 0:t.strength,S]),oe=u.useCallback(()=>{b(t==null?void 0:t.hrf_enabled)},[t==null?void 0:t.hrf_enabled,b]),re=u.useCallback(()=>{I(t==null?void 0:t.hrf_strength)},[t==null?void 0:t.hrf_strength,I]),de=u.useCallback(()=>{M(t==null?void 0:t.hrf_method)},[t==null?void 0:t.hrf_method,M]),P=u.useCallback(W=>{w(W)},[w]),B=u.useCallback(W=>{_(W)},[_]),H=u.useCallback(W=>{T(W)},[T]),V=u.useCallback(W=>{D(W)},[D]),le=u.useMemo(()=>t!=null&&t.controlnets?t.controlnets.filter(W=>kd(W.control_model)):[],[t==null?void 0:t.controlnets]),fe=u.useMemo(()=>t!=null&&t.ipAdapters?t.ipAdapters.filter(W=>kd(W.ip_adapter_model)):[],[t==null?void 0:t.ipAdapters]),ue=u.useMemo(()=>t!=null&&t.t2iAdapters?t.t2iAdapters.filter(W=>L8(W.t2i_adapter_model)):[],[t==null?void 0:t.t2iAdapters]);return!t||Object.keys(t).length===0?null:s.jsxs(s.Fragment,{children:[t.created_by&&s.jsx(Zt,{label:n("metadata.createdBy"),value:t.created_by}),t.generation_mode&&s.jsx(Zt,{label:n("metadata.generationMode"),value:t.generation_mode}),t.positive_prompt&&s.jsx(Zt,{label:n("metadata.positivePrompt"),labelPosition:"top",value:t.positive_prompt,onClick:Q}),t.negative_prompt&&s.jsx(Zt,{label:n("metadata.negativePrompt"),labelPosition:"top",value:t.negative_prompt,onClick:q}),t.positive_style_prompt&&s.jsx(Zt,{label:n("sdxl.posStylePrompt"),labelPosition:"top",value:t.positive_style_prompt,onClick:G}),t.negative_style_prompt&&s.jsx(Zt,{label:n("sdxl.negStylePrompt"),labelPosition:"top",value:t.negative_style_prompt,onClick:Z}),t.seed!==void 0&&t.seed!==null&&s.jsx(Zt,{label:n("metadata.seed"),value:t.seed,onClick:N}),t.model!==void 0&&t.model!==null&&t.model.model_name&&s.jsx(Zt,{label:n("metadata.model"),value:t.model.model_name,onClick:z}),t.width&&s.jsx(Zt,{label:n("metadata.width"),value:t.width,onClick:$}),t.height&&s.jsx(Zt,{label:n("metadata.height"),value:t.height,onClick:se}),t.scheduler&&s.jsx(Zt,{label:n("metadata.scheduler"),value:t.scheduler,onClick:he}),s.jsx(Zt,{label:n("metadata.vae"),value:((xe=t.vae)==null?void 0:xe.model_name)??"Default",onClick:ke}),t.steps&&s.jsx(Zt,{label:n("metadata.steps"),value:t.steps,onClick:Ce}),t.cfg_scale!==void 0&&t.cfg_scale!==null&&s.jsx(Zt,{label:n("metadata.cfgScale"),value:t.cfg_scale,onClick:ge}),t.cfg_rescale_multiplier!==void 0&&t.cfg_rescale_multiplier!==null&&s.jsx(Zt,{label:n("metadata.cfgRescaleMultiplier"),value:t.cfg_rescale_multiplier,onClick:De}),t.strength&&s.jsx(Zt,{label:n("metadata.strength"),value:t.strength,onClick:Se}),t.hrf_enabled&&s.jsx(Zt,{label:n("hrf.metadata.enabled"),value:t.hrf_enabled,onClick:oe}),t.hrf_enabled&&t.hrf_strength&&s.jsx(Zt,{label:n("hrf.metadata.strength"),value:t.hrf_strength,onClick:re}),t.hrf_enabled&&t.hrf_method&&s.jsx(Zt,{label:n("hrf.metadata.method"),value:t.hrf_method,onClick:de}),t.loras&&t.loras.map((W,Me)=>{if(cy(W.lora))return s.jsx(Zt,{label:"LoRA",value:`${W.lora.model_name} - ${W.weight}`,onClick:P.bind(null,W)},Me)}),le.map((W,Me)=>{var ye;return s.jsx(Zt,{label:"ControlNet",value:`${(ye=W.control_model)==null?void 0:ye.model_name} - ${W.control_weight}`,onClick:B.bind(null,W)},Me)}),fe.map((W,Me)=>{var ye;return s.jsx(Zt,{label:"IP Adapter",value:`${(ye=W.ip_adapter_model)==null?void 0:ye.model_name} - ${W.weight}`,onClick:H.bind(null,W)},Me)}),ue.map((W,Me)=>{var ye;return s.jsx(Zt,{label:"T2I Adapter",value:`${(ye=W.t2i_adapter_model)==null?void 0:ye.model_name} - ${W.weight}`,onClick:V.bind(null,W)},Me)})]})},hH=u.memo(mH),pH=e=>{const t=j(l=>l.config.workflowFetchDebounce??300),[n]=Eg(e!=null&&e.has_workflow?e.image_name:null,t),{data:o,isLoading:r}=T8(n??ss);return{workflow:o,isLoading:r}},gH=({image:e})=>{const{t}=R(),{workflow:n}=pH(e);return n?s.jsx(Ur,{data:n,label:t("metadata.workflow")}):s.jsx(Yt,{label:t("nodes.noWorkflow")})},xH=u.memo(gH),vH=({image:e})=>{const{t}=R(),{metadata:n}=Dg(e.image_name);return s.jsxs(L,{layerStyle:"first",padding:4,gap:1,flexDirection:"column",width:"full",height:"full",borderRadius:"base",position:"absolute",overflow:"hidden",children:[s.jsx(Oi,{href:e.image_url,label:e.image_name}),s.jsxs(Xr,{variant:"line",isLazy:!0,display:"flex",flexDir:"column",w:"full",h:"full",children:[s.jsxs(Jr,{children:[s.jsx(hn,{children:t("metadata.recallParameters")}),s.jsx(hn,{children:t("metadata.metadata")}),s.jsx(hn,{children:t("metadata.imageDetails")}),s.jsx(hn,{children:t("metadata.workflow")})]}),s.jsxs(Rl,{children:[s.jsx(An,{children:n?s.jsx(io,{children:s.jsx(hH,{metadata:n})}):s.jsx(Yt,{label:t("metadata.noRecallParameters")})}),s.jsx(An,{children:n?s.jsx(Ur,{data:n,label:t("metadata.metadata")}):s.jsx(Yt,{label:t("metadata.noMetaData")})}),s.jsx(An,{children:e?s.jsx(Ur,{data:e,label:t("metadata.imageDetails")}):s.jsx(Yt,{label:t("metadata.noImageDetails")})}),s.jsx(An,{children:s.jsx(xH,{image:e})})]})]})]})},CH=u.memo(vH),ep={color:"base.100",pointerEvents:"auto"},yH=()=>{const{t:e}=R(),{handleLeftImage:t,handleRightImage:n,isOnFirstImage:o,isOnLastImage:r}=Jj(),{areMoreImagesAvailable:l,handleLoadMoreImages:c,queryResult:{isFetching:d}}=Ff();return s.jsxs(We,{pos:"relative",h:"full",w:"full",children:[s.jsx(We,{pos:"absolute",top:"50%",transform:"translate(0, -50%)",insetInlineStart:1,children:!o&&s.jsx(je,{"aria-label":e("accessibility.previousImage"),icon:s.jsx(Zb,{size:64}),variant:"unstyled",onClick:t,boxSize:16,sx:ep})}),s.jsxs(We,{pos:"absolute",top:"50%",transform:"translate(0, -50%)",insetInlineEnd:6,children:[!r&&s.jsx(je,{"aria-label":e("accessibility.nextImage"),icon:s.jsx(qb,{size:64}),variant:"unstyled",onClick:n,boxSize:16,sx:ep}),r&&l&&!d&&s.jsx(je,{"aria-label":e("accessibility.loadMore"),icon:s.jsx(v7,{size:64}),variant:"unstyled",onClick:c,boxSize:16,sx:ep}),r&&l&&d&&s.jsx(L,{w:16,h:16,alignItems:"center",justifyContent:"center",children:s.jsx(Kr,{opacity:.5,size:"xl"})})]})]})},mw=u.memo(yH),bH=ft(hf,e=>e==null?void 0:e.image_name),jH=()=>{const e=j(y=>y.ui.shouldShowImageDetails),t=j(bH),n=j(y=>!!y.system.denoiseProgress),o=j(y=>y.ui.shouldShowProgressInViewer),{currentData:r}=zs(t??ss),l=u.useMemo(()=>{if(r)return{id:"current-image",payloadType:"IMAGE_DTO",payload:{imageDTO:r}}},[r]),c=u.useMemo(()=>({id:"current-image",actionType:"SET_CURRENT_IMAGE"}),[]),[d,f]=u.useState(!1),m=u.useRef(0),{t:g}=R(),p=u.useCallback(()=>{f(!0),window.clearTimeout(m.current)},[]),x=u.useCallback(()=>{m.current=window.setTimeout(()=>{f(!1)},500)},[]);return s.jsxs(L,{onMouseOver:p,onMouseOut:x,width:"full",height:"full",alignItems:"center",justifyContent:"center",position:"relative",children:[n&&o?s.jsx(uH,{}):s.jsx(Wr,{imageDTO:r,droppableData:c,draggableData:l,isUploadDisabled:!0,fitContainer:!0,useThumbailFallback:!0,dropLabel:g("gallery.setCurrentImage"),noContentFallback:s.jsx(Yt,{icon:Qi,label:g("gallery.noImageSelected")}),dataTestId:"image-preview"}),e&&r&&s.jsx(We,{position:"absolute",top:"0",width:"full",height:"full",borderRadius:"base",children:s.jsx(CH,{image:r})}),s.jsx(Aa,{children:!e&&r&&d&&s.jsx(_l.div,{initial:kH,animate:wH,exit:IH,style:MH,children:s.jsx(mw,{})},"nextPrevButtons")})]})},SH=u.memo(jH),kH={opacity:0},wH={opacity:1,transition:{duration:.1}},IH={opacity:0,transition:{duration:.1}},MH={position:"absolute",top:"0",width:"100%",height:"100%",pointerEvents:"none"},_H=()=>s.jsxs(L,{position:"relative",flexDirection:"column",height:"100%",width:"100%",rowGap:4,alignItems:"center",justifyContent:"center",children:[s.jsx(iH,{}),s.jsx(SH,{})]}),AH=u.memo(_H),PH=()=>s.jsx(We,{layerStyle:"first",position:"relative",w:"full",h:"full",p:2,borderRadius:"base",children:s.jsx(L,{w:"full",h:"full",children:s.jsx(AH,{})})}),hw=u.memo(PH),EH={height:"100%",width:"100%"},DH={position:"relative"},LH=()=>{const e=u.useRef(null),t=u.useCallback(()=>{e.current&&e.current.setLayout([50,50])},[]),n=Tg();return s.jsx(We,{w:"full",h:"full",children:s.jsxs(Kf,{ref:e,autoSaveId:"imageTab.content",direction:"horizontal",style:EH,storage:n,children:[s.jsx(Fr,{id:"imageTab.content.initImage",order:0,defaultSize:50,minSize:25,style:DH,children:s.jsx(tH,{})}),s.jsx(Yd,{orientation:"vertical",onDoubleClick:t}),s.jsx(Fr,{id:"imageTab.content.selectedImage",order:1,defaultSize:50,minSize:25,children:s.jsx(hw,{})})]})})},TH=u.memo(LH),pw=u.memo;var Dc=e=>e.type==="checkbox",pa=e=>e instanceof Date,Nn=e=>e==null;const gw=e=>typeof e=="object";var pn=e=>!Nn(e)&&!Array.isArray(e)&&gw(e)&&!pa(e),xw=e=>pn(e)&&e.target?Dc(e.target)?e.target.checked:e.target.value:e,RH=e=>e.substring(0,e.search(/\.\d+(\.|$)/))||e,vw=(e,t)=>e.has(RH(t)),BH=e=>{const t=e.constructor&&e.constructor.prototype;return pn(t)&&t.hasOwnProperty("isPrototypeOf")},Vg=typeof window<"u"&&typeof window.HTMLElement<"u"&&typeof document<"u";function es(e){let t;const n=Array.isArray(e);if(e instanceof Date)t=new Date(e);else if(e instanceof Set)t=new Set(e);else if(!(Vg&&(e instanceof Blob||e instanceof FileList))&&(n||pn(e)))if(t=n?[]:{},!n&&!BH(e))t=e;else for(const o in e)e.hasOwnProperty(o)&&(t[o]=es(e[o]));else return e;return t}var Lc=e=>Array.isArray(e)?e.filter(Boolean):[],sn=e=>e===void 0,Le=(e,t,n)=>{if(!t||!pn(e))return n;const o=Lc(t.split(/[,[\].]+?/)).reduce((r,l)=>Nn(r)?r:r[l],e);return sn(o)||o===e?sn(e[t])?n:e[t]:o},Ks=e=>typeof e=="boolean";const Xd={BLUR:"blur",FOCUS_OUT:"focusout",CHANGE:"change"},Js={onBlur:"onBlur",onChange:"onChange",onSubmit:"onSubmit",onTouched:"onTouched",all:"all"},Go={max:"max",min:"min",maxLength:"maxLength",minLength:"minLength",pattern:"pattern",required:"required",validate:"validate"},OH=te.createContext(null),Wg=()=>te.useContext(OH);var Cw=(e,t,n,o=!0)=>{const r={defaultValues:t._defaultValues};for(const l in e)Object.defineProperty(r,l,{get:()=>{const c=l;return t._proxyFormState[c]!==Js.all&&(t._proxyFormState[c]=!o||Js.all),n&&(n[c]=!0),e[c]}});return r},Os=e=>pn(e)&&!Object.keys(e).length,yw=(e,t,n,o)=>{n(e);const{name:r,...l}=e;return Os(l)||Object.keys(l).length>=Object.keys(t).length||Object.keys(l).find(c=>t[c]===(!o||Js.all))},xd=e=>Array.isArray(e)?e:[e],bw=(e,t,n)=>!e||!t||e===t||xd(e).some(o=>o&&(n?o===t:o.startsWith(t)||t.startsWith(o)));function Ug(e){const t=te.useRef(e);t.current=e,te.useEffect(()=>{const n=!e.disabled&&t.current.subject&&t.current.subject.subscribe({next:t.current.next});return()=>{n&&n.unsubscribe()}},[e.disabled])}function NH(e){const t=Wg(),{control:n=t.control,disabled:o,name:r,exact:l}=e||{},[c,d]=te.useState(n._formState),f=te.useRef(!0),m=te.useRef({isDirty:!1,isLoading:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1}),g=te.useRef(r);return g.current=r,Ug({disabled:o,next:p=>f.current&&bw(g.current,p.name,l)&&yw(p,m.current,n._updateFormState)&&d({...n._formState,...p}),subject:n._subjects.state}),te.useEffect(()=>(f.current=!0,m.current.isValid&&n._updateValid(!0),()=>{f.current=!1}),[n]),Cw(c,n,m.current,!1)}var Ao=e=>typeof e=="string",jw=(e,t,n,o,r)=>Ao(e)?(o&&t.watch.add(e),Le(n,e,r)):Array.isArray(e)?e.map(l=>(o&&t.watch.add(l),Le(n,l))):(o&&(t.watchAll=!0),n);function FH(e){const t=Wg(),{control:n=t.control,name:o,defaultValue:r,disabled:l,exact:c}=e||{},d=te.useRef(o);d.current=o,Ug({disabled:l,subject:n._subjects.values,next:g=>{bw(d.current,g.name,c)&&m(es(jw(d.current,n._names,g.values||n._formValues,!1,r)))}});const[f,m]=te.useState(n._getWatch(o,r));return te.useEffect(()=>n._removeUnmounted()),f}var Gg=e=>/^\w*$/.test(e),Sw=e=>Lc(e.replace(/["|']|\]/g,"").split(/\.|\[/)),Bt=(e,t,n)=>{let o=-1;const r=Gg(t)?[t]:Sw(t),l=r.length,c=l-1;for(;++o<l;){const d=r[o];let f=n;if(o!==c){const m=e[d];f=pn(m)||Array.isArray(m)?m:isNaN(+r[o+1])?{}:[]}e[d]=f,e=e[d]}return e};function Zg(e){const t=Wg(),{name:n,disabled:o,control:r=t.control,shouldUnregister:l}=e,c=vw(r._names.array,n),d=FH({control:r,name:n,defaultValue:Le(r._formValues,n,Le(r._defaultValues,n,e.defaultValue)),exact:!0}),f=NH({control:r,name:n}),m=te.useRef(r.register(n,{...e.rules,value:d,...Ks(e.disabled)?{disabled:e.disabled}:{}}));return te.useEffect(()=>{const g=r._options.shouldUnregister||l,p=(x,y)=>{const S=Le(r._fields,x);S&&(S._f.mount=y)};if(p(n,!0),g){const x=es(Le(r._options.defaultValues,n));Bt(r._defaultValues,n,x),sn(Le(r._formValues,n))&&Bt(r._formValues,n,x)}return()=>{(c?g&&!r._state.action:g)?r.unregister(n):p(n,!1)}},[n,r,c,l]),te.useEffect(()=>{Le(r._fields,n)&&r._updateDisabledField({disabled:o,fields:r._fields,name:n,value:Le(r._fields,n)._f.value})},[o,n,r]),{field:{name:n,value:d,...Ks(o)||f.disabled?{disabled:f.disabled||o}:{},onChange:te.useCallback(g=>m.current.onChange({target:{value:xw(g),name:n},type:Xd.CHANGE}),[n]),onBlur:te.useCallback(()=>m.current.onBlur({target:{value:Le(r._formValues,n),name:n},type:Xd.BLUR}),[n,r]),ref:g=>{const p=Le(r._fields,n);p&&g&&(p._f.ref={focus:()=>g.focus(),select:()=>g.select(),setCustomValidity:x=>g.setCustomValidity(x),reportValidity:()=>g.reportValidity()})}},formState:f,fieldState:Object.defineProperties({},{invalid:{enumerable:!0,get:()=>!!Le(f.errors,n)},isDirty:{enumerable:!0,get:()=>!!Le(f.dirtyFields,n)},isTouched:{enumerable:!0,get:()=>!!Le(f.touchedFields,n)},error:{enumerable:!0,get:()=>Le(f.errors,n)}})}}var zH=(e,t,n,o,r)=>t?{...n[e],types:{...n[e]&&n[e].types?n[e].types:{},[o]:r||!0}}:{},$v=e=>({isOnSubmit:!e||e===Js.onSubmit,isOnBlur:e===Js.onBlur,isOnChange:e===Js.onChange,isOnAll:e===Js.all,isOnTouch:e===Js.onTouched}),Vv=(e,t,n)=>!n&&(t.watchAll||t.watch.has(e)||[...t.watch].some(o=>e.startsWith(o)&&/^\.\w+/.test(e.slice(o.length))));const Wi=(e,t,n,o)=>{for(const r of n||Object.keys(e)){const l=Le(e,r);if(l){const{_f:c,...d}=l;if(c){if(c.refs&&c.refs[0]&&t(c.refs[0],r)&&!o)break;if(c.ref&&t(c.ref,c.name)&&!o)break;Wi(d,t)}else pn(d)&&Wi(d,t)}}};var HH=(e,t,n)=>{const o=Lc(Le(e,n));return Bt(o,"root",t[n]),Bt(e,n,o),e},qg=e=>e.type==="file",Br=e=>typeof e=="function",Jd=e=>{if(!Vg)return!1;const t=e?e.ownerDocument:0;return e instanceof(t&&t.defaultView?t.defaultView.HTMLElement:HTMLElement)},vd=e=>Ao(e),Qg=e=>e.type==="radio",ef=e=>e instanceof RegExp;const Wv={value:!1,isValid:!1},Uv={value:!0,isValid:!0};var kw=e=>{if(Array.isArray(e)){if(e.length>1){const t=e.filter(n=>n&&n.checked&&!n.disabled).map(n=>n.value);return{value:t,isValid:!!t.length}}return e[0].checked&&!e[0].disabled?e[0].attributes&&!sn(e[0].attributes.value)?sn(e[0].value)||e[0].value===""?Uv:{value:e[0].value,isValid:!0}:Uv:Wv}return Wv};const Gv={isValid:!1,value:null};var ww=e=>Array.isArray(e)?e.reduce((t,n)=>n&&n.checked&&!n.disabled?{isValid:!0,value:n.value}:t,Gv):Gv;function Zv(e,t,n="validate"){if(vd(e)||Array.isArray(e)&&e.every(vd)||Ks(e)&&!e)return{type:n,message:vd(e)?e:"",ref:t}}var ia=e=>pn(e)&&!ef(e)?e:{value:e,message:""},qv=async(e,t,n,o,r)=>{const{ref:l,refs:c,required:d,maxLength:f,minLength:m,min:g,max:p,pattern:x,validate:y,name:S,valueAsNumber:b,mount:I,disabled:M}=e._f,w=Le(t,S);if(!I||M)return{};const _=c?c[0]:l,T=N=>{o&&_.reportValidity&&(_.setCustomValidity(Ks(N)?"":N||""),_.reportValidity())},D={},A=Qg(l),F=Dc(l),Q=A||F,q=(b||qg(l))&&sn(l.value)&&sn(w)||Jd(l)&&l.value===""||w===""||Array.isArray(w)&&!w.length,G=zH.bind(null,S,n,D),Z=(N,z,$,se=Go.maxLength,he=Go.minLength)=>{const ke=N?z:$;D[S]={type:N?se:he,message:ke,ref:l,...G(N?se:he,ke)}};if(r?!Array.isArray(w)||!w.length:d&&(!Q&&(q||Nn(w))||Ks(w)&&!w||F&&!kw(c).isValid||A&&!ww(c).isValid)){const{value:N,message:z}=vd(d)?{value:!!d,message:d}:ia(d);if(N&&(D[S]={type:Go.required,message:z,ref:_,...G(Go.required,z)},!n))return T(z),D}if(!q&&(!Nn(g)||!Nn(p))){let N,z;const $=ia(p),se=ia(g);if(!Nn(w)&&!isNaN(w)){const he=l.valueAsNumber||w&&+w;Nn($.value)||(N=he>$.value),Nn(se.value)||(z=he<se.value)}else{const he=l.valueAsDate||new Date(w),ke=De=>new Date(new Date().toDateString()+" "+De),Ce=l.type=="time",ge=l.type=="week";Ao($.value)&&w&&(N=Ce?ke(w)>ke($.value):ge?w>$.value:he>new Date($.value)),Ao(se.value)&&w&&(z=Ce?ke(w)<ke(se.value):ge?w<se.value:he<new Date(se.value))}if((N||z)&&(Z(!!N,$.message,se.message,Go.max,Go.min),!n))return T(D[S].message),D}if((f||m)&&!q&&(Ao(w)||r&&Array.isArray(w))){const N=ia(f),z=ia(m),$=!Nn(N.value)&&w.length>+N.value,se=!Nn(z.value)&&w.length<+z.value;if(($||se)&&(Z($,N.message,z.message),!n))return T(D[S].message),D}if(x&&!q&&Ao(w)){const{value:N,message:z}=ia(x);if(ef(N)&&!w.match(N)&&(D[S]={type:Go.pattern,message:z,ref:l,...G(Go.pattern,z)},!n))return T(z),D}if(y){if(Br(y)){const N=await y(w,t),z=Zv(N,_);if(z&&(D[S]={...z,...G(Go.validate,z.message)},!n))return T(z.message),D}else if(pn(y)){let N={};for(const z in y){if(!Os(N)&&!n)break;const $=Zv(await y[z](w,t),_,z);$&&(N={...$,...G(z,$.message)},T($.message),n&&(D[S]=N))}if(!Os(N)&&(D[S]={ref:_,...N},!n))return D}}return T(!0),D};function $H(e,t){const n=t.slice(0,-1).length;let o=0;for(;o<n;)e=sn(e)?o++:e[t[o++]];return e}function VH(e){for(const t in e)if(e.hasOwnProperty(t)&&!sn(e[t]))return!1;return!0}function _n(e,t){const n=Array.isArray(t)?t:Gg(t)?[t]:Sw(t),o=n.length===1?e:$H(e,n),r=n.length-1,l=n[r];return o&&delete o[l],r!==0&&(pn(o)&&Os(o)||Array.isArray(o)&&VH(o))&&_n(e,n.slice(0,-1)),e}var tp=()=>{let e=[];return{get observers(){return e},next:r=>{for(const l of e)l.next&&l.next(r)},subscribe:r=>(e.push(r),{unsubscribe:()=>{e=e.filter(l=>l!==r)}}),unsubscribe:()=>{e=[]}}},tf=e=>Nn(e)||!gw(e);function Sl(e,t){if(tf(e)||tf(t))return e===t;if(pa(e)&&pa(t))return e.getTime()===t.getTime();const n=Object.keys(e),o=Object.keys(t);if(n.length!==o.length)return!1;for(const r of n){const l=e[r];if(!o.includes(r))return!1;if(r!=="ref"){const c=t[r];if(pa(l)&&pa(c)||pn(l)&&pn(c)||Array.isArray(l)&&Array.isArray(c)?!Sl(l,c):l!==c)return!1}}return!0}var Iw=e=>e.type==="select-multiple",WH=e=>Qg(e)||Dc(e),np=e=>Jd(e)&&e.isConnected,Mw=e=>{for(const t in e)if(Br(e[t]))return!0;return!1};function nf(e,t={}){const n=Array.isArray(e);if(pn(e)||n)for(const o in e)Array.isArray(e[o])||pn(e[o])&&!Mw(e[o])?(t[o]=Array.isArray(e[o])?[]:{},nf(e[o],t[o])):Nn(e[o])||(t[o]=!0);return t}function _w(e,t,n){const o=Array.isArray(e);if(pn(e)||o)for(const r in e)Array.isArray(e[r])||pn(e[r])&&!Mw(e[r])?sn(t)||tf(n[r])?n[r]=Array.isArray(e[r])?nf(e[r],[]):{...nf(e[r])}:_w(e[r],Nn(t)?{}:t[r],n[r]):n[r]=!Sl(e[r],t[r]);return n}var sp=(e,t)=>_w(e,t,nf(t)),Aw=(e,{valueAsNumber:t,valueAsDate:n,setValueAs:o})=>sn(e)?e:t?e===""?NaN:e&&+e:n&&Ao(e)?new Date(e):o?o(e):e;function op(e){const t=e.ref;if(!(e.refs?e.refs.every(n=>n.disabled):t.disabled))return qg(t)?t.files:Qg(t)?ww(e.refs).value:Iw(t)?[...t.selectedOptions].map(({value:n})=>n):Dc(t)?kw(e.refs).value:Aw(sn(t.value)?e.ref.value:t.value,e)}var UH=(e,t,n,o)=>{const r={};for(const l of e){const c=Le(t,l);c&&Bt(r,l,c._f)}return{criteriaMode:n,names:[...e],fields:r,shouldUseNativeValidation:o}},ki=e=>sn(e)?e:ef(e)?e.source:pn(e)?ef(e.value)?e.value.source:e.value:e,GH=e=>e.mount&&(e.required||e.min||e.max||e.maxLength||e.minLength||e.pattern||e.validate);function Qv(e,t,n){const o=Le(e,n);if(o||Gg(n))return{error:o,name:n};const r=n.split(".");for(;r.length;){const l=r.join("."),c=Le(t,l),d=Le(e,l);if(c&&!Array.isArray(c)&&n!==l)return{name:n};if(d&&d.type)return{name:l,error:d};r.pop()}return{name:n}}var ZH=(e,t,n,o,r)=>r.isOnAll?!1:!n&&r.isOnTouch?!(t||e):(n?o.isOnBlur:r.isOnBlur)?!e:(n?o.isOnChange:r.isOnChange)?e:!0,qH=(e,t)=>!Lc(Le(e,t)).length&&_n(e,t);const QH={mode:Js.onSubmit,reValidateMode:Js.onChange,shouldFocusError:!0};function KH(e={},t){let n={...QH,...e},o={submitCount:0,isDirty:!1,isLoading:Br(n.defaultValues),isValidating:!1,isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,touchedFields:{},dirtyFields:{},errors:n.errors||{},disabled:n.disabled||!1},r={},l=pn(n.defaultValues)||pn(n.values)?es(n.defaultValues||n.values)||{}:{},c=n.shouldUnregister?{}:es(l),d={action:!1,mount:!1,watch:!1},f={mount:new Set,unMount:new Set,array:new Set,watch:new Set},m,g=0;const p={isDirty:!1,dirtyFields:!1,touchedFields:!1,isValidating:!1,isValid:!1,errors:!1},x={values:tp(),array:tp(),state:tp()},y=$v(n.mode),S=$v(n.reValidateMode),b=n.criteriaMode===Js.all,I=O=>ne=>{clearTimeout(g),g=setTimeout(O,ne)},M=async O=>{if(p.isValid||O){const ne=n.resolver?Os((await q()).errors):await Z(r,!0);ne!==o.isValid&&x.state.next({isValid:ne})}},w=O=>p.isValidating&&x.state.next({isValidating:O}),_=(O,ne=[],ce,_e,be=!0,K=!0)=>{if(_e&&ce){if(d.action=!0,K&&Array.isArray(Le(r,O))){const ve=ce(Le(r,O),_e.argA,_e.argB);be&&Bt(r,O,ve)}if(K&&Array.isArray(Le(o.errors,O))){const ve=ce(Le(o.errors,O),_e.argA,_e.argB);be&&Bt(o.errors,O,ve),qH(o.errors,O)}if(p.touchedFields&&K&&Array.isArray(Le(o.touchedFields,O))){const ve=ce(Le(o.touchedFields,O),_e.argA,_e.argB);be&&Bt(o.touchedFields,O,ve)}p.dirtyFields&&(o.dirtyFields=sp(l,c)),x.state.next({name:O,isDirty:z(O,ne),dirtyFields:o.dirtyFields,errors:o.errors,isValid:o.isValid})}else Bt(c,O,ne)},T=(O,ne)=>{Bt(o.errors,O,ne),x.state.next({errors:o.errors})},D=O=>{o.errors=O,x.state.next({errors:o.errors,isValid:!1})},A=(O,ne,ce,_e)=>{const be=Le(r,O);if(be){const K=Le(c,O,sn(ce)?Le(l,O):ce);sn(K)||_e&&_e.defaultChecked||ne?Bt(c,O,ne?K:op(be._f)):he(O,K),d.mount&&M()}},F=(O,ne,ce,_e,be)=>{let K=!1,ve=!1;const Ee={name:O},Ze=!!(Le(r,O)&&Le(r,O)._f.disabled);if(!ce||_e){p.isDirty&&(ve=o.isDirty,o.isDirty=Ee.isDirty=z(),K=ve!==Ee.isDirty);const lt=Ze||Sl(Le(l,O),ne);ve=!!(!Ze&&Le(o.dirtyFields,O)),lt||Ze?_n(o.dirtyFields,O):Bt(o.dirtyFields,O,!0),Ee.dirtyFields=o.dirtyFields,K=K||p.dirtyFields&&ve!==!lt}if(ce){const lt=Le(o.touchedFields,O);lt||(Bt(o.touchedFields,O,ce),Ee.touchedFields=o.touchedFields,K=K||p.touchedFields&&lt!==ce)}return K&&be&&x.state.next(Ee),K?Ee:{}},Q=(O,ne,ce,_e)=>{const be=Le(o.errors,O),K=p.isValid&&Ks(ne)&&o.isValid!==ne;if(e.delayError&&ce?(m=I(()=>T(O,ce)),m(e.delayError)):(clearTimeout(g),m=null,ce?Bt(o.errors,O,ce):_n(o.errors,O)),(ce?!Sl(be,ce):be)||!Os(_e)||K){const ve={..._e,...K&&Ks(ne)?{isValid:ne}:{},errors:o.errors,name:O};o={...o,...ve},x.state.next(ve)}w(!1)},q=async O=>n.resolver(c,n.context,UH(O||f.mount,r,n.criteriaMode,n.shouldUseNativeValidation)),G=async O=>{const{errors:ne}=await q(O);if(O)for(const ce of O){const _e=Le(ne,ce);_e?Bt(o.errors,ce,_e):_n(o.errors,ce)}else o.errors=ne;return ne},Z=async(O,ne,ce={valid:!0})=>{for(const _e in O){const be=O[_e];if(be){const{_f:K,...ve}=be;if(K){const Ee=f.array.has(K.name),Ze=await qv(be,c,b,n.shouldUseNativeValidation&&!ne,Ee);if(Ze[K.name]&&(ce.valid=!1,ne))break;!ne&&(Le(Ze,K.name)?Ee?HH(o.errors,Ze,K.name):Bt(o.errors,K.name,Ze[K.name]):_n(o.errors,K.name))}ve&&await Z(ve,ne,ce)}}return ce.valid},N=()=>{for(const O of f.unMount){const ne=Le(r,O);ne&&(ne._f.refs?ne._f.refs.every(ce=>!np(ce)):!np(ne._f.ref))&&H(O)}f.unMount=new Set},z=(O,ne)=>(O&&ne&&Bt(c,O,ne),!Sl(oe(),l)),$=(O,ne,ce)=>jw(O,f,{...d.mount?c:sn(ne)?l:Ao(O)?{[O]:ne}:ne},ce,ne),se=O=>Lc(Le(d.mount?c:l,O,e.shouldUnregister?Le(l,O,[]):[])),he=(O,ne,ce={})=>{const _e=Le(r,O);let be=ne;if(_e){const K=_e._f;K&&(!K.disabled&&Bt(c,O,Aw(ne,K)),be=Jd(K.ref)&&Nn(ne)?"":ne,Iw(K.ref)?[...K.ref.options].forEach(ve=>ve.selected=be.includes(ve.value)):K.refs?Dc(K.ref)?K.refs.length>1?K.refs.forEach(ve=>(!ve.defaultChecked||!ve.disabled)&&(ve.checked=Array.isArray(be)?!!be.find(Ee=>Ee===ve.value):be===ve.value)):K.refs[0]&&(K.refs[0].checked=!!be):K.refs.forEach(ve=>ve.checked=ve.value===be):qg(K.ref)?K.ref.value="":(K.ref.value=be,K.ref.type||x.values.next({name:O,values:{...c}})))}(ce.shouldDirty||ce.shouldTouch)&&F(O,be,ce.shouldTouch,ce.shouldDirty,!0),ce.shouldValidate&&Se(O)},ke=(O,ne,ce)=>{for(const _e in ne){const be=ne[_e],K=`${O}.${_e}`,ve=Le(r,K);(f.array.has(O)||!tf(be)||ve&&!ve._f)&&!pa(be)?ke(K,be,ce):he(K,be,ce)}},Ce=(O,ne,ce={})=>{const _e=Le(r,O),be=f.array.has(O),K=es(ne);Bt(c,O,K),be?(x.array.next({name:O,values:{...c}}),(p.isDirty||p.dirtyFields)&&ce.shouldDirty&&x.state.next({name:O,dirtyFields:sp(l,c),isDirty:z(O,K)})):_e&&!_e._f&&!Nn(K)?ke(O,K,ce):he(O,K,ce),Vv(O,f)&&x.state.next({...o}),x.values.next({name:O,values:{...c}}),!d.mount&&t()},ge=async O=>{const ne=O.target;let ce=ne.name,_e=!0;const be=Le(r,ce),K=()=>ne.type?op(be._f):xw(O),ve=Ee=>{_e=Number.isNaN(Ee)||Ee===Le(c,ce,Ee)};if(be){let Ee,Ze;const lt=K(),St=O.type===Xd.BLUR||O.type===Xd.FOCUS_OUT,Ot=!GH(be._f)&&!n.resolver&&!Le(o.errors,ce)&&!be._f.deps||ZH(St,Le(o.touchedFields,ce),o.isSubmitted,S,y),Xt=Vv(ce,f,St);Bt(c,ce,lt),St?(be._f.onBlur&&be._f.onBlur(O),m&&m(0)):be._f.onChange&&be._f.onChange(O);const Jt=F(ce,lt,St,!1),xn=!Os(Jt)||Xt;if(!St&&x.values.next({name:ce,type:O.type,values:{...c}}),Ot)return p.isValid&&M(),xn&&x.state.next({name:ce,...Xt?{}:Jt});if(!St&&Xt&&x.state.next({...o}),w(!0),n.resolver){const{errors:on}=await q([ce]);if(ve(lt),_e){const en=Qv(o.errors,r,ce),Tt=Qv(on,r,en.name||ce);Ee=Tt.error,ce=Tt.name,Ze=Os(on)}}else Ee=(await qv(be,c,b,n.shouldUseNativeValidation))[ce],ve(lt),_e&&(Ee?Ze=!1:p.isValid&&(Ze=await Z(r,!0)));_e&&(be._f.deps&&Se(be._f.deps),Q(ce,Ze,Ee,Jt))}},De=(O,ne)=>{if(Le(o.errors,ne)&&O.focus)return O.focus(),1},Se=async(O,ne={})=>{let ce,_e;const be=xd(O);if(w(!0),n.resolver){const K=await G(sn(O)?O:be);ce=Os(K),_e=O?!be.some(ve=>Le(K,ve)):ce}else O?(_e=(await Promise.all(be.map(async K=>{const ve=Le(r,K);return await Z(ve&&ve._f?{[K]:ve}:ve)}))).every(Boolean),!(!_e&&!o.isValid)&&M()):_e=ce=await Z(r);return x.state.next({...!Ao(O)||p.isValid&&ce!==o.isValid?{}:{name:O},...n.resolver||!O?{isValid:ce}:{},errors:o.errors,isValidating:!1}),ne.shouldFocus&&!_e&&Wi(r,De,O?be:f.mount),_e},oe=O=>{const ne={...l,...d.mount?c:{}};return sn(O)?ne:Ao(O)?Le(ne,O):O.map(ce=>Le(ne,ce))},re=(O,ne)=>({invalid:!!Le((ne||o).errors,O),isDirty:!!Le((ne||o).dirtyFields,O),isTouched:!!Le((ne||o).touchedFields,O),error:Le((ne||o).errors,O)}),de=O=>{O&&xd(O).forEach(ne=>_n(o.errors,ne)),x.state.next({errors:O?o.errors:{}})},P=(O,ne,ce)=>{const _e=(Le(r,O,{_f:{}})._f||{}).ref;Bt(o.errors,O,{...ne,ref:_e}),x.state.next({name:O,errors:o.errors,isValid:!1}),ce&&ce.shouldFocus&&_e&&_e.focus&&_e.focus()},B=(O,ne)=>Br(O)?x.values.subscribe({next:ce=>O($(void 0,ne),ce)}):$(O,ne,!0),H=(O,ne={})=>{for(const ce of O?xd(O):f.mount)f.mount.delete(ce),f.array.delete(ce),ne.keepValue||(_n(r,ce),_n(c,ce)),!ne.keepError&&_n(o.errors,ce),!ne.keepDirty&&_n(o.dirtyFields,ce),!ne.keepTouched&&_n(o.touchedFields,ce),!n.shouldUnregister&&!ne.keepDefaultValue&&_n(l,ce);x.values.next({values:{...c}}),x.state.next({...o,...ne.keepDirty?{isDirty:z()}:{}}),!ne.keepIsValid&&M()},V=({disabled:O,name:ne,field:ce,fields:_e,value:be})=>{if(Ks(O)){const K=O?void 0:sn(be)?op(ce?ce._f:Le(_e,ne)._f):be;Bt(c,ne,K),F(ne,K,!1,!1,!0)}},le=(O,ne={})=>{let ce=Le(r,O);const _e=Ks(ne.disabled);return Bt(r,O,{...ce||{},_f:{...ce&&ce._f?ce._f:{ref:{name:O}},name:O,mount:!0,...ne}}),f.mount.add(O),ce?V({field:ce,disabled:ne.disabled,name:O,value:ne.value}):A(O,!0,ne.value),{..._e?{disabled:ne.disabled}:{},...n.progressive?{required:!!ne.required,min:ki(ne.min),max:ki(ne.max),minLength:ki(ne.minLength),maxLength:ki(ne.maxLength),pattern:ki(ne.pattern)}:{},name:O,onChange:ge,onBlur:ge,ref:be=>{if(be){le(O,ne),ce=Le(r,O);const K=sn(be.value)&&be.querySelectorAll&&be.querySelectorAll("input,select,textarea")[0]||be,ve=WH(K),Ee=ce._f.refs||[];if(ve?Ee.find(Ze=>Ze===K):K===ce._f.ref)return;Bt(r,O,{_f:{...ce._f,...ve?{refs:[...Ee.filter(np),K,...Array.isArray(Le(l,O))?[{}]:[]],ref:{type:K.type,name:O}}:{ref:K}}}),A(O,!1,void 0,K)}else ce=Le(r,O,{}),ce._f&&(ce._f.mount=!1),(n.shouldUnregister||ne.shouldUnregister)&&!(vw(f.array,O)&&d.action)&&f.unMount.add(O)}}},fe=()=>n.shouldFocusError&&Wi(r,De,f.mount),ue=O=>{Ks(O)&&(x.state.next({disabled:O}),Wi(r,(ne,ce)=>{let _e=O;const be=Le(r,ce);be&&Ks(be._f.disabled)&&(_e||(_e=be._f.disabled)),ne.disabled=_e},0,!1))},xe=(O,ne)=>async ce=>{ce&&(ce.preventDefault&&ce.preventDefault(),ce.persist&&ce.persist());let _e=es(c);if(x.state.next({isSubmitting:!0}),n.resolver){const{errors:be,values:K}=await q();o.errors=be,_e=K}else await Z(r);_n(o.errors,"root"),Os(o.errors)?(x.state.next({errors:{}}),await O(_e,ce)):(ne&&await ne({...o.errors},ce),fe(),setTimeout(fe)),x.state.next({isSubmitted:!0,isSubmitting:!1,isSubmitSuccessful:Os(o.errors),submitCount:o.submitCount+1,errors:o.errors})},W=(O,ne={})=>{Le(r,O)&&(sn(ne.defaultValue)?Ce(O,es(Le(l,O))):(Ce(O,ne.defaultValue),Bt(l,O,es(ne.defaultValue))),ne.keepTouched||_n(o.touchedFields,O),ne.keepDirty||(_n(o.dirtyFields,O),o.isDirty=ne.defaultValue?z(O,es(Le(l,O))):z()),ne.keepError||(_n(o.errors,O),p.isValid&&M()),x.state.next({...o}))},Me=(O,ne={})=>{const ce=O?es(O):l,_e=es(ce),be=O&&!Os(O)?_e:l;if(ne.keepDefaultValues||(l=ce),!ne.keepValues){if(ne.keepDirtyValues)for(const K of f.mount)Le(o.dirtyFields,K)?Bt(be,K,Le(c,K)):Ce(K,Le(be,K));else{if(Vg&&sn(O))for(const K of f.mount){const ve=Le(r,K);if(ve&&ve._f){const Ee=Array.isArray(ve._f.refs)?ve._f.refs[0]:ve._f.ref;if(Jd(Ee)){const Ze=Ee.closest("form");if(Ze){Ze.reset();break}}}}r={}}c=e.shouldUnregister?ne.keepDefaultValues?es(l):{}:es(be),x.array.next({values:{...be}}),x.values.next({values:{...be}})}f={mount:new Set,unMount:new Set,array:new Set,watch:new Set,watchAll:!1,focus:""},!d.mount&&t(),d.mount=!p.isValid||!!ne.keepIsValid,d.watch=!!e.shouldUnregister,x.state.next({submitCount:ne.keepSubmitCount?o.submitCount:0,isDirty:ne.keepDirty?o.isDirty:!!(ne.keepDefaultValues&&!Sl(O,l)),isSubmitted:ne.keepIsSubmitted?o.isSubmitted:!1,dirtyFields:ne.keepDirtyValues?o.dirtyFields:ne.keepDefaultValues&&O?sp(l,O):{},touchedFields:ne.keepTouched?o.touchedFields:{},errors:ne.keepErrors?o.errors:{},isSubmitSuccessful:ne.keepIsSubmitSuccessful?o.isSubmitSuccessful:!1,isSubmitting:!1})},ye=(O,ne)=>Me(Br(O)?O(c):O,ne);return{control:{register:le,unregister:H,getFieldState:re,handleSubmit:xe,setError:P,_executeSchema:q,_getWatch:$,_getDirty:z,_updateValid:M,_removeUnmounted:N,_updateFieldArray:_,_updateDisabledField:V,_getFieldArray:se,_reset:Me,_resetDefaultValues:()=>Br(n.defaultValues)&&n.defaultValues().then(O=>{ye(O,n.resetOptions),x.state.next({isLoading:!1})}),_updateFormState:O=>{o={...o,...O}},_disableForm:ue,_subjects:x,_proxyFormState:p,_setErrors:D,get _fields(){return r},get _formValues(){return c},get _state(){return d},set _state(O){d=O},get _defaultValues(){return l},get _names(){return f},set _names(O){f=O},get _formState(){return o},set _formState(O){o=O},get _options(){return n},set _options(O){n={...n,...O}}},trigger:Se,register:le,handleSubmit:xe,watch:B,setValue:Ce,getValues:oe,reset:ye,resetField:W,clearErrors:de,unregister:H,setError:P,setFocus:(O,ne={})=>{const ce=Le(r,O),_e=ce&&ce._f;if(_e){const be=_e.refs?_e.refs[0]:_e.ref;be.focus&&(be.focus(),ne.shouldSelect&&be.select())}},getFieldState:re}}function Tc(e={}){const t=te.useRef(),n=te.useRef(),[o,r]=te.useState({isDirty:!1,isValidating:!1,isLoading:Br(e.defaultValues),isSubmitted:!1,isSubmitting:!1,isSubmitSuccessful:!1,isValid:!1,submitCount:0,dirtyFields:{},touchedFields:{},errors:e.errors||{},disabled:e.disabled||!1,defaultValues:Br(e.defaultValues)?void 0:e.defaultValues});t.current||(t.current={...KH(e,()=>r(c=>({...c}))),formState:o});const l=t.current.control;return l._options=e,Ug({subject:l._subjects.state,next:c=>{yw(c,l._proxyFormState,l._updateFormState,!0)&&r({...l._formState})}}),te.useEffect(()=>l._disableForm(e.disabled),[l,e.disabled]),te.useEffect(()=>{if(l._proxyFormState.isDirty){const c=l._getDirty();c!==o.isDirty&&l._subjects.state.next({isDirty:c})}},[l,o.isDirty]),te.useEffect(()=>{e.values&&!Sl(e.values,n.current)?(l._reset(e.values,l._options.resetOptions),n.current=e.values,r(c=>({...c}))):l._resetDefaultValues()},[e.values,l]),te.useEffect(()=>{e.errors&&l._setErrors(e.errors)},[e.errors,l]),te.useEffect(()=>{l._state.mount||(l._updateValid(),l._state.mount=!0),l._state.watch&&(l._state.watch=!1,l._subjects.state.next({...l._formState})),l._removeUnmounted()}),t.current.formState=Cw(o,l),t.current}const Kv=[{value:"sd-1",label:yl["sd-1"]},{value:"sd-2",label:yl["sd-2"]},{value:"sdxl",label:yl.sdxl},{value:"sdxl-refiner",label:yl["sdxl-refiner"]}],YH=e=>{const{t}=R(),{field:n}=Zg(e),o=u.useMemo(()=>Kv.find(l=>l.value===n.value),[n.value]),r=u.useCallback(l=>{n.onChange(l==null?void 0:l.value)},[n]);return s.jsxs(U,{children:[s.jsx(Y,{children:t("modelManager.baseModel")}),s.jsx(Xe,{value:o,options:Kv,onChange:r})]})},Rc=pw(YH),XH={w:"full"},JH=e=>{const{data:t}=Yy(),{t:n}=R(),o=u.useMemo(()=>t?t.map(d=>({label:d,value:d})):[],[t]),{field:r}=Zg(e),l=u.useMemo(()=>o.find(d=>d.value===r.value),[r.value,o]),c=u.useCallback(d=>{r.onChange(d==null?void 0:d.value)},[r]);return s.jsxs(U,{children:[s.jsx(Y,{children:n("modelManager.configFile")}),s.jsx(Xe,{placeholder:"Select A Config File",value:l,options:o,onChange:c,sx:XH})]})},Pw=u.memo(JH),Yv=[{value:"normal",label:"Normal"},{value:"inpaint",label:"Inpaint"},{value:"depth",label:"Depth"}],e$=e=>{const{t}=R(),{field:n}=Zg(e),o=u.useMemo(()=>Yv.find(l=>l.value===n.value),[n.value]),r=u.useCallback(l=>{n.onChange(l==null?void 0:l.value)},[n]);return s.jsxs(U,{children:[s.jsx(Y,{children:t("modelManager.variant")}),s.jsx(Xe,{value:o,options:Yv,onChange:r})]})},em=pw(e$);function sf(e,t=!0){let n;t?n=new RegExp("[^\\\\/]+(?=\\.)"):n=new RegExp("[^\\\\/]+(?=[\\\\/]?$)");const o=e.match(n);return o?o[0]:""}const t$=e=>{var M,w,_,T;const{t}=R(),n=J(),{model_path:o}=e,{register:r,handleSubmit:l,control:c,getValues:d,setValue:f,formState:{errors:m},reset:g}=Tc({defaultValues:{model_name:o?sf(o):"",base_model:"sd-1",model_type:"main",path:o||"",description:"",model_format:"checkpoint",error:void 0,vae:"",variant:"normal",config:"configs\\stable-diffusion\\v1-inference.yaml"},mode:"onChange"}),[p]=Xy(),[x,y]=u.useState(!1),S=u.useCallback(D=>{p({body:D}).unwrap().then(A=>{n(Qe(_t({title:t("modelManager.modelAdded",{modelName:D.model_name}),status:"success"}))),g(),o&&n(hc(null))}).catch(A=>{A&&n(Qe(_t({title:t("toast.modelAddFailed"),status:"error"})))})},[p,n,o,g,t]),b=u.useCallback(D=>{if(d().model_name===""){const A=sf(D.currentTarget.value);A&&f("model_name",A)}},[d,f]),I=u.useCallback(()=>y(D=>!D),[]);return s.jsx("form",{onSubmit:l(S),style:n$,children:s.jsxs(L,{flexDirection:"column",gap:2,children:[s.jsxs(U,{isInvalid:!!m.model_name,children:[s.jsx(Y,{children:t("modelManager.model")}),s.jsx(dt,{...r("model_name",{validate:D=>D.trim().length>3||"Must be at least 3 characters"})}),((M=m.model_name)==null?void 0:M.message)&&s.jsx(Eo,{children:(w=m.model_name)==null?void 0:w.message})]}),s.jsx(Rc,{control:c,name:"base_model"}),s.jsxs(U,{isInvalid:!!m.path,children:[s.jsx(Y,{children:t("modelManager.modelLocation")}),s.jsx(dt,{...r("path",{validate:D=>D.trim().length>0||"Must provide a path",onBlur:b})}),((_=m.path)==null?void 0:_.message)&&s.jsx(Eo,{children:(T=m.path)==null?void 0:T.message})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("modelManager.description")}),s.jsx(dt,{...r("description")})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("modelManager.vaeLocation")}),s.jsx(dt,{...r("vae")})]}),s.jsx(em,{control:c,name:"variant"}),s.jsxs(L,{flexDirection:"column",width:"100%",gap:2,children:[x?s.jsxs(U,{isRequired:!0,children:[s.jsx(Y,{children:t("modelManager.config")}),s.jsx(dt,{...r("config")})]}):s.jsx(Pw,{control:c,name:"config"}),s.jsxs(U,{children:[s.jsx(Y,{children:t("modelManager.useCustomConfig")}),s.jsx(jn,{isChecked:x,onChange:I})]}),s.jsx(Ge,{mt:2,type:"submit",children:t("modelManager.addModel")})]})]})})},n$={width:"100%"},Ew=u.memo(t$),s$=e=>{var S,b,I,M;const{t}=R(),n=J(),{model_path:o}=e,[r]=Xy(),{register:l,handleSubmit:c,control:d,getValues:f,setValue:m,formState:{errors:g},reset:p}=Tc({defaultValues:{model_name:o?sf(o,!1):"",base_model:"sd-1",model_type:"main",path:o||"",description:"",model_format:"diffusers",error:void 0,vae:"",variant:"normal"},mode:"onChange"}),x=u.useCallback(w=>{r({body:w}).unwrap().then(_=>{n(Qe(_t({title:t("modelManager.modelAdded",{modelName:w.model_name}),status:"success"}))),p(),o&&n(hc(null))}).catch(_=>{_&&n(Qe(_t({title:t("toast.modelAddFailed"),status:"error"})))})},[r,n,o,p,t]),y=u.useCallback(w=>{if(f().model_name===""){const _=sf(w.currentTarget.value,!1);_&&m("model_name",_)}},[f,m]);return s.jsx("form",{onSubmit:c(x),style:o$,children:s.jsxs(L,{flexDirection:"column",gap:2,children:[s.jsxs(U,{isInvalid:!!g.model_name,children:[s.jsx(Y,{children:t("modelManager.name")}),s.jsx(dt,{...l("model_name",{validate:w=>w.trim().length>3||"Must be at least 3 characters"})}),((S=g.model_name)==null?void 0:S.message)&&s.jsx(Eo,{children:(b=g.model_name)==null?void 0:b.message})]}),s.jsx(Rc,{control:d,name:"base_model"}),s.jsxs(U,{isInvalid:!!g.path,children:[s.jsx(Y,{children:t("modelManager.modelLocation")}),s.jsx(dt,{...l("path",{validate:w=>w.trim().length>0||"Must provide a path",onBlur:y})}),((I=g.path)==null?void 0:I.message)&&s.jsx(Eo,{children:(M=g.path)==null?void 0:M.message})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("modelManager.description")}),s.jsx(dt,{...l("description")})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("modelManager.vaeLocation")}),s.jsx(dt,{...l("vae")})]}),s.jsx(em,{control:d,name:"variant"}),s.jsx(Ge,{mt:2,type:"submit",children:t("modelManager.addModel")})]})})},o$={width:"100%"},Dw=u.memo(s$),r$=mc.enum(["diffusers","checkpoint"]),Lw=e=>r$.safeParse(e).success,l$=()=>{const[e,t]=u.useState("diffusers"),{t:n}=R(),o=u.useCallback(c=>{Lw(c==null?void 0:c.value)&&t(c.value)},[]),r=u.useMemo(()=>[{label:n("modelManager.diffusersModels"),value:"diffusers"},{label:n("modelManager.checkpointOrSafetensors"),value:"checkpoint"}],[n]),l=u.useMemo(()=>r.find(c=>c.value===e),[r,e]);return s.jsxs(L,{flexDirection:"column",gap:4,width:"100%",children:[s.jsxs(U,{children:[s.jsx(Y,{children:n("modelManager.modelType")}),s.jsx(Xe,{value:l,options:r,onChange:o})]}),s.jsxs(L,{p:4,borderRadius:4,bg:"base.850",children:[e==="diffusers"&&s.jsx(Dw,{}),e==="checkpoint"&&s.jsx(Ew,{})]})]})},a$=u.memo(l$);var i$=function e(t,n){if(t===n)return!0;if(t&&n&&typeof t=="object"&&typeof n=="object"){if(t.constructor!==n.constructor)return!1;var o,r,l;if(Array.isArray(t)){if(o=t.length,o!=n.length)return!1;for(r=o;r--!==0;)if(!e(t[r],n[r]))return!1;return!0}if(t.constructor===RegExp)return t.source===n.source&&t.flags===n.flags;if(t.valueOf!==Object.prototype.valueOf)return t.valueOf()===n.valueOf();if(t.toString!==Object.prototype.toString)return t.toString()===n.toString();if(l=Object.keys(t),o=l.length,o!==Object.keys(n).length)return!1;for(r=o;r--!==0;)if(!Object.prototype.hasOwnProperty.call(n,l[r]))return!1;for(r=o;r--!==0;){var c=l[r];if(!e(t[c],n[c]))return!1}return!0}return t!==t&&n!==n};const Xv=ic(i$);function t0(e){return e===null||typeof e!="object"?{}:Object.keys(e).reduce((t,n)=>{const o=e[n];return o!=null&&o!==!1&&(t[n]=o),t},{})}var c$=Object.defineProperty,Jv=Object.getOwnPropertySymbols,u$=Object.prototype.hasOwnProperty,d$=Object.prototype.propertyIsEnumerable,eC=(e,t,n)=>t in e?c$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,f$=(e,t)=>{for(var n in t||(t={}))u$.call(t,n)&&eC(e,n,t[n]);if(Jv)for(var n of Jv(t))d$.call(t,n)&&eC(e,n,t[n]);return e};function Tw(e,t){if(t===null||typeof t!="object")return{};const n=f$({},t);return Object.keys(t).forEach(o=>{o.includes(`${String(e)}.`)&&delete n[o]}),n}const m$="__MANTINE_FORM_INDEX__";function tC(e,t){return t?typeof t=="boolean"?t:Array.isArray(t)?t.includes(e.replace(/[.][0-9]/g,`.${m$}`)):!1:!1}function nC(e,t,n){typeof n.value=="object"&&(n.value=ga(n.value)),!n.enumerable||n.get||n.set||!n.configurable||!n.writable||t==="__proto__"?Object.defineProperty(e,t,n):e[t]=n.value}function ga(e){if(typeof e!="object")return e;var t=0,n,o,r,l=Object.prototype.toString.call(e);if(l==="[object Object]"?r=Object.create(e.__proto__||null):l==="[object Array]"?r=Array(e.length):l==="[object Set]"?(r=new Set,e.forEach(function(c){r.add(ga(c))})):l==="[object Map]"?(r=new Map,e.forEach(function(c,d){r.set(ga(d),ga(c))})):l==="[object Date]"?r=new Date(+e):l==="[object RegExp]"?r=new RegExp(e.source,e.flags):l==="[object DataView]"?r=new e.constructor(ga(e.buffer)):l==="[object ArrayBuffer]"?r=e.slice(0):l.slice(-6)==="Array]"&&(r=new e.constructor(e)),r){for(o=Object.getOwnPropertySymbols(e);t<o.length;t++)nC(r,o[t],Object.getOwnPropertyDescriptor(e,o[t]));for(t=0,o=Object.getOwnPropertyNames(e);t<o.length;t++)Object.hasOwnProperty.call(r,n=o[t])&&r[n]===e[n]||nC(r,n,Object.getOwnPropertyDescriptor(e,n))}return r||e}function Rw(e){return typeof e!="string"?[]:e.split(".")}function tm(e,t,n){const o=Rw(e);if(o.length===0)return n;const r=ga(n);if(o.length===1)return r[o[0]]=t,r;let l=r[o[0]];for(let c=1;c<o.length-1;c+=1){if(l===void 0)return r;l=l[o[c]]}return l[o[o.length-1]]=t,r}function Qo(e,t){const n=Rw(e);if(n.length===0||typeof t!="object"||t===null)return;let o=t[n[0]];for(let r=1;r<n.length&&o!==void 0;r+=1)o=o[n[r]];return o}function sC(e){const t=t0(e);return{hasErrors:Object.keys(t).length>0,errors:t}}function n0(e,t,n="",o={}){return typeof e!="object"||e===null?o:Object.keys(e).reduce((r,l)=>{const c=e[l],d=`${n===""?"":`${n}.`}${l}`,f=Qo(d,t);let m=!1;return typeof c=="function"&&(r[d]=c(f,t,d)),typeof c=="object"&&Array.isArray(f)&&(m=!0,f.forEach((g,p)=>n0(c,t,`${d}.${p}`,r))),typeof c=="object"&&typeof f=="object"&&f!==null&&(m||n0(c,t,d,r)),r},o)}function s0(e,t){return sC(typeof e=="function"?e(t):n0(e,t))}function td(e,t,n){if(typeof e!="string")return{hasError:!1,error:null};const o=s0(t,n),r=Object.keys(o.errors).find(l=>e.split(".").every((c,d)=>c===l.split(".")[d]));return{hasError:!!r,error:r?o.errors[r]:null}}function h$(e,{from:t,to:n},o){const r=Qo(e,o);if(!Array.isArray(r))return o;const l=[...r],c=r[t];return l.splice(t,1),l.splice(n,0,c),tm(e,l,o)}var p$=Object.defineProperty,oC=Object.getOwnPropertySymbols,g$=Object.prototype.hasOwnProperty,x$=Object.prototype.propertyIsEnumerable,rC=(e,t,n)=>t in e?p$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,v$=(e,t)=>{for(var n in t||(t={}))g$.call(t,n)&&rC(e,n,t[n]);if(oC)for(var n of oC(t))x$.call(t,n)&&rC(e,n,t[n]);return e};function C$(e,{from:t,to:n},o){const r=`${e}.${t}`,l=`${e}.${n}`,c=v$({},o);return Object.keys(o).every(d=>{let f,m;if(d.startsWith(r)&&(f=d,m=d.replace(r,l)),d.startsWith(l)&&(f=d.replace(l,r),m=d),f&&m){const g=c[f],p=c[m];return p===void 0?delete c[f]:c[f]=p,g===void 0?delete c[m]:c[m]=g,!1}return!0}),c}function y$(e,t,n){const o=Qo(e,n);return Array.isArray(o)?tm(e,o.filter((r,l)=>l!==t),n):n}var b$=Object.defineProperty,lC=Object.getOwnPropertySymbols,j$=Object.prototype.hasOwnProperty,S$=Object.prototype.propertyIsEnumerable,aC=(e,t,n)=>t in e?b$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,k$=(e,t)=>{for(var n in t||(t={}))j$.call(t,n)&&aC(e,n,t[n]);if(lC)for(var n of lC(t))S$.call(t,n)&&aC(e,n,t[n]);return e};function iC(e,t){const n=e.substring(t.length+1).split(".")[0];return parseInt(n,10)}function cC(e,t,n,o){if(t===void 0)return n;const r=`${String(e)}`;let l=n;o===-1&&(l=Tw(`${r}.${t}`,l));const c=k$({},l),d=new Set;return Object.entries(l).filter(([f])=>{if(!f.startsWith(`${r}.`))return!1;const m=iC(f,r);return Number.isNaN(m)?!1:m>=t}).forEach(([f,m])=>{const g=iC(f,r),p=f.replace(`${r}.${g}`,`${r}.${g+o}`);c[p]=m,d.add(p),d.has(f)||delete c[f]}),c}function w$(e,t,n,o){const r=Qo(e,o);if(!Array.isArray(r))return o;const l=[...r];return l.splice(typeof n=="number"?n:l.length,0,t),tm(e,l,o)}function uC(e,t){const n=Object.keys(e);if(typeof t=="string"){const o=n.filter(r=>r.startsWith(`${t}.`));return e[t]||o.some(r=>e[r])||!1}return n.some(o=>e[o])}function I$(e){return t=>{if(!t)e(t);else if(typeof t=="function")e(t);else if(typeof t=="object"&&"nativeEvent"in t){const{currentTarget:n}=t;n instanceof HTMLInputElement?n.type==="checkbox"?e(n.checked):e(n.value):(n instanceof HTMLTextAreaElement||n instanceof HTMLSelectElement)&&e(n.value)}else e(t)}}var M$=Object.defineProperty,_$=Object.defineProperties,A$=Object.getOwnPropertyDescriptors,dC=Object.getOwnPropertySymbols,P$=Object.prototype.hasOwnProperty,E$=Object.prototype.propertyIsEnumerable,fC=(e,t,n)=>t in e?M$(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,wr=(e,t)=>{for(var n in t||(t={}))P$.call(t,n)&&fC(e,n,t[n]);if(dC)for(var n of dC(t))E$.call(t,n)&&fC(e,n,t[n]);return e},rp=(e,t)=>_$(e,A$(t));function Bw({initialValues:e={},initialErrors:t={},initialDirty:n={},initialTouched:o={},clearInputErrorOnChange:r=!0,validateInputOnChange:l=!1,validateInputOnBlur:c=!1,transformValues:d=m=>m,validate:f}={}){const[m,g]=u.useState(o),[p,x]=u.useState(n),[y,S]=u.useState(e),[b,I]=u.useState(t0(t)),M=u.useRef(e),w=P=>{M.current=P},_=u.useCallback(()=>g({}),[]),T=P=>{const B=P?wr(wr({},y),P):y;w(B),x({})},D=u.useCallback(P=>I(B=>t0(typeof P=="function"?P(B):P)),[]),A=u.useCallback(()=>I({}),[]),F=u.useCallback(()=>{S(e),A(),w(e),x({}),_()},[]),Q=u.useCallback((P,B)=>D(H=>rp(wr({},H),{[P]:B})),[]),q=u.useCallback(P=>D(B=>{if(typeof P!="string")return B;const H=wr({},B);return delete H[P],H}),[]),G=u.useCallback(P=>x(B=>{if(typeof P!="string")return B;const H=Tw(P,B);return delete H[P],H}),[]),Z=u.useCallback((P,B)=>{const H=tC(P,l);G(P),g(V=>rp(wr({},V),{[P]:!0})),S(V=>{const le=tm(P,B,V);if(H){const fe=td(P,f,le);fe.hasError?Q(P,fe.error):q(P)}return le}),!H&&r&&Q(P,null)},[]),N=u.useCallback(P=>{S(B=>{const H=typeof P=="function"?P(B):P;return wr(wr({},B),H)}),r&&A()},[]),z=u.useCallback((P,B)=>{G(P),S(H=>h$(P,B,H)),I(H=>C$(P,B,H))},[]),$=u.useCallback((P,B)=>{G(P),S(H=>y$(P,B,H)),I(H=>cC(P,B,H,-1))},[]),se=u.useCallback((P,B,H)=>{G(P),S(V=>w$(P,B,H,V)),I(V=>cC(P,H,V,1))},[]),he=u.useCallback(()=>{const P=s0(f,y);return I(P.errors),P},[y,f]),ke=u.useCallback(P=>{const B=td(P,f,y);return B.hasError?Q(P,B.error):q(P),B},[y,f]),Ce=(P,{type:B="input",withError:H=!0,withFocus:V=!0}={})=>{const fe={onChange:I$(ue=>Z(P,ue))};return H&&(fe.error=b[P]),B==="checkbox"?fe.checked=Qo(P,y):fe.value=Qo(P,y),V&&(fe.onFocus=()=>g(ue=>rp(wr({},ue),{[P]:!0})),fe.onBlur=()=>{if(tC(P,c)){const ue=td(P,f,y);ue.hasError?Q(P,ue.error):q(P)}}),fe},ge=(P,B)=>H=>{H==null||H.preventDefault();const V=he();V.hasErrors?B==null||B(V.errors,y,H):P==null||P(d(y),H)},De=P=>d(P||y),Se=u.useCallback(P=>{P.preventDefault(),F()},[]),oe=P=>{if(P){const H=Qo(P,p);if(typeof H=="boolean")return H;const V=Qo(P,y),le=Qo(P,M.current);return!Xv(V,le)}return Object.keys(p).length>0?uC(p):!Xv(y,M.current)},re=u.useCallback(P=>uC(m,P),[m]),de=u.useCallback(P=>P?!td(P,f,y).hasError:!s0(f,y).hasErrors,[y,f]);return{values:y,errors:b,setValues:N,setErrors:D,setFieldValue:Z,setFieldError:Q,clearFieldError:q,clearErrors:A,reset:F,validate:he,validateField:ke,reorderListItem:z,removeListItem:$,insertListItem:se,getInputProps:Ce,onSubmit:ge,onReset:Se,isDirty:oe,isTouched:re,setTouched:g,setDirty:x,resetTouched:_,resetDirty:T,isValid:de,getTransformedValues:De}}const mC=[{label:"None",value:"none"},{label:"v_prediction",value:"v_prediction"},{label:"epsilon",value:"epsilon"},{label:"sample",value:"sample"}],D$=()=>{const e=J(),{t}=R(),[n,{isLoading:o}]=Jy(),r=Bw({initialValues:{location:"",prediction_type:void 0}}),l=c=>{const d={location:c.location,prediction_type:c.prediction_type==="none"?void 0:c.prediction_type};n({body:d}).unwrap().then(f=>{e(Qe(_t({title:t("toast.modelAddedSimple"),status:"success"}))),r.reset()}).catch(f=>{f&&e(Qe(_t({title:`${f.data.detail} `,status:"error"})))})};return s.jsx("form",{onSubmit:r.onSubmit(c=>l(c)),style:L$,children:s.jsxs(L,{flexDirection:"column",width:"100%",gap:4,children:[s.jsxs(U,{children:[s.jsx(Y,{children:t("modelManager.modelLocation")}),s.jsx(dt,{placeholder:t("modelManager.simpleModelDesc"),w:"100%",...r.getInputProps("location")})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("modelManager.predictionType")}),s.jsx(Xe,{options:mC,defaultValue:mC[0],...r.getInputProps("prediction_type")})]}),s.jsx(Ge,{type:"submit",isLoading:o,children:t("modelManager.addModel")})]})})},L$={width:"100%"},T$=u.memo(D$),R$=()=>{const{t:e}=R(),[t,n]=u.useState("simple"),o=u.useCallback(()=>n("simple"),[]),r=u.useCallback(()=>n("advanced"),[]);return s.jsxs(L,{flexDirection:"column",width:"100%",overflow:"scroll",maxHeight:window.innerHeight-250,gap:4,children:[s.jsxs(wt,{children:[s.jsx(Ge,{size:"sm",isChecked:t==="simple",onClick:o,children:e("common.simple")}),s.jsx(Ge,{size:"sm",isChecked:t==="advanced",onClick:r,children:e("common.advanced")})]}),s.jsxs(L,{p:4,borderRadius:4,bg:"base.800",children:[t==="simple"&&s.jsx(T$,{}),t==="advanced"&&s.jsx(a$,{})]})]})},B$=u.memo(R$),O$=()=>{const e=j(I=>I.modelmanager.searchFolder),[t,n]=u.useState(""),{data:o}=so(lc),{foundModels:r,alreadyInstalled:l,filteredModels:c}=eb({search_path:e||""},{selectFromResult:({data:I})=>{const M=a_(o==null?void 0:o.entities),w=ys(M,"path"),_=t_(I,w),T=d_(I,w);return{foundModels:I,alreadyInstalled:hC(T,t),filteredModels:hC(_,t)}}}),[d,{isLoading:f}]=Jy(),m=J(),{t:g}=R(),p=u.useCallback(I=>{const M=I.currentTarget.id.split("\\").splice(-1)[0];d({body:{location:I.currentTarget.id}}).unwrap().then(w=>{m(Qe(_t({title:`Added Model: ${M}`,status:"success"})))}).catch(w=>{w&&m(Qe(_t({title:g("toast.modelAddFailed"),status:"error"})))})},[m,d,g]),x=u.useCallback(I=>{n(I.target.value)},[]),y=u.useCallback(I=>m(hc(I)),[m]),S=({models:I,showActions:M=!0})=>I.map(w=>s.jsxs(L,{p:4,gap:4,alignItems:"center",borderRadius:4,bg:"base.800",children:[s.jsxs(L,{w:"full",minW:"25%",flexDir:"column",children:[s.jsx(pe,{fontWeight:"semibold",children:w.split("\\").slice(-1)[0]}),s.jsx(pe,{fontSize:"sm",color:"base.400",children:w})]}),M?s.jsxs(L,{gap:2,children:[s.jsx(Ge,{id:w,onClick:p,isLoading:f,children:g("modelManager.quickAdd")}),s.jsx(Ge,{onClick:y.bind(null,w),isLoading:f,children:g("modelManager.advanced")})]}):s.jsx(pe,{fontWeight:"semibold",p:2,borderRadius:4,color:"invokeBlue.100",bg:"invokeBlue.600",children:g("common.installed")})]},w));return e?!r||r.length===0?s.jsx(L,{w:"full",h:"full",justifyContent:"center",alignItems:"center",height:96,userSelect:"none",bg:"base.900",children:s.jsx(pe,{variant:"subtext",children:g("modelManager.noModels")})}):s.jsxs(L,{flexDirection:"column",gap:2,w:"100%",minW:"50%",children:[s.jsxs(U,{children:[s.jsx(Y,{children:g("modelManager.search")}),s.jsx(dt,{onChange:x})]}),s.jsxs(L,{p:2,gap:2,children:[s.jsxs(pe,{fontWeight:"semibold",children:[g("modelManager.modelsFound"),": ",r.length]}),s.jsxs(pe,{fontWeight:"semibold",color:"invokeBlue.200",children:[g("common.notInstalled"),": ",c.length]})]}),s.jsx(io,{children:s.jsxs(L,{gap:2,flexDirection:"column",children:[S({models:c}),S({models:l,showActions:!1})]})})]}):null},hC=(e,t)=>{const n=[];return p0(e,o=>{if(!o)return null;o.includes(t)&&n.push(o)}),n},N$=u.memo(O$),F$=()=>{const e=j(p=>p.modelmanager.advancedAddScanModel),{t}=R(),n=u.useMemo(()=>[{label:t("modelManager.diffusersModels"),value:"diffusers"},{label:t("modelManager.checkpointOrSafetensors"),value:"checkpoint"}],[t]),[o,r]=u.useState("diffusers"),[l,c]=u.useState(!0);u.useEffect(()=>{e&&[".ckpt",".safetensors",".pth",".pt"].some(p=>e.endsWith(p))?r("checkpoint"):r("diffusers")},[e,r,l]);const d=J(),f=u.useCallback(()=>d(hc(null)),[d]),m=u.useCallback(p=>{Lw(p==null?void 0:p.value)&&(r(p.value),p.value==="checkpoint"?c(!0):c(!1))},[]),g=u.useMemo(()=>n.find(p=>p.value===o),[n,o]);return e?s.jsxs(We,{display:"flex",flexDirection:"column",minWidth:"40%",maxHeight:"calc(100vh - 300px)",overflow:"scroll",p:4,gap:4,borderRadius:4,bg:"base.800",children:[s.jsxs(L,{justifyContent:"space-between",alignItems:"center",children:[s.jsx(pe,{size:"xl",fontWeight:"semibold",children:l||o==="checkpoint"?"Add Checkpoint Model":"Add Diffusers Model"}),s.jsx(je,{icon:s.jsx(oo,{}),"aria-label":t("modelManager.closeAdvanced"),onClick:f,size:"sm"})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("modelManager.modelType")}),s.jsx(Xe,{value:g,options:n,onChange:m})]}),l?s.jsx(Ew,{model_path:e},e):s.jsx(Dw,{model_path:e},e)]}):null},z$=u.memo(F$);function H$(){const e=J(),{t}=R(),n=j(f=>f.modelmanager.searchFolder),{refetch:o}=eb({search_path:n||""}),r=Bw({initialValues:{folder:""}}),l=u.useCallback(f=>{e(l2(f.folder))},[e]),c=u.useCallback(()=>{o()},[o]),d=u.useCallback(()=>{e(l2(null)),e(hc(null))},[e]);return s.jsx("form",{onSubmit:r.onSubmit(f=>l(f)),style:V$,children:s.jsxs(L,{w:"100%",gap:2,borderRadius:4,alignItems:"center",children:[s.jsxs(L,{w:"100%",alignItems:"center",gap:4,minH:12,children:[s.jsx(pe,{fontSize:"sm",fontWeight:"semibold",color:"base.300",minW:"max-content",children:t("common.folder")}),n?s.jsx(L,{w:"100%",p:2,px:4,bg:"base.700",borderRadius:4,fontSize:"sm",fontWeight:"bold",children:n}):s.jsx(dt,{w:"100%",size:"md",...r.getInputProps("folder")})]}),s.jsxs(L,{gap:2,children:[n?s.jsx(je,{"aria-label":t("modelManager.scanAgain"),tooltip:t("modelManager.scanAgain"),icon:s.jsx(Z0,{}),onClick:c,fontSize:18,size:"sm"}):s.jsx(je,{"aria-label":t("modelManager.findModels"),tooltip:t("modelManager.findModels"),icon:s.jsx(F7,{}),fontSize:18,size:"sm",type:"submit"}),s.jsx(je,{"aria-label":t("modelManager.clearCheckpointFolder"),tooltip:t("modelManager.clearCheckpointFolder"),icon:s.jsx(Vs,{}),size:"sm",onClick:d,isDisabled:!n,colorScheme:"red"})]})]})})}const $$=u.memo(H$),V$={width:"100%"},W$=()=>s.jsxs(L,{flexDirection:"column",w:"100%",h:"full",gap:4,children:[s.jsx($$,{}),s.jsxs(L,{gap:4,children:[s.jsx(L,{overflow:"scroll",gap:4,w:"100%",h:"full",children:s.jsx(N$,{})}),s.jsx(z$,{})]})]}),U$=u.memo(W$),G$=()=>{const[e,t]=u.useState("add"),{t:n}=R(),o=u.useCallback(()=>t("add"),[]),r=u.useCallback(()=>t("scan"),[]);return s.jsxs(L,{flexDirection:"column",gap:4,h:"full",children:[s.jsxs(wt,{children:[s.jsx(Ge,{onClick:o,isChecked:e==="add",size:"sm",width:"100%",children:n("modelManager.addModel")}),s.jsx(Ge,{onClick:r,isChecked:e==="scan",size:"sm",width:"100%",isDisabled:!0,children:n("modelManager.scanForModels")})]}),e==="add"&&s.jsx(B$,{}),e==="scan"&&s.jsx(U$,{})]})},Z$=u.memo(G$),pC=[{label:"Stable Diffusion 1",value:"sd-1"},{label:"Stable Diffusion 2",value:"sd-2"}],q$=()=>{var ue,xe;const{t:e}=R(),t=J(),{data:n}=so(lc),[o,{isLoading:r}]=R8(),[l,c]=u.useState("sd-1"),d=u.useMemo(()=>pC.find(W=>W.value===l),[l]),f=x2(n==null?void 0:n.entities,(W,Me)=>(W==null?void 0:W.model_format)==="diffusers"&&(W==null?void 0:W.base_model)==="sd-1"),m=x2(n==null?void 0:n.entities,(W,Me)=>(W==null?void 0:W.model_format)==="diffusers"&&(W==null?void 0:W.base_model)==="sd-2"),g=u.useMemo(()=>({"sd-1":f,"sd-2":m}),[f,m]),[p,x]=u.useState(((ue=Object.keys(g[l]))==null?void 0:ue[0])??null),[y,S]=u.useState(((xe=Object.keys(g[l]))==null?void 0:xe[1])??null),[b,I]=u.useState(null),[M,w]=u.useState(""),[_,T]=u.useState(.5),[D,A]=u.useState("weighted_sum"),[F,Q]=u.useState("root"),[q,G]=u.useState(""),[Z,N]=u.useState(!1),z=u.useMemo(()=>Object.keys(g[l]).filter(W=>W!==y&&W!==b).map(W=>({label:W,value:W})),[g,l,y,b]),$=u.useMemo(()=>Object.keys(g[l]).filter(W=>W!==p&&W!==b).map(W=>({label:W,value:W})),[g,l,p,b]),se=u.useMemo(()=>Object.keys(g[l]).filter(W=>W!==p&&W!==y).map(W=>({label:W,value:W})),[g,l,p,y]),he=u.useCallback(W=>{W&&(W.value==="sd-1"||W.value==="sd-2")&&(c(W.value),x(null),S(null))},[]),ke=u.useCallback(W=>{W&&x(W.value)},[]),Ce=u.useCallback(W=>{W&&S(W.value)},[]),ge=u.useCallback(W=>{W?(I(W.value),A("weighted_sum")):(I(null),A("add_difference"))},[]),De=u.useMemo(()=>z.find(W=>W.value===p),[p,z]),Se=u.useMemo(()=>$.find(W=>W.value===y),[y,$]),oe=u.useMemo(()=>se.find(W=>W.value===b),[b,se]),re=u.useCallback(W=>w(W.target.value),[]),de=u.useCallback(W=>T(W),[]),P=u.useCallback(()=>T(.5),[]),B=u.useCallback(W=>A(W),[]),H=u.useCallback(W=>Q(W),[]),V=u.useCallback(W=>G(W.target.value),[]),le=u.useCallback(W=>N(W.target.checked),[]),fe=u.useCallback(()=>{const W=[];let Me=[p,y,b];Me=Me.filter(Pe=>Pe!==null),Me.forEach(Pe=>{var Ye;const Ve=(Ye=Pe==null?void 0:Pe.split("/"))==null?void 0:Ye[2];Ve&&W.push(Ve)});const ye={model_names:W,merged_model_name:M!==""?M:W.join("-"),alpha:_,interp:D,force:Z,merge_dest_directory:F==="root"?void 0:q};o({base_model:l,body:{body:ye}}).unwrap().then(Pe=>{t(Qe(_t({title:e("modelManager.modelsMerged"),status:"success"})))}).catch(Pe=>{Pe&&t(Qe(_t({title:e("modelManager.modelsMergeFailed"),status:"error"})))})},[l,t,o,M,_,q,Z,D,F,p,b,y,e]);return s.jsxs(L,{flexDir:"column",gap:4,children:[s.jsxs(L,{flexDir:"column",gap:1,children:[s.jsx(pe,{children:e("modelManager.modelMergeHeaderHelp1")}),s.jsx(pe,{fontSize:"sm",variant:"subtext",children:e("modelManager.modelMergeHeaderHelp2")})]}),s.jsxs(L,{columnGap:4,children:[s.jsxs(U,{w:"full",children:[s.jsx(Y,{children:e("modelManager.modelType")}),s.jsx(Xe,{options:pC,value:d,onChange:he})]}),s.jsxs(U,{w:"full",children:[s.jsx(Y,{children:e("modelManager.modelOne")}),s.jsx(Xe,{options:z,value:De,onChange:ke})]}),s.jsxs(U,{w:"full",children:[s.jsx(Y,{children:e("modelManager.modelTwo")}),s.jsx(Xe,{options:$,value:Se,onChange:Ce})]}),s.jsxs(U,{w:"full",children:[s.jsx(Y,{children:e("modelManager.modelThree")}),s.jsx(Xe,{options:se,value:oe,onChange:ge,isClearable:!0})]})]}),s.jsxs(U,{children:[s.jsx(Y,{children:e("modelManager.mergedModelName")}),s.jsx(dt,{value:M,onChange:re})]}),s.jsx(L,{flexDirection:"column",padding:4,borderRadius:"base",gap:4,bg:"base.800",children:s.jsxs(U,{children:[s.jsx(Y,{children:e("modelManager.alpha")}),s.jsx(Ue,{min:.01,max:.99,step:.01,value:_,onChange:de,onReset:P,marks:!0}),s.jsx($e,{min:.01,max:.99,step:.01,value:_,onChange:de,onReset:P}),s.jsx(ca,{children:e("modelManager.modelMergeAlphaHelp")})]})}),s.jsxs(L,{padding:4,gap:4,borderRadius:"base",bg:"base.800",children:[s.jsx(pe,{fontSize:"sm",variant:"subtext",children:e("modelManager.interpolationType")}),s.jsx(Ip,{value:D,onChange:B,children:s.jsx(L,{columnGap:4,children:b===null?s.jsxs(s.Fragment,{children:[s.jsx(Ir,{value:"weighted_sum",children:s.jsx(pe,{fontSize:"sm",children:e("modelManager.weightedSum")})}),s.jsx(Ir,{value:"sigmoid",children:s.jsx(pe,{fontSize:"sm",children:e("modelManager.sigmoid")})}),s.jsx(Ir,{value:"inv_sigmoid",children:s.jsx(pe,{fontSize:"sm",children:e("modelManager.inverseSigmoid")})})]}):s.jsx(Ir,{value:"add_difference",children:s.jsx(jt,{label:e("modelManager.modelMergeInterpAddDifferenceHelp"),children:s.jsx(pe,{fontSize:"sm",children:e("modelManager.addDifference")})})})})})]}),s.jsxs(L,{flexDirection:"column",padding:4,borderRadius:"base",gap:4,bg:"base.900",children:[s.jsxs(L,{columnGap:4,children:[s.jsx(pe,{fontSize:"sm",variant:"subtext",children:e("modelManager.mergedModelSaveLocation")}),s.jsx(Ip,{value:F,onChange:H,children:s.jsxs(L,{columnGap:4,children:[s.jsx(Ir,{value:"root",children:s.jsx(pe,{fontSize:"sm",children:e("modelManager.invokeAIFolder")})}),s.jsx(Ir,{value:"custom",children:s.jsx(pe,{fontSize:"sm",children:e("modelManager.custom")})})]})})]}),F==="custom"&&s.jsxs(U,{children:[s.jsx(Y,{children:e("modelManager.mergedModelCustomSaveLocation")}),s.jsx(dt,{value:q,onChange:V})]})]}),s.jsxs(U,{children:[s.jsx(Y,{children:e("modelManager.ignoreMismatch")}),s.jsx(jn,{isChecked:Z,onChange:le})]}),s.jsx(Ge,{onClick:fe,isLoading:r,isDisabled:p===null||y===null,children:e("modelManager.merge")})]})},Q$=u.memo(q$),K$=e=>{const{model:t}=e,n=J(),{t:o}=R(),[r,{isLoading:l}]=B8(),{isOpen:c,onOpen:d,onClose:f}=an(),[m,g]=u.useState("InvokeAIRoot"),[p,x]=u.useState("");u.useEffect(()=>{g("InvokeAIRoot")},[t]);const y=u.useCallback(()=>{g("InvokeAIRoot")},[]),S=u.useCallback(M=>{g(M)},[]),b=u.useCallback(M=>{x(M.target.value)},[]),I=u.useCallback(()=>{const M={base_model:t.base_model,model_name:t.model_name,convert_dest_directory:m==="Custom"?p:void 0};if(m==="Custom"&&p===""){n(Qe(_t({title:o("modelManager.noCustomLocationProvided"),status:"error"})));return}n(Qe(_t({title:`${o("modelManager.convertingModelBegin")}: ${t.model_name}`,status:"info"}))),r(M).unwrap().then(()=>{n(Qe(_t({title:`${o("modelManager.modelConverted")}: ${t.model_name}`,status:"success"})))}).catch(()=>{n(Qe(_t({title:`${o("modelManager.modelConversionFailed")}: ${t.model_name}`,status:"error"})))})},[r,p,n,t.base_model,t.model_name,m,o]);return s.jsxs(s.Fragment,{children:[s.jsxs(Ge,{onClick:d,size:"sm","aria-label":o("modelManager.convertToDiffusers"),className:" modal-close-btn",isLoading:l,children:["🧨 ",o("modelManager.convertToDiffusers")]}),s.jsxs(Gr,{title:`${o("modelManager.convert")} ${t.model_name}`,acceptCallback:I,cancelCallback:y,acceptButtonText:`${o("modelManager.convert")}`,isOpen:c,onClose:f,children:[s.jsxs(L,{flexDirection:"column",rowGap:4,children:[s.jsx(pe,{children:o("modelManager.convertToDiffusersHelpText1")}),s.jsxs(x0,{children:[s.jsx(wo,{children:o("modelManager.convertToDiffusersHelpText2")}),s.jsx(wo,{children:o("modelManager.convertToDiffusersHelpText3")}),s.jsx(wo,{children:o("modelManager.convertToDiffusersHelpText4")}),s.jsx(wo,{children:o("modelManager.convertToDiffusersHelpText5")})]}),s.jsx(pe,{children:o("modelManager.convertToDiffusersHelpText6")})]}),s.jsxs(L,{flexDir:"column",gap:2,children:[s.jsxs(L,{marginTop:4,flexDir:"column",gap:2,children:[s.jsx(pe,{fontWeight:"semibold",children:o("modelManager.convertToDiffusersSaveLocation")}),s.jsx(Ip,{value:m,onChange:S,children:s.jsxs(L,{gap:4,children:[s.jsx(Ir,{value:"InvokeAIRoot",children:s.jsx(jt,{label:"Save converted model in the InvokeAI root folder",children:o("modelManager.invokeRoot")})}),s.jsx(Ir,{value:"Custom",children:s.jsx(jt,{label:"Save converted model in a custom folder",children:o("modelManager.custom")})})]})})]}),m==="Custom"&&s.jsxs(U,{children:[s.jsx(Y,{children:o("modelManager.customSaveLocation")}),s.jsx(dt,{width:"full",value:p,onChange:b})]})]})]})]})},Y$=u.memo(K$),X$=e=>{var I,M,w,_;const{model:t}=e,[n,{isLoading:o}]=tb(),{data:r}=Yy(),[l,c]=u.useState(!1);u.useEffect(()=>{r!=null&&r.includes(t.config)||c(!0)},[r,t.config]);const d=J(),{t:f}=R(),{register:m,handleSubmit:g,control:p,formState:{errors:x},reset:y}=Tc({defaultValues:{model_name:t.model_name?t.model_name:"",base_model:t.base_model,model_type:"main",path:t.path?t.path:"",description:t.description?t.description:"",model_format:"checkpoint",vae:t.vae?t.vae:"",config:t.config?t.config:"",variant:t.variant},mode:"onChange"}),S=u.useCallback(()=>c(T=>!T),[]),b=u.useCallback(T=>{const D={base_model:t.base_model,model_name:t.model_name,body:T};n(D).unwrap().then(A=>{y(A,{keepDefaultValues:!0}),d(Qe(_t({title:f("modelManager.modelUpdated"),status:"success"})))}).catch(A=>{y(),d(Qe(_t({title:f("modelManager.modelUpdateFailed"),status:"error"})))})},[d,t.base_model,t.model_name,y,f,n]);return s.jsxs(L,{flexDirection:"column",rowGap:4,width:"100%",children:[s.jsxs(L,{justifyContent:"space-between",alignItems:"center",children:[s.jsxs(L,{flexDirection:"column",children:[s.jsx(pe,{fontSize:"lg",fontWeight:"bold",children:t.model_name}),s.jsxs(pe,{fontSize:"sm",color:"base.400",children:[yl[t.base_model]," ",f("modelManager.model")]})]}),[""].includes(t.base_model)?s.jsx(Yr,{p:2,borderRadius:4,bg:"error.400",children:f("modelManager.conversionNotSupported")}):s.jsx(Y$,{model:t})]}),s.jsx(Sn,{}),s.jsx(L,{flexDirection:"column",maxHeight:window.innerHeight-270,overflowY:"scroll",children:s.jsx("form",{onSubmit:g(b),children:s.jsxs(L,{flexDirection:"column",overflowY:"scroll",gap:4,children:[s.jsxs(U,{isInvalid:!!x.model_name,children:[s.jsx(Y,{children:f("modelManager.name")}),s.jsx(dt,{...m("model_name",{validate:T=>T.trim().length>3||"Must be at least 3 characters"})}),((I=x.model_name)==null?void 0:I.message)&&s.jsx(Eo,{children:(M=x.model_name)==null?void 0:M.message})]}),s.jsxs(U,{children:[s.jsx(Y,{children:f("modelManager.description")}),s.jsx(dt,{...m("description")})]}),s.jsx(Rc,{control:p,name:"base_model"}),s.jsx(em,{control:p,name:"variant"}),s.jsxs(U,{isInvalid:!!x.path,children:[s.jsx(Y,{children:f("modelManager.modelLocation")}),s.jsx(dt,{...m("path",{validate:T=>T.trim().length>0||"Must provide a path"})}),((w=x.path)==null?void 0:w.message)&&s.jsx(Eo,{children:(_=x.path)==null?void 0:_.message})]}),s.jsxs(U,{children:[s.jsx(Y,{children:f("modelManager.vaeLocation")}),s.jsx(dt,{...m("vae")})]}),s.jsxs(L,{flexDirection:"column",gap:2,children:[l?s.jsxs(U,{isRequired:!0,children:[s.jsx(Y,{children:f("modelManager.config")}),s.jsx(dt,{...m("config")})]}):s.jsx(Pw,{control:p,name:"config"}),s.jsxs(U,{children:[s.jsx(Y,{children:f("modelManager.useCustomConfig")}),s.jsx(jn,{isChecked:l,onChange:S})]})]}),s.jsx(Ge,{type:"submit",isLoading:o,children:f("modelManager.updateModel")})]})})})]})},J$=u.memo(X$),eV=e=>{var x,y,S,b;const{model:t}=e,[n,{isLoading:o}]=tb(),r=J(),{t:l}=R(),{register:c,handleSubmit:d,control:f,formState:{errors:m},reset:g}=Tc({defaultValues:{model_name:t.model_name?t.model_name:"",base_model:t.base_model,model_type:"main",path:t.path?t.path:"",description:t.description?t.description:"",model_format:"diffusers",vae:t.vae?t.vae:"",variant:t.variant},mode:"onChange"}),p=u.useCallback(I=>{const M={base_model:t.base_model,model_name:t.model_name,body:I};n(M).unwrap().then(w=>{g(w,{keepDefaultValues:!0}),r(Qe(_t({title:l("modelManager.modelUpdated"),status:"success"})))}).catch(w=>{g(),r(Qe(_t({title:l("modelManager.modelUpdateFailed"),status:"error"})))})},[r,t.base_model,t.model_name,g,l,n]);return s.jsxs(L,{flexDirection:"column",rowGap:4,width:"100%",children:[s.jsxs(L,{flexDirection:"column",children:[s.jsx(pe,{fontSize:"lg",fontWeight:"bold",children:t.model_name}),s.jsxs(pe,{fontSize:"sm",color:"base.400",children:[yl[t.base_model]," ",l("modelManager.model")]})]}),s.jsx(Sn,{}),s.jsx("form",{onSubmit:d(p),children:s.jsxs(L,{flexDirection:"column",overflowY:"scroll",gap:4,children:[s.jsxs(U,{isInvalid:!!m.model_name,children:[s.jsx(Y,{children:l("modelManager.name")}),s.jsx(dt,{...c("model_name",{validate:I=>I.trim().length>3||"Must be at least 3 characters"})}),((x=m.model_name)==null?void 0:x.message)&&s.jsx(Eo,{children:(y=m.model_name)==null?void 0:y.message})]}),s.jsxs(U,{children:[s.jsx(Y,{children:l("modelManager.description")}),s.jsx(dt,{...c("description")})]}),s.jsx(Rc,{control:f,name:"base_model"}),s.jsx(em,{control:f,name:"variant"}),s.jsxs(U,{isInvalid:!!m.path,children:[s.jsx(Y,{children:l("modelManager.modelLocation")}),s.jsx(dt,{...c("path",{validate:I=>I.trim().length>0||"Must provide a path"})}),((S=m.path)==null?void 0:S.message)&&s.jsx(Eo,{children:(b=m.path)==null?void 0:b.message})]}),s.jsxs(U,{children:[s.jsx(Y,{children:l("modelManager.vaeLocation")}),s.jsx(dt,{...c("vae")})]}),s.jsx(Ge,{type:"submit",isLoading:o,children:l("modelManager.updateModel")})]})})]})},tV=u.memo(eV),nV=e=>{var x,y,S,b;const{model:t}=e,[n,{isLoading:o}]=O8(),r=J(),{t:l}=R(),{register:c,handleSubmit:d,control:f,formState:{errors:m},reset:g}=Tc({defaultValues:{model_name:t.model_name?t.model_name:"",base_model:t.base_model,model_type:"lora",path:t.path?t.path:"",description:t.description?t.description:"",model_format:t.model_format},mode:"onChange"}),p=u.useCallback(I=>{const M={base_model:t.base_model,model_name:t.model_name,body:I};n(M).unwrap().then(w=>{g(w,{keepDefaultValues:!0}),r(Qe(_t({title:l("modelManager.modelUpdated"),status:"success"})))}).catch(w=>{g(),r(Qe(_t({title:l("modelManager.modelUpdateFailed"),status:"error"})))})},[r,t.base_model,t.model_name,g,l,n]);return s.jsxs(L,{flexDirection:"column",rowGap:4,width:"100%",children:[s.jsxs(L,{flexDirection:"column",children:[s.jsx(pe,{fontSize:"lg",fontWeight:"bold",children:t.model_name}),s.jsxs(pe,{fontSize:"sm",color:"base.400",children:[yl[t.base_model]," ",l("modelManager.model")," ⋅ ",N8[t.model_format]," ",l("common.format")]})]}),s.jsx(Sn,{}),s.jsx("form",{onSubmit:d(p),children:s.jsxs(L,{flexDirection:"column",overflowY:"scroll",gap:4,children:[s.jsxs(U,{isInvalid:!!m.model_name,children:[s.jsx(Y,{children:l("modelManager.name")}),s.jsx(dt,{...c("model_name",{validate:I=>I.trim().length>3||"Must be at least 3 characters"})}),((x=m.model_name)==null?void 0:x.message)&&s.jsx(Eo,{children:(y=m.model_name)==null?void 0:y.message})]}),s.jsxs(U,{children:[s.jsx(Y,{children:l("modelManager.description")}),s.jsx(dt,{...c("description")})]}),s.jsx(Rc,{control:f,name:"base_model"}),s.jsxs(U,{isInvalid:!!m.path,children:[s.jsx(Y,{children:l("modelManager.modelLocation")}),s.jsx(dt,{...c("path",{validate:I=>I.trim().length>0||"Must provide a path"})}),((S=m.path)==null?void 0:S.message)&&s.jsx(Eo,{children:(b=m.path)==null?void 0:b.message})]}),s.jsx(Ge,{type:"submit",isLoading:o,children:l("modelManager.updateModel")})]})})]})},sV=u.memo(nV),oV=e=>{const{t}=R(),n=J(),[o]=F8(),[r]=z8(),{isOpen:l,onOpen:c,onClose:d}=an(),{model:f,isSelected:m,setSelectedModelId:g}=e,p=u.useCallback(()=>{g(f.id)},[f.id,g]),x=u.useCallback(()=>{const y={main:o,lora:r}[f.model_type];y(f).unwrap().then(S=>{n(Qe(_t({title:`${t("modelManager.modelDeleted")}: ${f.model_name}`,status:"success"})))}).catch(S=>{S&&n(Qe(_t({title:`${t("modelManager.modelDeleteFailed")}: ${f.model_name}`,status:"error"})))}),g(void 0)},[o,r,f,g,n,t]);return s.jsxs(L,{gap:2,alignItems:"center",w:"full",children:[s.jsx(L,{as:Ge,isChecked:m,variant:m?"solid":"ghost",justifyContent:"start",p:2,borderRadius:"base",w:"full",alignItems:"center",onClick:p,children:s.jsxs(L,{gap:4,alignItems:"center",children:[s.jsx(Yr,{minWidth:14,p:.5,fontSize:"sm",variant:"solid",children:H8[f.base_model]}),s.jsx(jt,{label:f.description,placement:"bottom",children:s.jsx(pe,{children:f.model_name})})]})}),s.jsx(je,{onClick:c,icon:s.jsx(Vs,{}),"aria-label":t("modelManager.deleteConfig"),colorScheme:"error"}),s.jsx(Gr,{isOpen:l,onClose:d,title:t("modelManager.deleteModel"),acceptCallback:x,acceptButtonText:t("modelManager.delete"),children:s.jsxs(L,{rowGap:4,flexDirection:"column",children:[s.jsx(pe,{fontWeight:"bold",children:t("modelManager.deleteMsg1")}),s.jsx(pe,{children:t("modelManager.deleteMsg2")})]})})]})},rV=u.memo(oV),lV=e=>{const{selectedModelId:t,setSelectedModelId:n}=e,{t:o}=R(),[r,l]=u.useState(""),[c,d]=u.useState("all"),{filteredDiffusersModels:f,isLoadingDiffusersModels:m}=so(lc,{selectFromResult:({data:b,isLoading:I})=>({filteredDiffusersModels:lp(b,"main","diffusers",r),isLoadingDiffusersModels:I})}),{filteredCheckpointModels:g,isLoadingCheckpointModels:p}=so(lc,{selectFromResult:({data:b,isLoading:I})=>({filteredCheckpointModels:lp(b,"main","checkpoint",r),isLoadingCheckpointModels:I})}),{filteredLoraModels:x,isLoadingLoraModels:y}=dc(void 0,{selectFromResult:({data:b,isLoading:I})=>({filteredLoraModels:lp(b,"lora",void 0,r),isLoadingLoraModels:I})}),S=u.useCallback(b=>{l(b.target.value)},[]);return s.jsx(L,{flexDirection:"column",rowGap:4,width:"50%",minWidth:"50%",children:s.jsxs(L,{flexDirection:"column",gap:4,paddingInlineEnd:4,children:[s.jsxs(wt,{children:[s.jsx(Ge,{onClick:d.bind(null,"all"),isChecked:c==="all",size:"sm",children:o("modelManager.allModels")}),s.jsx(Ge,{size:"sm",onClick:d.bind(null,"diffusers"),isChecked:c==="diffusers",children:o("modelManager.diffusersModels")}),s.jsx(Ge,{size:"sm",onClick:d.bind(null,"checkpoint"),isChecked:c==="checkpoint",children:o("modelManager.checkpointModels")}),s.jsx(Ge,{size:"sm",onClick:d.bind(null,"lora"),isChecked:c==="lora",children:o("modelManager.loraModels")})]}),s.jsxs(U,{children:[s.jsx(Y,{children:o("modelManager.search")}),s.jsx(dt,{onChange:S})]}),s.jsxs(L,{flexDirection:"column",gap:4,maxHeight:window.innerHeight-280,overflow:"scroll",children:[m&&s.jsx(yd,{loadingMessage:"Loading Diffusers..."}),["all","diffusers"].includes(c)&&!m&&f.length>0&&s.jsx(Cd,{title:"Diffusers",modelList:f,selected:{selectedModelId:t,setSelectedModelId:n}},"diffusers"),p&&s.jsx(yd,{loadingMessage:"Loading Checkpoints..."}),["all","checkpoint"].includes(c)&&!p&&g.length>0&&s.jsx(Cd,{title:"Checkpoints",modelList:g,selected:{selectedModelId:t,setSelectedModelId:n}},"checkpoints"),y&&s.jsx(yd,{loadingMessage:"Loading LoRAs..."}),["all","lora"].includes(c)&&!y&&x.length>0&&s.jsx(Cd,{title:"LoRAs",modelList:x,selected:{selectedModelId:t,setSelectedModelId:n}},"loras")]})]})})},aV=u.memo(lV),lp=(e,t,n,o)=>{const r=[];return p0(e==null?void 0:e.entities,l=>{if(!l)return;const c=l.model_name.toLowerCase().includes(o.toLowerCase()),d=n===void 0||l.model_format===n,f=l.model_type===t;c&&d&&f&&r.push(l)}),r},Kg=u.memo(e=>s.jsx(L,{flexDirection:"column",gap:4,borderRadius:4,p:4,bg:"base.800",children:e.children}));Kg.displayName="StyledModelContainer";const Cd=u.memo(e=>{const{title:t,modelList:n,selected:o}=e;return s.jsx(Kg,{children:s.jsxs(L,{gap:2,flexDir:"column",children:[s.jsx(pe,{variant:"subtext",fontSize:"sm",children:t}),n.map(r=>s.jsx(rV,{model:r,isSelected:o.selectedModelId===r.id,setSelectedModelId:o.setSelectedModelId},r.id))]})})});Cd.displayName="ModelListWrapper";const yd=u.memo(({loadingMessage:e})=>s.jsx(Kg,{children:s.jsxs(L,{justifyContent:"center",alignItems:"center",flexDirection:"column",p:4,gap:8,children:[s.jsx(Kr,{}),s.jsx(pe,{variant:"subtext",children:e||"Fetching..."})]})}));yd.displayName="FetchingModelsLoader";const iV=()=>{const[e,t]=u.useState(),{mainModel:n}=so(lc,{selectFromResult:({data:l})=>({mainModel:e?l==null?void 0:l.entities[e]:void 0})}),{loraModel:o}=dc(void 0,{selectFromResult:({data:l})=>({loraModel:e?l==null?void 0:l.entities[e]:void 0})}),r=n||o;return s.jsxs(L,{gap:8,w:"full",h:"full",children:[s.jsx(aV,{selectedModelId:e,setSelectedModelId:t}),s.jsx(cV,{model:r})]})},cV=e=>{const{t}=R(),{model:n}=e;return(n==null?void 0:n.model_format)==="checkpoint"?s.jsx(J$,{model:n},n.id):(n==null?void 0:n.model_format)==="diffusers"?s.jsx(tV,{model:n},n.id):(n==null?void 0:n.model_type)==="lora"?s.jsx(sV,{model:n},n.id):s.jsx(L,{w:"full",h:"full",justifyContent:"center",alignItems:"center",maxH:96,userSelect:"none",children:s.jsx(pe,{variant:"subtext",children:t("modelManager.noModelSelected")})})},uV=u.memo(iV),Ow=u.memo(e=>{const{t}=R(),{syncModels:n,isLoading:o}=kk();return Kt("syncModels").isFeatureEnabled?s.jsx(Ge,{isLoading:o,onClick:n,leftIcon:s.jsx(G0,{}),minW:"max-content",...e,children:t("modelManager.syncModels")}):null});Ow.displayName="SyncModelsButton";const dV=()=>{const{t:e}=R();return s.jsxs(L,{w:"full",p:4,borderRadius:4,gap:4,justifyContent:"space-between",alignItems:"center",bg:"base.800",children:[s.jsxs(L,{flexDirection:"column",gap:2,children:[s.jsx(pe,{fontWeight:"semibold",children:e("modelManager.syncModels")}),s.jsx(pe,{fontSize:"sm",variant:"subtext",children:e("modelManager.syncModelsDesc")})]}),s.jsx(Ow,{})]})},fV=u.memo(dV),mV=()=>s.jsx(L,{children:s.jsx(fV,{})}),hV=u.memo(mV),pV=()=>{const{t:e}=R(),t=u.useMemo(()=>[{id:"modelManager",label:e("modelManager.modelManager"),content:s.jsx(uV,{})},{id:"importModels",label:e("modelManager.importModels"),content:s.jsx(Z$,{})},{id:"mergeModels",label:e("modelManager.mergeModels"),content:s.jsx(Q$,{})},{id:"settings",label:e("modelManager.settings"),content:s.jsx(hV,{})}],[e]);return s.jsxs(Xr,{isLazy:!0,variant:"line",layerStyle:"first",w:"full",h:"full",p:4,gap:4,borderRadius:"base",children:[s.jsx(Jr,{children:t.map(n=>s.jsx(hn,{borderTopRadius:"base",children:n.label},n.id))}),s.jsx(Rl,{w:"full",h:"full",children:t.map(n=>s.jsx(An,{w:"full",h:"full",children:n.content},n.id))})]})},gV=u.memo(pV),xV=()=>{const e=J(),{t}=R(),n=u.useCallback(()=>{e(nb())},[e]);return s.jsx(je,{tooltip:t("nodes.addNodeToolTip"),"aria-label":t("nodes.addNode"),icon:s.jsx(kl,{}),onClick:n,pointerEvents:"auto"})},vV=u.memo(xV),CV=()=>{const e=J(),{t}=R(),{isOpen:n,onOpen:o,onClose:r}=an(),l=j(f=>f.workflow.isTouched),c=u.useCallback(()=>{e(sb()),e(Qe(_t({title:t("workflows.workflowCleared"),status:"success"}))),r()},[e,r,t]),d=u.useCallback(()=>{if(!l){c();return}o()},[c,l,o]);return s.jsxs(s.Fragment,{children:[s.jsx(je,{tooltip:t("nodes.clearWorkflow"),"aria-label":t("nodes.clearWorkflow"),icon:s.jsx(bc,{}),onClick:d,pointerEvents:"auto"}),s.jsx(Gr,{isOpen:n,onClose:r,title:t("nodes.clearWorkflow"),acceptCallback:c,children:s.jsxs(L,{flexDir:"column",gap:2,children:[s.jsx(pe,{children:t("nodes.clearWorkflowDesc")}),s.jsx(pe,{variant:"subtext",children:t("nodes.clearWorkflowDesc2")})]})})]})},yV=u.memo(CV),bV=e=>`${e.trim()} (copy)`,ap=Tl(!1),nd=Tl(""),ip=Tl(!1),jV=ft(fc,({name:e,id:t})=>t?e.length?bV(e):"":e),nm=()=>{const e=j(jV),t=gt(ap),n=u.useCallback(()=>{nd.set(e),ap.set(!0)},[e]),o=u.useCallback(()=>{ap.set(!1),nd.set(""),ip.set(!1)},[]),r=gt(nd),l=u.useCallback(f=>nd.set(f),[]),c=gt(ip),d=u.useCallback(f=>{ip.set(f)},[]);return{workflowName:r,setWorkflowName:l,shouldSaveToProject:c,setShouldSaveToProject:d,isOpen:t,onOpen:n,onClose:o}},Ll=$8.injectEndpoints({endpoints:e=>({getWorkflow:e.query({query:t=>`workflows/i/${t}`,providesTags:(t,n,o)=>[{type:"Workflow",id:o},"FetchOnReconnect"],onQueryStarted:async(t,n)=>{const{dispatch:o,queryFulfilled:r}=n;try{await r,o(Ll.util.invalidateTags([{type:"WorkflowsRecent",id:Sr}]))}catch{}}}),deleteWorkflow:e.mutation({query:t=>({url:`workflows/i/${t}`,method:"DELETE"}),invalidatesTags:(t,n,o)=>[{type:"Workflow",id:Sr},{type:"Workflow",id:o},{type:"WorkflowsRecent",id:Sr}]}),createWorkflow:e.mutation({query:t=>({url:"workflows/",method:"POST",body:{workflow:t}}),invalidatesTags:[{type:"Workflow",id:Sr},{type:"WorkflowsRecent",id:Sr}]}),updateWorkflow:e.mutation({query:t=>({url:`workflows/i/${t.id}`,method:"PATCH",body:{workflow:t}}),invalidatesTags:(t,n,o)=>[{type:"WorkflowsRecent",id:Sr},{type:"Workflow",id:Sr},{type:"Workflow",id:o.id}]}),listWorkflows:e.query({query:t=>({url:"workflows/",params:t}),providesTags:["FetchOnReconnect",{type:"Workflow",id:Sr}]})})}),{useLazyGetWorkflowQuery:SV,useCreateWorkflowMutation:Nw,useDeleteWorkflowMutation:kV,useUpdateWorkflowMutation:wV,useListWorkflowsQuery:IV}=Ll,Yg=e=>!!e.id,Fw=()=>{const{t:e}=R(),t=J(),[n,o]=wV(),[r,l]=Nw(),c=Oa(),d=u.useRef();return{saveWorkflow:u.useCallback(async()=>{const m=Fl.get();if(m){d.current=c({title:e("workflows.savingWorkflow"),status:"loading",duration:null,isClosable:!1});try{if(Yg(m))await n(m).unwrap();else{const g=await r(m).unwrap();t(ob(g.workflow.id))}t(rb()),c.update(d.current,{title:e("workflows.workflowSaved"),status:"success",duration:1e3,isClosable:!0})}catch{!c.isActive(`auth-error-toast-${Ll.endpoints.createWorkflow.name}`)&&!c.isActive(`auth-error-toast-${Ll.endpoints.updateWorkflow.name}`)?c.update(d.current,{title:e("workflows.problemSavingWorkflow"),status:"error",duration:1e3,isClosable:!0}):c.close(d.current)}}},[n,t,c,e,r]),isLoading:o.isLoading||l.isLoading,isError:o.isError||l.isError}},MV=()=>{const{t:e}=R(),t=j(l=>l.workflow.isTouched),{onOpen:n}=nm(),{saveWorkflow:o}=Fw(),r=u.useCallback(async()=>{const l=Fl.get();l&&(Yg(l)?o():n())},[n,o]);return s.jsx(je,{tooltip:e("workflows.saveWorkflow"),"aria-label":e("workflows.saveWorkflow"),icon:s.jsx(yc,{}),isDisabled:!t,onClick:r,pointerEvents:"auto"})},_V=u.memo(MV),AV=ft(ot,gn,(e,t)=>e.nodes.filter(Pt).some(n=>{const o=t.templates[n.data.type];return o?wy(n,o):!1})),PV=()=>j(AV),EV=()=>{const e=J(),{t}=R(),n=PV(),o=u.useCallback(()=>{e(V8())},[e]);return n?s.jsx(je,{tooltip:t("nodes.updateAllNodes"),"aria-label":t("nodes.updateAllNodes"),icon:s.jsx(Y0,{}),onClick:o,pointerEvents:"auto"}):null},DV=u.memo(EV),LV=()=>{const e=j(t=>t.workflow.name);return s.jsx(pe,{m:2,fontSize:"lg",userSelect:"none",noOfLines:1,wordBreak:"break-all",fontWeight:"semibold",opacity:.8,children:e})},TV=u.memo(LV),zw=u.createContext(null);var RV=/d{1,4}|D{3,4}|m{1,4}|yy(?:yy)?|([HhMsTt])\1?|W{1,2}|[LlopSZN]|"[^"]*"|'[^']*'/g,BV=/\b(?:[A-Z]{1,3}[A-Z][TC])(?:[-+]\d{4})?|((?:Australian )?(?:Pacific|Mountain|Central|Eastern|Atlantic) (?:Standard|Daylight|Prevailing) Time)\b/g,OV=/[^-+\dA-Z]/g;function sd(e,t,n,o){if(arguments.length===1&&typeof e=="string"&&!/\d/.test(e)&&(t=e,e=void 0),e=e||e===0?e:new Date,e instanceof Date||(e=new Date(e)),isNaN(e))throw TypeError("Invalid date");t=String(xa[t]||t||xa.default);var r=t.slice(0,4);(r==="UTC:"||r==="GMT:")&&(t=t.slice(4),n=!0,r==="GMT:"&&(o=!0));var l=function(){return n?"getUTC":"get"},c=function(){return e[l()+"Date"]()},d=function(){return e[l()+"Day"]()},f=function(){return e[l()+"Month"]()},m=function(){return e[l()+"FullYear"]()},g=function(){return e[l()+"Hours"]()},p=function(){return e[l()+"Minutes"]()},x=function(){return e[l()+"Seconds"]()},y=function(){return e[l()+"Milliseconds"]()},S=function(){return n?0:e.getTimezoneOffset()},b=function(){return NV(e)},I=function(){return FV(e)},M={d:function(){return c()},dd:function(){return ds(c())},ddd:function(){return Yn.dayNames[d()]},DDD:function(){return gC({y:m(),m:f(),d:c(),_:l(),dayName:Yn.dayNames[d()],short:!0})},dddd:function(){return Yn.dayNames[d()+7]},DDDD:function(){return gC({y:m(),m:f(),d:c(),_:l(),dayName:Yn.dayNames[d()+7]})},m:function(){return f()+1},mm:function(){return ds(f()+1)},mmm:function(){return Yn.monthNames[f()]},mmmm:function(){return Yn.monthNames[f()+12]},yy:function(){return String(m()).slice(2)},yyyy:function(){return ds(m(),4)},h:function(){return g()%12||12},hh:function(){return ds(g()%12||12)},H:function(){return g()},HH:function(){return ds(g())},M:function(){return p()},MM:function(){return ds(p())},s:function(){return x()},ss:function(){return ds(x())},l:function(){return ds(y(),3)},L:function(){return ds(Math.floor(y()/10))},t:function(){return g()<12?Yn.timeNames[0]:Yn.timeNames[1]},tt:function(){return g()<12?Yn.timeNames[2]:Yn.timeNames[3]},T:function(){return g()<12?Yn.timeNames[4]:Yn.timeNames[5]},TT:function(){return g()<12?Yn.timeNames[6]:Yn.timeNames[7]},Z:function(){return o?"GMT":n?"UTC":zV(e)},o:function(){return(S()>0?"-":"+")+ds(Math.floor(Math.abs(S())/60)*100+Math.abs(S())%60,4)},p:function(){return(S()>0?"-":"+")+ds(Math.floor(Math.abs(S())/60),2)+":"+ds(Math.floor(Math.abs(S())%60),2)},S:function(){return["th","st","nd","rd"][c()%10>3?0:(c()%100-c()%10!=10)*c()%10]},W:function(){return b()},WW:function(){return ds(b())},N:function(){return I()}};return t.replace(RV,function(w){return w in M?M[w]():w.slice(1,w.length-1)})}var xa={default:"ddd mmm dd yyyy HH:MM:ss",shortDate:"m/d/yy",paddedShortDate:"mm/dd/yyyy",mediumDate:"mmm d, yyyy",longDate:"mmmm d, yyyy",fullDate:"dddd, mmmm d, yyyy",shortTime:"h:MM TT",mediumTime:"h:MM:ss TT",longTime:"h:MM:ss TT Z",isoDate:"yyyy-mm-dd",isoTime:"HH:MM:ss",isoDateTime:"yyyy-mm-dd'T'HH:MM:sso",isoUtcDateTime:"UTC:yyyy-mm-dd'T'HH:MM:ss'Z'",expiresHeaderFormat:"ddd, dd mmm yyyy HH:MM:ss Z"},Yn={dayNames:["Sun","Mon","Tue","Wed","Thu","Fri","Sat","Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],monthNames:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec","January","February","March","April","May","June","July","August","September","October","November","December"],timeNames:["a","p","am","pm","A","P","AM","PM"]},ds=function(t){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:2;return String(t).padStart(n,"0")},gC=function(t){var n=t.y,o=t.m,r=t.d,l=t._,c=t.dayName,d=t.short,f=d===void 0?!1:d,m=new Date,g=new Date;g.setDate(g[l+"Date"]()-1);var p=new Date;p.setDate(p[l+"Date"]()+1);var x=function(){return m[l+"Date"]()},y=function(){return m[l+"Month"]()},S=function(){return m[l+"FullYear"]()},b=function(){return g[l+"Date"]()},I=function(){return g[l+"Month"]()},M=function(){return g[l+"FullYear"]()},w=function(){return p[l+"Date"]()},_=function(){return p[l+"Month"]()},T=function(){return p[l+"FullYear"]()};return S()===n&&y()===o&&x()===r?f?"Tdy":"Today":M()===n&&I()===o&&b()===r?f?"Ysd":"Yesterday":T()===n&&_()===o&&w()===r?f?"Tmw":"Tomorrow":c},NV=function(t){var n=new Date(t.getFullYear(),t.getMonth(),t.getDate());n.setDate(n.getDate()-(n.getDay()+6)%7+3);var o=new Date(n.getFullYear(),0,4);o.setDate(o.getDate()-(o.getDay()+6)%7+3);var r=n.getTimezoneOffset()-o.getTimezoneOffset();n.setHours(n.getHours()-r);var l=(n-o)/(864e5*7);return 1+Math.floor(l)},FV=function(t){var n=t.getDay();return n===0&&(n=7),n},zV=function(t){return(String(t).match(BV)||[""]).pop().replace(OV,"").replace(/GMT\+0000/g,"UTC")};const Hw=()=>{const e=u.useContext(zw);if(!e)throw new Error("useWorkflowLibraryContext must be used within a WorkflowLibraryContext.Provider");return e},HV=({onSuccess:e,onError:t})=>{const n=ao(),o=Oa(),{t:r}=R(),[l,c]=kV();return{deleteWorkflow:u.useCallback(async f=>{try{await l(f).unwrap(),n({title:r("toast.workflowDeleted")}),e&&e()}catch{o.isActive(`auth-error-toast-${Ll.endpoints.deleteWorkflow.name}`)||n({title:r("toast.problemDeletingWorkflow"),status:"error"}),t&&t()}},[l,n,r,e,t,o]),deleteWorkflowResult:c}},$V=({onSuccess:e,onError:t})=>{const n=J(),o=ao(),r=Oa(),{t:l}=R(),[c,d]=SV();return{getAndLoadWorkflow:u.useCallback(async m=>{try{const g=await c(m).unwrap();n(M0({workflow:g.workflow,asCopy:!1})),e&&e()}catch{r.isActive(`auth-error-toast-${Ll.endpoints.getWorkflow.name}`)||o({title:l("toast.problemRetrievingWorkflow"),status:"error"}),t&&t()}},[c,n,e,o,l,t,r]),getAndLoadWorkflowResult:d}},VV=({workflowDTO:e})=>{const{t}=R(),n=j(p=>p.workflow.id),{onClose:o}=Hw(),{deleteWorkflow:r,deleteWorkflowResult:l}=HV({}),{getAndLoadWorkflow:c,getAndLoadWorkflowResult:d}=$V({onSuccess:o}),f=u.useCallback(()=>{r(e.workflow_id)},[r,e.workflow_id]),m=u.useCallback(()=>{c(e.workflow_id)},[c,e.workflow_id]),g=u.useMemo(()=>n===e.workflow_id,[n,e.workflow_id]);return s.jsx(L,{w:"full",p:2,borderRadius:"base",_hover:{bg:"base.750"},children:s.jsxs(L,{w:"full",alignItems:"center",gap:2,h:12,children:[s.jsxs(L,{flexDir:"column",flexGrow:1,h:"full",children:[s.jsxs(L,{alignItems:"center",w:"full",h:"50%",children:[s.jsx(ns,{size:"sm",noOfLines:1,variant:g?"invokeBlue":void 0,children:e.name||t("workflows.unnamedWorkflow")}),s.jsx(Cs,{}),e.category!=="default"&&s.jsxs(pe,{fontSize:"sm",variant:"subtext",flexShrink:0,noOfLines:1,children:[t("common.updated"),": ",sd(e.updated_at,xa.shortDate)," ",sd(e.updated_at,xa.shortTime)]})]}),s.jsxs(L,{alignItems:"center",w:"full",h:"50%",children:[e.description?s.jsx(pe,{fontSize:"sm",noOfLines:1,children:e.description}):s.jsx(pe,{fontSize:"sm",variant:"subtext",fontStyle:"italic",noOfLines:1,children:t("workflows.noDescription")}),s.jsx(Cs,{}),e.category!=="default"&&s.jsxs(pe,{fontSize:"sm",variant:"subtext",flexShrink:0,noOfLines:1,children:[t("common.created"),": ",sd(e.created_at,xa.shortDate)," ",sd(e.created_at,xa.shortTime)]})]})]}),s.jsx(Ge,{flexShrink:0,isDisabled:g,onClick:m,isLoading:d.isLoading,"aria-label":t("workflows.openWorkflow"),children:t("common.load")}),e.category!=="default"&&s.jsx(Ge,{flexShrink:0,colorScheme:"error",isDisabled:g,onClick:f,isLoading:l.isLoading,"aria-label":t("workflows.deleteWorkflow"),children:t("common.delete")})]})},e.workflow_id)},WV=u.memo(VV),gl=7,UV=({page:e,setPage:t,data:n})=>{const{t:o}=R(),r=u.useCallback(()=>{t(d=>Math.max(d-1,0))},[t]),l=u.useCallback(()=>{t(d=>Math.min(d+1,n.pages-1))},[n.pages,t]),c=u.useMemo(()=>{const d=[];let f=n.pages>gl?Math.max(0,e-Math.floor(gl/2)):0;const m=n.pages>gl?Math.min(n.pages,f+gl):n.pages;m-f<gl&&n.pages>gl&&(f=m-gl);for(let g=f;g<m;g++)d.push({page:g,onClick:()=>t(g)});return d},[n.pages,e,t]);return s.jsxs(wt,{children:[s.jsx(je,{variant:"ghost",onClick:r,isDisabled:e===0,"aria-label":o("common.prevPage"),icon:s.jsx(Zb,{})}),c.map(d=>s.jsx(Ge,{w:10,isDisabled:n.pages===1,onClick:d.page===e?void 0:d.onClick,variant:d.page===e?"solid":"ghost",transitionDuration:"0s",children:d.page+1},d.page)),s.jsx(je,{variant:"ghost",onClick:l,isDisabled:e===n.pages-1,"aria-label":o("common.nextPage"),icon:s.jsx(qb,{})})]})},GV=u.memo(UV),xC=10,ZV=mc.enum(["opened_at","created_at","updated_at","name"]),qV=e=>ZV.safeParse(e).success,vC=[{value:"opened_at",label:"Opened"},{value:"created_at",label:"Created"},{value:"updated_at",label:"Updated"},{value:"name",label:"Name"}],QV=mc.enum(["ASC","DESC"]),KV=e=>QV.safeParse(e).success,CC=[{value:"ASC",label:"Ascending"},{value:"DESC",label:"Descending"}],YV=()=>{var N;const{t:e}=R(),t=gt(lb),[n,o]=u.useState("user"),[r,l]=u.useState(0),[c,d]=u.useState(""),f=gt(W8),m=u.useMemo(()=>f?vC.filter(z=>z.value!=="opened_at"):vC,[f]),[g,p]=u.useState((N=m[0])==null?void 0:N.value),[x,y]=u.useState("ASC"),[S]=Eg(c,500),b=u.useMemo(()=>n!=="default"?{page:r,per_page:xC,order_by:g,direction:x,category:n,query:S}:{page:r,per_page:xC,order_by:"name",direction:"ASC",category:n,query:S},[n,S,x,g,r]),{data:I,isLoading:M,isError:w,isFetching:_}=IV(b),T=u.useCallback(z=>{!qV(z==null?void 0:z.value)||z.value===g||(p(z.value),l(0))},[g]),D=u.useMemo(()=>m.find(z=>z.value===g),[g,m]),A=u.useCallback(z=>{!KV(z==null?void 0:z.value)||z.value===x||(y(z.value),l(0))},[x]),F=u.useMemo(()=>CC.find(z=>z.value===x),[x]),Q=u.useCallback(()=>{d(""),l(0)},[]),q=u.useCallback(z=>{z.key==="Escape"&&(Q(),z.preventDefault(),l(0))},[Q]),G=u.useCallback(z=>{d(z.target.value),l(0)},[]),Z=u.useCallback(z=>{o(z),l(0)},[]);return s.jsxs(s.Fragment,{children:[s.jsxs(L,{gap:4,alignItems:"center",h:16,flexShrink:0,flexGrow:0,justifyContent:"space-between",children:[s.jsx(wt,{alignSelf:"flex-end",children:t.map(z=>s.jsx(Ge,{variant:n===z?void 0:"ghost",onClick:Z.bind(null,z),isChecked:n===z,children:e(`workflows.${z}Workflows`)},z))}),n!=="default"&&s.jsxs(s.Fragment,{children:[s.jsxs(U,{isDisabled:_,sx:{flexDir:"column",alignItems:"flex-start",gap:1,maxW:56},children:[s.jsx(Y,{children:e("common.orderBy")}),s.jsx(Xe,{value:D,options:m,onChange:T})]}),s.jsxs(U,{isDisabled:_,sx:{flexDir:"column",alignItems:"flex-start",gap:1,maxW:56},children:[s.jsx(Y,{children:e("common.direction")}),s.jsx(Xe,{value:F,options:CC,onChange:A})]})]}),s.jsxs(y0,{w:"20rem",alignSelf:"flex-end",children:[s.jsx(dt,{placeholder:e("workflows.searchWorkflows"),value:c,onKeyDown:q,onChange:G,"data-testid":"workflow-search-input",minW:64}),c.trim().length&&s.jsx(b0,{h:"full",pe:2,children:s.jsx(je,{onClick:Q,size:"sm",variant:"link","aria-label":e("workflows.clearWorkflowSearchFilter"),icon:s.jsx(oo,{})})})]})]}),s.jsx(Sn,{}),M?s.jsx(eg,{label:e("workflows.loading")}):!I||w?s.jsx(Yt,{label:e("workflows.problemLoading")}):I.items.length?s.jsx(io,{children:s.jsx(L,{w:"full",h:"full",flexDir:"column",children:I.items.map(z=>s.jsx(WV,{workflowDTO:z},z.workflow_id))})}):s.jsx(Yt,{label:e("workflows.noWorkflows")}),s.jsx(Sn,{}),I&&s.jsx(L,{w:"full",justifyContent:"space-around",children:s.jsx(GV,{data:I,page:r,setPage:l})})]})},XV=u.memo(YV),JV=e=>s.jsx(L,{w:"full",h:"full",flexDir:"column",layerStyle:"second",py:2,px:4,gap:2,borderRadius:"base",children:e.children}),eW=u.memo(JV),tW=()=>s.jsx(eW,{children:s.jsx(XV,{})}),nW=u.memo(tW),sW=()=>{const{t:e}=R(),{isOpen:t,onClose:n}=Hw();return s.jsxs(Al,{isOpen:t,onClose:n,isCentered:!0,children:[s.jsx(tr,{}),s.jsxs(Pl,{w:"80%",h:"80%",minW:"unset",minH:"unset",maxW:"1200px",maxH:"664px",children:[s.jsx(nr,{children:e("workflows.workflowLibrary")}),s.jsx(Ha,{}),s.jsx(sr,{children:s.jsx(nW,{})}),s.jsx(El,{})]})]})},oW=u.memo(sW),rW=()=>{const{t:e}=R(),t=an();return s.jsxs(zw.Provider,{value:t,children:[s.jsx(je,{"aria-label":e("workflows.workflowLibrary"),tooltip:e("workflows.workflowLibrary"),icon:s.jsx(g7,{}),onClick:t.onOpen,pointerEvents:"auto"}),s.jsx(oW,{})]})},lW=u.memo(rW),aW=()=>{const e=Fl.get();if(!e)return;const t=new Blob([JSON.stringify(e,null,2)]),n=document.createElement("a");n.href=URL.createObjectURL(t),n.download=`${e.name||"My Workflow"}.json`,document.body.appendChild(n),n.click(),n.remove()},iW=()=>aW,cW=()=>{const{t:e}=R(),t=iW();return s.jsx(it,{as:"button",icon:s.jsx(Cc,{}),onClick:t,children:e("workflows.downloadWorkflow")})},uW=u.memo(cW),dW=()=>{const{t:e}=R(),t=J(),{isOpen:n,onOpen:o,onClose:r}=an(),l=j(f=>f.workflow.isTouched),c=u.useCallback(()=>{t(sb()),t(Qe(_t({title:e("workflows.newWorkflowCreated"),status:"success"}))),r()},[t,r,e]),d=u.useCallback(()=>{if(!l){c();return}o()},[c,l,o]);return s.jsxs(s.Fragment,{children:[s.jsx(it,{as:"button",icon:s.jsx(If,{}),onClick:d,children:e("nodes.newWorkflow")}),s.jsx(Gr,{isOpen:n,onClose:r,title:e("nodes.newWorkflow"),acceptCallback:c,children:s.jsxs(L,{flexDir:"column",gap:2,children:[s.jsx(pe,{children:e("nodes.newWorkflowDesc")}),s.jsx(pe,{variant:"subtext",children:e("nodes.newWorkflowDesc2")})]})})]})},fW=u.memo(dW),mW=()=>{const{t:e}=R(),{onOpen:t}=nm();return s.jsx(it,{as:"button",icon:s.jsx(el,{}),onClick:t,children:e("workflows.saveWorkflowAs")})},hW=u.memo(mW),pW=()=>{const{t:e}=R(),{saveWorkflow:t}=Fw(),{onOpen:n}=nm(),o=j(l=>l.workflow.isTouched),r=u.useCallback(async()=>{const l=Fl.get();l&&(Yg(l)?t():n())},[n,t]);return s.jsx(it,{as:"button",isDisabled:!o,icon:s.jsx(yc,{}),onClick:r,children:e("workflows.saveWorkflow")})},gW=u.memo(pW),xW=()=>{const{t:e}=R(),t=J(),n=u.useCallback(()=>{t(U8())},[t]);return s.jsx(Ge,{leftIcon:s.jsx(G0,{}),tooltip:e("nodes.reloadNodeTemplates"),"aria-label":e("nodes.reloadNodeTemplates"),onClick:n,children:e("nodes.reloadNodeTemplates")})},vW=u.memo(xW),CW={flexGrow:1},yW=Fe(ot,e=>{const{shouldAnimateEdges:t,shouldValidateGraph:n,shouldSnapToGrid:o,shouldColorEdges:r,selectionMode:l}=e;return{shouldAnimateEdges:t,shouldValidateGraph:n,shouldSnapToGrid:o,shouldColorEdges:r,selectionModeIsChecked:l===G8.Full}}),bW=({children:e})=>{const{isOpen:t,onOpen:n,onClose:o}=an(),r=J(),{shouldAnimateEdges:l,shouldValidateGraph:c,shouldSnapToGrid:d,shouldColorEdges:f,selectionModeIsChecked:m}=j(yW),g=u.useCallback(I=>{r(Z8(I.target.checked))},[r]),p=u.useCallback(I=>{r(q8(I.target.checked))},[r]),x=u.useCallback(I=>{r(Q8(I.target.checked))},[r]),y=u.useCallback(I=>{r(K8(I.target.checked))},[r]),S=u.useCallback(I=>{r(Y8(I.target.checked))},[r]),{t:b}=R();return s.jsxs(s.Fragment,{children:[e({onOpen:n}),s.jsxs(Al,{isOpen:t,onClose:o,size:"2xl",isCentered:!0,children:[s.jsx(tr,{}),s.jsxs(Pl,{children:[s.jsx(nr,{children:b("nodes.workflowSettings")}),s.jsx(Ha,{}),s.jsx(sr,{children:s.jsxs(L,{flexDirection:"column",gap:4,py:4,children:[s.jsx(ns,{size:"sm",children:b("parameters.general")}),s.jsxs(wn,{orientation:"vertical",formLabelProps:CW,children:[s.jsxs(U,{children:[s.jsxs(L,{w:"full",children:[s.jsx(Y,{children:b("nodes.animatedEdges")}),s.jsx(kt,{onChange:p,isChecked:l})]}),s.jsx(ca,{children:b("nodes.animatedEdgesHelp")})]}),s.jsx(Sn,{}),s.jsxs(U,{children:[s.jsxs(L,{w:"full",children:[s.jsx(Y,{children:b("nodes.snapToGrid")}),s.jsx(kt,{isChecked:d,onChange:x})]}),s.jsx(ca,{children:b("nodes.snapToGridHelp")})]}),s.jsx(Sn,{}),s.jsxs(U,{children:[s.jsxs(L,{w:"full",children:[s.jsx(Y,{children:b("nodes.colorCodeEdges")}),s.jsx(kt,{isChecked:f,onChange:y})]}),s.jsx(ca,{children:b("nodes.colorCodeEdgesHelp")})]}),s.jsx(Sn,{}),s.jsxs(U,{children:[s.jsxs(L,{w:"full",children:[s.jsx(Y,{children:b("nodes.fullyContainNodes")}),s.jsx(kt,{isChecked:m,onChange:S})]}),s.jsx(ca,{children:b("nodes.fullyContainNodesHelp")})]}),s.jsx(Sn,{}),s.jsx(ns,{size:"sm",pt:4,children:b("common.advanced")}),s.jsxs(U,{children:[s.jsxs(L,{w:"full",children:[s.jsx(Y,{children:b("nodes.validateConnections")}),s.jsx(kt,{isChecked:c,onChange:g})]}),s.jsx(ca,{children:b("nodes.validateConnectionsHelp")})]}),s.jsx(Sn,{})]}),s.jsx(vW,{})]})})]})]})]})},jW=u.memo(bW),SW=()=>{const{t:e}=R();return s.jsx(jW,{children:({onOpen:t})=>s.jsx(it,{as:"button",icon:s.jsx(Hj,{}),onClick:t,children:e("nodes.workflowSettings")})})},kW=u.memo(SW),wW=({resetRef:e})=>{const t=J(),n=yb("nodes"),{t:o}=R();return u.useCallback(l=>{var d;if(!l)return;const c=new FileReader;c.onload=async()=>{const f=c.result;try{const m=JSON.parse(String(f));t(M0({workflow:m,asCopy:!0}))}catch{n.error(o("nodes.unableToLoadWorkflow")),t(Qe(_t({title:o("nodes.unableToLoadWorkflow"),status:"error"}))),c.abort()}},c.readAsText(l),(d=e.current)==null||d.call(e)},[t,n,e,o])},IW=()=>{const{t:e}=R(),t=u.useRef(null),n=wW({resetRef:t}),o=u.useCallback(c=>{c[0]&&n(c[0])},[n]),{getRootProps:r,getInputProps:l}=wf({accept:{"application/json":[".json"]},onDropAccepted:o,noDrag:!0,multiple:!1});return s.jsxs(it,{as:"button",icon:s.jsx(_f,{}),...r(),children:[e("workflows.uploadWorkflow"),s.jsx("input",{...l()})]})},MW=u.memo(IW),_W=()=>{const{t:e}=R(),{isOpen:t,onOpen:n,onClose:o}=an();return Sf(o),s.jsxs(yf,{isOpen:t,onOpen:n,onClose:o,children:[s.jsx(bf,{as:je,"aria-label":e("workflows.workflowEditorMenu"),icon:s.jsx(X0,{}),pointerEvents:"auto"}),s.jsxs(zr,{pointerEvents:"auto",children:[s.jsx(fW,{}),s.jsx(MW,{}),s.jsx(Er,{}),s.jsx(gW,{}),s.jsx(hW,{}),s.jsx(uW,{}),s.jsx(Er,{}),s.jsx(kW,{})]})]})},AW=u.memo(_W),PW=()=>s.jsxs(L,{gap:2,top:2,left:2,right:2,position:"absolute",alignItems:"flex-start",pointerEvents:"none",children:[s.jsxs(L,{flexDir:"column",gap:"2",children:[s.jsxs(L,{gap:"2",children:[s.jsx(vV,{}),s.jsx(lW,{})]}),s.jsx(DV,{})]}),s.jsx(Cs,{}),s.jsx(TV,{}),s.jsx(Cs,{}),s.jsx(yV,{}),s.jsx(_V,{}),s.jsx(AW,{})]}),EW=u.memo(PW),DW=()=>{const{t:e}=R(),t=J(),[n,o]=Nw(),r=Oa(),l=u.useRef();return{saveWorkflowAs:u.useCallback(async({name:d,category:f,onSuccess:m,onError:g})=>{const p=Fl.get();if(p){l.current=r({title:e("workflows.savingWorkflow"),status:"loading",duration:null,isClosable:!1});try{p.id=void 0,p.name=d,p.meta.category=f;const x=await n(p).unwrap();t(ob(x.workflow.id)),t(My(x.workflow.name)),t(X8(x.workflow.meta.category)),t(rb()),m&&m(),r.update(l.current,{title:e("workflows.workflowSaved"),status:"success",duration:1e3,isClosable:!0})}catch{g&&g(),r.isActive(`auth-error-toast-${Ll.endpoints.createWorkflow.name}`)?r.close(l.current):r.update(l.current,{title:e("workflows.problemSavingWorkflow"),status:"error",duration:1e3,isClosable:!0})}}},[r,n,t,e]),isLoading:o.isLoading,isError:o.isError}},LW=()=>{const{isOpen:e,onClose:t,workflowName:n,setWorkflowName:o,shouldSaveToProject:r,setShouldSaveToProject:l}=nm(),c=gt(lb),{saveWorkflowAs:d}=DW(),f=u.useRef(null),m=u.useRef(null),g=u.useCallback(S=>{o(S.target.value)},[o]),p=u.useCallback(S=>{l(S.target.checked)},[l]),x=u.useCallback(()=>{t()},[t]),y=u.useCallback(async()=>{await d({name:n,category:r?"project":"user",onSuccess:x,onError:x})},[n,d,r,x]);return s.jsx(ty,{isOpen:e,onClose:t,leastDestructiveRef:f,isCentered:!0,children:s.jsx(tr,{children:s.jsxs(ny,{children:[s.jsx(nr,{fontSize:"lg",fontWeight:"bold",children:Zo("workflows.saveWorkflowAs")}),s.jsx(sr,{children:s.jsxs(U,{alignItems:"flex-start",children:[s.jsx(Y,{mt:"2",children:Zo("workflows.workflowName")}),s.jsxs(L,{flexDir:"column",width:"full",gap:"2",children:[s.jsx(dt,{ref:m,value:n,onChange:g,placeholder:Zo("workflows.workflowName")}),c.includes("project")&&s.jsx(jn,{isChecked:r,onChange:p,children:s.jsx(Y,{children:Zo("workflows.saveWorkflowToProject")})})]})]})}),s.jsxs(El,{children:[s.jsx(Ge,{ref:f,onClick:x,children:Zo("common.cancel")}),s.jsx(Ge,{colorScheme:"invokeBlue",onClick:y,ml:3,isDisabled:!n||!n.length,children:Zo("common.saveAs")})]})]})})})};function TW(e){return Ie({tag:"svg",attr:{viewBox:"0 0 24 24"},child:[{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0z"},child:[]},{tag:"path",attr:{fill:"none",d:"M0 0h24v24H0V0z"},child:[]},{tag:"path",attr:{d:"m17 16-4-4V8.82C14.16 8.4 15 7.3 15 6c0-1.66-1.34-3-3-3S9 4.34 9 6c0 1.3.84 2.4 2 2.82V12l-4 4H3v5h5v-3.05l4-4.2 4 4.2V21h5v-5h-4z"},child:[]}]})(e)}const RW=e=>{const t=Or();return{...ab,id:t,type:"current_image",position:e,data:{id:t,type:"current_image",isOpen:!0,label:"Current Image"}}},BW=e=>{const t=Or();return{...ab,id:t,type:"notes",position:e,data:{id:t,isOpen:!0,label:"Notes",notes:"",type:"notes"}}},OW=()=>{const e=j(n=>n.nodeTemplates.templates),t=R0();return u.useCallback(n=>{var f;let o=window.innerWidth/2,r=window.innerHeight/2;const l=(f=document.querySelector("#workflow-editor"))==null?void 0:f.getBoundingClientRect();l&&(o=l.width/2-Mp/2+l.left,r=l.height/2-Mp/2+l.top);const c=t.screenToFlowPosition({x:o,y:r});if(n==="current_image")return RW(c);if(n==="notes")return BW(c);const d=e[n];return J8(c,d)},[e,t])},NW=ib(e=>new RegExp(e.trim().replace(/[-[\]{}()*+!<=:?./\\^$|#,]/g,"").split(" ").join(".*"),"gi")),FW=ib((e,t)=>{if(!t)return!0;const n=NW(t);return n.test(e.label)||n.test(e.data.description??"")||(e.data.tags??[]).some(o=>n.test(o))}),zW=()=>{const e=J(),t=OW(),n=ao(),{t:o}=R(),r=u.useRef(null),l=u.useRef(null),c=j(_=>_.nodes.connectionStartFieldType),d=j(_=>{var T;return(T=_.nodes.connectionStartParams)==null?void 0:T.handleType}),f=Fe(gn,_=>{const T=c?Hy(_.templates,A=>{const F=d==="source"?A.inputs:A.outputs;return eo(F,Q=>{const q=d==="source"?c:Q.type,G=d==="target"?c:Q.type;return B0(q,G)})}):ys(_.templates),D=ys(T,A=>({label:A.title,value:A.type,description:A.description,tags:A.tags}));return c===null&&(D.push({label:o("nodes.currentImage"),value:"current_image",description:o("nodes.currentImageDescription"),tags:["progress"]}),D.push({label:o("nodes.notes"),value:"notes",description:o("nodes.notesDescription"),tags:["notes"]})),D.sort((A,F)=>A.label.localeCompare(F.label)),{options:D}}),{options:m}=j(f),g=j(_=>_.nodes.isAddNodePopoverOpen),p=u.useCallback(_=>{const T=t(_);if(!T){const D=o("nodes.unknownNode",{nodeType:_});n({status:"error",title:D});return}e(e3(T))},[e,t,n,o]),x=u.useCallback(_=>{_&&(p(_.value),e(a2()))},[p,e]),y=u.useCallback(()=>{e(a2())},[e]),S=u.useCallback(()=>{e(nb())},[e]),b=u.useCallback(_=>{_.preventDefault(),S(),_0.flushSync(()=>{var T,D;(D=(T=r.current)==null?void 0:T.inputRef)==null||D.focus()})},[S]),I=u.useCallback(()=>{y()},[y]);Oe(["shift+a","space"],b),Oe(["escape"],I);const M=u.useCallback(_=>{_.key==="Escape"&&y()},[y]),w=u.useCallback(()=>o("nodes.noMatchingNodes"),[o]);return s.jsxs(Zr,{isOpen:g,onClose:y,placement:"bottom",openDelay:0,closeDelay:0,closeOnBlur:!0,returnFocusOnClose:!0,initialFocusRef:l,isLazy:!0,children:[s.jsx(Oy,{children:s.jsx(L,{position:"absolute",top:"15%",insetInlineStart:"50%",pointerEvents:"none"})}),s.jsx(qr,{p:0,top:-1,shadow:"dark-lg",borderColor:"invokeBlue.400",borderWidth:"2px",borderStyle:"solid",children:s.jsx(Qr,{w:"32rem",p:0,children:s.jsx(Xe,{menuIsOpen:g,selectRef:r,value:null,placeholder:o("nodes.nodeSearch"),options:m,noOptionsMessage:w,filterOption:FW,onChange:x,onMenuClose:y,onKeyDown:M,inputRef:l,closeMenuOnSelect:!1})})})]})},HW=u.memo(zW),$W=()=>{const e=R0(),t=j(o=>o.nodes.shouldValidateGraph);return u.useCallback(({source:o,sourceHandle:r,target:l,targetHandle:c})=>{const d=e.getEdges(),f=e.getNodes();if(!(o&&r&&l&&c))return!1;const m=e.getNode(o),g=e.getNode(l);if(!(m&&g&&m.data&&g.data))return!1;const p=m.data.outputs[r],x=g.data.inputs[c];return!p||!x||o===l?!1:t?d.find(y=>{y.target===l&&y.targetHandle===c&&y.source===o&&y.sourceHandle})||d.find(y=>y.target===l&&y.targetHandle===c)&&x.type.name!=="CollectionItemField"||!B0(p.type,x.type)?!1:cb(o,l,f,d):!0},[e,t])},Ma=e=>`var(--invoke-colors-${e.split(".").join("-")})`,Xg=e=>{if(!e)return Ma("base.500");const t=t3[e.name];return Ma(t||"base.500")},VW=ft(ot,e=>e.shouldColorEdges?Xg(e.connectionStartFieldType):Ma("base.500")),WW=ft(ot,e=>e.shouldAnimateEdges?"react-flow__custom_connection-path animated":"react-flow__custom_connection-path"),UW={opacity:.8},GW=({fromX:e,fromY:t,fromPosition:n,toX:o,toY:r,toPosition:l})=>{const c=j(VW),d=j(WW),f={sourceX:e,sourceY:t,sourcePosition:n,targetX:o,targetY:r,targetPosition:l},[m]=O0(f);return s.jsx("g",{children:s.jsx("path",{fill:"none",stroke:c,strokeWidth:2,className:d,d:m,style:UW})})},ZW=u.memo(GW),$w=()=>{const[e,t,n,o,r,l,c,d,f,m,g,p,x,y,S,b,I,M,w,_,T,D,A,F,Q,q,G,Z,N,z,$,se,he,ke,Ce,ge,De,Se,oe,re,de,P,B,H,V,le,fe,ue,xe,W,Me,ye,Pe,Ve,Ye,O,ne,ce,_e,be,K,ve,Ee,Ze,lt,St,Ot,Xt,Jt,xn,on,en,Tt,is,cn,_s]=kf("colors",["base.50","base.100","base.150","base.200","base.250","base.300","base.350","base.400","base.450","base.500","base.550","base.600","base.650","base.700","base.750","base.800","base.850","base.900","base.950","accent.50","accent.100","accent.150","accent.200","accent.250","accent.300","accent.350","accent.400","accent.450","accent.500","accent.550","accent.600","accent.650","accent.700","accent.750","accent.800","accent.850","accent.900","accent.950","baseAlpha.50","baseAlpha.100","baseAlpha.150","baseAlpha.200","baseAlpha.250","baseAlpha.300","baseAlpha.350","baseAlpha.400","baseAlpha.450","baseAlpha.500","baseAlpha.550","baseAlpha.600","baseAlpha.650","baseAlpha.700","baseAlpha.750","baseAlpha.800","baseAlpha.850","baseAlpha.900","baseAlpha.950","accentAlpha.50","accentAlpha.100","accentAlpha.150","accentAlpha.200","accentAlpha.250","accentAlpha.300","accentAlpha.350","accentAlpha.400","accentAlpha.450","accentAlpha.500","accentAlpha.550","accentAlpha.600","accentAlpha.650","accentAlpha.700","accentAlpha.750","accentAlpha.800","accentAlpha.850","accentAlpha.900","accentAlpha.950"]);return{base50:e,base100:t,base150:n,base200:o,base250:r,base300:l,base350:c,base400:d,base450:f,base500:m,base550:g,base600:p,base650:x,base700:y,base750:S,base800:b,base850:I,base900:M,base950:w,accent50:_,accent100:T,accent150:D,accent200:A,accent250:F,accent300:Q,accent350:q,accent400:G,accent450:Z,accent500:N,accent550:z,accent600:$,accent650:se,accent700:he,accent750:ke,accent800:Ce,accent850:ge,accent900:De,accent950:Se,baseAlpha50:oe,baseAlpha100:re,baseAlpha150:de,baseAlpha200:P,baseAlpha250:B,baseAlpha300:H,baseAlpha350:V,baseAlpha400:le,baseAlpha450:fe,baseAlpha500:ue,baseAlpha550:xe,baseAlpha600:W,baseAlpha650:Me,baseAlpha700:ye,baseAlpha750:Pe,baseAlpha800:Ve,baseAlpha850:Ye,baseAlpha900:O,baseAlpha950:ne,accentAlpha50:ce,accentAlpha100:_e,accentAlpha150:be,accentAlpha200:K,accentAlpha250:ve,accentAlpha300:Ee,accentAlpha350:Ze,accentAlpha400:lt,accentAlpha450:St,accentAlpha500:Ot,accentAlpha550:Xt,accentAlpha600:Jt,accentAlpha650:xn,accentAlpha700:on,accentAlpha750:en,accentAlpha800:Tt,accentAlpha850:is,accentAlpha900:cn,accentAlpha950:_s}},Vw=(e,t,n,o,r)=>Fe(ot,l=>{var x,y;const c=l.nodes.find(S=>S.id===e),d=l.nodes.find(S=>S.id===n),f=Pt(c)&&Pt(d),m=(c==null?void 0:c.selected)||(d==null?void 0:d.selected)||r,g=f?(y=(x=c==null?void 0:c.data)==null?void 0:x.outputs[t||""])==null?void 0:y.type:void 0,p=g&&l.shouldColorEdges?Xg(g):Ma("base.500");return{isSelected:m,shouldAnimate:l.shouldAnimateEdges&&m,stroke:p}}),qW=({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:r,targetPosition:l,markerEnd:c,data:d,selected:f,source:m,target:g,sourceHandleId:p,targetHandleId:x})=>{const y=u.useMemo(()=>Vw(m,p,g,x,f),[f,m,p,g,x]),{isSelected:S,shouldAnimate:b}=j(y),[I,M,w]=O0({sourceX:e,sourceY:t,sourcePosition:r,targetX:n,targetY:o,targetPosition:l}),{base500:_}=$w(),T=u.useMemo(()=>({strokeWidth:S?3:2,stroke:_,opacity:S?.8:.5,animation:b?"dashdraw 0.5s linear infinite":void 0,strokeDasharray:b?5:"none"}),[_,S,b]);return s.jsxs(s.Fragment,{children:[s.jsx(ub,{path:I,markerEnd:c,style:T}),(d==null?void 0:d.count)&&d.count>1&&s.jsx(n3,{children:s.jsx(L,{position:"absolute",transform:`translate(-50%, -50%) translate(${M}px,${w}px)`,className:"nodrag nopan",children:s.jsx(Yr,{variant:"solid",bg:"base.500",opacity:S?.8:.5,boxShadow:"base",children:d.count})})})]})},QW=u.memo(qW),KW=({sourceX:e,sourceY:t,targetX:n,targetY:o,sourcePosition:r,targetPosition:l,markerEnd:c,selected:d,source:f,target:m,sourceHandleId:g,targetHandleId:p})=>{const x=u.useMemo(()=>Vw(f,g,m,p,d),[f,g,m,p,d]),{isSelected:y,shouldAnimate:S,stroke:b}=j(x),[I]=O0({sourceX:e,sourceY:t,sourcePosition:r,targetX:n,targetY:o,targetPosition:l}),M=u.useMemo(()=>({strokeWidth:y?3:2,stroke:b,opacity:y?.8:.5,animation:S?"dashdraw 0.5s linear infinite":void 0,strokeDasharray:S?5:"none"}),[y,S,b]);return s.jsx(ub,{path:I,markerEnd:c,style:M})},YW=u.memo(KW),XW=e=>{const{nodeId:t,width:n,children:o,selected:r}=e,{isMouseOverNode:l,handleMouseOut:c,handleMouseOver:d}=dk(t),f=u.useMemo(()=>ft(ot,M=>{var w;return((w=M.nodeExecutionStates[t])==null?void 0:w.status)===Ko.enum.IN_PROGRESS}),[t]),m=j(f),[g,p,x]=kf("shadows",["nodeInProgress","shadows.xl","shadows.base"]),y=J(),S=j(M=>M.nodes.nodeOpacity),{onCloseGlobal:b}=Sf(),I=u.useCallback(M=>{!M.ctrlKey&&!M.altKey&&!M.metaKey&&!M.shiftKey&&y(s3(t)),b()},[y,b,t]);return s.jsxs(We,{onClick:I,onMouseEnter:d,onMouseLeave:c,className:Va,h:"full",position:"relative",borderRadius:"base",w:n||Mp,transitionProperty:"common",transitionDuration:"0.1s",cursor:"grab",opacity:S,children:[s.jsx(We,{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,borderRadius:"base",pointerEvents:"none",shadow:`${p}, ${x}, ${x}`,zIndex:-1}),s.jsx(We,{position:"absolute",top:0,insetInlineEnd:0,bottom:0,insetInlineStart:0,borderRadius:"md",pointerEvents:"none",transitionProperty:"common",transitionDuration:"0.1s",opacity:.7,shadow:m?g:void 0,zIndex:-1}),o,s.jsx(uk,{isSelected:r,isHovered:l})]})},sm=u.memo(XW),JW=Fe(Na,uc,(e,t)=>{var o;return{imageDTO:t.selection[t.selection.length-1],progressImage:(o=e.denoiseProgress)==null?void 0:o.progress_image}}),eU=e=>{const{progressImage:t,imageDTO:n}=j(JW);return t?s.jsx(cp,{nodeProps:e,children:s.jsx(ur,{src:t.dataURL,w:"full",h:"full",objectFit:"contain",borderRadius:"base"})}):n?s.jsx(cp,{nodeProps:e,children:s.jsx(Wr,{imageDTO:n,isDragDisabled:!0,useThumbailFallback:!0})}):s.jsx(cp,{nodeProps:e,children:s.jsx(Yt,{})})},tU=u.memo(eU),cp=e=>{const[t,n]=u.useState(!1),o=u.useCallback(()=>{n(!0)},[]),r=u.useCallback(()=>{n(!1)},[]),{t:l}=R();return s.jsx(sm,{nodeId:e.nodeProps.id,selected:e.nodeProps.selected,width:384,children:s.jsxs(L,{onMouseEnter:o,onMouseLeave:r,className:Va,position:"relative",flexDirection:"column",children:[s.jsx(L,{layerStyle:"nodeHeader",borderTopRadius:"base",alignItems:"center",justifyContent:"center",h:8,children:s.jsx(pe,{fontSize:"sm",fontWeight:"semibold",color:"base.200",children:l("nodes.currentImage")})}),s.jsxs(L,{layerStyle:"nodeBody",w:"full",h:"full",borderBottomRadius:"base",p:2,children:[e.children,t&&s.jsx(_l.div,{initial:nU,animate:sU,exit:oU,style:rU,children:s.jsx(mw,{})},"nextPrevButtons")]})]})})},nU={opacity:0},sU={opacity:1,transition:{duration:.1}},oU={opacity:0,transition:{duration:.1}},rU={position:"absolute",top:40,left:-2,right:-2,bottom:0,pointerEvents:"none"},Jg=e=>{const t=e.filter(r=>!r.ui_hidden),n=t.filter(r=>!zn(r.ui_order)).sort((r,l)=>(r.ui_order??0)-(l.ui_order??0)),o=t.filter(r=>zn(r.ui_order));return n.concat(o).map(r=>r.name).filter(r=>r!=="is_intermediate")},lU=e=>{const t=u.useMemo(()=>Fe(ot,gn,(o,r)=>{const l=o.nodes.find(f=>f.id===e);if(!Pt(l))return[];const c=r.templates[l.data.type];if(!c)return[];const d=ys(c.inputs).filter(f=>(["any","direct"].includes(f.input)||f.type.isCollectionOrScalar)&&i0(db).includes(f.type.name));return Jg(d)}),[e]);return j(t)},aU=e=>{const t=u.useMemo(()=>Fe(ot,gn,(o,r)=>{const l=o.nodes.find(f=>f.id===e);if(!Pt(l))return[];const c=r.templates[l.data.type];if(!c)return[];const d=ys(c.inputs).filter(f=>f.input==="connection"&&!f.type.isCollectionOrScalar||!i0(db).includes(f.type.name));return Jg(d)}),[e]);return j(t)},iU=e=>{const t=u.useMemo(()=>Fe(ot,gn,(o,r)=>{const l=o.nodes.find(d=>d.id===e);if(!Pt(l))return[];const c=r.templates[l.data.type];return c?Jg(ys(c.outputs)):[]}),[e]);return j(t)},e1=e=>{const t=u.useMemo(()=>Fe(ot,o=>{const r=o.nodes.find(l=>l.id===e);return Pt(r)?eo(r.data.outputs,l=>l.type.name==="ImageField"&&r.data.type!=="image"):!1}),[e]);return j(t)},cU=e=>{const t=e1(e),n=Kt("invocationCache").isFeatureEnabled;return u.useMemo(()=>t||n,[t,n])},uU=(e,t,n,o)=>ft(ot,r=>{if(!o)return nn.t("nodes.noFieldType");const{connectionStartFieldType:l,connectionStartParams:c,nodes:d,edges:f}=r;if(!c||!l)return nn.t("nodes.noConnectionInProgress");const{handleType:m,nodeId:g,handleId:p}=c;if(!m||!g||!p)return nn.t("nodes.noConnectionData");const x=n==="target"?o:l,y=n==="source"?o:l;if(e===g)return nn.t("nodes.cannotConnectToSelf");if(n===m)return n==="source"?nn.t("nodes.cannotConnectOutputToOutput"):nn.t("nodes.cannotConnectInputToInput");const S=n==="target"?e:g,b=n==="target"?t:p,I=n==="source"?e:g,M=n==="source"?t:p;if(f.find(_=>{_.target===S&&_.targetHandle===b&&_.source===I&&_.sourceHandle}))return nn.t("nodes.cannotDuplicateConnection");if(f.find(_=>_.target===S&&_.targetHandle===b)&&x.name!=="CollectionItemField")return nn.t("nodes.inputMayOnlyHaveOneConnection");if(!B0(y,x))return nn.t("nodes.fieldTypesMustMatch");if(!cb(m==="source"?g:e,m==="source"?e:g,d,f))return nn.t("nodes.connectionWouldCreateCycle")}),dU=(e,t,n)=>{const o=u.useMemo(()=>Fe(ot,l=>{const c=l.nodes.find(f=>f.id===e);if(!Pt(c))return;const d=c.data[E0[n]][t];return d==null?void 0:d.type}),[t,n,e]);return j(o)},fU=ft(ot,e=>e.connectionStartFieldType!==null&&e.connectionStartParams!==null),Ww=({nodeId:e,fieldName:t,kind:n})=>{const o=dU(e,t,n),r=u.useMemo(()=>ft(ot,x=>!!x.edges.filter(y=>(n==="input"?y.target:y.source)===e&&(n==="input"?y.targetHandle:y.sourceHandle)===t).length),[t,n,e]),l=u.useMemo(()=>uU(e,t,n==="input"?"target":"source",o),[e,t,n,o]),c=u.useMemo(()=>ft(ot,x=>{var y,S,b;return((y=x.connectionStartParams)==null?void 0:y.nodeId)===e&&((S=x.connectionStartParams)==null?void 0:S.handleId)===t&&((b=x.connectionStartParams)==null?void 0:b.handleType)==={input:"target",output:"source"}[n]}),[t,n,e]),d=j(r),f=j(fU),m=j(c),g=j(l),p=u.useMemo(()=>!!(f&&g&&!m),[g,f,m]);return{isConnected:d,isConnectionInProgress:f,isConnectionStartField:m,connectionError:g,shouldDim:p}},mU=(e,t)=>{const n=u.useMemo(()=>Fe(ot,r=>{var c;const l=r.nodes.find(d=>d.id===e);if(Pt(l))return((c=l==null?void 0:l.data.inputs[t])==null?void 0:c.value)!==void 0}),[t,e]);return j(n)},hU=(e,t)=>{const n=u.useMemo(()=>Fe(ot,r=>{const l=r.nodes.find(c=>c.id===e);if(Pt(l))return l.data.inputs[t]}),[t,e]);return j(n)},pU=(e,t)=>{const n=u.useMemo(()=>Fe(ot,gn,(r,l)=>{const c=r.nodes.find(f=>f.id===e);if(!Pt(c))return;const d=l.templates[(c==null?void 0:c.data.type)??""];return d==null?void 0:d.inputs[t]}),[t,e]);return j(n)},gU=(e,t)=>{const n=u.useMemo(()=>ft(ot,gn,(r,l)=>{const c=r.nodes.find(m=>m.id===e);if(!Pt(c))return;const d=l.templates[(c==null?void 0:c.data.type)??""],f=d==null?void 0:d.inputs[t];return f==null?void 0:f.input}),[t,e]);return j(n)},xU=({nodeId:e,fieldName:t,kind:n,children:o})=>{const r=J(),l=fk(e,t),c=mk(e,t,n),d=gU(e,t),{t:f}=R(),m=u.useMemo(()=>ft(fc,I=>!!I.exposedFields.find(M=>M.nodeId===e&&M.fieldName===t)),[t,e]),g=u.useMemo(()=>d&&["any","direct"].includes(d),[d]),p=j(m),x=u.useCallback(()=>{r(o3({nodeId:e,fieldName:t}))},[r,t,e]),y=u.useCallback(()=>{r(Ey({nodeId:e,fieldName:t}))},[r,t,e]),S=u.useMemo(()=>{const I=[];return g&&!p&&I.push(s.jsx(it,{icon:s.jsx(kl,{}),onClick:x,children:f("nodes.addLinearView")},`${e}.${t}.expose-field`)),g&&p&&I.push(s.jsx(it,{icon:s.jsx(V7,{}),onClick:y,children:f("nodes.removeLinearView")},`${e}.${t}.unexpose-field`)),I},[t,x,y,p,g,e,f]),b=u.useCallback(()=>S.length?s.jsx(zr,{visibility:"visible",children:s.jsx(Bi,{title:l||c||f("nodes.unknownField"),children:S})}):null,[c,l,S,f]);return s.jsx(j0,{renderMenu:b,children:o})},vU=u.memo(xU),CU=e=>{const{fieldTemplate:t,handleType:n,isConnectionInProgress:o,isConnectionStartField:r,connectionError:l}=e,{name:c}=t,d=t.type,f=gk(d),m=u.useMemo(()=>{const p=r3.some(S=>S===d.name),x=Xg(d),y={backgroundColor:d.isCollection||d.isCollectionOrScalar?Ma("base.900"):x,position:"absolute",width:"1rem",height:"1rem",borderWidth:d.isCollection||d.isCollectionOrScalar?4:0,borderStyle:"solid",borderColor:x,borderRadius:p?4:"100%",zIndex:1};return n==="target"?y.insetInlineStart="-1rem":y.insetInlineEnd="-1rem",o&&!r&&l&&(y.filter="opacity(0.4) grayscale(0.7)"),o&&l?r?y.cursor="grab":y.cursor="not-allowed":y.cursor="crosshair",y},[l,n,o,r,d]),g=u.useMemo(()=>o&&l?l:f,[l,f,o]);return s.jsx(jt,{label:g,placement:n==="target"?"start":"end",openDelay:jf,children:s.jsx(Mi,{type:n,id:c,position:n==="target"?da.Left:da.Right,style:m})})},o0=u.memo(CU),yU=({nodeId:e,fieldName:t})=>{const{t:n}=R(),o=pU(e,t),r=hU(e,t),l=mU(e,t),{isConnected:c,isConnectionInProgress:d,isConnectionStartField:f,connectionError:m,shouldDim:g}=Ww({nodeId:e,fieldName:t,kind:"input"}),p=u.useMemo(()=>!o||!o.required?!1:!c&&o.input==="connection"||!l&&!c&&o.input!=="connection",[o,c,l]);return!o||!r?s.jsx(bd,{shouldDim:g,children:s.jsx(U,{alignItems:"stretch",justifyContent:"space-between",flexDir:"column",gap:2,h:"full",w:"full",children:s.jsx(Y,{display:"flex",alignItems:"center",mb:0,px:1,gap:2,h:"full",children:n("nodes.unknownInput",{name:(r==null?void 0:r.label)??(o==null?void 0:o.title)??t})})})}):o.input==="connection"?s.jsxs(bd,{shouldDim:g,children:[s.jsx(U,{isInvalid:p,isDisabled:c,px:2,children:s.jsx(Kp,{nodeId:e,fieldName:t,kind:"input",isMissingInput:p,withTooltip:!0})}),s.jsx(o0,{fieldTemplate:o,handleType:"target",isConnectionInProgress:d,isConnectionStartField:f,connectionError:m})]}):s.jsxs(bd,{shouldDim:g,children:[s.jsx(U,{isInvalid:p,isDisabled:c,orientation:"vertical",px:2,children:s.jsxs(L,{flexDir:"column",w:"full",gap:1,children:[s.jsx(vU,{nodeId:e,fieldName:t,kind:"input",children:x=>s.jsx(Kp,{ref:x,nodeId:e,fieldName:t,kind:"input",isMissingInput:p,withTooltip:!0})}),s.jsx(wk,{nodeId:e,fieldName:t})]})}),o.input!=="direct"&&s.jsx(o0,{fieldTemplate:o,handleType:"target",isConnectionInProgress:d,isConnectionStartField:f,connectionError:m})]})},yC=u.memo(yU),bd=u.memo(({shouldDim:e,children:t})=>s.jsx(L,{position:"relative",minH:8,py:.5,alignItems:"center",opacity:e?.5:1,transitionProperty:"opacity",transitionDuration:"0.1s",w:"full",h:"full",children:t}));bd.displayName="InputFieldWrapper";const bU=(e,t)=>{const n=u.useMemo(()=>Fe(ot,r=>{const l=r.nodes.find(c=>c.id===e);if(Pt(l))return l.data.outputs[t]}),[t,e]);return j(n)},jU=(e,t)=>{const n=u.useMemo(()=>Fe(ot,gn,(r,l)=>{const c=r.nodes.find(f=>f.id===e);if(!Pt(c))return;const d=l.templates[(c==null?void 0:c.data.type)??""];return d==null?void 0:d.outputs[t]}),[t,e]);return j(n)},SU=({nodeId:e,fieldName:t})=>{const{t:n}=R(),o=jU(e,t),r=bU(e,t),{isConnected:l,isConnectionInProgress:c,isConnectionStartField:d,connectionError:f,shouldDim:m}=Ww({nodeId:e,fieldName:t,kind:"output"});return!o||!r?s.jsx(r0,{shouldDim:m,children:s.jsx(U,{alignItems:"stretch",justifyContent:"space-between",gap:2,h:"full",w:"full",children:s.jsx(Y,{display:"flex",alignItems:"center",h:"full",color:"error.300",mb:0,px:1,gap:2,children:n("nodes.unknownOutput",{name:(o==null?void 0:o.title)??t})})})}):s.jsxs(r0,{shouldDim:m,children:[s.jsx(jt,{label:s.jsx(Bg,{nodeId:e,fieldName:t,kind:"output"}),openDelay:jf,placement:"top",shouldWrapChildren:!0,children:s.jsx(U,{isDisabled:l,pe:2,children:s.jsx(Y,{mb:0,children:o==null?void 0:o.title})})}),s.jsx(o0,{fieldTemplate:o,handleType:"source",isConnectionInProgress:c,isConnectionStartField:d,connectionError:f})]})},kU=u.memo(SU),r0=u.memo(({shouldDim:e,children:t})=>s.jsx(L,{position:"relative",minH:8,py:.5,alignItems:"center",opacity:e?.5:1,transitionProperty:"opacity",transitionDuration:"0.1s",justifyContent:"flex-end",children:t}));r0.displayName="OutputFieldWrapper";const wU=e=>{const t=u.useMemo(()=>ft(ot,o=>{const r=o.nodes.find(l=>l.id===e);return Pt(r)?r.data.isIntermediate:!1}),[e]);return j(t)},IU=({nodeId:e})=>{const{t}=R(),n=J(),o=e1(e),r=wU(e),l=u.useCallback(c=>{n(l3({nodeId:e,isIntermediate:!c.target.checked}))},[n,e]);return o?s.jsxs(U,{className:"nopan",children:[s.jsxs(Y,{children:[t("hotkeys.saveToGallery.title")," "]}),s.jsx(jn,{onChange:l,isChecked:!r})]}):null},MU=u.memo(IU),_U=e=>{const t=u.useMemo(()=>ft(ot,o=>{const r=o.nodes.find(l=>l.id===e);return Pt(r)?r.data.useCache:!1}),[e]);return j(t)},AU=({nodeId:e})=>{const t=J(),n=_U(e),o=u.useCallback(l=>{t(a3({nodeId:e,useCache:l.target.checked}))},[t,e]),{t:r}=R();return s.jsxs(U,{children:[s.jsx(Y,{children:r("invocationCache.useCache")}),s.jsx(jn,{className:"nopan",onChange:o,isChecked:n})]})},PU=u.memo(AU),bC={w:"unset"},EU=({nodeId:e})=>{const t=e1(e),n=Kt("invocationCache").isFeatureEnabled;return s.jsx(L,{className:Va,layerStyle:"nodeFooter",w:"full",borderBottomRadius:"base",gap:4,px:2,py:0,h:8,justifyContent:"space-between",children:s.jsxs(wn,{formControlProps:bC,formLabelProps:bC,children:[n&&s.jsx(PU,{nodeId:e}),t&&s.jsx(MU,{nodeId:e})]})})},DU=u.memo(EU),LU=({nodeId:e,isOpen:t})=>{const n=J(),o=i3(),r=u.useCallback(()=>{n(c3({nodeId:e,isOpen:!t})),o(e)},[n,t,e,o]);return s.jsx(je,{className:"nodrag",onClick:r,"aria-label":"Minimize",minW:8,w:8,h:8,variant:"link",icon:s.jsx(Vn,{as:q0,transform:t?"rotate(0deg)":"rotate(180deg)",transitionProperty:"common",transitionDuration:"normal"})})},t1=u.memo(LU),TU=({nodeId:e,title:t})=>{const n=J(),o=ak(e),r=ik(e),{t:l}=R(),[c,d]=u.useState(""),f=u.useCallback(async g=>{n(Iy({nodeId:e,label:g})),d(o||t||r||l("nodes.problemSettingTitle"))},[n,e,t,r,o,l]),m=u.useCallback(g=>{d(g)},[]);return u.useEffect(()=>{d(o||t||r||l("nodes.problemSettingTitle"))},[o,r,t,l]),s.jsx(L,{overflow:"hidden",w:"full",h:"full",alignItems:"center",justifyContent:"center",cursor:"text",children:s.jsxs(uf,{as:L,value:c,onChange:m,onSubmit:f,alignItems:"center",position:"relative",w:"full",h:"full",children:[s.jsx(df,{fontSize:"sm",p:0,w:"full",noOfLines:1}),s.jsx(ff,{className:"nodrag",fontSize:"sm",sx:BU}),s.jsx(RU,{})]})})},Uw=u.memo(TU);function RU(){const{isEditing:e,getEditButtonProps:t}=_y(),n=u.useCallback(o=>{const{onClick:r}=t();r&&r(o)},[t]);return e?null:s.jsx(We,{className:Va,onDoubleClick:n,position:"absolute",w:"full",h:"full",top:0,cursor:"grab"})}const BU={p:0,fontWeight:"bold",_focusVisible:{p:0}},OU=e=>{const t=u.useMemo(()=>Fe(ot,gn,(o,r)=>{const l=o.nodes.find(d=>d.id===e);if(!Pt(l))return!1;const c=r.templates[(l==null?void 0:l.data.type)??""];return c==null?void 0:c.classification}),[e]);return j(t)},NU=({nodeId:e})=>{const t=OU(e);return!t||t==="stable"?null:s.jsx(jt,{label:s.jsx(Gw,{classification:t}),placement:"top",shouldWrapChildren:!0,children:s.jsx(Vn,{as:zU(t),display:"block",boxSize:4,color:"base.400"})})},FU=u.memo(NU),Gw=u.memo(({classification:e})=>{const{t}=R();return e==="beta"?t("nodes.betaDesc"):e==="prototype"?t("nodes.prototypeDesc"):null});Gw.displayName="ClassificationTooltipContent";const zU=e=>{if(e==="beta")return A7;if(e==="prototype")return M7},jC={visibility:"hidden"},HU=({nodeId:e})=>{const t=Rg(e),{base600:n}=$w(),o=u.useMemo(()=>({borderWidth:0,borderRadius:"3px",width:"1rem",height:"1rem",backgroundColor:n,zIndex:-1}),[n]),r=u.useMemo(()=>({...o,left:"-0.5rem"}),[o]),l=u.useMemo(()=>({...o,right:"-0.5rem"}),[o]);return wd(t)?s.jsxs(s.Fragment,{children:[s.jsx(Mi,{type:"target",id:`${t.id}-collapsed-target`,isConnectable:!1,position:da.Left,style:r}),ys(t.inputs,c=>s.jsx(Mi,{type:"target",id:c.name,isConnectable:!1,position:da.Left,style:jC},`${t.id}-${c.name}-collapsed-input-handle`)),s.jsx(Mi,{type:"source",id:`${t.id}-collapsed-source`,isConnectable:!1,position:da.Right,style:l}),ys(t.outputs,c=>s.jsx(Mi,{type:"source",id:c.name,isConnectable:!1,position:da.Right,style:jC},`${t.id}-${c.name}-collapsed-output-handle`))]}):null},$U=u.memo(HU),VU=e=>{const t=u.useMemo(()=>Fe(ot,gn,(o,r)=>{const l=o.nodes.find(d=>d.id===e);return r.templates[(l==null?void 0:l.data.type)??""]}),[e]);return j(t)},WU=({nodeId:e})=>{const t=lk(e);return s.jsx(jt,{label:s.jsx(Zw,{nodeId:e}),placement:"top",shouldWrapChildren:!0,children:s.jsx(Vn,{as:Mf,display:"block",boxSize:4,w:8,color:t?"error.400":"base.400"})})},UU=u.memo(WU),Zw=u.memo(({nodeId:e})=>{const t=Rg(e),n=VU(e),{t:o}=R(),r=u.useMemo(()=>t!=null&&t.label&&(n!=null&&n.title)?`${t.label} (${n.title})`:t!=null&&t.label&&!n?t.label:!(t!=null&&t.label)&&n?n.title:o("nodes.unknownNode"),[t,n,o]),l=u.useMemo(()=>!wd(t)||!n?null:t.version?n.version?i2(t.version,n.version,"<")?s.jsxs(pe,{as:"span",color:"error.500",children:[o("nodes.version")," ",t.version," (",o("nodes.updateNode"),")"]}):i2(t.version,n.version,">")?s.jsxs(pe,{as:"span",color:"error.500",children:[o("nodes.version")," ",t.version," (",o("nodes.updateApp"),")"]}):s.jsxs(pe,{as:"span",children:[o("nodes.version")," ",t.version]}):s.jsxs(pe,{as:"span",color:"error.500",children:[o("nodes.version")," ",t.version," (",o("nodes.unknownTemplate"),")"]}):s.jsx(pe,{as:"span",color:"error.500",children:o("nodes.versionUnknown")}),[t,n,o]);return wd(t)?s.jsxs(L,{flexDir:"column",children:[s.jsx(pe,{as:"span",fontWeight:"semibold",children:r}),(n==null?void 0:n.nodePack)&&s.jsxs(pe,{opacity:.7,children:[o("nodes.nodePack"),": ",n.nodePack]}),s.jsx(pe,{opacity:.7,fontStyle:"oblique 5deg",children:n==null?void 0:n.description}),l,(t==null?void 0:t.notes)&&s.jsx(pe,{children:t.notes})]}):s.jsx(pe,{fontWeight:"semibold",children:o("nodes.unknownNode")})});Zw.displayName="TooltipContent";const up=3,SC={circle:{transitionProperty:"none",transitionDuration:"0s"},".chakra-progress__track":{stroke:"transparent"}},GU=({nodeId:e})=>{const t=u.useMemo(()=>Fe(ot,o=>o.nodeExecutionStates[e]),[e]),n=j(t);return n?s.jsx(jt,{label:s.jsx(qw,{nodeExecutionState:n}),placement:"top",children:s.jsx(L,{className:Va,w:5,h:"full",alignItems:"center",justifyContent:"flex-end",children:s.jsx(Qw,{nodeExecutionState:n})})}):null},ZU=u.memo(GU),qw=u.memo(({nodeExecutionState:e})=>{const{status:t,progress:n,progressImage:o}=e,{t:r}=R();return t===Ko.enum.PENDING?s.jsx(pe,{children:r("queue.pending")}):t===Ko.enum.IN_PROGRESS?o?s.jsxs(L,{pos:"relative",pt:1.5,pb:.5,children:[s.jsx(ur,{src:o.dataURL,w:32,h:32,borderRadius:"base",objectFit:"contain"}),n!==null&&s.jsxs(Yr,{variant:"solid",pos:"absolute",top:2.5,insetInlineEnd:1,children:[Math.round(n*100),"%"]})]}):n!==null?s.jsxs(pe,{children:[r("nodes.executionStateInProgress")," (",Math.round(n*100),"%)"]}):s.jsx(pe,{children:r("nodes.executionStateInProgress")}):t===Ko.enum.COMPLETED?s.jsx(pe,{children:r("nodes.executionStateCompleted")}):t===Ko.enum.FAILED?s.jsx(pe,{children:r("nodes.executionStateError")}):null});qw.displayName="TooltipLabel";const Qw=u.memo(e=>{const{progress:t,status:n}=e.nodeExecutionState;return n===Ko.enum.PENDING?s.jsx(Vn,{as:X0,boxSize:up,color:"base.300"}):n===Ko.enum.IN_PROGRESS?t===null?s.jsx(c2,{isIndeterminate:!0,size:"14px",color:"base.500",thickness:14,sx:SC}):s.jsx(c2,{value:Math.round(t*100),size:"14px",color:"base.500",thickness:14,sx:SC}):n===Ko.enum.COMPLETED?s.jsx(Vn,{as:Qb,boxSize:up,color:"ok.300"}):n===Ko.enum.FAILED?s.jsx(Vn,{as:Y0,boxSize:up,color:"error.300"}):null});Qw.displayName="StatusIcon";const qU=({nodeId:e,isOpen:t})=>s.jsxs(L,{layerStyle:"nodeHeader",borderTopRadius:"base",borderBottomRadius:t?0:"base",alignItems:"center",justifyContent:"space-between",h:8,textAlign:"center",color:"base.200",children:[s.jsx(t1,{nodeId:e,isOpen:t}),s.jsx(FU,{nodeId:e}),s.jsx(Uw,{nodeId:e}),s.jsxs(L,{alignItems:"center",children:[s.jsx(ZU,{nodeId:e}),s.jsx(UU,{nodeId:e})]}),!t&&s.jsx($U,{nodeId:e})]}),QU=u.memo(qU),KU=({nodeId:e,isOpen:t,label:n,type:o,selected:r})=>{const l=aU(e),c=lU(e),d=cU(e),f=iU(e);return s.jsxs(sm,{nodeId:e,selected:r,children:[s.jsx(QU,{nodeId:e,isOpen:t,label:n,selected:r,type:o}),t&&s.jsxs(s.Fragment,{children:[s.jsx(L,{layerStyle:"nodeBody",flexDirection:"column",w:"full",h:"full",py:2,gap:1,borderBottomRadius:d?0:"base",children:s.jsxs(L,{flexDir:"column",px:2,w:"full",h:"full",children:[s.jsxs(Ca,{gridTemplateColumns:"1fr auto",gridAutoRows:"1fr",children:[l.map((m,g)=>s.jsx(Pr,{gridColumnStart:1,gridRowStart:g+1,children:s.jsx(yC,{nodeId:e,fieldName:m})},`${e}.${m}.input-field`)),f.map((m,g)=>s.jsx(Pr,{gridColumnStart:2,gridRowStart:g+1,children:s.jsx(kU,{nodeId:e,fieldName:m})},`${e}.${m}.output-field`))]}),c.map(m=>s.jsx(yC,{nodeId:e,fieldName:m},`${e}.${m}.input-field`))]})}),d&&s.jsx(DU,{nodeId:e})]})]})},YU=u.memo(KU),XU=e=>{const t=u.useMemo(()=>ft(ot,o=>{const r=o.nodes.find(l=>l.id===e);return Pt(r)?r.data.nodePack:!1}),[e]);return j(t)},JU=({nodeId:e,isOpen:t,label:n,type:o,selected:r})=>{const{t:l}=R(),c=XU(e);return s.jsxs(sm,{nodeId:e,selected:r,children:[s.jsxs(L,{className:Va,layerStyle:"nodeHeader",borderTopRadius:"base",borderBottomRadius:t?0:"base",alignItems:"center",h:8,fontWeight:"semibold",fontSize:"sm",children:[s.jsx(t1,{nodeId:e,isOpen:t}),s.jsx(pe,{w:"full",textAlign:"center",pe:8,color:"error.300",children:n?`${n} (${o})`:o})]}),t&&s.jsx(L,{layerStyle:"nodeBody",userSelect:"auto",flexDirection:"column",w:"full",h:"full",p:4,gap:1,borderBottomRadius:"base",fontSize:"sm",children:s.jsxs(L,{gap:2,flexDir:"column",children:[s.jsxs(pe,{as:"span",children:[l("nodes.unknownNodeType"),":"," ",s.jsx(pe,{as:"span",fontWeight:"semibold",children:o})]}),c&&s.jsxs(pe,{as:"span",children:[l("nodes.nodePack"),":"," ",s.jsx(pe,{as:"span",fontWeight:"semibold",children:c})]})]})})]})},eG=u.memo(JU),tG=e=>{const{data:t,selected:n}=e,{id:o,type:r,isOpen:l,label:c}=t,d=u.useMemo(()=>ft(gn,m=>!!m.templates[r]),[r]);return j(d)?s.jsx(YU,{nodeId:o,isOpen:l,label:c,type:r,selected:n}):s.jsx(eG,{nodeId:o,isOpen:l,label:c,type:r,selected:n})},nG=u.memo(tG),sG=e=>{const{id:t,data:n,selected:o}=e,{notes:r,isOpen:l}=n,c=J(),d=u.useCallback(f=>{c(u3({nodeId:t,value:f.target.value}))},[c,t]);return s.jsxs(sm,{nodeId:t,selected:o,children:[s.jsxs(L,{layerStyle:"nodeHeader",borderTopRadius:"base",borderBottomRadius:l?0:"base",alignItems:"center",justifyContent:"space-between",h:8,children:[s.jsx(t1,{nodeId:t,isOpen:l}),s.jsx(Uw,{nodeId:t,title:"Notes"}),s.jsx(We,{minW:8})]}),l&&s.jsx(s.Fragment,{children:s.jsx(L,{layerStyle:"nodeBody",className:"nopan",cursor:"auto",flexDirection:"column",borderBottomRadius:"base",w:"full",h:"full",p:2,gap:1,children:s.jsx(L,{className:"nopan",w:"full",h:"full",flexDir:"column",children:s.jsx(or,{value:r,onChange:d,rows:8,resize:"none",fontSize:"sm"})})})})]})},oG=u.memo(sG),rG=["Delete","Backspace"],lG={collapsed:QW,default:YW},aG={invocation:nG,current_image:tU,notes:oG},iG={hideAttribution:!0},cG=[25,25],Kw=u.memo(()=>{const e=J(),t=j(N=>N.nodes.nodes),n=j(N=>N.nodes.edges),o=j(N=>N.nodes.viewport),r=j(N=>N.nodes.shouldSnapToGrid),l=j(N=>N.nodes.selectionMode),c=u.useRef(null),d=u.useRef(null),f=$W();zR();const[m]=kf("radii",["base"]),g=u.useMemo(()=>({borderRadius:m}),[m]),p=u.useCallback(N=>{e(d3(N))},[e]),x=u.useCallback(N=>{e(f3(N))},[e]),y=u.useCallback((N,z)=>{e(m3(z))},[e]),S=u.useCallback(N=>{e(u2(N))},[e]),b=u.useCallback(()=>{d.current&&e(h3({cursorPosition:d.current,mouseOverNodeId:gd.get()}))},[e]),I=u.useCallback(N=>{e(p3(N))},[e]),M=u.useCallback(N=>{e(g3(N))},[e]),w=u.useCallback(({nodes:N,edges:z})=>{e(x3(N?N.map($=>$.id):[])),e(v3(z?z.map($=>$.id):[]))},[e]),_=u.useCallback((N,z)=>{e(C3(z))},[e]),{onCloseGlobal:T}=Sf(),D=u.useCallback(()=>{T()},[T]),A=u.useCallback(N=>{d2.set(N),N.fitView()},[]),F=u.useCallback(N=>{var z,$;(z=c.current)!=null&&z.getBoundingClientRect()&&(d.current=(($=d2.get())==null?void 0:$.screenToFlowPosition({x:N.clientX,y:N.clientY}))??null)},[]),Q=u.useRef(),q=u.useCallback((N,z,$)=>{Q.current=N,e(y3(z.id)),e(b3())},[e]),G=u.useCallback((N,z)=>{e(u2(z))},[e]),Z=u.useCallback((N,z,$)=>{var se,he;!("touches"in N)&&((se=Q.current)==null?void 0:se.clientX)===N.clientX&&((he=Q.current)==null?void 0:he.clientY)===N.clientY&&e(j3(z)),Q.current=void 0},[e]);return Oe(["Ctrl+c","Meta+c"],N=>{N.preventDefault(),e(k3())}),Oe(["Ctrl+a","Meta+a"],N=>{N.preventDefault(),e(w3())}),Oe(["Ctrl+v","Meta+v"],N=>{d.current&&(N.preventDefault(),e(I3({cursorPosition:d.current})))}),s.jsx(S3,{id:"workflow-editor",ref:c,defaultViewport:o,nodeTypes:aG,edgeTypes:lG,nodes:t,edges:n,onInit:A,onMouseMove:F,onNodesChange:p,onEdgesChange:x,onEdgesDelete:I,onEdgeUpdate:G,onEdgeUpdateStart:q,onEdgeUpdateEnd:Z,onNodesDelete:M,onConnectStart:y,onConnect:S,onConnectEnd:b,onMoveEnd:_,connectionLineComponent:ZW,onSelectionChange:w,isValidConnection:f,minZoom:.1,snapToGrid:r,snapGrid:cG,connectionRadius:30,proOptions:iG,style:g,onPaneClick:D,deleteKeyCode:rG,selectionMode:l,children:s.jsx(M_,{})})});Kw.displayName="Flow";const uG=()=>{const e=J(),t=j(r=>r.nodes.nodeOpacity),{t:n}=R(),o=u.useCallback(r=>{e(M3(r))},[e]);return s.jsx(L,{alignItems:"center",children:s.jsx(Ue,{"aria-label":n("nodes.nodeOpacity"),value:t,defaultValue:1,min:.5,max:1,step:.01,onChange:o,orientation:"vertical",h:"calc(100% - 0.5rem)"})})},dG=u.memo(uG),fG=()=>{const{t:e}=R(),{zoomIn:t,zoomOut:n,fitView:o}=R0(),r=J(),l=j(g=>g.nodes.shouldShowMinimapPanel),c=u.useCallback(()=>{t()},[t]),d=u.useCallback(()=>{n()},[n]),f=u.useCallback(()=>{o()},[o]),m=u.useCallback(()=>{r(_3(!l))},[l,r]);return s.jsxs(wt,{orientation:"vertical",children:[s.jsx(je,{tooltip:e("nodes.zoomInNodes"),"aria-label":e("nodes.zoomInNodes"),onClick:c,icon:s.jsx(H7,{})}),s.jsx(je,{tooltip:e("nodes.zoomOutNodes"),"aria-label":e("nodes.zoomOutNodes"),onClick:d,icon:s.jsx(z7,{})}),s.jsx(je,{tooltip:e("nodes.fitViewportNodes"),"aria-label":e("nodes.fitViewportNodes"),onClick:f,icon:s.jsx(Xb,{})}),s.jsx(je,{tooltip:e(l?"nodes.hideMinimapnodes":"nodes.showMinimapnodes"),"aria-label":e(l?"nodes.hideMinimapnodes":"nodes.showMinimapnodes"),isChecked:l,onClick:m,icon:s.jsx($7,{})})]})},mG=u.memo(fG),hG=()=>s.jsxs(L,{gap:2,position:"absolute",bottom:2,insetInlineStart:2,children:[s.jsx(mG,{}),s.jsx(dG,{})]}),pG=u.memo(hG),gG=P0(b_),xG={m:"0 !important",borderRadius:"base",backgroundColor:"base.500 !important",svg:{borderRadius:"inherit"}},vG=()=>{const e=j(t=>t.nodes.shouldShowMinimapPanel);return s.jsx(L,{gap:2,position:"absolute",bottom:2,insetInlineEnd:2,children:e&&s.jsx(gG,{pannable:!0,zoomable:!0,nodeBorderRadius:15,sx:xG,nodeColor:"var(--invoke-colors-base-600)",maskColor:"var(--invoke-colors-blackAlpha-600)"})})},CG=u.memo(vG),yG={position:"relative",width:"100%",height:"100%"},bG={position:"absolute",width:"100%",height:"100%"},kC={opacity:0},wC={opacity:1,transition:{duration:.2}},IC={opacity:0,transition:{duration:.2}},jG=()=>{const e=j(n=>n.nodes.isReady),{t}=R();return s.jsxs(L,{layerStyle:"first",position:"relative",width:"full",height:"full",borderRadius:"base",alignItems:"center",justifyContent:"center",children:[s.jsx(Aa,{children:e&&s.jsxs(_l.div,{initial:kC,animate:wC,exit:IC,style:yG,children:[s.jsx(Kw,{}),s.jsx(HW,{}),s.jsx(EW,{}),s.jsx(pG,{}),s.jsx(CG,{}),s.jsx(LW,{})]})}),s.jsx(Aa,{children:!e&&s.jsx(_l.div,{initial:kC,animate:wC,exit:IC,style:bG,children:s.jsx(L,{layerStyle:"first",position:"relative",width:"full",height:"full",borderRadius:"base",alignItems:"center",justifyContent:"center",pointerEvents:"none",children:s.jsx(Yt,{label:t("nodes.loadingNodes"),icon:TW})})})})]})},SG=u.memo(jG),kG=()=>s.jsx(A3,{children:s.jsx(SG,{})}),wG=u.memo(kG),IG=()=>{const{t:e}=R(),t=J(),{data:n}=pc(),o=j(f=>f.system.isConnected),[r,{isLoading:l}]=P3({fixedCacheKey:"clearInvocationCache"}),c=u.useMemo(()=>!(n!=null&&n.size)||!o,[n==null?void 0:n.size,o]);return{clearInvocationCache:u.useCallback(async()=>{if(!c)try{await r().unwrap(),t(Qe({title:e("invocationCache.clearSucceeded"),status:"success"}))}catch{t(Qe({title:e("invocationCache.clearFailed"),status:"error"}))}},[c,r,t,e]),isLoading:l,cacheStatus:n,isDisabled:c}},MG=()=>{const{t:e}=R(),{clearInvocationCache:t,isDisabled:n,isLoading:o}=IG();return s.jsx(Ge,{isDisabled:n,isLoading:o,onClick:t,children:e("invocationCache.clear")})},_G=u.memo(MG),AG=({children:e,...t})=>s.jsx(E3,{alignItems:"center",justifyContent:"center",w:"full",h:"full",layerStyle:"first",borderRadius:"base",py:2,px:3,gap:6,flexWrap:"nowrap",...t,children:e}),Yw=u.memo(AG),PG={'&[aria-disabled="true"]':{color:"base.500"}},EG=({label:e,value:t,isDisabled:n=!1,...o})=>s.jsxs(D3,{flexGrow:1,textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap","aria-disabled":n,sx:PG,...o,children:[s.jsx(L3,{textOverflow:"ellipsis",overflow:"hidden",whiteSpace:"nowrap",children:e}),s.jsx(T3,{children:t})]}),So=u.memo(EG),DG=()=>{const{t:e}=R(),t=J(),{data:n}=pc(),o=j(f=>f.system.isConnected),[r,{isLoading:l}]=R3({fixedCacheKey:"disableInvocationCache"}),c=u.useMemo(()=>!(n!=null&&n.enabled)||!o||(n==null?void 0:n.max_size)===0,[n==null?void 0:n.enabled,n==null?void 0:n.max_size,o]);return{disableInvocationCache:u.useCallback(async()=>{if(!c)try{await r().unwrap(),t(Qe({title:e("invocationCache.disableSucceeded"),status:"success"}))}catch{t(Qe({title:e("invocationCache.disableFailed"),status:"error"}))}},[c,r,t,e]),isLoading:l,cacheStatus:n,isDisabled:c}},LG=()=>{const{t:e}=R(),t=J(),{data:n}=pc(),o=j(f=>f.system.isConnected),[r,{isLoading:l}]=B3({fixedCacheKey:"enableInvocationCache"}),c=u.useMemo(()=>(n==null?void 0:n.enabled)||!o||(n==null?void 0:n.max_size)===0,[n==null?void 0:n.enabled,n==null?void 0:n.max_size,o]);return{enableInvocationCache:u.useCallback(async()=>{if(!c)try{await r().unwrap(),t(Qe({title:e("invocationCache.enableSucceeded"),status:"success"}))}catch{t(Qe({title:e("invocationCache.enableFailed"),status:"error"}))}},[c,r,t,e]),isLoading:l,cacheStatus:n,isDisabled:c}},TG=()=>{const{t:e}=R(),{data:t}=pc(),{enableInvocationCache:n,isDisabled:o,isLoading:r}=LG(),{disableInvocationCache:l,isDisabled:c,isLoading:d}=DG();return t!=null&&t.enabled?s.jsx(Ge,{isDisabled:c,isLoading:d,onClick:l,children:e("invocationCache.disable")}):s.jsx(Ge,{isDisabled:o,isLoading:r,onClick:n,children:e("invocationCache.enable")})},RG=u.memo(TG),BG=()=>{const{t:e}=R(),{data:t}=pc(void 0);return s.jsxs(Yw,{children:[s.jsx(So,{isDisabled:!(t!=null&&t.enabled),label:e("invocationCache.cacheSize"),value:(t==null?void 0:t.size)??0}),s.jsx(So,{isDisabled:!(t!=null&&t.enabled),label:e("invocationCache.hits"),value:(t==null?void 0:t.hits)??0}),s.jsx(So,{isDisabled:!(t!=null&&t.enabled),label:e("invocationCache.misses"),value:(t==null?void 0:t.misses)??0}),s.jsx(So,{isDisabled:!(t!=null&&t.enabled),label:e("invocationCache.maxCacheSize"),value:(t==null?void 0:t.max_size)??0}),s.jsxs(wt,{w:24,orientation:"vertical",size:"sm",children:[s.jsx(_G,{}),s.jsx(RG,{})]})]})},OG=u.memo(BG),MC={pending:{colorScheme:"cyan",translationKey:"queue.pending"},in_progress:{colorScheme:"yellow",translationKey:"queue.in_progress"},completed:{colorScheme:"green",translationKey:"queue.completed"},failed:{colorScheme:"red",translationKey:"queue.failed"},canceled:{colorScheme:"orange",translationKey:"queue.canceled"}},NG=({status:e})=>{const{t}=R();return s.jsx(Yr,{colorScheme:MC[e].colorScheme,children:t(MC[e].translationKey)})},FG=u.memo(NG),Xw=e=>{const t=j(d=>d.system.isConnected),[n,{isLoading:o}]=d0(),r=J(),{t:l}=R();return{cancelQueueItem:u.useCallback(async()=>{try{await n(e).unwrap(),r(Qe({title:l("queue.cancelSucceeded"),status:"success"}))}catch{r(Qe({title:l("queue.cancelFailed"),status:"error"}))}},[r,e,l,n]),isLoading:o,isDisabled:!t}},Jw=(e,t)=>Number(((Date.parse(t)-Date.parse(e))/1e3).toFixed(2)),ko={number:"3rem",statusBadge:"5.7rem",statusDot:2,time:"4rem",batchId:"5rem",fieldValues:"auto",actions:"auto"},zG=e=>{const t=j(f=>f.system.isConnected),{isCanceled:n}=O3({batch_id:e},{selectFromResult:({data:f})=>f?{isCanceled:(f==null?void 0:f.in_progress)===0&&(f==null?void 0:f.pending)===0}:{isCanceled:!0}}),[o,{isLoading:r}]=N3({fixedCacheKey:"cancelByBatchIds"}),l=J(),{t:c}=R();return{cancelBatch:u.useCallback(async()=>{if(!n)try{await o({batch_ids:[e]}).unwrap(),l(Qe({title:c("queue.cancelBatchSucceeded"),status:"success"}))}catch{l(Qe({title:c("queue.cancelBatchFailed"),status:"error"}))}},[e,l,n,c,o]),isLoading:r,isCanceled:n,isDisabled:!t}},HG=({queueItemDTO:e})=>{const{session_id:t,batch_id:n,item_id:o}=e,{t:r}=R(),{cancelBatch:l,isLoading:c,isCanceled:d}=zG(n),{cancelQueueItem:f,isLoading:m}=Xw(o),{data:g}=F3(o),p=u.useMemo(()=>{if(!g)return r("common.loading");if(!g.completed_at||!g.started_at)return r(`queue.${g.status}`);const x=Jw(g.started_at,g.completed_at);return g.status==="completed"?`${r("queue.completedIn")} ${x}${x===1?"":"s"}`:`${x}s`},[g,r]);return s.jsxs(L,{layerStyle:"third",flexDir:"column",p:2,pt:0,borderRadius:"base",gap:2,children:[s.jsxs(L,{layerStyle:"second",p:2,gap:2,justifyContent:"space-between",alignItems:"center",borderRadius:"base",h:20,children:[s.jsx(od,{label:r("queue.status"),data:p}),s.jsx(od,{label:r("queue.item"),data:o}),s.jsx(od,{label:r("queue.batch"),data:n}),s.jsx(od,{label:r("queue.session"),data:t}),s.jsxs(wt,{size:"xs",orientation:"vertical",children:[s.jsx(Ge,{onClick:f,isLoading:m,isDisabled:g?["canceled","completed","failed"].includes(g.status):!0,"aria-label":r("queue.cancelItem"),leftIcon:s.jsx(oo,{}),colorScheme:"error",children:r("queue.cancelItem")}),s.jsx(Ge,{onClick:l,isLoading:c,isDisabled:d,"aria-label":r("queue.cancelBatch"),leftIcon:s.jsx(oo,{}),colorScheme:"error",children:r("queue.cancelBatch")})]})]}),(g==null?void 0:g.error)&&s.jsxs(L,{layerStyle:"second",p:3,gap:1,justifyContent:"space-between",alignItems:"flex-start",borderRadius:"base",flexDir:"column",children:[s.jsx(ns,{size:"sm",color:"error.400",children:r("common.error")}),s.jsx("pre",{children:g.error})]}),s.jsx(L,{layerStyle:"second",h:512,w:"full",borderRadius:"base",alignItems:"center",justifyContent:"center",children:g?s.jsx(Ur,{label:"Queue Item",data:g}):s.jsx(Kr,{opacity:.5})})]})},$G=u.memo(HG),od=({label:e,data:t})=>s.jsxs(L,{flexDir:"column",justifyContent:"flex-start",p:1,gap:1,overflow:"hidden",h:"full",w:"full",children:[s.jsx(ns,{size:"md",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:e}),s.jsx(pe,{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",children:t})]}),_C={bg:"base.700"},VG={_hover:_C,"&[aria-selected='true']":_C},WG=({index:e,item:t,context:n})=>{const{t:o}=R(),r=u.useCallback(()=>{n.toggleQueueItem(t.item_id)},[n,t.item_id]),{cancelQueueItem:l,isLoading:c}=Xw(t.item_id),d=u.useCallback(x=>{x.stopPropagation(),l()},[l]),f=u.useMemo(()=>n.openQueueItems.includes(t.item_id),[n.openQueueItems,t.item_id]),m=u.useMemo(()=>!t.completed_at||!t.started_at?void 0:`${Jw(t.started_at,t.completed_at)}s`,[t]),g=u.useMemo(()=>["canceled","completed","failed"].includes(t.status),[t.status]),p=u.useMemo(()=>s.jsx(oo,{}),[]);return s.jsxs(L,{flexDir:"column","aria-selected":f,fontSize:"sm",borderRadius:"base",justifyContent:"center",sx:VG,"data-testid":"queue-item",children:[s.jsxs(L,{minH:9,alignItems:"center",gap:4,p:1.5,cursor:"pointer",onClick:r,children:[s.jsx(L,{w:ko.number,justifyContent:"flex-end",alignItems:"center",flexShrink:0,children:s.jsx(pe,{variant:"subtext",children:e+1})}),s.jsx(L,{w:ko.statusBadge,alignItems:"center",flexShrink:0,children:s.jsx(FG,{status:t.status})}),s.jsx(L,{w:ko.time,alignItems:"center",flexShrink:0,children:m||"-"}),s.jsx(L,{w:ko.batchId,flexShrink:0,children:s.jsx(pe,{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",alignItems:"center",children:t.batch_id})}),s.jsx(L,{alignItems:"center",overflow:"hidden",flexGrow:1,children:t.field_values&&s.jsx(L,{gap:2,w:"full",whiteSpace:"nowrap",textOverflow:"ellipsis",overflow:"hidden",children:t.field_values.filter(x=>x.node_path!=="metadata_accumulator").map(({node_path:x,field_name:y,value:S})=>s.jsxs(pe,{as:"span",children:[s.jsxs(pe,{as:"span",fontWeight:"semibold",children:[x,".",y]}),": ",S]},`${t.item_id}.${x}.${y}.${S}`))})}),s.jsx(L,{alignItems:"center",w:ko.actions,pe:3,children:s.jsx(wt,{size:"xs",variant:"ghost",children:s.jsx(je,{onClick:d,isDisabled:g,isLoading:c,"aria-label":o("queue.cancelItem"),icon:p})})})]}),s.jsx(ry,{in:f,transition:UG,unmountOnExit:!0,children:s.jsx($G,{queueItemDTO:t})})]})},UG={enter:{duration:.1},exit:{duration:.1}},GG=u.memo(WG),ZG=u.memo(mf((e,t)=>s.jsx(L,{...e,ref:t,flexDirection:"column",gap:.5,children:e.children}))),qG=u.memo(ZG),QG=()=>{const{t:e}=R();return s.jsxs(L,{alignItems:"center",gap:4,p:1,pb:2,textTransform:"uppercase",fontWeight:"bold",fontSize:"sm",letterSpacing:1,children:[s.jsx(L,{w:ko.number,justifyContent:"flex-end",alignItems:"center",children:s.jsx(pe,{variant:"subtext",children:"#"})}),s.jsx(L,{ps:.5,w:ko.statusBadge,alignItems:"center",children:s.jsx(pe,{variant:"subtext",children:e("queue.status")})}),s.jsx(L,{ps:.5,w:ko.time,alignItems:"center",children:s.jsx(pe,{variant:"subtext",children:e("queue.time")})}),s.jsx(L,{ps:.5,w:ko.batchId,alignItems:"center",children:s.jsx(pe,{variant:"subtext",children:e("queue.batch")})}),s.jsx(L,{ps:.5,w:ko.fieldValues,alignItems:"center",children:s.jsx(pe,{variant:"subtext",children:e("queue.batchFieldValues")})})]})},KG=u.memo(QG),YG=(e,t)=>t.item_id,XG={List:qG},JG=(e,t,n)=>s.jsx(GG,{index:e,item:t,context:n}),eZ=()=>{const e=j(M=>M.queue.listCursor),t=j(M=>M.queue.listPriority),n=J(),o=u.useRef(null),[r,l]=u.useState(null),[c,d]=pg(kc),{t:f}=R();u.useEffect(()=>{const{current:M}=o;return r&&M&&c({target:M,elements:{viewport:r}}),()=>{var w;return(w=d())==null?void 0:w.destroy()}},[r,c,d]);const{data:m,isLoading:g}=z3({cursor:e,priority:t}),p=u.useMemo(()=>m?H3.selectAll(m):[],[m]),x=u.useCallback(()=>{if(!(m!=null&&m.has_more))return;const M=p[p.length-1];M&&(n(f0(M.item_id)),n(m0(M.priority)))},[n,m==null?void 0:m.has_more,p]),[y,S]=u.useState([]),b=u.useCallback(M=>{S(w=>w.includes(M)?w.filter(_=>_!==M):[...w,M])},[]),I=u.useMemo(()=>({openQueueItems:y,toggleQueueItem:b}),[y,b]);return g?s.jsx(eg,{}):p.length?s.jsxs(L,{w:"full",h:"full",flexDir:"column",children:[s.jsx(KG,{}),s.jsx(L,{ref:o,w:"full",h:"full",alignItems:"center",justifyContent:"center",children:s.jsx(TL,{data:p,endReached:x,scrollerRef:l,itemContent:JG,computeItemKey:YG,components:XG,context:I})})]}):s.jsx(L,{w:"full",h:"full",alignItems:"center",justifyContent:"center",children:s.jsx(ns,{color:"base.500",children:f("queue.queueEmpty")})})},tZ=u.memo(eZ),nZ=()=>{const{data:e}=Ro(),{t}=R();return s.jsxs(Yw,{"data-testid":"queue-status",children:[s.jsx(So,{label:t("queue.in_progress"),value:(e==null?void 0:e.queue.in_progress)??0}),s.jsx(So,{label:t("queue.pending"),value:(e==null?void 0:e.queue.pending)??0}),s.jsx(So,{label:t("queue.completed"),value:(e==null?void 0:e.queue.completed)??0}),s.jsx(So,{label:t("queue.failed"),value:(e==null?void 0:e.queue.failed)??0}),s.jsx(So,{label:t("queue.canceled"),value:(e==null?void 0:e.queue.canceled)??0}),s.jsx(So,{label:t("queue.total"),value:(e==null?void 0:e.queue.total)??0})]})},sZ=u.memo(nZ),oZ=e=>{const{t}=R(),n=an(),{isLoading:o,isDisabled:r}=xc();return s.jsxs(s.Fragment,{children:[s.jsx(Ge,{isDisabled:r,isLoading:o,tooltip:t("queue.clearTooltip"),leftIcon:s.jsx(bc,{}),colorScheme:"error",onClick:n.onOpen,"data-testid":t("queue.clear"),...e,children:t("queue.clear")}),s.jsx(Uf,{disclosure:n})]})},rZ=u.memo(oZ),lZ=({label:e,tooltip:t,icon:n,onClick:o,isDisabled:r,colorScheme:l,asIconButton:c,isLoading:d,loadingText:f,sx:m})=>c?s.jsx(je,{"aria-label":e,tooltip:t,icon:n,onClick:o,isDisabled:r,colorScheme:l,isLoading:d,sx:m,"data-testid":e}):s.jsx(Ge,{"aria-label":e,tooltip:t,leftIcon:n,onClick:o,isDisabled:r,colorScheme:l,isLoading:d,loadingText:f??e,flexGrow:1,sx:m,"data-testid":e,children:e}),n1=u.memo(lZ),aZ=({asIconButton:e})=>{const{t}=R(),{pauseProcessor:n,isLoading:o,isDisabled:r}=FS();return s.jsx(n1,{asIconButton:e,label:t("queue.pause"),tooltip:t("queue.pauseTooltip"),isDisabled:r,isLoading:o,icon:s.jsx(sj,{}),onClick:n,colorScheme:"gold"})},iZ=u.memo(aZ),cZ=()=>{const e=J(),{t}=R(),n=j(f=>f.system.isConnected),[o,{isLoading:r}]=Qy({fixedCacheKey:"pruneQueue"}),{finishedCount:l}=Ro(void 0,{selectFromResult:({data:f})=>f?{finishedCount:f.queue.completed+f.queue.canceled+f.queue.failed}:{finishedCount:0}}),c=u.useCallback(async()=>{if(l)try{const f=await o().unwrap();e(Qe({title:t("queue.pruneSucceeded",{item_count:f.deleted}),status:"success"})),e(f0(void 0)),e(m0(void 0))}catch{e(Qe({title:t("queue.pruneFailed"),status:"error"}))}},[l,o,e,t]),d=u.useMemo(()=>!n||!l,[l,n]);return{pruneQueue:c,isLoading:r,finishedCount:l,isDisabled:d}},uZ=({asIconButton:e})=>{const{t}=R(),{pruneQueue:n,isLoading:o,finishedCount:r,isDisabled:l}=cZ();return s.jsx(n1,{isDisabled:l,isLoading:o,asIconButton:e,label:t("queue.prune"),tooltip:t("queue.pruneTooltip",{item_count:r}),icon:s.jsx(gg,{}),onClick:n,colorScheme:"invokeBlue"})},dZ=u.memo(uZ),fZ=({asIconButton:e})=>{const{t}=R(),{resumeProcessor:n,isLoading:o,isDisabled:r}=zS();return s.jsx(n1,{asIconButton:e,label:t("queue.resume"),tooltip:t("queue.resumeTooltip"),isDisabled:r,isLoading:o,icon:s.jsx(oj,{}),onClick:n,colorScheme:"green"})},mZ=u.memo(fZ),hZ=()=>{const e=Kt("pauseQueue").isFeatureEnabled,t=Kt("resumeQueue").isFeatureEnabled;return s.jsxs(L,{layerStyle:"first",borderRadius:"base",p:2,gap:2,children:[e||t?s.jsxs(wt,{w:28,orientation:"vertical",size:"sm",children:[t?s.jsx(mZ,{}):s.jsx(s.Fragment,{}),e?s.jsx(iZ,{}):s.jsx(s.Fragment,{})]}):s.jsx(s.Fragment,{}),s.jsxs(wt,{w:28,orientation:"vertical",size:"sm",children:[s.jsx(dZ,{}),s.jsx(rZ,{})]})]})},pZ=u.memo(hZ),gZ=()=>{const e=Kt("invocationCache").isFeatureEnabled;return s.jsxs(L,{borderRadius:"base",w:"full",h:"full",flexDir:"column",gap:2,children:[s.jsxs(L,{gap:2,w:"full",children:[s.jsx(pZ,{}),s.jsx(sZ,{}),e&&s.jsx(OG,{})]}),s.jsx(We,{layerStyle:"first",p:2,borderRadius:"base",w:"full",h:"full",children:s.jsx(tZ,{})})]})},xZ=u.memo(gZ),vZ=()=>s.jsx(xZ,{}),CZ=u.memo(vZ),yZ=()=>{const e=J(),t=j(ks),n=u.useCallback(()=>{(ln.get()==="move"||t)&&!Dr.get()&&Gi.set(!0)},[t]),o=u.useCallback(l=>{if(!((ln.get()==="move"||t)&&!Dr.get()))return;const d={x:l.target.x(),y:l.target.y()};e(fb(d))},[e,t]),r=u.useCallback(()=>{(ln.get()==="move"||t)&&!Dr.get()&&Gi.set(!1)},[t]);return{handleDragStart:n,handleDragMove:o,handleDragEnd:r}},bZ=e=>e.tagName.toLowerCase()==="input"||e.tagName.toLowerCase()==="textarea"||e.tagName.toLowerCase()==="select",AC=e=>e instanceof HTMLElement?e.tabIndex>-1||bZ(e)||["dialog","alertdialog"].includes(e.getAttribute("role")??""):!1,jZ=()=>{const e=J(),t=j(js),n=j(g=>g.canvas.shouldShowBoundingBox),o=j(ks),r=j(g=>g.canvas.isMaskEnabled),l=j(g=>g.canvas.shouldSnapToGrid),c=u.useCallback(()=>e(mb()),[e]);Oe(["shift+c"],()=>{c()},{enabled:()=>!o,preventDefault:!0},[]);const d=()=>e(N0(!r));Oe(["h"],()=>{d()},{enabled:()=>!o,preventDefault:!0},[r]),Oe(["n"],()=>{e(_d(!l))},{enabled:!0,preventDefault:!0},[l]),Oe("esc",()=>{$3()},{enabled:()=>!0,preventDefault:!0}),Oe("shift+h",()=>{e(V3(!n))},{enabled:()=>!o,preventDefault:!0},[t,n]);const f=u.useCallback(g=>{var p;g.repeat||g.key!==" "||AC(g.target)||t!=="unifiedCanvas"||bi.get()||ln.get()==="move"||((p=Ad.get())==null||p.container().focus(),bi.set(ln.get()),ln.set("move"),dd())},[t]),m=u.useCallback(g=>{var p;g.repeat||g.key!==" "||AC(g.target)||t!=="unifiedCanvas"||!bi.get()||ln.get()!=="move"||((p=Ad.get())==null||p.container().focus(),ln.set(bi.get()??"move"),bi.set(null))},[t]);u.useEffect(()=>(window.addEventListener("keydown",f),window.addEventListener("keyup",m),()=>{window.removeEventListener("keydown",f),window.removeEventListener("keyup",m)}),[f,m])},s1=e=>{const t=e.getPointerPosition(),n=e.getAbsoluteTransform().copy();if(!t||!n)return;const o=n.invert().point(t);return{x:o.x,y:o.y}},e4=()=>{const e=J(),t=u.useCallback(()=>{const o=Ad.get(),r=F0.get();if(!o||!r)return;const l=o.getPointerPosition();if(!l)return;const c=W3.pixelRatio,[d,f,m,g]=r.getContext().getImageData(l.x*c,l.y*c,1,1).data;d===void 0||f===void 0||m===void 0||g===void 0||e(U3({r:d,g:f,b:m,a:g}))},[e]),n=u.useCallback(()=>{e(G3()),ln.set("brush")},[e]);return{updateColorUnderCursor:t,commitColorUnderCursor:n}},SZ=e=>{const t=J(),n=j(ks),{commitColorUnderCursor:o}=e4();return u.useCallback(r=>{if(!e.current)return;e.current.container().focus();const l=ln.get();if(l==="move"||n){Gi.set(!0);return}if(l==="colorPicker"){o();return}const c=s1(e.current);c&&(r.evt.preventDefault(),Zi.set(!0),t(Z3({points:[c.x,c.y],tool:l})))},[e,n,t,o])},kZ=(e,t,n)=>{const o=J(),r=j(ks),{updateColorUnderCursor:l}=e4();return u.useCallback(()=>{if(!e.current)return;const c=s1(e.current);if(!c)return;z0.set(c),n.current=c;const d=ln.get();if(d==="colorPicker"){l();return}!Zi.get()||d==="move"||r||(t.current=!0,o(hb([c.x,c.y])))},[t,o,r,n,e,l])},wZ=()=>u.useCallback(()=>{q3()},[]),IZ=(e,t)=>{const n=J(),o=gt(Zi),r=j(ks);return u.useCallback(()=>{if(ln.get()==="move"||r){Gi.set(!1);return}if(!t.current&&o&&e.current){const l=s1(e.current);if(!l)return;n(hb([l.x,l.y]))}else t.current=!1;Zi.set(!1)},[t,n,o,r,e])},MZ=e=>{const t=J(),n=j(l=>l.canvas.stageScale),o=gt(Q3),r=j(l=>l.canvas.brushSize);return u.useCallback(l=>{if(!(!e.current||o))if(l.evt.preventDefault(),K3.get()||Y3.get()){const c=Math.sign(l.evt.deltaY)*.7363*Math.pow(1.0394,r),d=Xo(c,-20,20),f=Xo(r+d,1,500);t(_i(f))}else{const c=e.current.getPointerPosition();let d=l.evt.deltaY;if(!c)return;const f={x:(c.x-e.current.x())/n,y:(c.y-e.current.y())/n};l.evt.ctrlKey&&(d=-d);const m=Xo(n*e9**d,J3,X3),g={x:c.x-f.x*m,y:c.y-f.y*m};t(t9(m)),t(fb(g))}},[e,o,n,t,r])};var l0={exports:{}};(function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.Konva=void 0;var n=f2;Object.defineProperty(t,"Konva",{enumerable:!0,get:function(){return n.Konva}});const o=f2;e.exports=o.Konva})(l0,l0.exports);var _Z=l0.exports;const ac=ic(_Z);var t4={exports:{}};/**
 * @license React
 * react-reconciler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var AZ=function(t){var n={},o=u,r=fd,l=Object.assign;function c(a){for(var i="https://reactjs.org/docs/error-decoder.html?invariant="+a,h=1;h<arguments.length;h++)i+="&args[]="+encodeURIComponent(arguments[h]);return"Minified React error #"+a+"; visit "+i+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var d=o.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,f=Symbol.for("react.element"),m=Symbol.for("react.portal"),g=Symbol.for("react.fragment"),p=Symbol.for("react.strict_mode"),x=Symbol.for("react.profiler"),y=Symbol.for("react.provider"),S=Symbol.for("react.context"),b=Symbol.for("react.forward_ref"),I=Symbol.for("react.suspense"),M=Symbol.for("react.suspense_list"),w=Symbol.for("react.memo"),_=Symbol.for("react.lazy"),T=Symbol.for("react.offscreen"),D=Symbol.iterator;function A(a){return a===null||typeof a!="object"?null:(a=D&&a[D]||a["@@iterator"],typeof a=="function"?a:null)}function F(a){if(a==null)return null;if(typeof a=="function")return a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case g:return"Fragment";case m:return"Portal";case x:return"Profiler";case p:return"StrictMode";case I:return"Suspense";case M:return"SuspenseList"}if(typeof a=="object")switch(a.$$typeof){case S:return(a.displayName||"Context")+".Consumer";case y:return(a._context.displayName||"Context")+".Provider";case b:var i=a.render;return a=a.displayName,a||(a=i.displayName||i.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case w:return i=a.displayName||null,i!==null?i:F(a.type)||"Memo";case _:i=a._payload,a=a._init;try{return F(a(i))}catch{}}return null}function Q(a){var i=a.type;switch(a.tag){case 24:return"Cache";case 9:return(i.displayName||"Context")+".Consumer";case 10:return(i._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=i.render,a=a.displayName||a.name||"",i.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 5:return i;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return F(i);case 8:return i===p?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof i=="function")return i.displayName||i.name||null;if(typeof i=="string")return i}return null}function q(a){var i=a,h=a;if(a.alternate)for(;i.return;)i=i.return;else{a=i;do i=a,i.flags&4098&&(h=i.return),a=i.return;while(a)}return i.tag===3?h:null}function G(a){if(q(a)!==a)throw Error(c(188))}function Z(a){var i=a.alternate;if(!i){if(i=q(a),i===null)throw Error(c(188));return i!==a?null:a}for(var h=a,v=i;;){var C=h.return;if(C===null)break;var k=C.alternate;if(k===null){if(v=C.return,v!==null){h=v;continue}break}if(C.child===k.child){for(k=C.child;k;){if(k===h)return G(C),a;if(k===v)return G(C),i;k=k.sibling}throw Error(c(188))}if(h.return!==v.return)h=C,v=k;else{for(var E=!1,X=C.child;X;){if(X===h){E=!0,h=C,v=k;break}if(X===v){E=!0,v=C,h=k;break}X=X.sibling}if(!E){for(X=k.child;X;){if(X===h){E=!0,h=k,v=C;break}if(X===v){E=!0,v=k,h=C;break}X=X.sibling}if(!E)throw Error(c(189))}}if(h.alternate!==v)throw Error(c(190))}if(h.tag!==3)throw Error(c(188));return h.stateNode.current===h?a:i}function N(a){return a=Z(a),a!==null?z(a):null}function z(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){var i=z(a);if(i!==null)return i;a=a.sibling}return null}function $(a){if(a.tag===5||a.tag===6)return a;for(a=a.child;a!==null;){if(a.tag!==4){var i=$(a);if(i!==null)return i}a=a.sibling}return null}var se=Array.isArray,he=t.getPublicInstance,ke=t.getRootHostContext,Ce=t.getChildHostContext,ge=t.prepareForCommit,De=t.resetAfterCommit,Se=t.createInstance,oe=t.appendInitialChild,re=t.finalizeInitialChildren,de=t.prepareUpdate,P=t.shouldSetTextContent,B=t.createTextInstance,H=t.scheduleTimeout,V=t.cancelTimeout,le=t.noTimeout,fe=t.isPrimaryRenderer,ue=t.supportsMutation,xe=t.supportsPersistence,W=t.supportsHydration,Me=t.getInstanceFromNode,ye=t.preparePortalMount,Pe=t.getCurrentEventPriority,Ve=t.detachDeletedInstance,Ye=t.supportsMicrotasks,O=t.scheduleMicrotask,ne=t.supportsTestSelectors,ce=t.findFiberRoot,_e=t.getBoundingRect,be=t.getTextContent,K=t.isHiddenSubtree,ve=t.matchAccessibilityRole,Ee=t.setFocusIfFocusable,Ze=t.setupIntersectionObserver,lt=t.appendChild,St=t.appendChildToContainer,Ot=t.commitTextUpdate,Xt=t.commitMount,Jt=t.commitUpdate,xn=t.insertBefore,on=t.insertInContainerBefore,en=t.removeChild,Tt=t.removeChildFromContainer,is=t.resetTextContent,cn=t.hideInstance,_s=t.hideTextInstance,Hl=t.unhideInstance,rm=t.unhideTextInstance,lm=t.clearContainer,Oo=t.cloneInstance,No=t.createContainerChildSet,co=t.appendChildToContainerChildSet,am=t.finalizeContainerChildren,uo=t.replaceContainerChildren,Bc=t.cloneHiddenInstance,$l=t.cloneHiddenTextInstance,Xa=t.canHydrateInstance,Ja=t.canHydrateTextInstance,Oc=t.canHydrateSuspenseInstance,Nc=t.isSuspenseInstancePending,Vl=t.isSuspenseInstanceFallback,f4=t.getSuspenseInstanceFallbackErrorDetails,m4=t.registerSuspenseInstanceRetry,Fc=t.getNextHydratableSibling,h4=t.getFirstHydratableChild,p4=t.getFirstHydratableChildWithinContainer,g4=t.getFirstHydratableChildWithinSuspenseInstance,x4=t.hydrateInstance,v4=t.hydrateTextInstance,C4=t.hydrateSuspenseInstance,y4=t.getNextHydratableInstanceAfterSuspenseInstance,b4=t.commitHydratedContainer,j4=t.commitHydratedSuspenseInstance,S4=t.clearSuspenseBoundary,k4=t.clearSuspenseBoundaryFromContainer,w4=t.shouldDeleteUnhydratedTailInstances,I4=t.didNotMatchHydratedContainerTextInstance,M4=t.didNotMatchHydratedTextInstance,im;function ei(a){if(im===void 0)try{throw Error()}catch(h){var i=h.stack.trim().match(/\n( *(at )?)/);im=i&&i[1]||""}return`
`+im+a}var cm=!1;function um(a,i){if(!a||cm)return"";cm=!0;var h=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(i)if(i=function(){throw Error()},Object.defineProperty(i.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(i,[])}catch(Ae){var v=Ae}Reflect.construct(a,[],i)}else{try{i.call()}catch(Ae){v=Ae}a.call(i.prototype)}else{try{throw Error()}catch(Ae){v=Ae}a()}}catch(Ae){if(Ae&&v&&typeof Ae.stack=="string"){for(var C=Ae.stack.split(`
`),k=v.stack.split(`
`),E=C.length-1,X=k.length-1;1<=E&&0<=X&&C[E]!==k[X];)X--;for(;1<=E&&0<=X;E--,X--)if(C[E]!==k[X]){if(E!==1||X!==1)do if(E--,X--,0>X||C[E]!==k[X]){var ie=`
`+C[E].replace(" at new "," at ");return a.displayName&&ie.includes("<anonymous>")&&(ie=ie.replace("<anonymous>",a.displayName)),ie}while(1<=E&&0<=X);break}}}finally{cm=!1,Error.prepareStackTrace=h}return(a=a?a.displayName||a.name:"")?ei(a):""}var _4=Object.prototype.hasOwnProperty,dm=[],Wl=-1;function mr(a){return{current:a}}function Nt(a){0>Wl||(a.current=dm[Wl],dm[Wl]=null,Wl--)}function Rt(a,i){Wl++,dm[Wl]=a.current,a.current=i}var hr={},En=mr(hr),Un=mr(!1),rl=hr;function Ul(a,i){var h=a.type.contextTypes;if(!h)return hr;var v=a.stateNode;if(v&&v.__reactInternalMemoizedUnmaskedChildContext===i)return v.__reactInternalMemoizedMaskedChildContext;var C={},k;for(k in h)C[k]=i[k];return v&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=i,a.__reactInternalMemoizedMaskedChildContext=C),C}function Gn(a){return a=a.childContextTypes,a!=null}function zc(){Nt(Un),Nt(En)}function l1(a,i,h){if(En.current!==hr)throw Error(c(168));Rt(En,i),Rt(Un,h)}function a1(a,i,h){var v=a.stateNode;if(i=i.childContextTypes,typeof v.getChildContext!="function")return h;v=v.getChildContext();for(var C in v)if(!(C in i))throw Error(c(108,Q(a)||"Unknown",C));return l({},h,v)}function Hc(a){return a=(a=a.stateNode)&&a.__reactInternalMemoizedMergedChildContext||hr,rl=En.current,Rt(En,a),Rt(Un,Un.current),!0}function i1(a,i,h){var v=a.stateNode;if(!v)throw Error(c(169));h?(a=a1(a,i,rl),v.__reactInternalMemoizedMergedChildContext=a,Nt(Un),Nt(En),Rt(En,a)):Nt(Un),Rt(Un,h)}var Ws=Math.clz32?Math.clz32:E4,A4=Math.log,P4=Math.LN2;function E4(a){return a>>>=0,a===0?32:31-(A4(a)/P4|0)|0}var $c=64,Vc=4194304;function ti(a){switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return a&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return a}}function Wc(a,i){var h=a.pendingLanes;if(h===0)return 0;var v=0,C=a.suspendedLanes,k=a.pingedLanes,E=h&268435455;if(E!==0){var X=E&~C;X!==0?v=ti(X):(k&=E,k!==0&&(v=ti(k)))}else E=h&~C,E!==0?v=ti(E):k!==0&&(v=ti(k));if(v===0)return 0;if(i!==0&&i!==v&&!(i&C)&&(C=v&-v,k=i&-i,C>=k||C===16&&(k&4194240)!==0))return i;if(v&4&&(v|=h&16),i=a.entangledLanes,i!==0)for(a=a.entanglements,i&=v;0<i;)h=31-Ws(i),C=1<<h,v|=a[h],i&=~C;return v}function D4(a,i){switch(a){case 1:case 2:case 4:return i+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return i+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function L4(a,i){for(var h=a.suspendedLanes,v=a.pingedLanes,C=a.expirationTimes,k=a.pendingLanes;0<k;){var E=31-Ws(k),X=1<<E,ie=C[E];ie===-1?(!(X&h)||X&v)&&(C[E]=D4(X,i)):ie<=i&&(a.expiredLanes|=X),k&=~X}}function fm(a){return a=a.pendingLanes&-1073741825,a!==0?a:a&1073741824?1073741824:0}function c1(){var a=$c;return $c<<=1,!($c&4194240)&&($c=64),a}function mm(a){for(var i=[],h=0;31>h;h++)i.push(a);return i}function ni(a,i,h){a.pendingLanes|=i,i!==536870912&&(a.suspendedLanes=0,a.pingedLanes=0),a=a.eventTimes,i=31-Ws(i),a[i]=h}function T4(a,i){var h=a.pendingLanes&~i;a.pendingLanes=i,a.suspendedLanes=0,a.pingedLanes=0,a.expiredLanes&=i,a.mutableReadLanes&=i,a.entangledLanes&=i,i=a.entanglements;var v=a.eventTimes;for(a=a.expirationTimes;0<h;){var C=31-Ws(h),k=1<<C;i[C]=0,v[C]=-1,a[C]=-1,h&=~k}}function hm(a,i){var h=a.entangledLanes|=i;for(a=a.entanglements;h;){var v=31-Ws(h),C=1<<v;C&i|a[v]&i&&(a[v]|=i),h&=~C}}var xt=0;function u1(a){return a&=-a,1<a?4<a?a&268435455?16:536870912:4:1}var pm=r.unstable_scheduleCallback,d1=r.unstable_cancelCallback,R4=r.unstable_shouldYield,B4=r.unstable_requestPaint,vn=r.unstable_now,gm=r.unstable_ImmediatePriority,O4=r.unstable_UserBlockingPriority,xm=r.unstable_NormalPriority,N4=r.unstable_IdlePriority,Uc=null,fo=null;function F4(a){if(fo&&typeof fo.onCommitFiberRoot=="function")try{fo.onCommitFiberRoot(Uc,a,void 0,(a.current.flags&128)===128)}catch{}}function z4(a,i){return a===i&&(a!==0||1/a===1/i)||a!==a&&i!==i}var Us=typeof Object.is=="function"?Object.is:z4,Fo=null,Gc=!1,vm=!1;function f1(a){Fo===null?Fo=[a]:Fo.push(a)}function H4(a){Gc=!0,f1(a)}function mo(){if(!vm&&Fo!==null){vm=!0;var a=0,i=xt;try{var h=Fo;for(xt=1;a<h.length;a++){var v=h[a];do v=v(!0);while(v!==null)}Fo=null,Gc=!1}catch(C){throw Fo!==null&&(Fo=Fo.slice(a+1)),pm(gm,mo),C}finally{xt=i,vm=!1}}return null}var Gl=[],Zl=0,Zc=null,qc=0,As=[],Ps=0,ll=null,zo=1,Ho="";function al(a,i){Gl[Zl++]=qc,Gl[Zl++]=Zc,Zc=a,qc=i}function m1(a,i,h){As[Ps++]=zo,As[Ps++]=Ho,As[Ps++]=ll,ll=a;var v=zo;a=Ho;var C=32-Ws(v)-1;v&=~(1<<C),h+=1;var k=32-Ws(i)+C;if(30<k){var E=C-C%5;k=(v&(1<<E)-1).toString(32),v>>=E,C-=E,zo=1<<32-Ws(i)+C|h<<C|v,Ho=k+a}else zo=1<<k|h<<C|v,Ho=a}function Cm(a){a.return!==null&&(al(a,1),m1(a,1,0))}function ym(a){for(;a===Zc;)Zc=Gl[--Zl],Gl[Zl]=null,qc=Gl[--Zl],Gl[Zl]=null;for(;a===ll;)ll=As[--Ps],As[Ps]=null,Ho=As[--Ps],As[Ps]=null,zo=As[--Ps],As[Ps]=null}var cs=null,Es=null,Ht=!1,si=!1,Gs=null;function h1(a,i){var h=Bs(5,null,null,0);h.elementType="DELETED",h.stateNode=i,h.return=a,i=a.deletions,i===null?(a.deletions=[h],a.flags|=16):i.push(h)}function p1(a,i){switch(a.tag){case 5:return i=Xa(i,a.type,a.pendingProps),i!==null?(a.stateNode=i,cs=a,Es=h4(i),!0):!1;case 6:return i=Ja(i,a.pendingProps),i!==null?(a.stateNode=i,cs=a,Es=null,!0):!1;case 13:if(i=Oc(i),i!==null){var h=ll!==null?{id:zo,overflow:Ho}:null;return a.memoizedState={dehydrated:i,treeContext:h,retryLane:1073741824},h=Bs(18,null,null,0),h.stateNode=i,h.return=a,a.child=h,cs=a,Es=null,!0}return!1;default:return!1}}function bm(a){return(a.mode&1)!==0&&(a.flags&128)===0}function jm(a){if(Ht){var i=Es;if(i){var h=i;if(!p1(a,i)){if(bm(a))throw Error(c(418));i=Fc(h);var v=cs;i&&p1(a,i)?h1(v,h):(a.flags=a.flags&-4097|2,Ht=!1,cs=a)}}else{if(bm(a))throw Error(c(418));a.flags=a.flags&-4097|2,Ht=!1,cs=a}}}function g1(a){for(a=a.return;a!==null&&a.tag!==5&&a.tag!==3&&a.tag!==13;)a=a.return;cs=a}function Qc(a){if(!W||a!==cs)return!1;if(!Ht)return g1(a),Ht=!0,!1;if(a.tag!==3&&(a.tag!==5||w4(a.type)&&!P(a.type,a.memoizedProps))){var i=Es;if(i){if(bm(a))throw x1(),Error(c(418));for(;i;)h1(a,i),i=Fc(i)}}if(g1(a),a.tag===13){if(!W)throw Error(c(316));if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error(c(317));Es=y4(a)}else Es=cs?Fc(a.stateNode):null;return!0}function x1(){for(var a=Es;a;)a=Fc(a)}function ql(){W&&(Es=cs=null,si=Ht=!1)}function Sm(a){Gs===null?Gs=[a]:Gs.push(a)}var $4=d.ReactCurrentBatchConfig;function Kc(a,i){if(Us(a,i))return!0;if(typeof a!="object"||a===null||typeof i!="object"||i===null)return!1;var h=Object.keys(a),v=Object.keys(i);if(h.length!==v.length)return!1;for(v=0;v<h.length;v++){var C=h[v];if(!_4.call(i,C)||!Us(a[C],i[C]))return!1}return!0}function V4(a){switch(a.tag){case 5:return ei(a.type);case 16:return ei("Lazy");case 13:return ei("Suspense");case 19:return ei("SuspenseList");case 0:case 2:case 15:return a=um(a.type,!1),a;case 11:return a=um(a.type.render,!1),a;case 1:return a=um(a.type,!0),a;default:return""}}function Zs(a,i){if(a&&a.defaultProps){i=l({},i),a=a.defaultProps;for(var h in a)i[h]===void 0&&(i[h]=a[h]);return i}return i}var Yc=mr(null),Xc=null,Ql=null,km=null;function wm(){km=Ql=Xc=null}function v1(a,i,h){fe?(Rt(Yc,i._currentValue),i._currentValue=h):(Rt(Yc,i._currentValue2),i._currentValue2=h)}function Im(a){var i=Yc.current;Nt(Yc),fe?a._currentValue=i:a._currentValue2=i}function Mm(a,i,h){for(;a!==null;){var v=a.alternate;if((a.childLanes&i)!==i?(a.childLanes|=i,v!==null&&(v.childLanes|=i)):v!==null&&(v.childLanes&i)!==i&&(v.childLanes|=i),a===h)break;a=a.return}}function Kl(a,i){Xc=a,km=Ql=null,a=a.dependencies,a!==null&&a.firstContext!==null&&(a.lanes&i&&(Zn=!0),a.firstContext=null)}function Ds(a){var i=fe?a._currentValue:a._currentValue2;if(km!==a)if(a={context:a,memoizedValue:i,next:null},Ql===null){if(Xc===null)throw Error(c(308));Ql=a,Xc.dependencies={lanes:0,firstContext:a}}else Ql=Ql.next=a;return i}var il=null;function _m(a){il===null?il=[a]:il.push(a)}function C1(a,i,h,v){var C=i.interleaved;return C===null?(h.next=h,_m(i)):(h.next=C.next,C.next=h),i.interleaved=h,ho(a,v)}function ho(a,i){a.lanes|=i;var h=a.alternate;for(h!==null&&(h.lanes|=i),h=a,a=a.return;a!==null;)a.childLanes|=i,h=a.alternate,h!==null&&(h.childLanes|=i),h=a,a=a.return;return h.tag===3?h.stateNode:null}var pr=!1;function Am(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function y1(a,i){a=a.updateQueue,i.updateQueue===a&&(i.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,effects:a.effects})}function $o(a,i){return{eventTime:a,lane:i,tag:0,payload:null,callback:null,next:null}}function gr(a,i,h){var v=a.updateQueue;if(v===null)return null;if(v=v.shared,ut&2){var C=v.pending;return C===null?i.next=i:(i.next=C.next,C.next=i),v.pending=i,ho(a,h)}return C=v.interleaved,C===null?(i.next=i,_m(v)):(i.next=C.next,C.next=i),v.interleaved=i,ho(a,h)}function Jc(a,i,h){if(i=i.updateQueue,i!==null&&(i=i.shared,(h&4194240)!==0)){var v=i.lanes;v&=a.pendingLanes,h|=v,i.lanes=h,hm(a,h)}}function b1(a,i){var h=a.updateQueue,v=a.alternate;if(v!==null&&(v=v.updateQueue,h===v)){var C=null,k=null;if(h=h.firstBaseUpdate,h!==null){do{var E={eventTime:h.eventTime,lane:h.lane,tag:h.tag,payload:h.payload,callback:h.callback,next:null};k===null?C=k=E:k=k.next=E,h=h.next}while(h!==null);k===null?C=k=i:k=k.next=i}else C=k=i;h={baseState:v.baseState,firstBaseUpdate:C,lastBaseUpdate:k,shared:v.shared,effects:v.effects},a.updateQueue=h;return}a=h.lastBaseUpdate,a===null?h.firstBaseUpdate=i:a.next=i,h.lastBaseUpdate=i}function eu(a,i,h,v){var C=a.updateQueue;pr=!1;var k=C.firstBaseUpdate,E=C.lastBaseUpdate,X=C.shared.pending;if(X!==null){C.shared.pending=null;var ie=X,Ae=ie.next;ie.next=null,E===null?k=Ae:E.next=Ae,E=ie;var ze=a.alternate;ze!==null&&(ze=ze.updateQueue,X=ze.lastBaseUpdate,X!==E&&(X===null?ze.firstBaseUpdate=Ae:X.next=Ae,ze.lastBaseUpdate=ie))}if(k!==null){var nt=C.baseState;E=0,ze=Ae=ie=null,X=k;do{var Re=X.lane,Ft=X.eventTime;if((v&Re)===Re){ze!==null&&(ze=ze.next={eventTime:Ft,lane:0,tag:X.tag,payload:X.payload,callback:X.callback,next:null});e:{var Et=a,Kn=X;switch(Re=i,Ft=h,Kn.tag){case 1:if(Et=Kn.payload,typeof Et=="function"){nt=Et.call(Ft,nt,Re);break e}nt=Et;break e;case 3:Et.flags=Et.flags&-65537|128;case 0:if(Et=Kn.payload,Re=typeof Et=="function"?Et.call(Ft,nt,Re):Et,Re==null)break e;nt=l({},nt,Re);break e;case 2:pr=!0}}X.callback!==null&&X.lane!==0&&(a.flags|=64,Re=C.effects,Re===null?C.effects=[X]:Re.push(X))}else Ft={eventTime:Ft,lane:Re,tag:X.tag,payload:X.payload,callback:X.callback,next:null},ze===null?(Ae=ze=Ft,ie=nt):ze=ze.next=Ft,E|=Re;if(X=X.next,X===null){if(X=C.shared.pending,X===null)break;Re=X,X=Re.next,Re.next=null,C.lastBaseUpdate=Re,C.shared.pending=null}}while(!0);if(ze===null&&(ie=nt),C.baseState=ie,C.firstBaseUpdate=Ae,C.lastBaseUpdate=ze,i=C.shared.interleaved,i!==null){C=i;do E|=C.lane,C=C.next;while(C!==i)}else k===null&&(C.shared.lanes=0);ul|=E,a.lanes=E,a.memoizedState=nt}}function j1(a,i,h){if(a=i.effects,i.effects=null,a!==null)for(i=0;i<a.length;i++){var v=a[i],C=v.callback;if(C!==null){if(v.callback=null,v=h,typeof C!="function")throw Error(c(191,C));C.call(v)}}}var S1=new o.Component().refs;function Pm(a,i,h,v){i=a.memoizedState,h=h(v,i),h=h==null?i:l({},i,h),a.memoizedState=h,a.lanes===0&&(a.updateQueue.baseState=h)}var tu={isMounted:function(a){return(a=a._reactInternals)?q(a)===a:!1},enqueueSetState:function(a,i,h){a=a._reactInternals;var v=Rn(),C=Cr(a),k=$o(v,C);k.payload=i,h!=null&&(k.callback=h),i=gr(a,k,C),i!==null&&(Rs(i,a,C,v),Jc(i,a,C))},enqueueReplaceState:function(a,i,h){a=a._reactInternals;var v=Rn(),C=Cr(a),k=$o(v,C);k.tag=1,k.payload=i,h!=null&&(k.callback=h),i=gr(a,k,C),i!==null&&(Rs(i,a,C,v),Jc(i,a,C))},enqueueForceUpdate:function(a,i){a=a._reactInternals;var h=Rn(),v=Cr(a),C=$o(h,v);C.tag=2,i!=null&&(C.callback=i),i=gr(a,C,v),i!==null&&(Rs(i,a,v,h),Jc(i,a,v))}};function k1(a,i,h,v,C,k,E){return a=a.stateNode,typeof a.shouldComponentUpdate=="function"?a.shouldComponentUpdate(v,k,E):i.prototype&&i.prototype.isPureReactComponent?!Kc(h,v)||!Kc(C,k):!0}function w1(a,i,h){var v=!1,C=hr,k=i.contextType;return typeof k=="object"&&k!==null?k=Ds(k):(C=Gn(i)?rl:En.current,v=i.contextTypes,k=(v=v!=null)?Ul(a,C):hr),i=new i(h,k),a.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,i.updater=tu,a.stateNode=i,i._reactInternals=a,v&&(a=a.stateNode,a.__reactInternalMemoizedUnmaskedChildContext=C,a.__reactInternalMemoizedMaskedChildContext=k),i}function I1(a,i,h,v){a=i.state,typeof i.componentWillReceiveProps=="function"&&i.componentWillReceiveProps(h,v),typeof i.UNSAFE_componentWillReceiveProps=="function"&&i.UNSAFE_componentWillReceiveProps(h,v),i.state!==a&&tu.enqueueReplaceState(i,i.state,null)}function Em(a,i,h,v){var C=a.stateNode;C.props=h,C.state=a.memoizedState,C.refs=S1,Am(a);var k=i.contextType;typeof k=="object"&&k!==null?C.context=Ds(k):(k=Gn(i)?rl:En.current,C.context=Ul(a,k)),C.state=a.memoizedState,k=i.getDerivedStateFromProps,typeof k=="function"&&(Pm(a,i,k,h),C.state=a.memoizedState),typeof i.getDerivedStateFromProps=="function"||typeof C.getSnapshotBeforeUpdate=="function"||typeof C.UNSAFE_componentWillMount!="function"&&typeof C.componentWillMount!="function"||(i=C.state,typeof C.componentWillMount=="function"&&C.componentWillMount(),typeof C.UNSAFE_componentWillMount=="function"&&C.UNSAFE_componentWillMount(),i!==C.state&&tu.enqueueReplaceState(C,C.state,null),eu(a,h,C,v),C.state=a.memoizedState),typeof C.componentDidMount=="function"&&(a.flags|=4194308)}function oi(a,i,h){if(a=h.ref,a!==null&&typeof a!="function"&&typeof a!="object"){if(h._owner){if(h=h._owner,h){if(h.tag!==1)throw Error(c(309));var v=h.stateNode}if(!v)throw Error(c(147,a));var C=v,k=""+a;return i!==null&&i.ref!==null&&typeof i.ref=="function"&&i.ref._stringRef===k?i.ref:(i=function(E){var X=C.refs;X===S1&&(X=C.refs={}),E===null?delete X[k]:X[k]=E},i._stringRef=k,i)}if(typeof a!="string")throw Error(c(284));if(!h._owner)throw Error(c(290,a))}return a}function nu(a,i){throw a=Object.prototype.toString.call(i),Error(c(31,a==="[object Object]"?"object with keys {"+Object.keys(i).join(", ")+"}":a))}function M1(a){var i=a._init;return i(a._payload)}function _1(a){function i(ae,ee){if(a){var me=ae.deletions;me===null?(ae.deletions=[ee],ae.flags|=16):me.push(ee)}}function h(ae,ee){if(!a)return null;for(;ee!==null;)i(ae,ee),ee=ee.sibling;return null}function v(ae,ee){for(ae=new Map;ee!==null;)ee.key!==null?ae.set(ee.key,ee):ae.set(ee.index,ee),ee=ee.sibling;return ae}function C(ae,ee){return ae=br(ae,ee),ae.index=0,ae.sibling=null,ae}function k(ae,ee,me){return ae.index=me,a?(me=ae.alternate,me!==null?(me=me.index,me<ee?(ae.flags|=2,ee):me):(ae.flags|=2,ee)):(ae.flags|=1048576,ee)}function E(ae){return a&&ae.alternate===null&&(ae.flags|=2),ae}function X(ae,ee,me,Be){return ee===null||ee.tag!==6?(ee=vh(me,ae.mode,Be),ee.return=ae,ee):(ee=C(ee,me),ee.return=ae,ee)}function ie(ae,ee,me,Be){var Ke=me.type;return Ke===g?ze(ae,ee,me.props.children,Be,me.key):ee!==null&&(ee.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===_&&M1(Ke)===ee.type)?(Be=C(ee,me.props),Be.ref=oi(ae,ee,me),Be.return=ae,Be):(Be=_u(me.type,me.key,me.props,null,ae.mode,Be),Be.ref=oi(ae,ee,me),Be.return=ae,Be)}function Ae(ae,ee,me,Be){return ee===null||ee.tag!==4||ee.stateNode.containerInfo!==me.containerInfo||ee.stateNode.implementation!==me.implementation?(ee=Ch(me,ae.mode,Be),ee.return=ae,ee):(ee=C(ee,me.children||[]),ee.return=ae,ee)}function ze(ae,ee,me,Be,Ke){return ee===null||ee.tag!==7?(ee=hl(me,ae.mode,Be,Ke),ee.return=ae,ee):(ee=C(ee,me),ee.return=ae,ee)}function nt(ae,ee,me){if(typeof ee=="string"&&ee!==""||typeof ee=="number")return ee=vh(""+ee,ae.mode,me),ee.return=ae,ee;if(typeof ee=="object"&&ee!==null){switch(ee.$$typeof){case f:return me=_u(ee.type,ee.key,ee.props,null,ae.mode,me),me.ref=oi(ae,null,ee),me.return=ae,me;case m:return ee=Ch(ee,ae.mode,me),ee.return=ae,ee;case _:var Be=ee._init;return nt(ae,Be(ee._payload),me)}if(se(ee)||A(ee))return ee=hl(ee,ae.mode,me,null),ee.return=ae,ee;nu(ae,ee)}return null}function Re(ae,ee,me,Be){var Ke=ee!==null?ee.key:null;if(typeof me=="string"&&me!==""||typeof me=="number")return Ke!==null?null:X(ae,ee,""+me,Be);if(typeof me=="object"&&me!==null){switch(me.$$typeof){case f:return me.key===Ke?ie(ae,ee,me,Be):null;case m:return me.key===Ke?Ae(ae,ee,me,Be):null;case _:return Ke=me._init,Re(ae,ee,Ke(me._payload),Be)}if(se(me)||A(me))return Ke!==null?null:ze(ae,ee,me,Be,null);nu(ae,me)}return null}function Ft(ae,ee,me,Be,Ke){if(typeof Be=="string"&&Be!==""||typeof Be=="number")return ae=ae.get(me)||null,X(ee,ae,""+Be,Ke);if(typeof Be=="object"&&Be!==null){switch(Be.$$typeof){case f:return ae=ae.get(Be.key===null?me:Be.key)||null,ie(ee,ae,Be,Ke);case m:return ae=ae.get(Be.key===null?me:Be.key)||null,Ae(ee,ae,Be,Ke);case _:var at=Be._init;return Ft(ae,ee,me,at(Be._payload),Ke)}if(se(Be)||A(Be))return ae=ae.get(me)||null,ze(ee,ae,Be,Ke,null);nu(ee,Be)}return null}function Et(ae,ee,me,Be){for(var Ke=null,at=null,st=ee,vt=ee=0,bn=null;st!==null&&vt<me.length;vt++){st.index>vt?(bn=st,st=null):bn=st.sibling;var Ct=Re(ae,st,me[vt],Be);if(Ct===null){st===null&&(st=bn);break}a&&st&&Ct.alternate===null&&i(ae,st),ee=k(Ct,ee,vt),at===null?Ke=Ct:at.sibling=Ct,at=Ct,st=bn}if(vt===me.length)return h(ae,st),Ht&&al(ae,vt),Ke;if(st===null){for(;vt<me.length;vt++)st=nt(ae,me[vt],Be),st!==null&&(ee=k(st,ee,vt),at===null?Ke=st:at.sibling=st,at=st);return Ht&&al(ae,vt),Ke}for(st=v(ae,st);vt<me.length;vt++)bn=Ft(st,ae,vt,me[vt],Be),bn!==null&&(a&&bn.alternate!==null&&st.delete(bn.key===null?vt:bn.key),ee=k(bn,ee,vt),at===null?Ke=bn:at.sibling=bn,at=bn);return a&&st.forEach(function(jr){return i(ae,jr)}),Ht&&al(ae,vt),Ke}function Kn(ae,ee,me,Be){var Ke=A(me);if(typeof Ke!="function")throw Error(c(150));if(me=Ke.call(me),me==null)throw Error(c(151));for(var at=Ke=null,st=ee,vt=ee=0,bn=null,Ct=me.next();st!==null&&!Ct.done;vt++,Ct=me.next()){st.index>vt?(bn=st,st=null):bn=st.sibling;var jr=Re(ae,st,Ct.value,Be);if(jr===null){st===null&&(st=bn);break}a&&st&&jr.alternate===null&&i(ae,st),ee=k(jr,ee,vt),at===null?Ke=jr:at.sibling=jr,at=jr,st=bn}if(Ct.done)return h(ae,st),Ht&&al(ae,vt),Ke;if(st===null){for(;!Ct.done;vt++,Ct=me.next())Ct=nt(ae,Ct.value,Be),Ct!==null&&(ee=k(Ct,ee,vt),at===null?Ke=Ct:at.sibling=Ct,at=Ct);return Ht&&al(ae,vt),Ke}for(st=v(ae,st);!Ct.done;vt++,Ct=me.next())Ct=Ft(st,ae,vt,Ct.value,Be),Ct!==null&&(a&&Ct.alternate!==null&&st.delete(Ct.key===null?vt:Ct.key),ee=k(Ct,ee,vt),at===null?Ke=Ct:at.sibling=Ct,at=Ct);return a&&st.forEach(function(C5){return i(ae,C5)}),Ht&&al(ae,vt),Ke}function Uo(ae,ee,me,Be){if(typeof me=="object"&&me!==null&&me.type===g&&me.key===null&&(me=me.props.children),typeof me=="object"&&me!==null){switch(me.$$typeof){case f:e:{for(var Ke=me.key,at=ee;at!==null;){if(at.key===Ke){if(Ke=me.type,Ke===g){if(at.tag===7){h(ae,at.sibling),ee=C(at,me.props.children),ee.return=ae,ae=ee;break e}}else if(at.elementType===Ke||typeof Ke=="object"&&Ke!==null&&Ke.$$typeof===_&&M1(Ke)===at.type){h(ae,at.sibling),ee=C(at,me.props),ee.ref=oi(ae,at,me),ee.return=ae,ae=ee;break e}h(ae,at);break}else i(ae,at);at=at.sibling}me.type===g?(ee=hl(me.props.children,ae.mode,Be,me.key),ee.return=ae,ae=ee):(Be=_u(me.type,me.key,me.props,null,ae.mode,Be),Be.ref=oi(ae,ee,me),Be.return=ae,ae=Be)}return E(ae);case m:e:{for(at=me.key;ee!==null;){if(ee.key===at)if(ee.tag===4&&ee.stateNode.containerInfo===me.containerInfo&&ee.stateNode.implementation===me.implementation){h(ae,ee.sibling),ee=C(ee,me.children||[]),ee.return=ae,ae=ee;break e}else{h(ae,ee);break}else i(ae,ee);ee=ee.sibling}ee=Ch(me,ae.mode,Be),ee.return=ae,ae=ee}return E(ae);case _:return at=me._init,Uo(ae,ee,at(me._payload),Be)}if(se(me))return Et(ae,ee,me,Be);if(A(me))return Kn(ae,ee,me,Be);nu(ae,me)}return typeof me=="string"&&me!==""||typeof me=="number"?(me=""+me,ee!==null&&ee.tag===6?(h(ae,ee.sibling),ee=C(ee,me),ee.return=ae,ae=ee):(h(ae,ee),ee=vh(me,ae.mode,Be),ee.return=ae,ae=ee),E(ae)):h(ae,ee)}return Uo}var Yl=_1(!0),A1=_1(!1),ri={},Ls=mr(ri),li=mr(ri),Xl=mr(ri);function po(a){if(a===ri)throw Error(c(174));return a}function Dm(a,i){Rt(Xl,i),Rt(li,a),Rt(Ls,ri),a=ke(i),Nt(Ls),Rt(Ls,a)}function Jl(){Nt(Ls),Nt(li),Nt(Xl)}function P1(a){var i=po(Xl.current),h=po(Ls.current);i=Ce(h,a.type,i),h!==i&&(Rt(li,a),Rt(Ls,i))}function Lm(a){li.current===a&&(Nt(Ls),Nt(li))}var Ut=mr(0);function su(a){for(var i=a;i!==null;){if(i.tag===13){var h=i.memoizedState;if(h!==null&&(h=h.dehydrated,h===null||Nc(h)||Vl(h)))return i}else if(i.tag===19&&i.memoizedProps.revealOrder!==void 0){if(i.flags&128)return i}else if(i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return null;i=i.return}i.sibling.return=i.return,i=i.sibling}return null}var Tm=[];function Rm(){for(var a=0;a<Tm.length;a++){var i=Tm[a];fe?i._workInProgressVersionPrimary=null:i._workInProgressVersionSecondary=null}Tm.length=0}var ou=d.ReactCurrentDispatcher,Bm=d.ReactCurrentBatchConfig,cl=0,Gt=null,dn=null,Cn=null,ru=!1,ai=!1,ii=0,W4=0;function Dn(){throw Error(c(321))}function Om(a,i){if(i===null)return!1;for(var h=0;h<i.length&&h<a.length;h++)if(!Us(a[h],i[h]))return!1;return!0}function Nm(a,i,h,v,C,k){if(cl=k,Gt=i,i.memoizedState=null,i.updateQueue=null,i.lanes=0,ou.current=a===null||a.memoizedState===null?q4:Q4,a=h(v,C),ai){k=0;do{if(ai=!1,ii=0,25<=k)throw Error(c(301));k+=1,Cn=dn=null,i.updateQueue=null,ou.current=K4,a=h(v,C)}while(ai)}if(ou.current=iu,i=dn!==null&&dn.next!==null,cl=0,Cn=dn=Gt=null,ru=!1,i)throw Error(c(300));return a}function Fm(){var a=ii!==0;return ii=0,a}function go(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Cn===null?Gt.memoizedState=Cn=a:Cn=Cn.next=a,Cn}function Ts(){if(dn===null){var a=Gt.alternate;a=a!==null?a.memoizedState:null}else a=dn.next;var i=Cn===null?Gt.memoizedState:Cn.next;if(i!==null)Cn=i,dn=a;else{if(a===null)throw Error(c(310));dn=a,a={memoizedState:dn.memoizedState,baseState:dn.baseState,baseQueue:dn.baseQueue,queue:dn.queue,next:null},Cn===null?Gt.memoizedState=Cn=a:Cn=Cn.next=a}return Cn}function ci(a,i){return typeof i=="function"?i(a):i}function zm(a){var i=Ts(),h=i.queue;if(h===null)throw Error(c(311));h.lastRenderedReducer=a;var v=dn,C=v.baseQueue,k=h.pending;if(k!==null){if(C!==null){var E=C.next;C.next=k.next,k.next=E}v.baseQueue=C=k,h.pending=null}if(C!==null){k=C.next,v=v.baseState;var X=E=null,ie=null,Ae=k;do{var ze=Ae.lane;if((cl&ze)===ze)ie!==null&&(ie=ie.next={lane:0,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null}),v=Ae.hasEagerState?Ae.eagerState:a(v,Ae.action);else{var nt={lane:ze,action:Ae.action,hasEagerState:Ae.hasEagerState,eagerState:Ae.eagerState,next:null};ie===null?(X=ie=nt,E=v):ie=ie.next=nt,Gt.lanes|=ze,ul|=ze}Ae=Ae.next}while(Ae!==null&&Ae!==k);ie===null?E=v:ie.next=X,Us(v,i.memoizedState)||(Zn=!0),i.memoizedState=v,i.baseState=E,i.baseQueue=ie,h.lastRenderedState=v}if(a=h.interleaved,a!==null){C=a;do k=C.lane,Gt.lanes|=k,ul|=k,C=C.next;while(C!==a)}else C===null&&(h.lanes=0);return[i.memoizedState,h.dispatch]}function Hm(a){var i=Ts(),h=i.queue;if(h===null)throw Error(c(311));h.lastRenderedReducer=a;var v=h.dispatch,C=h.pending,k=i.memoizedState;if(C!==null){h.pending=null;var E=C=C.next;do k=a(k,E.action),E=E.next;while(E!==C);Us(k,i.memoizedState)||(Zn=!0),i.memoizedState=k,i.baseQueue===null&&(i.baseState=k),h.lastRenderedState=k}return[k,v]}function E1(){}function D1(a,i){var h=Gt,v=Ts(),C=i(),k=!Us(v.memoizedState,C);if(k&&(v.memoizedState=C,Zn=!0),v=v.queue,$m(R1.bind(null,h,v,a),[a]),v.getSnapshot!==i||k||Cn!==null&&Cn.memoizedState.tag&1){if(h.flags|=2048,ui(9,T1.bind(null,h,v,C,i),void 0,null),yn===null)throw Error(c(349));cl&30||L1(h,i,C)}return C}function L1(a,i,h){a.flags|=16384,a={getSnapshot:i,value:h},i=Gt.updateQueue,i===null?(i={lastEffect:null,stores:null},Gt.updateQueue=i,i.stores=[a]):(h=i.stores,h===null?i.stores=[a]:h.push(a))}function T1(a,i,h,v){i.value=h,i.getSnapshot=v,B1(i)&&O1(a)}function R1(a,i,h){return h(function(){B1(i)&&O1(a)})}function B1(a){var i=a.getSnapshot;a=a.value;try{var h=i();return!Us(a,h)}catch{return!0}}function O1(a){var i=ho(a,1);i!==null&&Rs(i,a,1,-1)}function N1(a){var i=go();return typeof a=="function"&&(a=a()),i.memoizedState=i.baseState=a,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:ci,lastRenderedState:a},i.queue=a,a=a.dispatch=Z4.bind(null,Gt,a),[i.memoizedState,a]}function ui(a,i,h,v){return a={tag:a,create:i,destroy:h,deps:v,next:null},i=Gt.updateQueue,i===null?(i={lastEffect:null,stores:null},Gt.updateQueue=i,i.lastEffect=a.next=a):(h=i.lastEffect,h===null?i.lastEffect=a.next=a:(v=h.next,h.next=a,a.next=v,i.lastEffect=a)),a}function F1(){return Ts().memoizedState}function lu(a,i,h,v){var C=go();Gt.flags|=a,C.memoizedState=ui(1|i,h,void 0,v===void 0?null:v)}function au(a,i,h,v){var C=Ts();v=v===void 0?null:v;var k=void 0;if(dn!==null){var E=dn.memoizedState;if(k=E.destroy,v!==null&&Om(v,E.deps)){C.memoizedState=ui(i,h,k,v);return}}Gt.flags|=a,C.memoizedState=ui(1|i,h,k,v)}function z1(a,i){return lu(8390656,8,a,i)}function $m(a,i){return au(2048,8,a,i)}function H1(a,i){return au(4,2,a,i)}function $1(a,i){return au(4,4,a,i)}function V1(a,i){if(typeof i=="function")return a=a(),i(a),function(){i(null)};if(i!=null)return a=a(),i.current=a,function(){i.current=null}}function W1(a,i,h){return h=h!=null?h.concat([a]):null,au(4,4,V1.bind(null,i,a),h)}function Vm(){}function U1(a,i){var h=Ts();i=i===void 0?null:i;var v=h.memoizedState;return v!==null&&i!==null&&Om(i,v[1])?v[0]:(h.memoizedState=[a,i],a)}function G1(a,i){var h=Ts();i=i===void 0?null:i;var v=h.memoizedState;return v!==null&&i!==null&&Om(i,v[1])?v[0]:(a=a(),h.memoizedState=[a,i],a)}function Z1(a,i,h){return cl&21?(Us(h,i)||(h=c1(),Gt.lanes|=h,ul|=h,a.baseState=!0),i):(a.baseState&&(a.baseState=!1,Zn=!0),a.memoizedState=h)}function U4(a,i){var h=xt;xt=h!==0&&4>h?h:4,a(!0);var v=Bm.transition;Bm.transition={};try{a(!1),i()}finally{xt=h,Bm.transition=v}}function q1(){return Ts().memoizedState}function G4(a,i,h){var v=Cr(a);if(h={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null},Q1(a))K1(i,h);else if(h=C1(a,i,h,v),h!==null){var C=Rn();Rs(h,a,v,C),Y1(h,i,v)}}function Z4(a,i,h){var v=Cr(a),C={lane:v,action:h,hasEagerState:!1,eagerState:null,next:null};if(Q1(a))K1(i,C);else{var k=a.alternate;if(a.lanes===0&&(k===null||k.lanes===0)&&(k=i.lastRenderedReducer,k!==null))try{var E=i.lastRenderedState,X=k(E,h);if(C.hasEagerState=!0,C.eagerState=X,Us(X,E)){var ie=i.interleaved;ie===null?(C.next=C,_m(i)):(C.next=ie.next,ie.next=C),i.interleaved=C;return}}catch{}finally{}h=C1(a,i,C,v),h!==null&&(C=Rn(),Rs(h,a,v,C),Y1(h,i,v))}}function Q1(a){var i=a.alternate;return a===Gt||i!==null&&i===Gt}function K1(a,i){ai=ru=!0;var h=a.pending;h===null?i.next=i:(i.next=h.next,h.next=i),a.pending=i}function Y1(a,i,h){if(h&4194240){var v=i.lanes;v&=a.pendingLanes,h|=v,i.lanes=h,hm(a,h)}}var iu={readContext:Ds,useCallback:Dn,useContext:Dn,useEffect:Dn,useImperativeHandle:Dn,useInsertionEffect:Dn,useLayoutEffect:Dn,useMemo:Dn,useReducer:Dn,useRef:Dn,useState:Dn,useDebugValue:Dn,useDeferredValue:Dn,useTransition:Dn,useMutableSource:Dn,useSyncExternalStore:Dn,useId:Dn,unstable_isNewReconciler:!1},q4={readContext:Ds,useCallback:function(a,i){return go().memoizedState=[a,i===void 0?null:i],a},useContext:Ds,useEffect:z1,useImperativeHandle:function(a,i,h){return h=h!=null?h.concat([a]):null,lu(4194308,4,V1.bind(null,i,a),h)},useLayoutEffect:function(a,i){return lu(4194308,4,a,i)},useInsertionEffect:function(a,i){return lu(4,2,a,i)},useMemo:function(a,i){var h=go();return i=i===void 0?null:i,a=a(),h.memoizedState=[a,i],a},useReducer:function(a,i,h){var v=go();return i=h!==void 0?h(i):i,v.memoizedState=v.baseState=i,a={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:i},v.queue=a,a=a.dispatch=G4.bind(null,Gt,a),[v.memoizedState,a]},useRef:function(a){var i=go();return a={current:a},i.memoizedState=a},useState:N1,useDebugValue:Vm,useDeferredValue:function(a){return go().memoizedState=a},useTransition:function(){var a=N1(!1),i=a[0];return a=U4.bind(null,a[1]),go().memoizedState=a,[i,a]},useMutableSource:function(){},useSyncExternalStore:function(a,i,h){var v=Gt,C=go();if(Ht){if(h===void 0)throw Error(c(407));h=h()}else{if(h=i(),yn===null)throw Error(c(349));cl&30||L1(v,i,h)}C.memoizedState=h;var k={value:h,getSnapshot:i};return C.queue=k,z1(R1.bind(null,v,k,a),[a]),v.flags|=2048,ui(9,T1.bind(null,v,k,h,i),void 0,null),h},useId:function(){var a=go(),i=yn.identifierPrefix;if(Ht){var h=Ho,v=zo;h=(v&~(1<<32-Ws(v)-1)).toString(32)+h,i=":"+i+"R"+h,h=ii++,0<h&&(i+="H"+h.toString(32)),i+=":"}else h=W4++,i=":"+i+"r"+h.toString(32)+":";return a.memoizedState=i},unstable_isNewReconciler:!1},Q4={readContext:Ds,useCallback:U1,useContext:Ds,useEffect:$m,useImperativeHandle:W1,useInsertionEffect:H1,useLayoutEffect:$1,useMemo:G1,useReducer:zm,useRef:F1,useState:function(){return zm(ci)},useDebugValue:Vm,useDeferredValue:function(a){var i=Ts();return Z1(i,dn.memoizedState,a)},useTransition:function(){var a=zm(ci)[0],i=Ts().memoizedState;return[a,i]},useMutableSource:E1,useSyncExternalStore:D1,useId:q1,unstable_isNewReconciler:!1},K4={readContext:Ds,useCallback:U1,useContext:Ds,useEffect:$m,useImperativeHandle:W1,useInsertionEffect:H1,useLayoutEffect:$1,useMemo:G1,useReducer:Hm,useRef:F1,useState:function(){return Hm(ci)},useDebugValue:Vm,useDeferredValue:function(a){var i=Ts();return dn===null?i.memoizedState=a:Z1(i,dn.memoizedState,a)},useTransition:function(){var a=Hm(ci)[0],i=Ts().memoizedState;return[a,i]},useMutableSource:E1,useSyncExternalStore:D1,useId:q1,unstable_isNewReconciler:!1};function ea(a,i){try{var h="",v=i;do h+=V4(v),v=v.return;while(v);var C=h}catch(k){C=`
Error generating stack: `+k.message+`
`+k.stack}return{value:a,source:i,stack:C,digest:null}}function Wm(a,i,h){return{value:a,source:null,stack:h??null,digest:i??null}}function Um(a,i){try{console.error(i.value)}catch(h){setTimeout(function(){throw h})}}var Y4=typeof WeakMap=="function"?WeakMap:Map;function X1(a,i,h){h=$o(-1,h),h.tag=3,h.payload={element:null};var v=i.value;return h.callback=function(){ju||(ju=!0,dh=v),Um(a,i)},h}function J1(a,i,h){h=$o(-1,h),h.tag=3;var v=a.type.getDerivedStateFromError;if(typeof v=="function"){var C=i.value;h.payload=function(){return v(C)},h.callback=function(){Um(a,i)}}var k=a.stateNode;return k!==null&&typeof k.componentDidCatch=="function"&&(h.callback=function(){Um(a,i),typeof v!="function"&&(xr===null?xr=new Set([this]):xr.add(this));var E=i.stack;this.componentDidCatch(i.value,{componentStack:E!==null?E:""})}),h}function ex(a,i,h){var v=a.pingCache;if(v===null){v=a.pingCache=new Y4;var C=new Set;v.set(i,C)}else C=v.get(i),C===void 0&&(C=new Set,v.set(i,C));C.has(h)||(C.add(h),a=d5.bind(null,a,i,h),i.then(a,a))}function tx(a){do{var i;if((i=a.tag===13)&&(i=a.memoizedState,i=i!==null?i.dehydrated!==null:!0),i)return a;a=a.return}while(a!==null);return null}function nx(a,i,h,v,C){return a.mode&1?(a.flags|=65536,a.lanes=C,a):(a===i?a.flags|=65536:(a.flags|=128,h.flags|=131072,h.flags&=-52805,h.tag===1&&(h.alternate===null?h.tag=17:(i=$o(-1,1),i.tag=2,gr(h,i,1))),h.lanes|=1),a)}var X4=d.ReactCurrentOwner,Zn=!1;function On(a,i,h,v){i.child=a===null?A1(i,null,h,v):Yl(i,a.child,h,v)}function sx(a,i,h,v,C){h=h.render;var k=i.ref;return Kl(i,C),v=Nm(a,i,h,v,k,C),h=Fm(),a!==null&&!Zn?(i.updateQueue=a.updateQueue,i.flags&=-2053,a.lanes&=~C,Vo(a,i,C)):(Ht&&h&&Cm(i),i.flags|=1,On(a,i,v,C),i.child)}function ox(a,i,h,v,C){if(a===null){var k=h.type;return typeof k=="function"&&!xh(k)&&k.defaultProps===void 0&&h.compare===null&&h.defaultProps===void 0?(i.tag=15,i.type=k,rx(a,i,k,v,C)):(a=_u(h.type,null,v,i,i.mode,C),a.ref=i.ref,a.return=i,i.child=a)}if(k=a.child,!(a.lanes&C)){var E=k.memoizedProps;if(h=h.compare,h=h!==null?h:Kc,h(E,v)&&a.ref===i.ref)return Vo(a,i,C)}return i.flags|=1,a=br(k,v),a.ref=i.ref,a.return=i,i.child=a}function rx(a,i,h,v,C){if(a!==null){var k=a.memoizedProps;if(Kc(k,v)&&a.ref===i.ref)if(Zn=!1,i.pendingProps=v=k,(a.lanes&C)!==0)a.flags&131072&&(Zn=!0);else return i.lanes=a.lanes,Vo(a,i,C)}return Gm(a,i,h,v,C)}function lx(a,i,h){var v=i.pendingProps,C=v.children,k=a!==null?a.memoizedState:null;if(v.mode==="hidden")if(!(i.mode&1))i.memoizedState={baseLanes:0,cachePool:null,transitions:null},Rt(na,us),us|=h;else{if(!(h&1073741824))return a=k!==null?k.baseLanes|h:h,i.lanes=i.childLanes=1073741824,i.memoizedState={baseLanes:a,cachePool:null,transitions:null},i.updateQueue=null,Rt(na,us),us|=a,null;i.memoizedState={baseLanes:0,cachePool:null,transitions:null},v=k!==null?k.baseLanes:h,Rt(na,us),us|=v}else k!==null?(v=k.baseLanes|h,i.memoizedState=null):v=h,Rt(na,us),us|=v;return On(a,i,C,h),i.child}function ax(a,i){var h=i.ref;(a===null&&h!==null||a!==null&&a.ref!==h)&&(i.flags|=512,i.flags|=2097152)}function Gm(a,i,h,v,C){var k=Gn(h)?rl:En.current;return k=Ul(i,k),Kl(i,C),h=Nm(a,i,h,v,k,C),v=Fm(),a!==null&&!Zn?(i.updateQueue=a.updateQueue,i.flags&=-2053,a.lanes&=~C,Vo(a,i,C)):(Ht&&v&&Cm(i),i.flags|=1,On(a,i,h,C),i.child)}function ix(a,i,h,v,C){if(Gn(h)){var k=!0;Hc(i)}else k=!1;if(Kl(i,C),i.stateNode===null)uu(a,i),w1(i,h,v),Em(i,h,v,C),v=!0;else if(a===null){var E=i.stateNode,X=i.memoizedProps;E.props=X;var ie=E.context,Ae=h.contextType;typeof Ae=="object"&&Ae!==null?Ae=Ds(Ae):(Ae=Gn(h)?rl:En.current,Ae=Ul(i,Ae));var ze=h.getDerivedStateFromProps,nt=typeof ze=="function"||typeof E.getSnapshotBeforeUpdate=="function";nt||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(X!==v||ie!==Ae)&&I1(i,E,v,Ae),pr=!1;var Re=i.memoizedState;E.state=Re,eu(i,v,E,C),ie=i.memoizedState,X!==v||Re!==ie||Un.current||pr?(typeof ze=="function"&&(Pm(i,h,ze,v),ie=i.memoizedState),(X=pr||k1(i,h,X,v,Re,ie,Ae))?(nt||typeof E.UNSAFE_componentWillMount!="function"&&typeof E.componentWillMount!="function"||(typeof E.componentWillMount=="function"&&E.componentWillMount(),typeof E.UNSAFE_componentWillMount=="function"&&E.UNSAFE_componentWillMount()),typeof E.componentDidMount=="function"&&(i.flags|=4194308)):(typeof E.componentDidMount=="function"&&(i.flags|=4194308),i.memoizedProps=v,i.memoizedState=ie),E.props=v,E.state=ie,E.context=Ae,v=X):(typeof E.componentDidMount=="function"&&(i.flags|=4194308),v=!1)}else{E=i.stateNode,y1(a,i),X=i.memoizedProps,Ae=i.type===i.elementType?X:Zs(i.type,X),E.props=Ae,nt=i.pendingProps,Re=E.context,ie=h.contextType,typeof ie=="object"&&ie!==null?ie=Ds(ie):(ie=Gn(h)?rl:En.current,ie=Ul(i,ie));var Ft=h.getDerivedStateFromProps;(ze=typeof Ft=="function"||typeof E.getSnapshotBeforeUpdate=="function")||typeof E.UNSAFE_componentWillReceiveProps!="function"&&typeof E.componentWillReceiveProps!="function"||(X!==nt||Re!==ie)&&I1(i,E,v,ie),pr=!1,Re=i.memoizedState,E.state=Re,eu(i,v,E,C);var Et=i.memoizedState;X!==nt||Re!==Et||Un.current||pr?(typeof Ft=="function"&&(Pm(i,h,Ft,v),Et=i.memoizedState),(Ae=pr||k1(i,h,Ae,v,Re,Et,ie)||!1)?(ze||typeof E.UNSAFE_componentWillUpdate!="function"&&typeof E.componentWillUpdate!="function"||(typeof E.componentWillUpdate=="function"&&E.componentWillUpdate(v,Et,ie),typeof E.UNSAFE_componentWillUpdate=="function"&&E.UNSAFE_componentWillUpdate(v,Et,ie)),typeof E.componentDidUpdate=="function"&&(i.flags|=4),typeof E.getSnapshotBeforeUpdate=="function"&&(i.flags|=1024)):(typeof E.componentDidUpdate!="function"||X===a.memoizedProps&&Re===a.memoizedState||(i.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||X===a.memoizedProps&&Re===a.memoizedState||(i.flags|=1024),i.memoizedProps=v,i.memoizedState=Et),E.props=v,E.state=Et,E.context=ie,v=Ae):(typeof E.componentDidUpdate!="function"||X===a.memoizedProps&&Re===a.memoizedState||(i.flags|=4),typeof E.getSnapshotBeforeUpdate!="function"||X===a.memoizedProps&&Re===a.memoizedState||(i.flags|=1024),v=!1)}return Zm(a,i,h,v,k,C)}function Zm(a,i,h,v,C,k){ax(a,i);var E=(i.flags&128)!==0;if(!v&&!E)return C&&i1(i,h,!1),Vo(a,i,k);v=i.stateNode,X4.current=i;var X=E&&typeof h.getDerivedStateFromError!="function"?null:v.render();return i.flags|=1,a!==null&&E?(i.child=Yl(i,a.child,null,k),i.child=Yl(i,null,X,k)):On(a,i,X,k),i.memoizedState=v.state,C&&i1(i,h,!0),i.child}function cx(a){var i=a.stateNode;i.pendingContext?l1(a,i.pendingContext,i.pendingContext!==i.context):i.context&&l1(a,i.context,!1),Dm(a,i.containerInfo)}function ux(a,i,h,v,C){return ql(),Sm(C),i.flags|=256,On(a,i,h,v),i.child}var qm={dehydrated:null,treeContext:null,retryLane:0};function Qm(a){return{baseLanes:a,cachePool:null,transitions:null}}function dx(a,i,h){var v=i.pendingProps,C=Ut.current,k=!1,E=(i.flags&128)!==0,X;if((X=E)||(X=a!==null&&a.memoizedState===null?!1:(C&2)!==0),X?(k=!0,i.flags&=-129):(a===null||a.memoizedState!==null)&&(C|=1),Rt(Ut,C&1),a===null)return jm(i),a=i.memoizedState,a!==null&&(a=a.dehydrated,a!==null)?(i.mode&1?Vl(a)?i.lanes=8:i.lanes=1073741824:i.lanes=1,null):(E=v.children,a=v.fallback,k?(v=i.mode,k=i.child,E={mode:"hidden",children:E},!(v&1)&&k!==null?(k.childLanes=0,k.pendingProps=E):k=Au(E,v,0,null),a=hl(a,v,h,null),k.return=i,a.return=i,k.sibling=a,i.child=k,i.child.memoizedState=Qm(h),i.memoizedState=qm,a):Km(i,E));if(C=a.memoizedState,C!==null&&(X=C.dehydrated,X!==null))return J4(a,i,E,v,X,C,h);if(k){k=v.fallback,E=i.mode,C=a.child,X=C.sibling;var ie={mode:"hidden",children:v.children};return!(E&1)&&i.child!==C?(v=i.child,v.childLanes=0,v.pendingProps=ie,i.deletions=null):(v=br(C,ie),v.subtreeFlags=C.subtreeFlags&14680064),X!==null?k=br(X,k):(k=hl(k,E,h,null),k.flags|=2),k.return=i,v.return=i,v.sibling=k,i.child=v,v=k,k=i.child,E=a.child.memoizedState,E=E===null?Qm(h):{baseLanes:E.baseLanes|h,cachePool:null,transitions:E.transitions},k.memoizedState=E,k.childLanes=a.childLanes&~h,i.memoizedState=qm,v}return k=a.child,a=k.sibling,v=br(k,{mode:"visible",children:v.children}),!(i.mode&1)&&(v.lanes=h),v.return=i,v.sibling=null,a!==null&&(h=i.deletions,h===null?(i.deletions=[a],i.flags|=16):h.push(a)),i.child=v,i.memoizedState=null,v}function Km(a,i){return i=Au({mode:"visible",children:i},a.mode,0,null),i.return=a,a.child=i}function cu(a,i,h,v){return v!==null&&Sm(v),Yl(i,a.child,null,h),a=Km(i,i.pendingProps.children),a.flags|=2,i.memoizedState=null,a}function J4(a,i,h,v,C,k,E){if(h)return i.flags&256?(i.flags&=-257,v=Wm(Error(c(422))),cu(a,i,E,v)):i.memoizedState!==null?(i.child=a.child,i.flags|=128,null):(k=v.fallback,C=i.mode,v=Au({mode:"visible",children:v.children},C,0,null),k=hl(k,C,E,null),k.flags|=2,v.return=i,k.return=i,v.sibling=k,i.child=v,i.mode&1&&Yl(i,a.child,null,E),i.child.memoizedState=Qm(E),i.memoizedState=qm,k);if(!(i.mode&1))return cu(a,i,E,null);if(Vl(C))return v=f4(C).digest,k=Error(c(419)),v=Wm(k,v,void 0),cu(a,i,E,v);if(h=(E&a.childLanes)!==0,Zn||h){if(v=yn,v!==null){switch(E&-E){case 4:C=2;break;case 16:C=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:C=32;break;case 536870912:C=268435456;break;default:C=0}C=C&(v.suspendedLanes|E)?0:C,C!==0&&C!==k.retryLane&&(k.retryLane=C,ho(a,C),Rs(v,a,C,-1))}return gh(),v=Wm(Error(c(421))),cu(a,i,E,v)}return Nc(C)?(i.flags|=128,i.child=a.child,i=f5.bind(null,a),m4(C,i),null):(a=k.treeContext,W&&(Es=g4(C),cs=i,Ht=!0,Gs=null,si=!1,a!==null&&(As[Ps++]=zo,As[Ps++]=Ho,As[Ps++]=ll,zo=a.id,Ho=a.overflow,ll=i)),i=Km(i,v.children),i.flags|=4096,i)}function fx(a,i,h){a.lanes|=i;var v=a.alternate;v!==null&&(v.lanes|=i),Mm(a.return,i,h)}function Ym(a,i,h,v,C){var k=a.memoizedState;k===null?a.memoizedState={isBackwards:i,rendering:null,renderingStartTime:0,last:v,tail:h,tailMode:C}:(k.isBackwards=i,k.rendering=null,k.renderingStartTime=0,k.last=v,k.tail=h,k.tailMode=C)}function mx(a,i,h){var v=i.pendingProps,C=v.revealOrder,k=v.tail;if(On(a,i,v.children,h),v=Ut.current,v&2)v=v&1|2,i.flags|=128;else{if(a!==null&&a.flags&128)e:for(a=i.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&fx(a,h,i);else if(a.tag===19)fx(a,h,i);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===i)break e;for(;a.sibling===null;){if(a.return===null||a.return===i)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}v&=1}if(Rt(Ut,v),!(i.mode&1))i.memoizedState=null;else switch(C){case"forwards":for(h=i.child,C=null;h!==null;)a=h.alternate,a!==null&&su(a)===null&&(C=h),h=h.sibling;h=C,h===null?(C=i.child,i.child=null):(C=h.sibling,h.sibling=null),Ym(i,!1,C,h,k);break;case"backwards":for(h=null,C=i.child,i.child=null;C!==null;){if(a=C.alternate,a!==null&&su(a)===null){i.child=C;break}a=C.sibling,C.sibling=h,h=C,C=a}Ym(i,!0,h,null,k);break;case"together":Ym(i,!1,null,null,void 0);break;default:i.memoizedState=null}return i.child}function uu(a,i){!(i.mode&1)&&a!==null&&(a.alternate=null,i.alternate=null,i.flags|=2)}function Vo(a,i,h){if(a!==null&&(i.dependencies=a.dependencies),ul|=i.lanes,!(h&i.childLanes))return null;if(a!==null&&i.child!==a.child)throw Error(c(153));if(i.child!==null){for(a=i.child,h=br(a,a.pendingProps),i.child=h,h.return=i;a.sibling!==null;)a=a.sibling,h=h.sibling=br(a,a.pendingProps),h.return=i;h.sibling=null}return i.child}function e5(a,i,h){switch(i.tag){case 3:cx(i),ql();break;case 5:P1(i);break;case 1:Gn(i.type)&&Hc(i);break;case 4:Dm(i,i.stateNode.containerInfo);break;case 10:v1(i,i.type._context,i.memoizedProps.value);break;case 13:var v=i.memoizedState;if(v!==null)return v.dehydrated!==null?(Rt(Ut,Ut.current&1),i.flags|=128,null):h&i.child.childLanes?dx(a,i,h):(Rt(Ut,Ut.current&1),a=Vo(a,i,h),a!==null?a.sibling:null);Rt(Ut,Ut.current&1);break;case 19:if(v=(h&i.childLanes)!==0,a.flags&128){if(v)return mx(a,i,h);i.flags|=128}var C=i.memoizedState;if(C!==null&&(C.rendering=null,C.tail=null,C.lastEffect=null),Rt(Ut,Ut.current),v)break;return null;case 22:case 23:return i.lanes=0,lx(a,i,h)}return Vo(a,i,h)}function xo(a){a.flags|=4}function hx(a,i){if(a!==null&&a.child===i.child)return!0;if(i.flags&16)return!1;for(a=i.child;a!==null;){if(a.flags&12854||a.subtreeFlags&12854)return!1;a=a.sibling}return!0}var di,fi,du,fu;if(ue)di=function(a,i){for(var h=i.child;h!==null;){if(h.tag===5||h.tag===6)oe(a,h.stateNode);else if(h.tag!==4&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===i)break;for(;h.sibling===null;){if(h.return===null||h.return===i)return;h=h.return}h.sibling.return=h.return,h=h.sibling}},fi=function(){},du=function(a,i,h,v,C){if(a=a.memoizedProps,a!==v){var k=i.stateNode,E=po(Ls.current);h=de(k,h,a,v,C,E),(i.updateQueue=h)&&xo(i)}},fu=function(a,i,h,v){h!==v&&xo(i)};else if(xe){di=function(a,i,h,v){for(var C=i.child;C!==null;){if(C.tag===5){var k=C.stateNode;h&&v&&(k=Bc(k,C.type,C.memoizedProps,C)),oe(a,k)}else if(C.tag===6)k=C.stateNode,h&&v&&(k=$l(k,C.memoizedProps,C)),oe(a,k);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)k=C.child,k!==null&&(k.return=C),di(a,C,!0,!0);else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===i)break;for(;C.sibling===null;){if(C.return===null||C.return===i)return;C=C.return}C.sibling.return=C.return,C=C.sibling}};var px=function(a,i,h,v){for(var C=i.child;C!==null;){if(C.tag===5){var k=C.stateNode;h&&v&&(k=Bc(k,C.type,C.memoizedProps,C)),co(a,k)}else if(C.tag===6)k=C.stateNode,h&&v&&(k=$l(k,C.memoizedProps,C)),co(a,k);else if(C.tag!==4){if(C.tag===22&&C.memoizedState!==null)k=C.child,k!==null&&(k.return=C),px(a,C,!0,!0);else if(C.child!==null){C.child.return=C,C=C.child;continue}}if(C===i)break;for(;C.sibling===null;){if(C.return===null||C.return===i)return;C=C.return}C.sibling.return=C.return,C=C.sibling}};fi=function(a,i){var h=i.stateNode;if(!hx(a,i)){a=h.containerInfo;var v=No(a);px(v,i,!1,!1),h.pendingChildren=v,xo(i),am(a,v)}},du=function(a,i,h,v,C){var k=a.stateNode,E=a.memoizedProps;if((a=hx(a,i))&&E===v)i.stateNode=k;else{var X=i.stateNode,ie=po(Ls.current),Ae=null;E!==v&&(Ae=de(X,h,E,v,C,ie)),a&&Ae===null?i.stateNode=k:(k=Oo(k,Ae,h,E,v,i,a,X),re(k,h,v,C,ie)&&xo(i),i.stateNode=k,a?xo(i):di(k,i,!1,!1))}},fu=function(a,i,h,v){h!==v?(a=po(Xl.current),h=po(Ls.current),i.stateNode=B(v,a,h,i),xo(i)):i.stateNode=a.stateNode}}else fi=function(){},du=function(){},fu=function(){};function mi(a,i){if(!Ht)switch(a.tailMode){case"hidden":i=a.tail;for(var h=null;i!==null;)i.alternate!==null&&(h=i),i=i.sibling;h===null?a.tail=null:h.sibling=null;break;case"collapsed":h=a.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?i||a.tail===null?a.tail=null:a.tail.sibling=null:v.sibling=null}}function Ln(a){var i=a.alternate!==null&&a.alternate.child===a.child,h=0,v=0;if(i)for(var C=a.child;C!==null;)h|=C.lanes|C.childLanes,v|=C.subtreeFlags&14680064,v|=C.flags&14680064,C.return=a,C=C.sibling;else for(C=a.child;C!==null;)h|=C.lanes|C.childLanes,v|=C.subtreeFlags,v|=C.flags,C.return=a,C=C.sibling;return a.subtreeFlags|=v,a.childLanes=h,i}function t5(a,i,h){var v=i.pendingProps;switch(ym(i),i.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Ln(i),null;case 1:return Gn(i.type)&&zc(),Ln(i),null;case 3:return h=i.stateNode,Jl(),Nt(Un),Nt(En),Rm(),h.pendingContext&&(h.context=h.pendingContext,h.pendingContext=null),(a===null||a.child===null)&&(Qc(i)?xo(i):a===null||a.memoizedState.isDehydrated&&!(i.flags&256)||(i.flags|=1024,Gs!==null&&(hh(Gs),Gs=null))),fi(a,i),Ln(i),null;case 5:Lm(i),h=po(Xl.current);var C=i.type;if(a!==null&&i.stateNode!=null)du(a,i,C,v,h),a.ref!==i.ref&&(i.flags|=512,i.flags|=2097152);else{if(!v){if(i.stateNode===null)throw Error(c(166));return Ln(i),null}if(a=po(Ls.current),Qc(i)){if(!W)throw Error(c(175));a=x4(i.stateNode,i.type,i.memoizedProps,h,a,i,!si),i.updateQueue=a,a!==null&&xo(i)}else{var k=Se(C,v,h,a,i);di(k,i,!1,!1),i.stateNode=k,re(k,C,v,h,a)&&xo(i)}i.ref!==null&&(i.flags|=512,i.flags|=2097152)}return Ln(i),null;case 6:if(a&&i.stateNode!=null)fu(a,i,a.memoizedProps,v);else{if(typeof v!="string"&&i.stateNode===null)throw Error(c(166));if(a=po(Xl.current),h=po(Ls.current),Qc(i)){if(!W)throw Error(c(176));if(a=i.stateNode,h=i.memoizedProps,(v=v4(a,h,i,!si))&&(C=cs,C!==null))switch(C.tag){case 3:I4(C.stateNode.containerInfo,a,h,(C.mode&1)!==0);break;case 5:M4(C.type,C.memoizedProps,C.stateNode,a,h,(C.mode&1)!==0)}v&&xo(i)}else i.stateNode=B(v,a,h,i)}return Ln(i),null;case 13:if(Nt(Ut),v=i.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(Ht&&Es!==null&&i.mode&1&&!(i.flags&128))x1(),ql(),i.flags|=98560,C=!1;else if(C=Qc(i),v!==null&&v.dehydrated!==null){if(a===null){if(!C)throw Error(c(318));if(!W)throw Error(c(344));if(C=i.memoizedState,C=C!==null?C.dehydrated:null,!C)throw Error(c(317));C4(C,i)}else ql(),!(i.flags&128)&&(i.memoizedState=null),i.flags|=4;Ln(i),C=!1}else Gs!==null&&(hh(Gs),Gs=null),C=!0;if(!C)return i.flags&65536?i:null}return i.flags&128?(i.lanes=h,i):(h=v!==null,h!==(a!==null&&a.memoizedState!==null)&&h&&(i.child.flags|=8192,i.mode&1&&(a===null||Ut.current&1?fn===0&&(fn=3):gh())),i.updateQueue!==null&&(i.flags|=4),Ln(i),null);case 4:return Jl(),fi(a,i),a===null&&ye(i.stateNode.containerInfo),Ln(i),null;case 10:return Im(i.type._context),Ln(i),null;case 17:return Gn(i.type)&&zc(),Ln(i),null;case 19:if(Nt(Ut),C=i.memoizedState,C===null)return Ln(i),null;if(v=(i.flags&128)!==0,k=C.rendering,k===null)if(v)mi(C,!1);else{if(fn!==0||a!==null&&a.flags&128)for(a=i.child;a!==null;){if(k=su(a),k!==null){for(i.flags|=128,mi(C,!1),a=k.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),i.subtreeFlags=0,a=h,h=i.child;h!==null;)v=h,C=a,v.flags&=14680066,k=v.alternate,k===null?(v.childLanes=0,v.lanes=C,v.child=null,v.subtreeFlags=0,v.memoizedProps=null,v.memoizedState=null,v.updateQueue=null,v.dependencies=null,v.stateNode=null):(v.childLanes=k.childLanes,v.lanes=k.lanes,v.child=k.child,v.subtreeFlags=0,v.deletions=null,v.memoizedProps=k.memoizedProps,v.memoizedState=k.memoizedState,v.updateQueue=k.updateQueue,v.type=k.type,C=k.dependencies,v.dependencies=C===null?null:{lanes:C.lanes,firstContext:C.firstContext}),h=h.sibling;return Rt(Ut,Ut.current&1|2),i.child}a=a.sibling}C.tail!==null&&vn()>uh&&(i.flags|=128,v=!0,mi(C,!1),i.lanes=4194304)}else{if(!v)if(a=su(k),a!==null){if(i.flags|=128,v=!0,a=a.updateQueue,a!==null&&(i.updateQueue=a,i.flags|=4),mi(C,!0),C.tail===null&&C.tailMode==="hidden"&&!k.alternate&&!Ht)return Ln(i),null}else 2*vn()-C.renderingStartTime>uh&&h!==1073741824&&(i.flags|=128,v=!0,mi(C,!1),i.lanes=4194304);C.isBackwards?(k.sibling=i.child,i.child=k):(a=C.last,a!==null?a.sibling=k:i.child=k,C.last=k)}return C.tail!==null?(i=C.tail,C.rendering=i,C.tail=i.sibling,C.renderingStartTime=vn(),i.sibling=null,a=Ut.current,Rt(Ut,v?a&1|2:a&1),i):(Ln(i),null);case 22:case 23:return ph(),h=i.memoizedState!==null,a!==null&&a.memoizedState!==null!==h&&(i.flags|=8192),h&&i.mode&1?us&1073741824&&(Ln(i),ue&&i.subtreeFlags&6&&(i.flags|=8192)):Ln(i),null;case 24:return null;case 25:return null}throw Error(c(156,i.tag))}function n5(a,i){switch(ym(i),i.tag){case 1:return Gn(i.type)&&zc(),a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 3:return Jl(),Nt(Un),Nt(En),Rm(),a=i.flags,a&65536&&!(a&128)?(i.flags=a&-65537|128,i):null;case 5:return Lm(i),null;case 13:if(Nt(Ut),a=i.memoizedState,a!==null&&a.dehydrated!==null){if(i.alternate===null)throw Error(c(340));ql()}return a=i.flags,a&65536?(i.flags=a&-65537|128,i):null;case 19:return Nt(Ut),null;case 4:return Jl(),null;case 10:return Im(i.type._context),null;case 22:case 23:return ph(),null;case 24:return null;default:return null}}var mu=!1,Tn=!1,s5=typeof WeakSet=="function"?WeakSet:Set,Ne=null;function ta(a,i){var h=a.ref;if(h!==null)if(typeof h=="function")try{h(null)}catch(v){$t(a,i,v)}else h.current=null}function Xm(a,i,h){try{h()}catch(v){$t(a,i,v)}}var gx=!1;function o5(a,i){for(ge(a.containerInfo),Ne=i;Ne!==null;)if(a=Ne,i=a.child,(a.subtreeFlags&1028)!==0&&i!==null)i.return=a,Ne=i;else for(;Ne!==null;){a=Ne;try{var h=a.alternate;if(a.flags&1024)switch(a.tag){case 0:case 11:case 15:break;case 1:if(h!==null){var v=h.memoizedProps,C=h.memoizedState,k=a.stateNode,E=k.getSnapshotBeforeUpdate(a.elementType===a.type?v:Zs(a.type,v),C);k.__reactInternalSnapshotBeforeUpdate=E}break;case 3:ue&&lm(a.stateNode.containerInfo);break;case 5:case 6:case 4:case 17:break;default:throw Error(c(163))}}catch(X){$t(a,a.return,X)}if(i=a.sibling,i!==null){i.return=a.return,Ne=i;break}Ne=a.return}return h=gx,gx=!1,h}function hi(a,i,h){var v=i.updateQueue;if(v=v!==null?v.lastEffect:null,v!==null){var C=v=v.next;do{if((C.tag&a)===a){var k=C.destroy;C.destroy=void 0,k!==void 0&&Xm(i,h,k)}C=C.next}while(C!==v)}}function hu(a,i){if(i=i.updateQueue,i=i!==null?i.lastEffect:null,i!==null){var h=i=i.next;do{if((h.tag&a)===a){var v=h.create;h.destroy=v()}h=h.next}while(h!==i)}}function Jm(a){var i=a.ref;if(i!==null){var h=a.stateNode;switch(a.tag){case 5:a=he(h);break;default:a=h}typeof i=="function"?i(a):i.current=a}}function xx(a){var i=a.alternate;i!==null&&(a.alternate=null,xx(i)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(i=a.stateNode,i!==null&&Ve(i)),a.stateNode=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function vx(a){return a.tag===5||a.tag===3||a.tag===4}function Cx(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||vx(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function eh(a,i,h){var v=a.tag;if(v===5||v===6)a=a.stateNode,i?on(h,a,i):St(h,a);else if(v!==4&&(a=a.child,a!==null))for(eh(a,i,h),a=a.sibling;a!==null;)eh(a,i,h),a=a.sibling}function th(a,i,h){var v=a.tag;if(v===5||v===6)a=a.stateNode,i?xn(h,a,i):lt(h,a);else if(v!==4&&(a=a.child,a!==null))for(th(a,i,h),a=a.sibling;a!==null;)th(a,i,h),a=a.sibling}var In=null,qs=!1;function vo(a,i,h){for(h=h.child;h!==null;)nh(a,i,h),h=h.sibling}function nh(a,i,h){if(fo&&typeof fo.onCommitFiberUnmount=="function")try{fo.onCommitFiberUnmount(Uc,h)}catch{}switch(h.tag){case 5:Tn||ta(h,i);case 6:if(ue){var v=In,C=qs;In=null,vo(a,i,h),In=v,qs=C,In!==null&&(qs?Tt(In,h.stateNode):en(In,h.stateNode))}else vo(a,i,h);break;case 18:ue&&In!==null&&(qs?k4(In,h.stateNode):S4(In,h.stateNode));break;case 4:ue?(v=In,C=qs,In=h.stateNode.containerInfo,qs=!0,vo(a,i,h),In=v,qs=C):(xe&&(v=h.stateNode.containerInfo,C=No(v),uo(v,C)),vo(a,i,h));break;case 0:case 11:case 14:case 15:if(!Tn&&(v=h.updateQueue,v!==null&&(v=v.lastEffect,v!==null))){C=v=v.next;do{var k=C,E=k.destroy;k=k.tag,E!==void 0&&(k&2||k&4)&&Xm(h,i,E),C=C.next}while(C!==v)}vo(a,i,h);break;case 1:if(!Tn&&(ta(h,i),v=h.stateNode,typeof v.componentWillUnmount=="function"))try{v.props=h.memoizedProps,v.state=h.memoizedState,v.componentWillUnmount()}catch(X){$t(h,i,X)}vo(a,i,h);break;case 21:vo(a,i,h);break;case 22:h.mode&1?(Tn=(v=Tn)||h.memoizedState!==null,vo(a,i,h),Tn=v):vo(a,i,h);break;default:vo(a,i,h)}}function yx(a){var i=a.updateQueue;if(i!==null){a.updateQueue=null;var h=a.stateNode;h===null&&(h=a.stateNode=new s5),i.forEach(function(v){var C=m5.bind(null,a,v);h.has(v)||(h.add(v),v.then(C,C))})}}function Qs(a,i){var h=i.deletions;if(h!==null)for(var v=0;v<h.length;v++){var C=h[v];try{var k=a,E=i;if(ue){var X=E;e:for(;X!==null;){switch(X.tag){case 5:In=X.stateNode,qs=!1;break e;case 3:In=X.stateNode.containerInfo,qs=!0;break e;case 4:In=X.stateNode.containerInfo,qs=!0;break e}X=X.return}if(In===null)throw Error(c(160));nh(k,E,C),In=null,qs=!1}else nh(k,E,C);var ie=C.alternate;ie!==null&&(ie.return=null),C.return=null}catch(Ae){$t(C,i,Ae)}}if(i.subtreeFlags&12854)for(i=i.child;i!==null;)bx(i,a),i=i.sibling}function bx(a,i){var h=a.alternate,v=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:if(Qs(i,a),Co(a),v&4){try{hi(3,a,a.return),hu(3,a)}catch(Re){$t(a,a.return,Re)}try{hi(5,a,a.return)}catch(Re){$t(a,a.return,Re)}}break;case 1:Qs(i,a),Co(a),v&512&&h!==null&&ta(h,h.return);break;case 5:if(Qs(i,a),Co(a),v&512&&h!==null&&ta(h,h.return),ue){if(a.flags&32){var C=a.stateNode;try{is(C)}catch(Re){$t(a,a.return,Re)}}if(v&4&&(C=a.stateNode,C!=null)){var k=a.memoizedProps;if(h=h!==null?h.memoizedProps:k,v=a.type,i=a.updateQueue,a.updateQueue=null,i!==null)try{Jt(C,i,v,h,k,a)}catch(Re){$t(a,a.return,Re)}}}break;case 6:if(Qs(i,a),Co(a),v&4&&ue){if(a.stateNode===null)throw Error(c(162));C=a.stateNode,k=a.memoizedProps,h=h!==null?h.memoizedProps:k;try{Ot(C,h,k)}catch(Re){$t(a,a.return,Re)}}break;case 3:if(Qs(i,a),Co(a),v&4){if(ue&&W&&h!==null&&h.memoizedState.isDehydrated)try{b4(i.containerInfo)}catch(Re){$t(a,a.return,Re)}if(xe){C=i.containerInfo,k=i.pendingChildren;try{uo(C,k)}catch(Re){$t(a,a.return,Re)}}}break;case 4:if(Qs(i,a),Co(a),v&4&&xe){k=a.stateNode,C=k.containerInfo,k=k.pendingChildren;try{uo(C,k)}catch(Re){$t(a,a.return,Re)}}break;case 13:Qs(i,a),Co(a),C=a.child,C.flags&8192&&(k=C.memoizedState!==null,C.stateNode.isHidden=k,!k||C.alternate!==null&&C.alternate.memoizedState!==null||(ch=vn())),v&4&&yx(a);break;case 22:var E=h!==null&&h.memoizedState!==null;if(a.mode&1?(Tn=(h=Tn)||E,Qs(i,a),Tn=h):Qs(i,a),Co(a),v&8192){if(h=a.memoizedState!==null,(a.stateNode.isHidden=h)&&!E&&a.mode&1)for(Ne=a,v=a.child;v!==null;){for(i=Ne=v;Ne!==null;){E=Ne;var X=E.child;switch(E.tag){case 0:case 11:case 14:case 15:hi(4,E,E.return);break;case 1:ta(E,E.return);var ie=E.stateNode;if(typeof ie.componentWillUnmount=="function"){var Ae=E,ze=E.return;try{var nt=Ae;ie.props=nt.memoizedProps,ie.state=nt.memoizedState,ie.componentWillUnmount()}catch(Re){$t(Ae,ze,Re)}}break;case 5:ta(E,E.return);break;case 22:if(E.memoizedState!==null){kx(i);continue}}X!==null?(X.return=E,Ne=X):kx(i)}v=v.sibling}if(ue){e:if(v=null,ue)for(i=a;;){if(i.tag===5){if(v===null){v=i;try{C=i.stateNode,h?cn(C):Hl(i.stateNode,i.memoizedProps)}catch(Re){$t(a,a.return,Re)}}}else if(i.tag===6){if(v===null)try{k=i.stateNode,h?_s(k):rm(k,i.memoizedProps)}catch(Re){$t(a,a.return,Re)}}else if((i.tag!==22&&i.tag!==23||i.memoizedState===null||i===a)&&i.child!==null){i.child.return=i,i=i.child;continue}if(i===a)break e;for(;i.sibling===null;){if(i.return===null||i.return===a)break e;v===i&&(v=null),i=i.return}v===i&&(v=null),i.sibling.return=i.return,i=i.sibling}}}break;case 19:Qs(i,a),Co(a),v&4&&yx(a);break;case 21:break;default:Qs(i,a),Co(a)}}function Co(a){var i=a.flags;if(i&2){try{if(ue){e:{for(var h=a.return;h!==null;){if(vx(h)){var v=h;break e}h=h.return}throw Error(c(160))}switch(v.tag){case 5:var C=v.stateNode;v.flags&32&&(is(C),v.flags&=-33);var k=Cx(a);th(a,k,C);break;case 3:case 4:var E=v.stateNode.containerInfo,X=Cx(a);eh(a,X,E);break;default:throw Error(c(161))}}}catch(ie){$t(a,a.return,ie)}a.flags&=-3}i&4096&&(a.flags&=-4097)}function r5(a,i,h){Ne=a,jx(a)}function jx(a,i,h){for(var v=(a.mode&1)!==0;Ne!==null;){var C=Ne,k=C.child;if(C.tag===22&&v){var E=C.memoizedState!==null||mu;if(!E){var X=C.alternate,ie=X!==null&&X.memoizedState!==null||Tn;X=mu;var Ae=Tn;if(mu=E,(Tn=ie)&&!Ae)for(Ne=C;Ne!==null;)E=Ne,ie=E.child,E.tag===22&&E.memoizedState!==null?wx(C):ie!==null?(ie.return=E,Ne=ie):wx(C);for(;k!==null;)Ne=k,jx(k),k=k.sibling;Ne=C,mu=X,Tn=Ae}Sx(a)}else C.subtreeFlags&8772&&k!==null?(k.return=C,Ne=k):Sx(a)}}function Sx(a){for(;Ne!==null;){var i=Ne;if(i.flags&8772){var h=i.alternate;try{if(i.flags&8772)switch(i.tag){case 0:case 11:case 15:Tn||hu(5,i);break;case 1:var v=i.stateNode;if(i.flags&4&&!Tn)if(h===null)v.componentDidMount();else{var C=i.elementType===i.type?h.memoizedProps:Zs(i.type,h.memoizedProps);v.componentDidUpdate(C,h.memoizedState,v.__reactInternalSnapshotBeforeUpdate)}var k=i.updateQueue;k!==null&&j1(i,k,v);break;case 3:var E=i.updateQueue;if(E!==null){if(h=null,i.child!==null)switch(i.child.tag){case 5:h=he(i.child.stateNode);break;case 1:h=i.child.stateNode}j1(i,E,h)}break;case 5:var X=i.stateNode;h===null&&i.flags&4&&Xt(X,i.type,i.memoizedProps,i);break;case 6:break;case 4:break;case 12:break;case 13:if(W&&i.memoizedState===null){var ie=i.alternate;if(ie!==null){var Ae=ie.memoizedState;if(Ae!==null){var ze=Ae.dehydrated;ze!==null&&j4(ze)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(c(163))}Tn||i.flags&512&&Jm(i)}catch(nt){$t(i,i.return,nt)}}if(i===a){Ne=null;break}if(h=i.sibling,h!==null){h.return=i.return,Ne=h;break}Ne=i.return}}function kx(a){for(;Ne!==null;){var i=Ne;if(i===a){Ne=null;break}var h=i.sibling;if(h!==null){h.return=i.return,Ne=h;break}Ne=i.return}}function wx(a){for(;Ne!==null;){var i=Ne;try{switch(i.tag){case 0:case 11:case 15:var h=i.return;try{hu(4,i)}catch(ie){$t(i,h,ie)}break;case 1:var v=i.stateNode;if(typeof v.componentDidMount=="function"){var C=i.return;try{v.componentDidMount()}catch(ie){$t(i,C,ie)}}var k=i.return;try{Jm(i)}catch(ie){$t(i,k,ie)}break;case 5:var E=i.return;try{Jm(i)}catch(ie){$t(i,E,ie)}}}catch(ie){$t(i,i.return,ie)}if(i===a){Ne=null;break}var X=i.sibling;if(X!==null){X.return=i.return,Ne=X;break}Ne=i.return}}var pu=0,gu=1,xu=2,vu=3,Cu=4;if(typeof Symbol=="function"&&Symbol.for){var pi=Symbol.for;pu=pi("selector.component"),gu=pi("selector.has_pseudo_class"),xu=pi("selector.role"),vu=pi("selector.test_id"),Cu=pi("selector.text")}function sh(a){var i=Me(a);if(i!=null){if(typeof i.memoizedProps["data-testname"]!="string")throw Error(c(364));return i}if(a=ce(a),a===null)throw Error(c(362));return a.stateNode.current}function oh(a,i){switch(i.$$typeof){case pu:if(a.type===i.value)return!0;break;case gu:e:{i=i.value,a=[a,0];for(var h=0;h<a.length;){var v=a[h++],C=a[h++],k=i[C];if(v.tag!==5||!K(v)){for(;k!=null&&oh(v,k);)C++,k=i[C];if(C===i.length){i=!0;break e}else for(v=v.child;v!==null;)a.push(v,C),v=v.sibling}}i=!1}return i;case xu:if(a.tag===5&&ve(a.stateNode,i.value))return!0;break;case Cu:if((a.tag===5||a.tag===6)&&(a=be(a),a!==null&&0<=a.indexOf(i.value)))return!0;break;case vu:if(a.tag===5&&(a=a.memoizedProps["data-testname"],typeof a=="string"&&a.toLowerCase()===i.value.toLowerCase()))return!0;break;default:throw Error(c(365))}return!1}function rh(a){switch(a.$$typeof){case pu:return"<"+(F(a.value)||"Unknown")+">";case gu:return":has("+(rh(a)||"")+")";case xu:return'[role="'+a.value+'"]';case Cu:return'"'+a.value+'"';case vu:return'[data-testname="'+a.value+'"]';default:throw Error(c(365))}}function Ix(a,i){var h=[];a=[a,0];for(var v=0;v<a.length;){var C=a[v++],k=a[v++],E=i[k];if(C.tag!==5||!K(C)){for(;E!=null&&oh(C,E);)k++,E=i[k];if(k===i.length)h.push(C);else for(C=C.child;C!==null;)a.push(C,k),C=C.sibling}}return h}function lh(a,i){if(!ne)throw Error(c(363));a=sh(a),a=Ix(a,i),i=[],a=Array.from(a);for(var h=0;h<a.length;){var v=a[h++];if(v.tag===5)K(v)||i.push(v.stateNode);else for(v=v.child;v!==null;)a.push(v),v=v.sibling}return i}var l5=Math.ceil,yu=d.ReactCurrentDispatcher,ah=d.ReactCurrentOwner,rn=d.ReactCurrentBatchConfig,ut=0,yn=null,un=null,Mn=0,us=0,na=mr(0),fn=0,gi=null,ul=0,bu=0,ih=0,xi=null,qn=null,ch=0,uh=1/0,Wo=null;function sa(){uh=vn()+500}var ju=!1,dh=null,xr=null,Su=!1,vr=null,ku=0,vi=0,fh=null,wu=-1,Iu=0;function Rn(){return ut&6?vn():wu!==-1?wu:wu=vn()}function Cr(a){return a.mode&1?ut&2&&Mn!==0?Mn&-Mn:$4.transition!==null?(Iu===0&&(Iu=c1()),Iu):(a=xt,a!==0?a:Pe()):1}function Rs(a,i,h,v){if(50<vi)throw vi=0,fh=null,Error(c(185));ni(a,h,v),(!(ut&2)||a!==yn)&&(a===yn&&(!(ut&2)&&(bu|=h),fn===4&&yr(a,Mn)),Qn(a,v),h===1&&ut===0&&!(i.mode&1)&&(sa(),Gc&&mo()))}function Qn(a,i){var h=a.callbackNode;L4(a,i);var v=Wc(a,a===yn?Mn:0);if(v===0)h!==null&&d1(h),a.callbackNode=null,a.callbackPriority=0;else if(i=v&-v,a.callbackPriority!==i){if(h!=null&&d1(h),i===1)a.tag===0?H4(_x.bind(null,a)):f1(_x.bind(null,a)),Ye?O(function(){!(ut&6)&&mo()}):pm(gm,mo),h=null;else{switch(u1(v)){case 1:h=gm;break;case 4:h=O4;break;case 16:h=xm;break;case 536870912:h=N4;break;default:h=xm}h=Ox(h,Mx.bind(null,a))}a.callbackPriority=i,a.callbackNode=h}}function Mx(a,i){if(wu=-1,Iu=0,ut&6)throw Error(c(327));var h=a.callbackNode;if(ml()&&a.callbackNode!==h)return null;var v=Wc(a,a===yn?Mn:0);if(v===0)return null;if(v&30||v&a.expiredLanes||i)i=Mu(a,v);else{i=v;var C=ut;ut|=2;var k=Ex();(yn!==a||Mn!==i)&&(Wo=null,sa(),dl(a,i));do try{c5();break}catch(X){Px(a,X)}while(!0);wm(),yu.current=k,ut=C,un!==null?i=0:(yn=null,Mn=0,i=fn)}if(i!==0){if(i===2&&(C=fm(a),C!==0&&(v=C,i=mh(a,C))),i===1)throw h=gi,dl(a,0),yr(a,v),Qn(a,vn()),h;if(i===6)yr(a,v);else{if(C=a.current.alternate,!(v&30)&&!a5(C)&&(i=Mu(a,v),i===2&&(k=fm(a),k!==0&&(v=k,i=mh(a,k))),i===1))throw h=gi,dl(a,0),yr(a,v),Qn(a,vn()),h;switch(a.finishedWork=C,a.finishedLanes=v,i){case 0:case 1:throw Error(c(345));case 2:fl(a,qn,Wo);break;case 3:if(yr(a,v),(v&130023424)===v&&(i=ch+500-vn(),10<i)){if(Wc(a,0)!==0)break;if(C=a.suspendedLanes,(C&v)!==v){Rn(),a.pingedLanes|=a.suspendedLanes&C;break}a.timeoutHandle=H(fl.bind(null,a,qn,Wo),i);break}fl(a,qn,Wo);break;case 4:if(yr(a,v),(v&4194240)===v)break;for(i=a.eventTimes,C=-1;0<v;){var E=31-Ws(v);k=1<<E,E=i[E],E>C&&(C=E),v&=~k}if(v=C,v=vn()-v,v=(120>v?120:480>v?480:1080>v?1080:1920>v?1920:3e3>v?3e3:4320>v?4320:1960*l5(v/1960))-v,10<v){a.timeoutHandle=H(fl.bind(null,a,qn,Wo),v);break}fl(a,qn,Wo);break;case 5:fl(a,qn,Wo);break;default:throw Error(c(329))}}}return Qn(a,vn()),a.callbackNode===h?Mx.bind(null,a):null}function mh(a,i){var h=xi;return a.current.memoizedState.isDehydrated&&(dl(a,i).flags|=256),a=Mu(a,i),a!==2&&(i=qn,qn=h,i!==null&&hh(i)),a}function hh(a){qn===null?qn=a:qn.push.apply(qn,a)}function a5(a){for(var i=a;;){if(i.flags&16384){var h=i.updateQueue;if(h!==null&&(h=h.stores,h!==null))for(var v=0;v<h.length;v++){var C=h[v],k=C.getSnapshot;C=C.value;try{if(!Us(k(),C))return!1}catch{return!1}}}if(h=i.child,i.subtreeFlags&16384&&h!==null)h.return=i,i=h;else{if(i===a)break;for(;i.sibling===null;){if(i.return===null||i.return===a)return!0;i=i.return}i.sibling.return=i.return,i=i.sibling}}return!0}function yr(a,i){for(i&=~ih,i&=~bu,a.suspendedLanes|=i,a.pingedLanes&=~i,a=a.expirationTimes;0<i;){var h=31-Ws(i),v=1<<h;a[h]=-1,i&=~v}}function _x(a){if(ut&6)throw Error(c(327));ml();var i=Wc(a,0);if(!(i&1))return Qn(a,vn()),null;var h=Mu(a,i);if(a.tag!==0&&h===2){var v=fm(a);v!==0&&(i=v,h=mh(a,v))}if(h===1)throw h=gi,dl(a,0),yr(a,i),Qn(a,vn()),h;if(h===6)throw Error(c(345));return a.finishedWork=a.current.alternate,a.finishedLanes=i,fl(a,qn,Wo),Qn(a,vn()),null}function Ax(a){vr!==null&&vr.tag===0&&!(ut&6)&&ml();var i=ut;ut|=1;var h=rn.transition,v=xt;try{if(rn.transition=null,xt=1,a)return a()}finally{xt=v,rn.transition=h,ut=i,!(ut&6)&&mo()}}function ph(){us=na.current,Nt(na)}function dl(a,i){a.finishedWork=null,a.finishedLanes=0;var h=a.timeoutHandle;if(h!==le&&(a.timeoutHandle=le,V(h)),un!==null)for(h=un.return;h!==null;){var v=h;switch(ym(v),v.tag){case 1:v=v.type.childContextTypes,v!=null&&zc();break;case 3:Jl(),Nt(Un),Nt(En),Rm();break;case 5:Lm(v);break;case 4:Jl();break;case 13:Nt(Ut);break;case 19:Nt(Ut);break;case 10:Im(v.type._context);break;case 22:case 23:ph()}h=h.return}if(yn=a,un=a=br(a.current,null),Mn=us=i,fn=0,gi=null,ih=bu=ul=0,qn=xi=null,il!==null){for(i=0;i<il.length;i++)if(h=il[i],v=h.interleaved,v!==null){h.interleaved=null;var C=v.next,k=h.pending;if(k!==null){var E=k.next;k.next=C,v.next=E}h.pending=v}il=null}return a}function Px(a,i){do{var h=un;try{if(wm(),ou.current=iu,ru){for(var v=Gt.memoizedState;v!==null;){var C=v.queue;C!==null&&(C.pending=null),v=v.next}ru=!1}if(cl=0,Cn=dn=Gt=null,ai=!1,ii=0,ah.current=null,h===null||h.return===null){fn=1,gi=i,un=null;break}e:{var k=a,E=h.return,X=h,ie=i;if(i=Mn,X.flags|=32768,ie!==null&&typeof ie=="object"&&typeof ie.then=="function"){var Ae=ie,ze=X,nt=ze.tag;if(!(ze.mode&1)&&(nt===0||nt===11||nt===15)){var Re=ze.alternate;Re?(ze.updateQueue=Re.updateQueue,ze.memoizedState=Re.memoizedState,ze.lanes=Re.lanes):(ze.updateQueue=null,ze.memoizedState=null)}var Ft=tx(E);if(Ft!==null){Ft.flags&=-257,nx(Ft,E,X,k,i),Ft.mode&1&&ex(k,Ae,i),i=Ft,ie=Ae;var Et=i.updateQueue;if(Et===null){var Kn=new Set;Kn.add(ie),i.updateQueue=Kn}else Et.add(ie);break e}else{if(!(i&1)){ex(k,Ae,i),gh();break e}ie=Error(c(426))}}else if(Ht&&X.mode&1){var Uo=tx(E);if(Uo!==null){!(Uo.flags&65536)&&(Uo.flags|=256),nx(Uo,E,X,k,i),Sm(ea(ie,X));break e}}k=ie=ea(ie,X),fn!==4&&(fn=2),xi===null?xi=[k]:xi.push(k),k=E;do{switch(k.tag){case 3:k.flags|=65536,i&=-i,k.lanes|=i;var ae=X1(k,ie,i);b1(k,ae);break e;case 1:X=ie;var ee=k.type,me=k.stateNode;if(!(k.flags&128)&&(typeof ee.getDerivedStateFromError=="function"||me!==null&&typeof me.componentDidCatch=="function"&&(xr===null||!xr.has(me)))){k.flags|=65536,i&=-i,k.lanes|=i;var Be=J1(k,X,i);b1(k,Be);break e}}k=k.return}while(k!==null)}Lx(h)}catch(Ke){i=Ke,un===h&&h!==null&&(un=h=h.return);continue}break}while(!0)}function Ex(){var a=yu.current;return yu.current=iu,a===null?iu:a}function gh(){(fn===0||fn===3||fn===2)&&(fn=4),yn===null||!(ul&268435455)&&!(bu&268435455)||yr(yn,Mn)}function Mu(a,i){var h=ut;ut|=2;var v=Ex();(yn!==a||Mn!==i)&&(Wo=null,dl(a,i));do try{i5();break}catch(C){Px(a,C)}while(!0);if(wm(),ut=h,yu.current=v,un!==null)throw Error(c(261));return yn=null,Mn=0,fn}function i5(){for(;un!==null;)Dx(un)}function c5(){for(;un!==null&&!R4();)Dx(un)}function Dx(a){var i=Bx(a.alternate,a,us);a.memoizedProps=a.pendingProps,i===null?Lx(a):un=i,ah.current=null}function Lx(a){var i=a;do{var h=i.alternate;if(a=i.return,i.flags&32768){if(h=n5(h,i),h!==null){h.flags&=32767,un=h;return}if(a!==null)a.flags|=32768,a.subtreeFlags=0,a.deletions=null;else{fn=6,un=null;return}}else if(h=t5(h,i,us),h!==null){un=h;return}if(i=i.sibling,i!==null){un=i;return}un=i=a}while(i!==null);fn===0&&(fn=5)}function fl(a,i,h){var v=xt,C=rn.transition;try{rn.transition=null,xt=1,u5(a,i,h,v)}finally{rn.transition=C,xt=v}return null}function u5(a,i,h,v){do ml();while(vr!==null);if(ut&6)throw Error(c(327));h=a.finishedWork;var C=a.finishedLanes;if(h===null)return null;if(a.finishedWork=null,a.finishedLanes=0,h===a.current)throw Error(c(177));a.callbackNode=null,a.callbackPriority=0;var k=h.lanes|h.childLanes;if(T4(a,k),a===yn&&(un=yn=null,Mn=0),!(h.subtreeFlags&2064)&&!(h.flags&2064)||Su||(Su=!0,Ox(xm,function(){return ml(),null})),k=(h.flags&15990)!==0,h.subtreeFlags&15990||k){k=rn.transition,rn.transition=null;var E=xt;xt=1;var X=ut;ut|=4,ah.current=null,o5(a,h),bx(h,a),De(a.containerInfo),a.current=h,r5(h),B4(),ut=X,xt=E,rn.transition=k}else a.current=h;if(Su&&(Su=!1,vr=a,ku=C),k=a.pendingLanes,k===0&&(xr=null),F4(h.stateNode),Qn(a,vn()),i!==null)for(v=a.onRecoverableError,h=0;h<i.length;h++)C=i[h],v(C.value,{componentStack:C.stack,digest:C.digest});if(ju)throw ju=!1,a=dh,dh=null,a;return ku&1&&a.tag!==0&&ml(),k=a.pendingLanes,k&1?a===fh?vi++:(vi=0,fh=a):vi=0,mo(),null}function ml(){if(vr!==null){var a=u1(ku),i=rn.transition,h=xt;try{if(rn.transition=null,xt=16>a?16:a,vr===null)var v=!1;else{if(a=vr,vr=null,ku=0,ut&6)throw Error(c(331));var C=ut;for(ut|=4,Ne=a.current;Ne!==null;){var k=Ne,E=k.child;if(Ne.flags&16){var X=k.deletions;if(X!==null){for(var ie=0;ie<X.length;ie++){var Ae=X[ie];for(Ne=Ae;Ne!==null;){var ze=Ne;switch(ze.tag){case 0:case 11:case 15:hi(8,ze,k)}var nt=ze.child;if(nt!==null)nt.return=ze,Ne=nt;else for(;Ne!==null;){ze=Ne;var Re=ze.sibling,Ft=ze.return;if(xx(ze),ze===Ae){Ne=null;break}if(Re!==null){Re.return=Ft,Ne=Re;break}Ne=Ft}}}var Et=k.alternate;if(Et!==null){var Kn=Et.child;if(Kn!==null){Et.child=null;do{var Uo=Kn.sibling;Kn.sibling=null,Kn=Uo}while(Kn!==null)}}Ne=k}}if(k.subtreeFlags&2064&&E!==null)E.return=k,Ne=E;else e:for(;Ne!==null;){if(k=Ne,k.flags&2048)switch(k.tag){case 0:case 11:case 15:hi(9,k,k.return)}var ae=k.sibling;if(ae!==null){ae.return=k.return,Ne=ae;break e}Ne=k.return}}var ee=a.current;for(Ne=ee;Ne!==null;){E=Ne;var me=E.child;if(E.subtreeFlags&2064&&me!==null)me.return=E,Ne=me;else e:for(E=ee;Ne!==null;){if(X=Ne,X.flags&2048)try{switch(X.tag){case 0:case 11:case 15:hu(9,X)}}catch(Ke){$t(X,X.return,Ke)}if(X===E){Ne=null;break e}var Be=X.sibling;if(Be!==null){Be.return=X.return,Ne=Be;break e}Ne=X.return}}if(ut=C,mo(),fo&&typeof fo.onPostCommitFiberRoot=="function")try{fo.onPostCommitFiberRoot(Uc,a)}catch{}v=!0}return v}finally{xt=h,rn.transition=i}}return!1}function Tx(a,i,h){i=ea(h,i),i=X1(a,i,1),a=gr(a,i,1),i=Rn(),a!==null&&(ni(a,1,i),Qn(a,i))}function $t(a,i,h){if(a.tag===3)Tx(a,a,h);else for(;i!==null;){if(i.tag===3){Tx(i,a,h);break}else if(i.tag===1){var v=i.stateNode;if(typeof i.type.getDerivedStateFromError=="function"||typeof v.componentDidCatch=="function"&&(xr===null||!xr.has(v))){a=ea(h,a),a=J1(i,a,1),i=gr(i,a,1),a=Rn(),i!==null&&(ni(i,1,a),Qn(i,a));break}}i=i.return}}function d5(a,i,h){var v=a.pingCache;v!==null&&v.delete(i),i=Rn(),a.pingedLanes|=a.suspendedLanes&h,yn===a&&(Mn&h)===h&&(fn===4||fn===3&&(Mn&130023424)===Mn&&500>vn()-ch?dl(a,0):ih|=h),Qn(a,i)}function Rx(a,i){i===0&&(a.mode&1?(i=Vc,Vc<<=1,!(Vc&130023424)&&(Vc=4194304)):i=1);var h=Rn();a=ho(a,i),a!==null&&(ni(a,i,h),Qn(a,h))}function f5(a){var i=a.memoizedState,h=0;i!==null&&(h=i.retryLane),Rx(a,h)}function m5(a,i){var h=0;switch(a.tag){case 13:var v=a.stateNode,C=a.memoizedState;C!==null&&(h=C.retryLane);break;case 19:v=a.stateNode;break;default:throw Error(c(314))}v!==null&&v.delete(i),Rx(a,h)}var Bx;Bx=function(a,i,h){if(a!==null)if(a.memoizedProps!==i.pendingProps||Un.current)Zn=!0;else{if(!(a.lanes&h)&&!(i.flags&128))return Zn=!1,e5(a,i,h);Zn=!!(a.flags&131072)}else Zn=!1,Ht&&i.flags&1048576&&m1(i,qc,i.index);switch(i.lanes=0,i.tag){case 2:var v=i.type;uu(a,i),a=i.pendingProps;var C=Ul(i,En.current);Kl(i,h),C=Nm(null,i,v,a,C,h);var k=Fm();return i.flags|=1,typeof C=="object"&&C!==null&&typeof C.render=="function"&&C.$$typeof===void 0?(i.tag=1,i.memoizedState=null,i.updateQueue=null,Gn(v)?(k=!0,Hc(i)):k=!1,i.memoizedState=C.state!==null&&C.state!==void 0?C.state:null,Am(i),C.updater=tu,i.stateNode=C,C._reactInternals=i,Em(i,v,a,h),i=Zm(null,i,v,!0,k,h)):(i.tag=0,Ht&&k&&Cm(i),On(null,i,C,h),i=i.child),i;case 16:v=i.elementType;e:{switch(uu(a,i),a=i.pendingProps,C=v._init,v=C(v._payload),i.type=v,C=i.tag=p5(v),a=Zs(v,a),C){case 0:i=Gm(null,i,v,a,h);break e;case 1:i=ix(null,i,v,a,h);break e;case 11:i=sx(null,i,v,a,h);break e;case 14:i=ox(null,i,v,Zs(v.type,a),h);break e}throw Error(c(306,v,""))}return i;case 0:return v=i.type,C=i.pendingProps,C=i.elementType===v?C:Zs(v,C),Gm(a,i,v,C,h);case 1:return v=i.type,C=i.pendingProps,C=i.elementType===v?C:Zs(v,C),ix(a,i,v,C,h);case 3:e:{if(cx(i),a===null)throw Error(c(387));v=i.pendingProps,k=i.memoizedState,C=k.element,y1(a,i),eu(i,v,null,h);var E=i.memoizedState;if(v=E.element,W&&k.isDehydrated)if(k={element:v,isDehydrated:!1,cache:E.cache,pendingSuspenseBoundaries:E.pendingSuspenseBoundaries,transitions:E.transitions},i.updateQueue.baseState=k,i.memoizedState=k,i.flags&256){C=ea(Error(c(423)),i),i=ux(a,i,v,h,C);break e}else if(v!==C){C=ea(Error(c(424)),i),i=ux(a,i,v,h,C);break e}else for(W&&(Es=p4(i.stateNode.containerInfo),cs=i,Ht=!0,Gs=null,si=!1),h=A1(i,null,v,h),i.child=h;h;)h.flags=h.flags&-3|4096,h=h.sibling;else{if(ql(),v===C){i=Vo(a,i,h);break e}On(a,i,v,h)}i=i.child}return i;case 5:return P1(i),a===null&&jm(i),v=i.type,C=i.pendingProps,k=a!==null?a.memoizedProps:null,E=C.children,P(v,C)?E=null:k!==null&&P(v,k)&&(i.flags|=32),ax(a,i),On(a,i,E,h),i.child;case 6:return a===null&&jm(i),null;case 13:return dx(a,i,h);case 4:return Dm(i,i.stateNode.containerInfo),v=i.pendingProps,a===null?i.child=Yl(i,null,v,h):On(a,i,v,h),i.child;case 11:return v=i.type,C=i.pendingProps,C=i.elementType===v?C:Zs(v,C),sx(a,i,v,C,h);case 7:return On(a,i,i.pendingProps,h),i.child;case 8:return On(a,i,i.pendingProps.children,h),i.child;case 12:return On(a,i,i.pendingProps.children,h),i.child;case 10:e:{if(v=i.type._context,C=i.pendingProps,k=i.memoizedProps,E=C.value,v1(i,v,E),k!==null)if(Us(k.value,E)){if(k.children===C.children&&!Un.current){i=Vo(a,i,h);break e}}else for(k=i.child,k!==null&&(k.return=i);k!==null;){var X=k.dependencies;if(X!==null){E=k.child;for(var ie=X.firstContext;ie!==null;){if(ie.context===v){if(k.tag===1){ie=$o(-1,h&-h),ie.tag=2;var Ae=k.updateQueue;if(Ae!==null){Ae=Ae.shared;var ze=Ae.pending;ze===null?ie.next=ie:(ie.next=ze.next,ze.next=ie),Ae.pending=ie}}k.lanes|=h,ie=k.alternate,ie!==null&&(ie.lanes|=h),Mm(k.return,h,i),X.lanes|=h;break}ie=ie.next}}else if(k.tag===10)E=k.type===i.type?null:k.child;else if(k.tag===18){if(E=k.return,E===null)throw Error(c(341));E.lanes|=h,X=E.alternate,X!==null&&(X.lanes|=h),Mm(E,h,i),E=k.sibling}else E=k.child;if(E!==null)E.return=k;else for(E=k;E!==null;){if(E===i){E=null;break}if(k=E.sibling,k!==null){k.return=E.return,E=k;break}E=E.return}k=E}On(a,i,C.children,h),i=i.child}return i;case 9:return C=i.type,v=i.pendingProps.children,Kl(i,h),C=Ds(C),v=v(C),i.flags|=1,On(a,i,v,h),i.child;case 14:return v=i.type,C=Zs(v,i.pendingProps),C=Zs(v.type,C),ox(a,i,v,C,h);case 15:return rx(a,i,i.type,i.pendingProps,h);case 17:return v=i.type,C=i.pendingProps,C=i.elementType===v?C:Zs(v,C),uu(a,i),i.tag=1,Gn(v)?(a=!0,Hc(i)):a=!1,Kl(i,h),w1(i,v,C),Em(i,v,C,h),Zm(null,i,v,!0,a,h);case 19:return mx(a,i,h);case 22:return lx(a,i,h)}throw Error(c(156,i.tag))};function Ox(a,i){return pm(a,i)}function h5(a,i,h,v){this.tag=a,this.key=h,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=i,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=v,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Bs(a,i,h,v){return new h5(a,i,h,v)}function xh(a){return a=a.prototype,!(!a||!a.isReactComponent)}function p5(a){if(typeof a=="function")return xh(a)?1:0;if(a!=null){if(a=a.$$typeof,a===b)return 11;if(a===w)return 14}return 2}function br(a,i){var h=a.alternate;return h===null?(h=Bs(a.tag,i,a.key,a.mode),h.elementType=a.elementType,h.type=a.type,h.stateNode=a.stateNode,h.alternate=a,a.alternate=h):(h.pendingProps=i,h.type=a.type,h.flags=0,h.subtreeFlags=0,h.deletions=null),h.flags=a.flags&14680064,h.childLanes=a.childLanes,h.lanes=a.lanes,h.child=a.child,h.memoizedProps=a.memoizedProps,h.memoizedState=a.memoizedState,h.updateQueue=a.updateQueue,i=a.dependencies,h.dependencies=i===null?null:{lanes:i.lanes,firstContext:i.firstContext},h.sibling=a.sibling,h.index=a.index,h.ref=a.ref,h}function _u(a,i,h,v,C,k){var E=2;if(v=a,typeof a=="function")xh(a)&&(E=1);else if(typeof a=="string")E=5;else e:switch(a){case g:return hl(h.children,C,k,i);case p:E=8,C|=8;break;case x:return a=Bs(12,h,i,C|2),a.elementType=x,a.lanes=k,a;case I:return a=Bs(13,h,i,C),a.elementType=I,a.lanes=k,a;case M:return a=Bs(19,h,i,C),a.elementType=M,a.lanes=k,a;case T:return Au(h,C,k,i);default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case y:E=10;break e;case S:E=9;break e;case b:E=11;break e;case w:E=14;break e;case _:E=16,v=null;break e}throw Error(c(130,a==null?a:typeof a,""))}return i=Bs(E,h,i,C),i.elementType=a,i.type=v,i.lanes=k,i}function hl(a,i,h,v){return a=Bs(7,a,v,i),a.lanes=h,a}function Au(a,i,h,v){return a=Bs(22,a,v,i),a.elementType=T,a.lanes=h,a.stateNode={isHidden:!1},a}function vh(a,i,h){return a=Bs(6,a,null,i),a.lanes=h,a}function Ch(a,i,h){return i=Bs(4,a.children!==null?a.children:[],a.key,i),i.lanes=h,i.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},i}function g5(a,i,h,v,C){this.tag=i,this.containerInfo=a,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=le,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=mm(0),this.expirationTimes=mm(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=mm(0),this.identifierPrefix=v,this.onRecoverableError=C,W&&(this.mutableSourceEagerHydrationData=null)}function Nx(a,i,h,v,C,k,E,X,ie){return a=new g5(a,i,h,X,ie),i===1?(i=1,k===!0&&(i|=8)):i=0,k=Bs(3,null,null,i),a.current=k,k.stateNode=a,k.memoizedState={element:v,isDehydrated:h,cache:null,transitions:null,pendingSuspenseBoundaries:null},Am(k),a}function Fx(a){if(!a)return hr;a=a._reactInternals;e:{if(q(a)!==a||a.tag!==1)throw Error(c(170));var i=a;do{switch(i.tag){case 3:i=i.stateNode.context;break e;case 1:if(Gn(i.type)){i=i.stateNode.__reactInternalMemoizedMergedChildContext;break e}}i=i.return}while(i!==null);throw Error(c(171))}if(a.tag===1){var h=a.type;if(Gn(h))return a1(a,h,i)}return i}function zx(a){var i=a._reactInternals;if(i===void 0)throw typeof a.render=="function"?Error(c(188)):(a=Object.keys(a).join(","),Error(c(268,a)));return a=N(i),a===null?null:a.stateNode}function Hx(a,i){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var h=a.retryLane;a.retryLane=h!==0&&h<i?h:i}}function Pu(a,i){Hx(a,i),(a=a.alternate)&&Hx(a,i)}function x5(a){return a=N(a),a===null?null:a.stateNode}function v5(){return null}return n.attemptContinuousHydration=function(a){if(a.tag===13){var i=ho(a,134217728);if(i!==null){var h=Rn();Rs(i,a,134217728,h)}Pu(a,134217728)}},n.attemptDiscreteHydration=function(a){if(a.tag===13){var i=ho(a,1);if(i!==null){var h=Rn();Rs(i,a,1,h)}Pu(a,1)}},n.attemptHydrationAtCurrentPriority=function(a){if(a.tag===13){var i=Cr(a),h=ho(a,i);if(h!==null){var v=Rn();Rs(h,a,i,v)}Pu(a,i)}},n.attemptSynchronousHydration=function(a){switch(a.tag){case 3:var i=a.stateNode;if(i.current.memoizedState.isDehydrated){var h=ti(i.pendingLanes);h!==0&&(hm(i,h|1),Qn(i,vn()),!(ut&6)&&(sa(),mo()))}break;case 13:Ax(function(){var v=ho(a,1);if(v!==null){var C=Rn();Rs(v,a,1,C)}}),Pu(a,1)}},n.batchedUpdates=function(a,i){var h=ut;ut|=1;try{return a(i)}finally{ut=h,ut===0&&(sa(),Gc&&mo())}},n.createComponentSelector=function(a){return{$$typeof:pu,value:a}},n.createContainer=function(a,i,h,v,C,k,E){return Nx(a,i,!1,null,h,v,C,k,E)},n.createHasPseudoClassSelector=function(a){return{$$typeof:gu,value:a}},n.createHydrationContainer=function(a,i,h,v,C,k,E,X,ie){return a=Nx(h,v,!0,a,C,k,E,X,ie),a.context=Fx(null),h=a.current,v=Rn(),C=Cr(h),k=$o(v,C),k.callback=i??null,gr(h,k,C),a.current.lanes=C,ni(a,C,v),Qn(a,v),a},n.createPortal=function(a,i,h){var v=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:m,key:v==null?null:""+v,children:a,containerInfo:i,implementation:h}},n.createRoleSelector=function(a){return{$$typeof:xu,value:a}},n.createTestNameSelector=function(a){return{$$typeof:vu,value:a}},n.createTextSelector=function(a){return{$$typeof:Cu,value:a}},n.deferredUpdates=function(a){var i=xt,h=rn.transition;try{return rn.transition=null,xt=16,a()}finally{xt=i,rn.transition=h}},n.discreteUpdates=function(a,i,h,v,C){var k=xt,E=rn.transition;try{return rn.transition=null,xt=1,a(i,h,v,C)}finally{xt=k,rn.transition=E,ut===0&&sa()}},n.findAllNodes=lh,n.findBoundingRects=function(a,i){if(!ne)throw Error(c(363));i=lh(a,i),a=[];for(var h=0;h<i.length;h++)a.push(_e(i[h]));for(i=a.length-1;0<i;i--){h=a[i];for(var v=h.x,C=v+h.width,k=h.y,E=k+h.height,X=i-1;0<=X;X--)if(i!==X){var ie=a[X],Ae=ie.x,ze=Ae+ie.width,nt=ie.y,Re=nt+ie.height;if(v>=Ae&&k>=nt&&C<=ze&&E<=Re){a.splice(i,1);break}else if(v!==Ae||h.width!==ie.width||Re<k||nt>E){if(!(k!==nt||h.height!==ie.height||ze<v||Ae>C)){Ae>v&&(ie.width+=Ae-v,ie.x=v),ze<C&&(ie.width=C-Ae),a.splice(i,1);break}}else{nt>k&&(ie.height+=nt-k,ie.y=k),Re<E&&(ie.height=E-nt),a.splice(i,1);break}}}return a},n.findHostInstance=zx,n.findHostInstanceWithNoPortals=function(a){return a=Z(a),a=a!==null?$(a):null,a===null?null:a.stateNode},n.findHostInstanceWithWarning=function(a){return zx(a)},n.flushControlled=function(a){var i=ut;ut|=1;var h=rn.transition,v=xt;try{rn.transition=null,xt=1,a()}finally{xt=v,rn.transition=h,ut=i,ut===0&&(sa(),mo())}},n.flushPassiveEffects=ml,n.flushSync=Ax,n.focusWithin=function(a,i){if(!ne)throw Error(c(363));for(a=sh(a),i=Ix(a,i),i=Array.from(i),a=0;a<i.length;){var h=i[a++];if(!K(h)){if(h.tag===5&&Ee(h.stateNode))return!0;for(h=h.child;h!==null;)i.push(h),h=h.sibling}}return!1},n.getCurrentUpdatePriority=function(){return xt},n.getFindAllNodesFailureDescription=function(a,i){if(!ne)throw Error(c(363));var h=0,v=[];a=[sh(a),0];for(var C=0;C<a.length;){var k=a[C++],E=a[C++],X=i[E];if((k.tag!==5||!K(k))&&(oh(k,X)&&(v.push(rh(X)),E++,E>h&&(h=E)),E<i.length))for(k=k.child;k!==null;)a.push(k,E),k=k.sibling}if(h<i.length){for(a=[];h<i.length;h++)a.push(rh(i[h]));return`findAllNodes was able to match part of the selector:
  `+(v.join(" > ")+`

No matching component was found for:
  `)+a.join(" > ")}return null},n.getPublicRootInstance=function(a){if(a=a.current,!a.child)return null;switch(a.child.tag){case 5:return he(a.child.stateNode);default:return a.child.stateNode}},n.injectIntoDevTools=function(a){if(a={bundleType:a.bundleType,version:a.version,rendererPackageName:a.rendererPackageName,rendererConfig:a.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:d.ReactCurrentDispatcher,findHostInstanceByFiber:x5,findFiberByHostInstance:a.findFiberByHostInstance||v5,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.2.0"},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")a=!1;else{var i=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(i.isDisabled||!i.supportsFiber)a=!0;else{try{Uc=i.inject(a),fo=i}catch{}a=!!i.checkDCE}}return a},n.isAlreadyRendering=function(){return!1},n.observeVisibleRects=function(a,i,h,v){if(!ne)throw Error(c(363));a=lh(a,i);var C=Ze(a,h,v).disconnect;return{disconnect:function(){C()}}},n.registerMutableSourceForHydration=function(a,i){var h=i._getVersion;h=h(i._source),a.mutableSourceEagerHydrationData==null?a.mutableSourceEagerHydrationData=[i,h]:a.mutableSourceEagerHydrationData.push(i,h)},n.runWithPriority=function(a,i){var h=xt;try{return xt=a,i()}finally{xt=h}},n.shouldError=function(){return null},n.shouldSuspend=function(){return!1},n.updateContainer=function(a,i,h,v){var C=i.current,k=Rn(),E=Cr(C);return h=Fx(h),i.context===null?i.context=h:i.pendingContext=h,i=$o(k,E),i.payload={element:a},v=v===void 0?null:v,v!==null&&(i.callback=v),a=gr(C,i,E),a!==null&&(Rs(a,C,E,k),Jc(a,C,E)),E},n};t4.exports=AZ;var PZ=t4.exports;const EZ=ic(PZ);var n4={exports:{}},zl={};/**
 * @license React
 * react-reconciler-constants.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */zl.ConcurrentRoot=1;zl.ContinuousEventPriority=4;zl.DefaultEventPriority=16;zl.DiscreteEventPriority=1;zl.IdleEventPriority=536870912;zl.LegacyRoot=0;n4.exports=zl;var s4=n4.exports;const PC={children:!0,ref:!0,key:!0,style:!0,forwardedRef:!0,unstable_applyCache:!0,unstable_applyDrawHitFromCache:!0};let EC=!1,DC=!1;const o1=".react-konva-event",DZ=`ReactKonva: You have a Konva node with draggable = true and position defined but no onDragMove or onDragEnd events are handled.
Position of a node will be changed during drag&drop, so you should update state of the react app as well.
Consider to add onDragMove or onDragEnd events.
For more info see: https://github.com/konvajs/react-konva/issues/256
`,LZ=`ReactKonva: You are using "zIndex" attribute for a Konva node.
react-konva may get confused with ordering. Just define correct order of elements in your render function of a component.
For more info see: https://github.com/konvajs/react-konva/issues/194
`,TZ={};function om(e,t,n=TZ){if(!EC&&"zIndex"in t&&(console.warn(LZ),EC=!0),!DC&&t.draggable){var o=t.x!==void 0||t.y!==void 0,r=t.onDragEnd||t.onDragMove;o&&!r&&(console.warn(DZ),DC=!0)}for(var l in n)if(!PC[l]){var c=l.slice(0,2)==="on",d=n[l]!==t[l];if(c&&d){var f=l.substr(2).toLowerCase();f.substr(0,7)==="content"&&(f="content"+f.substr(7,1).toUpperCase()+f.substr(8)),e.off(f,n[l])}var m=!t.hasOwnProperty(l);m&&e.setAttr(l,void 0)}var g=t._useStrictMode,p={},x=!1;const y={};for(var l in t)if(!PC[l]){var c=l.slice(0,2)==="on",S=n[l]!==t[l];if(c&&S){var f=l.substr(2).toLowerCase();f.substr(0,7)==="content"&&(f="content"+f.substr(7,1).toUpperCase()+f.substr(8)),t[l]&&(y[f]=t[l])}!c&&(t[l]!==n[l]||g&&t[l]!==e.getAttr(l))&&(x=!0,p[l]=t[l])}x&&(e.setAttrs(p),ol(e));for(var f in y)e.on(f+o1,y[f])}function ol(e){if(!n9.Konva.autoDrawEnabled){var t=e.getLayer()||e.getStage();t&&t.batchDraw()}}const o4={},RZ={};ac.Node.prototype._applyProps=om;function BZ(e,t){if(typeof t=="string"){console.error(`Do not use plain text as child of Konva.Node. You are using text: ${t}`);return}e.add(t),ol(e)}function OZ(e,t,n){let o=ac[e];o||(console.error(`Konva has no node with the type ${e}. Group will be used instead. If you use minimal version of react-konva, just import required nodes into Konva: "import "konva/lib/shapes/${e}"  If you want to render DOM elements as part of canvas tree take a look into this demo: https://konvajs.github.io/docs/react/DOM_Portal.html`),o=ac.Group);const r={},l={};for(var c in t){var d=c.slice(0,2)==="on";d?l[c]=t[c]:r[c]=t[c]}const f=new o(r);return om(f,l),f}function NZ(e,t,n){console.error(`Text components are not supported for now in ReactKonva. Your text is: "${e}"`)}function FZ(e,t,n){return!1}function zZ(e){return e}function HZ(){return null}function $Z(){return null}function VZ(e,t,n,o){return RZ}function WZ(){}function UZ(e){}function GZ(e,t){return!1}function ZZ(){return o4}function qZ(){return o4}const QZ=setTimeout,KZ=clearTimeout,YZ=-1;function XZ(e,t){return!1}const JZ=!1,eq=!0,tq=!0;function nq(e,t){t.parent===e?t.moveToTop():e.add(t),ol(e)}function sq(e,t){t.parent===e?t.moveToTop():e.add(t),ol(e)}function r4(e,t,n){t._remove(),e.add(t),t.setZIndex(n.getZIndex()),ol(e)}function oq(e,t,n){r4(e,t,n)}function rq(e,t){t.destroy(),t.off(o1),ol(e)}function lq(e,t){t.destroy(),t.off(o1),ol(e)}function aq(e,t,n){console.error(`Text components are not yet supported in ReactKonva. You text is: "${n}"`)}function iq(e,t,n){}function cq(e,t,n,o,r){om(e,r,o)}function uq(e){e.hide(),ol(e)}function dq(e){}function fq(e,t){(t.visible==null||t.visible)&&e.show()}function mq(e,t){}function hq(e){}function pq(){}const gq=()=>s4.DefaultEventPriority,xq=Object.freeze(Object.defineProperty({__proto__:null,appendChild:nq,appendChildToContainer:sq,appendInitialChild:BZ,cancelTimeout:KZ,clearContainer:hq,commitMount:iq,commitTextUpdate:aq,commitUpdate:cq,createInstance:OZ,createTextInstance:NZ,detachDeletedInstance:pq,finalizeInitialChildren:FZ,getChildHostContext:qZ,getCurrentEventPriority:gq,getPublicInstance:zZ,getRootHostContext:ZZ,hideInstance:uq,hideTextInstance:dq,idlePriority:fd.unstable_IdlePriority,insertBefore:r4,insertInContainerBefore:oq,isPrimaryRenderer:JZ,noTimeout:YZ,now:fd.unstable_now,prepareForCommit:HZ,preparePortalMount:$Z,prepareUpdate:VZ,removeChild:rq,removeChildFromContainer:lq,resetAfterCommit:WZ,resetTextContent:UZ,run:fd.unstable_runWithPriority,scheduleTimeout:QZ,shouldDeprioritizeSubtree:GZ,shouldSetTextContent:XZ,supportsMutation:tq,unhideInstance:fq,unhideTextInstance:mq,warnsIfNotActing:eq},Symbol.toStringTag,{value:"Module"}));var vq=Object.defineProperty,Cq=Object.defineProperties,yq=Object.getOwnPropertyDescriptors,LC=Object.getOwnPropertySymbols,bq=Object.prototype.hasOwnProperty,jq=Object.prototype.propertyIsEnumerable,TC=(e,t,n)=>t in e?vq(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,RC=(e,t)=>{for(var n in t||(t={}))bq.call(t,n)&&TC(e,n,t[n]);if(LC)for(var n of LC(t))jq.call(t,n)&&TC(e,n,t[n]);return e},Sq=(e,t)=>Cq(e,yq(t));function l4(e,t,n){if(!e)return;if(n(e)===!0)return e;let o=t?e.return:e.child;for(;o;){const r=l4(o,t,n);if(r)return r;o=t?null:o.sibling}}function a4(e){try{return Object.defineProperties(e,{_currentRenderer:{get(){return null},set(){}},_currentRenderer2:{get(){return null},set(){}}})}catch{return e}}const r1=a4(u.createContext(null));class i4 extends u.Component{render(){return u.createElement(r1.Provider,{value:this._reactInternals},this.props.children)}}const{ReactCurrentOwner:BC,ReactCurrentDispatcher:OC}=u.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function kq(){const e=u.useContext(r1);if(e===null)throw new Error("its-fine: useFiber must be called within a <FiberProvider />!");const t=u.useId();return u.useMemo(()=>{for(const o of[BC==null?void 0:BC.current,e,e==null?void 0:e.alternate]){if(!o)continue;const r=l4(o,!1,l=>{let c=l.memoizedState;for(;c;){if(c.memoizedState===t)return!0;c=c.next}});if(r)return r}},[e,t])}function wq(){var e,t;const n=kq(),[o]=u.useState(()=>new Map);o.clear();let r=n;for(;r;){const l=(e=r.type)==null?void 0:e._context;l&&l!==r1&&!o.has(l)&&o.set(l,(t=OC==null?void 0:OC.current)==null?void 0:t.readContext(a4(l))),r=r.return}return o}function Iq(){const e=wq();return u.useMemo(()=>Array.from(e.keys()).reduce((t,n)=>o=>u.createElement(t,null,u.createElement(n.Provider,Sq(RC({},o),{value:e.get(n)}))),t=>u.createElement(i4,RC({},t))),[e])}function Mq(e){const t=te.useRef({});return te.useLayoutEffect(()=>{t.current=e}),te.useLayoutEffect(()=>()=>{t.current={}},[]),t.current}const _q=e=>{const t=te.useRef(),n=te.useRef(),o=te.useRef(),r=Mq(e),l=Iq(),c=d=>{const{forwardedRef:f}=e;f&&(typeof f=="function"?f(d):f.current=d)};return te.useLayoutEffect(()=>(n.current=new ac.Stage({width:e.width,height:e.height,container:t.current}),c(n.current),o.current=Ri.createContainer(n.current,s4.LegacyRoot,!1,null),Ri.updateContainer(te.createElement(l,{},e.children),o.current),()=>{ac.isBrowser&&(c(null),Ri.updateContainer(null,o.current,null),n.current.destroy())}),[]),te.useLayoutEffect(()=>{c(n.current),om(n.current,e,r),Ri.updateContainer(te.createElement(l,{},e.children),o.current,null)}),te.createElement("div",{ref:t,id:e.id,accessKey:e.accessKey,className:e.className,role:e.role,style:e.style,tabIndex:e.tabIndex,title:e.title})},wi="Layer",Lo="Group",To="Rect",xl="Circle",of="Line",c4="Image",Aq="Text",Pq="Transformer",Ri=EZ(xq);Ri.injectIntoDevTools({findHostInstanceByFiber:()=>null,bundleType:0,version:te.version,rendererPackageName:"react-konva"});const Eq=te.forwardRef((e,t)=>te.createElement(i4,{},te.createElement(_q,{...e,forwardedRef:t}))),Dq=Fe(rs,e=>{const{boundingBoxCoordinates:t,boundingBoxDimensions:n,stageDimensions:o,stageCoordinates:r}=e;return{boundingBoxCoordinates:t,boundingBoxDimensions:n,stageCoordinates:r,stageDimensions:o}}),Lq=()=>{const{boundingBoxCoordinates:e,boundingBoxDimensions:t,stageCoordinates:n,stageDimensions:o}=j(Dq),r=j(c=>c.canvas.shouldDarkenOutsideBoundingBox),l=j(c=>c.canvas.stageScale);return s.jsxs(Lo,{listening:!1,children:[s.jsx(To,{offsetX:n.x/l,offsetY:n.y/l,height:o.height/l,width:o.width/l,fill:"rgba(0,0,0,0.4)",listening:!1,visible:r}),s.jsx(To,{x:e.x,y:e.y,width:t.width,height:t.height,fill:"rgb(255,255,255)",listening:!1,visible:r,globalCompositeOperation:"destination-out"})]})},Tq=u.memo(Lq),Rq=Fe(rs,e=>({stageCoordinates:e.stageCoordinates,stageDimensions:e.stageDimensions})),NC=pb(27),FC=pb(18),Bq=()=>{const{stageCoordinates:e,stageDimensions:t}=j(Rq),n=j(c=>c.canvas.stageScale),o=u.useMemo(()=>n>=2?8:n>=1&&n<2?16:n>=.5&&n<1?32:64,[n]),r=u.useCallback(c=>c/n,[n]),l=u.useMemo(()=>{const{width:c,height:d}=t,{x:f,y:m}=e,g={x1:0,y1:0,x2:c,y2:d,offset:{x:r(f),y:r(m)}},p={x:Math.ceil(r(f)/o)*o,y:Math.ceil(r(m)/o)*o},x={x1:-p.x,y1:-p.y,x2:r(c)-p.x+o,y2:r(d)-p.y+o},y={x1:Math.min(g.x1,x.x1),y1:Math.min(g.y1,x.y1),x2:Math.max(g.x2,x.x2),y2:Math.max(g.y2,x.y2)},S=y.x2-y.x1,b=y.y2-y.y1,I=Math.round(S/o)+1,M=Math.round(b/o)+1,w=r(1),_=new Array(I+M);let T=0,D=0;for(let A=0;A<I;A++)T=y.x1+A*o,_.push(s.jsx(of,{x:T,y:y.y1,points:[0,0,0,b],stroke:T%64?FC:NC,strokeWidth:w,listening:!1},`x_${A}`));for(let A=0;A<M;A++)D=y.y1+A*o,_.push(s.jsx(of,{x:y.x1,y:D,points:[0,0,S,0],stroke:D%64?FC:NC,strokeWidth:w,listening:!1},`y_${A}`));return _},[t,e,r,o]);return s.jsx(Lo,{listening:!1,children:l})},Oq=u.memo(Bq),Nq=Fe([Na,rs],(e,t)=>{const{denoiseProgress:n}=e,{batchIds:o}=t;return{progressImage:n&&o.includes(n.batch_id)?n.progress_image:void 0,boundingBox:t.layerState.stagingArea.boundingBox}}),Fq=()=>{const{progressImage:e,boundingBox:t}=j(Nq),[n,o]=u.useState(null);return u.useEffect(()=>{if(!e)return;const r=new Image;r.onload=()=>{o(r)},r.src=e.dataURL},[e]),!(e&&t)||!n?null:s.jsx(c4,{x:t.x,y:t.y,width:t.width,height:t.height,image:n,listening:!1})},zq=u.memo(Fq),_a=e=>{const{r:t,g:n,b:o,a:r}=e;return`rgba(${t}, ${n}, ${o}, ${r})`},zC=e=>`data:image/svg+xml;utf8,<?xml version="1.0" encoding="UTF-8" standalone="no"?>
  <!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
  <svg width="60px" height="60px" viewBox="0 0 30 30" version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" xml:space="preserve" xmlns:serif="http://www.serif.com/" style="fill-rule:evenodd;clip-rule:evenodd;stroke-linecap:round;stroke-linejoin:round;stroke-miterlimit:1.5;">
  <g transform="matrix(0.5,0,0,0.5,0,0)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,2.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,7.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,10)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,12.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,15)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,17.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,20)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,22.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,25)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,27.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,30)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-2.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-7.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-10)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-12.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-15)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-17.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-20)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-22.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-25)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-27.5)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
  <g transform="matrix(0.5,0,0,0.5,0,-30)">
      <path d="M-3.5,63.5L64,-4" style="fill:none;stroke:black;stroke-width:1px;"/>
  </g>
</svg>`.replaceAll("black",e),Hq=Fe(rs,e=>({stageCoordinates:e.stageCoordinates,stageDimensions:e.stageDimensions})),$q=e=>{const{...t}=e,{stageCoordinates:n,stageDimensions:o}=j(Hq),r=j(y=>y.canvas.stageScale),l=j(y=>_a(y.canvas.maskColor)),[c,d]=u.useState(null),[f,m]=u.useState(0),g=u.useRef(null),p=u.useCallback(()=>{m(f+1),setTimeout(p,500)},[f]);u.useEffect(()=>{if(c)return;const y=new Image;y.onload=()=>{d(y)},y.src=zC(l)},[c,l]),u.useEffect(()=>{c&&(c.src=zC(l))},[c,l]),u.useEffect(()=>{const y=setInterval(()=>m(S=>(S+1)%5),50);return()=>clearInterval(y)},[]);const x=u.useMemo(()=>({x:1/r,y:1/r}),[r]);return!c||!ra(n.x)||!ra(n.y)||!ra(r)||!ra(o.width)||!ra(o.height)?null:s.jsx(To,{ref:g,offsetX:n.x/r,offsetY:n.y/r,height:o.height/r,width:o.width/r,fillPatternImage:c,fillPatternOffsetY:ra(f)?f:0,fillPatternRepeat:"repeat",fillPatternScale:x,listening:!0,globalCompositeOperation:"source-in",...t})},Vq=u.memo($q),Wq=e=>{const t=j(n=>n.canvas.layerState.objects);return s.jsx(Lo,{listening:!1,...e,children:t.filter(s9).map((n,o)=>s.jsx(of,{points:n.points,stroke:"rgb(0,0,0)",strokeWidth:n.strokeWidth*2,tension:0,lineCap:"round",lineJoin:"round",shadowForStrokeEnabled:!1,listening:!1,globalCompositeOperation:n.tool==="brush"?"source-over":"destination-out"},o))})},Uq=u.memo(Wq);var vl=u,Gq=function(t,n,o){const r=vl.useRef("loading"),l=vl.useRef(),[c,d]=vl.useState(0),f=vl.useRef(),m=vl.useRef(),g=vl.useRef();return(f.current!==t||m.current!==n||g.current!==o)&&(r.current="loading",l.current=void 0,f.current=t,m.current=n,g.current=o),vl.useLayoutEffect(function(){if(!t)return;var p=document.createElement("img");function x(){r.current="loaded",l.current=p,d(Math.random())}function y(){r.current="failed",l.current=void 0,d(Math.random())}return p.addEventListener("load",x),p.addEventListener("error",y),n&&(p.crossOrigin=n),o&&(p.referrerPolicy=o),p.src=t,function(){p.removeEventListener("load",x),p.removeEventListener("error",y)}},[t,n,o]),[l.current,r.current]};const Zq=ic(Gq),qq=({canvasImage:e})=>{const[t,n]=kf("colors",["base.500","base.900"]),{t:o}=R();return s.jsxs(Lo,{listening:!1,children:[s.jsx(To,{x:e.x,y:e.y,width:e.width,height:e.height,fill:t,listening:!1}),s.jsx(Aq,{x:e.x,y:e.y,width:e.width,height:e.height,align:"center",verticalAlign:"middle",fontFamily:'"Inter Variable", sans-serif',fontSize:e.width/16,fontStyle:"600",text:o("common.imageFailedToLoad"),fill:n,listening:!1})]})},Qq=u.memo(qq),Kq=e=>{const{x:t,y:n,imageName:o}=e.canvasImage,{currentData:r,isError:l}=zs(o??ss),[c,d]=Zq((r==null?void 0:r.image_url)??"",iy.get()?"use-credentials":"anonymous");return l||d==="failed"?s.jsx(Qq,{canvasImage:e.canvasImage}):s.jsx(c4,{x:t,y:n,image:c,listening:!1})},u4=u.memo(Kq),Yq=()=>{const e=j(t=>t.canvas.layerState.objects);return s.jsx(Lo,{name:"outpainting-objects",listening:!1,children:e.map((t,n)=>{if(ly(t))return s.jsx(u4,{canvasImage:t},n);if(o9(t)){const o=s.jsx(of,{points:t.points,stroke:t.color?_a(t.color):"rgb(0,0,0)",strokeWidth:t.strokeWidth*2,tension:0,lineCap:"round",lineJoin:"round",shadowForStrokeEnabled:!1,listening:!1,globalCompositeOperation:t.tool==="brush"?"source-over":"destination-out"},n);return t.clip?s.jsx(Lo,{clipX:t.clip.x,clipY:t.clip.y,clipWidth:t.clip.width,clipHeight:t.clip.height,listening:!1,children:o},n):o}else{if(r9(t))return s.jsx(To,{x:t.x,y:t.y,width:t.width,height:t.height,fill:_a(t.color),listening:!1},n);if(l9(t))return s.jsx(To,{x:t.x,y:t.y,width:t.width,height:t.height,fill:"rgb(255, 255, 255)",globalCompositeOperation:"destination-out",listening:!1},n)}})})},Xq=u.memo(Yq),Jq=[4,4],eQ=Fe(rs,e=>{const{layerState:t,shouldShowStagingImage:n,shouldShowStagingOutline:o,boundingBoxCoordinates:r,boundingBoxDimensions:l}=e,{selectedImageIndex:c,images:d,boundingBox:f}=t.stagingArea;return{currentStagingAreaImage:d.length>0&&c!==void 0?d[c]:void 0,isOnFirstImage:c===0,isOnLastImage:c===d.length-1,shouldShowStagingImage:n,shouldShowStagingOutline:o,x:(f==null?void 0:f.x)??r.x,y:(f==null?void 0:f.y)??r.y,width:(f==null?void 0:f.width)??l.width,height:(f==null?void 0:f.height)??l.height}}),tQ=e=>{const{currentStagingAreaImage:t,shouldShowStagingImage:n,shouldShowStagingOutline:o,x:r,y:l,width:c,height:d}=j(eQ);return s.jsxs(Lo,{...e,children:[n&&t&&s.jsx(u4,{canvasImage:t}),o&&s.jsxs(Lo,{listening:!1,children:[s.jsx(To,{x:r,y:l,width:c,height:d,strokeWidth:1,stroke:"white",strokeScaleEnabled:!1,listening:!1}),s.jsx(To,{x:r,y:l,width:c,height:d,dash:Jq,strokeWidth:1,stroke:"black",strokeScaleEnabled:!1,listening:!1})]})]})},nQ=u.memo(tQ),sQ=Fe(rs,e=>{const{layerState:{stagingArea:{images:t,selectedImageIndex:n}},shouldShowStagingOutline:o,shouldShowStagingImage:r}=e;return{currentIndex:n,total:t.length,currentStagingAreaImage:t.length>0?t[n]:void 0,shouldShowStagingImage:r,shouldShowStagingOutline:o}}),oQ=()=>{const e=J(),{currentStagingAreaImage:t,shouldShowStagingImage:n,currentIndex:o,total:r}=j(sQ),{t:l}=R(),c=u.useCallback(()=>{e(m2(!0))},[e]),d=u.useCallback(()=>{e(m2(!1))},[e]),f=u.useCallback(()=>e(a9()),[e]),m=u.useCallback(()=>e(i9()),[e]),g=u.useCallback(()=>e(c9()),[e]);Oe(["left"],f,{enabled:()=>!0,preventDefault:!0}),Oe(["right"],m,{enabled:()=>!0,preventDefault:!0}),Oe(["enter"],g,{enabled:()=>!0,preventDefault:!0}),Oe(["esc"],()=>{S()},{preventDefault:!0});const{data:p}=zs((t==null?void 0:t.imageName)??ss),x=u.useCallback(()=>{e(u9(!n))},[e,n]),y=u.useCallback(()=>{p&&e(d9({imageDTO:p}))},[e,p]);Oe(["shift+s"],()=>{n&&y()},{preventDefault:!0},[n,y]);const S=u.useCallback(()=>{e(f9())},[e]);return t?s.jsxs(L,{pos:"absolute",bottom:4,gap:2,w:"100%",align:"center",justify:"center",onMouseEnter:c,onMouseLeave:d,children:[s.jsxs(wt,{borderRadius:"base",shadow:"dark-lg",children:[s.jsx(je,{tooltip:`${l("unifiedCanvas.previous")} (Left)`,"aria-label":`${l("unifiedCanvas.previous")} (Left)`,icon:s.jsx(m7,{}),onClick:f,colorScheme:"invokeBlue",isDisabled:!n}),s.jsx(Ge,{colorScheme:"base",pointerEvents:"none",isDisabled:!n,minW:20,children:`${o+1}/${r}`}),s.jsx(je,{tooltip:`${l("unifiedCanvas.next")} (Right)`,"aria-label":`${l("unifiedCanvas.next")} (Right)`,icon:s.jsx(h7,{}),onClick:m,colorScheme:"invokeBlue",isDisabled:!n})]}),s.jsxs(wt,{borderRadius:"base",shadow:"dark-lg",children:[s.jsx(je,{tooltip:`${l("unifiedCanvas.accept")} (Enter)`,"aria-label":`${l("unifiedCanvas.accept")} (Enter)`,icon:s.jsx(Qb,{}),onClick:g,colorScheme:"invokeBlue"}),s.jsx(je,{tooltip:l(n?"unifiedCanvas.showResultsOn":"unifiedCanvas.showResultsOff"),"aria-label":l(n?"unifiedCanvas.showResultsOn":"unifiedCanvas.showResultsOff"),"data-alert":!n,icon:n?s.jsx(k7,{}):s.jsx(w7,{}),onClick:x,colorScheme:"invokeBlue"}),s.jsx(je,{tooltip:`${l("unifiedCanvas.saveToGallery")} (Shift+S)`,"aria-label":l("unifiedCanvas.saveToGallery"),isDisabled:!p||!p.is_intermediate,icon:s.jsx(yc,{}),onClick:y,colorScheme:"invokeBlue"}),s.jsx(je,{tooltip:`${l("unifiedCanvas.discardAll")} (Esc)`,"aria-label":l("unifiedCanvas.discardAll"),icon:s.jsx(oo,{}),onClick:S,colorScheme:"error",fontSize:20})]})]}):null},rQ=u.memo(oQ),va=e=>Math.round(e*100)/100,lQ=()=>{const e=j(d=>d.canvas.layerState),t=j(d=>d.canvas.boundingBoxCoordinates),n=j(d=>d.canvas.boundingBoxDimensions),o=j(d=>d.canvas.isMaskEnabled),r=j(d=>d.canvas.shouldPreserveMaskedArea),[l,c]=u.useState();return u.useEffect(()=>{c(void 0)},[e,t,n,o,r]),uN(async()=>{const d=await m9(e,t,n,o,r);if(!d)return;const{baseImageData:f,maskImageData:m}=d,g=h9(f,m);c(g)},1e3,[e,t,n,o,r]),l},aQ=()=>{const e=lQ(),{t}=R(),n=u.useMemo(()=>({txt2img:t("common.txt2img"),img2img:t("common.img2img"),inpaint:t("common.inpaint"),outpaint:t("common.outpaint")}),[t]);return s.jsxs(We,{children:[t("accessibility.mode"),": ",e?n[e]:"..."]})},iQ=u.memo(aQ),cQ=()=>{const{t:e}=R(),t=gt(z0),n=u.useMemo(()=>{const o=(t==null?void 0:t.x)??-1,r=(t==null?void 0:t.y)??-1;return`(${va(o)}, ${va(r)})`},[t==null?void 0:t.x,t==null?void 0:t.y]);return s.jsx(We,{children:`${e("unifiedCanvas.cursorPosition")}: ${n}`})},uQ=u.memo(cQ),a0="var(--invoke-colors-warning-500)",dQ=Fe(rs,e=>{const{stageDimensions:{width:t,height:n},stageCoordinates:{x:o,y:r},boundingBoxDimensions:{width:l,height:c},scaledBoundingBoxDimensions:{width:d,height:f},boundingBoxCoordinates:{x:m,y:g},stageScale:p,shouldShowCanvasDebugInfo:x,layer:y,boundingBoxScaleMethod:S,shouldPreserveMaskedArea:b}=e;let I="inherit";return(S==="none"&&(l<512||c<512)||S==="manual"&&d*f<512*512)&&(I=a0),{activeLayerColor:y==="mask"?a0:"inherit",layer:y,boundingBoxColor:I,boundingBoxCoordinatesString:`(${va(m)}, ${va(g)})`,boundingBoxDimensionsString:`${l}×${c}`,scaledBoundingBoxDimensionsString:`${d}×${f}`,canvasCoordinatesString:`${va(o)}×${va(r)}`,canvasDimensionsString:`${t}×${n}`,canvasScaleString:Math.round(p*100),shouldShowCanvasDebugInfo:x,shouldShowBoundingBox:S!=="auto",shouldShowScaledBoundingBox:S!=="none",shouldPreserveMaskedArea:b}}),fQ=()=>{const{activeLayerColor:e,layer:t,boundingBoxColor:n,boundingBoxCoordinatesString:o,boundingBoxDimensionsString:r,scaledBoundingBoxDimensionsString:l,shouldShowScaledBoundingBox:c,canvasCoordinatesString:d,canvasDimensionsString:f,canvasScaleString:m,shouldShowCanvasDebugInfo:g,shouldShowBoundingBox:p,shouldPreserveMaskedArea:x}=j(dQ),{t:y}=R();return s.jsxs(L,{flexDirection:"column",position:"absolute",top:0,insetInlineStart:0,opacity:.65,display:"flex",fontSize:"sm",padding:1,px:2,minWidth:48,margin:1,borderRadius:"base",pointerEvents:"none",bg:"base.800",children:[s.jsx(iQ,{}),s.jsx(We,{color:e,children:`${y("unifiedCanvas.activeLayer")}: ${y(`unifiedCanvas.${t}`)}`}),s.jsx(We,{children:`${y("unifiedCanvas.canvasScale")}: ${m}%`}),x&&s.jsxs(We,{color:a0,children:[y("unifiedCanvas.preserveMaskedArea"),": ",y("common.on")]}),p&&s.jsx(We,{color:n,children:`${y("unifiedCanvas.boundingBox")}: ${r}`}),c&&s.jsx(We,{color:n,children:`${y("unifiedCanvas.scaledBoundingBox")}: ${l}`}),g&&s.jsxs(s.Fragment,{children:[s.jsx(We,{children:`${y("unifiedCanvas.boundingBoxPosition")}: ${o}`}),s.jsx(We,{children:`${y("unifiedCanvas.canvasDimensions")}: ${f}`}),s.jsx(We,{children:`${y("unifiedCanvas.canvasPosition")}: ${d}`}),s.jsx(uQ,{})]})]})},mQ=u.memo(fQ),hQ=[4,4],pQ=e=>{const{...t}=e,n=J(),o=j(Ce=>Ce.canvas.boundingBoxCoordinates),r=j(Ce=>Ce.canvas.boundingBoxDimensions),l=j(Ce=>Ce.canvas.stageScale),c=j(Ce=>Ce.canvas.shouldSnapToGrid),d=j(Ce=>20/Ce.canvas.stageScale),f=j(Ce=>Ce.canvas.aspectRatio),m=j(ls),g=u.useRef(null),p=u.useRef(null),x=A0(),y=gt(ln),S=gt(Zi),b=gt(Dr),I=gt(fa),M=gt(ji);u.useEffect(()=>{var Ce;!g.current||!p.current||(g.current.nodes([p.current]),(Ce=g.current.getLayer())==null||Ce.batchDraw())},[]);const w=u.useMemo(()=>x?p9:g9,[x]),_=u.useMemo(()=>w*l,[w,l]);Oe("N",()=>{n(_d(!c))},[c]);const T=u.useCallback(Ce=>{if(!c){n(_h({x:Math.floor(Ce.target.x()),y:Math.floor(Ce.target.y())}));return}const ge=Ce.target.x(),De=Ce.target.y(),Se=Md(ge,w),oe=Md(De,w);Ce.target.x(Se),Ce.target.y(oe),n(_h({x:Se,y:oe}))},[n,w,c]),D=u.useCallback(Ce=>{if(!p.current)return;const ge=p.current,De=ge.scaleX(),Se=ge.scaleY(),oe=Math.round(ge.width()*De),re=Math.round(ge.height()*Se),de=Math.round(ge.x()),P=Math.round(ge.y());if(f.isLocked){const B=ud(f.value,oe*re);n(Ui({width:Bu(B.width,w),height:Bu(B.height,w)},m))}else n(Ui({width:Bu(oe,w),height:Bu(re,w)},m)),n(Gy({isLocked:!1,id:"Free",value:oe/re}));n(_h({x:c?Ou(de,w):de,y:c?Ou(P,w):P})),ge.scaleX(1),ge.scaleY(1)},[f.isLocked,f.value,n,c,w,m]),A=u.useCallback((Ce,ge,De)=>{const Se=Ce.x%_,oe=Ce.y%_;return{x:Ou(ge.x,_)+Se,y:Ou(ge.y,_)+oe}},[_]),F=u.useCallback(()=>{fa.set(!0)},[]),Q=u.useCallback(()=>{fa.set(!1),Dr.set(!1),Ai.set(!1),ji.set(!1)},[]),q=u.useCallback(()=>{Dr.set(!0)},[]),G=u.useCallback(()=>{fa.set(!1),Dr.set(!1),Ai.set(!1),ji.set(!1)},[]),Z=u.useCallback(()=>{ji.set(!0)},[]),N=u.useCallback(()=>{!I&&!b&&ji.set(!1)},[b,I]),z=u.useCallback(()=>{Ai.set(!0)},[]),$=u.useCallback(()=>{Ai.set(!1)},[]),se=u.useMemo(()=>M||b||I?"rgba(255,255,255,0.5)":"white",[M,b,I]),he=u.useMemo(()=>M||b||I?6/l:1/l,[M,b,I,l]),ke=u.useMemo(()=>{if(y!=="move")return xQ;if(f.isLocked)return["bottom-right"]},[f.isLocked,y]);return s.jsxs(Lo,{...t,children:[s.jsx(To,{height:r.height,width:r.width,x:o.x,y:o.y,onMouseEnter:z,onMouseOver:z,onMouseLeave:$,onMouseOut:$}),s.jsx(To,{draggable:!0,fillEnabled:!1,height:r.height,hitStrokeWidth:d,listening:!S&&y==="move",onDragStart:q,onDragEnd:G,onDragMove:T,onMouseDown:q,onMouseOut:N,onMouseOver:Z,onMouseEnter:Z,onMouseUp:G,onTransform:D,onTransformEnd:Q,ref:p,stroke:se,strokeWidth:he,width:r.width,x:o.x,y:o.y}),s.jsx(Pq,{anchorCornerRadius:3,anchorDragBoundFunc:A,anchorFill:"rgba(212,216,234,1)",anchorSize:15,anchorStroke:"rgb(42,42,42)",borderDash:hQ,borderEnabled:!0,borderStroke:"black",draggable:!1,enabledAnchors:ke,flipEnabled:!1,ignoreStroke:!0,keepRatio:!1,listening:!S&&y==="move",onDragStart:q,onDragEnd:G,onMouseDown:F,onMouseUp:Q,onTransformEnd:Q,ref:g,rotateEnabled:!1,shiftBehavior:"none"})]})},gQ=u.memo(pQ),xQ=[],vQ=Fe(rs,e=>{const{stageDimensions:t,boundingBoxCoordinates:n,boundingBoxDimensions:o,shouldRestrictStrokesToBox:r}=e;return{clip:r?{clipX:n.x,clipY:n.y,clipWidth:o.width,clipHeight:o.height}:{},stageDimensions:t}}),CQ=e=>{const t=j(_=>_.canvas.brushSize/2),n=j(_=>_a({..._.canvas.maskColor,a:.5})),o=gt(ln),r=j(_=>_.canvas.layer),l=j(_=>1.5/_.canvas.stageScale),c=j(_=>1.5/_.canvas.stageScale),d=j(_=>_a(_.canvas.brushColor)),f=j(_=>_a(_.canvas.colorPickerColor)),m=j(_=>(h2-Ah+1)/_.canvas.stageScale),g=j(_=>h2/_.canvas.stageScale),{clip:p,stageDimensions:x}=j(vQ),y=gt(z0),S=gt(Dr),b=gt(fa),I=u.useMemo(()=>y?y.x:x.width/2,[y,x]),M=u.useMemo(()=>y?y.y:x.height/2,[y,x]);return u.useMemo(()=>!(S||b||!y),[y,S,b])?s.jsxs(Lo,{listening:!1,...p,...e,children:[o==="colorPicker"?s.jsxs(s.Fragment,{children:[s.jsx(xl,{x:I,y:M,radius:g,stroke:d,strokeWidth:Ah,strokeScaleEnabled:!1,listening:!1}),s.jsx(xl,{x:I,y:M,radius:m,stroke:f,strokeWidth:Ah,strokeScaleEnabled:!1,listening:!1})]}):s.jsxs(s.Fragment,{children:[s.jsx(xl,{x:I,y:M,radius:t,fill:r==="mask"?n:d,globalCompositeOperation:o==="eraser"?"destination-out":"source-out",listening:!1}),s.jsx(xl,{x:I,y:M,radius:t,stroke:"rgba(255,255,255,0.4)",strokeWidth:c*2,strokeEnabled:!0,listening:!1}),s.jsx(xl,{x:I,y:M,radius:t,stroke:"rgba(0,0,0,1)",strokeWidth:c,strokeEnabled:!0,listening:!1})]}),s.jsx(xl,{x:I,y:M,radius:l*2,fill:"rgba(255,255,255,0.4)",listening:!1}),s.jsx(xl,{x:I,y:M,radius:l,fill:"rgba(0,0,0,1)",listening:!1})]}):null},yQ=u.memo(CQ),bQ=Fe(rs,e=>({stageCoordinates:e.stageCoordinates,stageDimensions:e.stageDimensions})),jQ=P0(Eq,{shouldForwardProp:e=>!["sx"].includes(e)}),SQ=()=>{const e=j(ks),t=j(ge=>ge.canvas.isMaskEnabled),n=j(ge=>ge.canvas.shouldShowBoundingBox),o=j(ge=>ge.canvas.shouldShowGrid),r=j(ge=>ge.canvas.stageScale),l=j(ge=>ge.canvas.shouldShowIntermediates),c=j(ge=>ge.canvas.shouldAntialias),d=j(ge=>ge.canvas.shouldRestrictStrokesToBox),{stageCoordinates:f,stageDimensions:m}=j(bQ),g=J(),p=u.useRef(null),x=u.useRef(null),y=u.useRef(null),S=gt(x9),b=gt(Gi),I=gt(fa),M=gt(Ai),w=gt(ln);jZ();const _=u.useCallback(ge=>{Ad.set(ge),x.current=ge},[]),T=u.useMemo(()=>w==="move"||e?b?"grabbing":"grab":I?void 0:d&&!M?"default":"none",[M,b,e,I,d,w]),D=u.useCallback(ge=>{F0.set(ge),y.current=ge},[]),A=u.useRef({x:0,y:0}),F=u.useRef(!1),Q=MZ(x),q=SZ(x),G=IZ(x,F),Z=kZ(x,F,A),{handleDragStart:N,handleDragMove:z,handleDragEnd:$}=yZ(),se=wZ(),he=u.useCallback(ge=>ge.evt.preventDefault(),[]);u.useEffect(()=>{if(!p.current)return;const ge=new ResizeObserver(()=>{if(!p.current)return;const{width:oe,height:re}=p.current.getBoundingClientRect();g(p2({width:oe,height:re}))});ge.observe(p.current);const{width:De,height:Se}=p.current.getBoundingClientRect();return g(p2({width:De,height:Se})),()=>{ge.disconnect()}},[g]);const ke=u.useMemo(()=>({outline:"none",overflow:"hidden",cursor:T||void 0,canvas:{outline:"none"}}),[T]),Ce=u.useMemo(()=>({x:r,y:r}),[r]);return s.jsxs(L,{id:"canvas-container",ref:p,position:"relative",height:"100%",width:"100%",borderRadius:"base",children:[s.jsx(We,{position:"absolute",children:s.jsxs(jQ,{tabIndex:-1,ref:_,sx:ke,x:f.x,y:f.y,width:m.width,height:m.height,scale:Ce,onTouchStart:q,onTouchMove:Z,onTouchEnd:G,onMouseDown:q,onMouseLeave:se,onMouseMove:Z,onMouseUp:G,onDragStart:N,onDragMove:z,onDragEnd:$,onContextMenu:he,onWheel:Q,draggable:(w==="move"||e)&&!S,children:[s.jsx(wi,{id:"grid",visible:o,listening:!1,children:s.jsx(Oq,{})}),s.jsx(wi,{id:"base",ref:D,listening:!1,imageSmoothingEnabled:c,children:s.jsx(Xq,{})}),s.jsxs(wi,{id:"mask",visible:t&&!e,listening:!1,children:[s.jsx(Uq,{visible:!0,listening:!1}),s.jsx(Vq,{listening:!1})]}),s.jsx(wi,{listening:!1,children:s.jsx(Tq,{})}),s.jsxs(wi,{id:"preview",imageSmoothingEnabled:c,children:[!e&&s.jsx(yQ,{visible:w!=="move",listening:!1}),s.jsx(nQ,{listening:!1,visible:e}),l&&s.jsx(zq,{}),s.jsx(gQ,{visible:n&&!e})]})]})}),s.jsx(mQ,{}),s.jsx(rQ,{})]})},kQ=u.memo(SQ);function wQ({onSingleClick:e,onDoubleClick:t,latency:n=250}){const[o,r]=u.useState(0);return u.useEffect(()=>{const c=setTimeout(()=>{o===1&&e(),r(0)},n);return o===2&&t(),()=>clearTimeout(c)},[o,t,n,e]),u.useCallback(()=>r(c=>c+1),[])}const dp={width:6,height:6,borderColor:"base.100"},IQ={".react-colorful__hue-pointer":dp,".react-colorful__saturation-pointer":dp,".react-colorful__alpha-pointer":dp,gap:2,flexDir:"column"},MQ={width:"100%"},rd="4.2rem",_Q=e=>{const{color:t,onChange:n,withNumberInput:o,...r}=e,{t:l}=R(),c=u.useCallback(g=>n({...t,r:g}),[t,n]),d=u.useCallback(g=>n({...t,g}),[t,n]),f=u.useCallback(g=>n({...t,b:g}),[t,n]),m=u.useCallback(g=>n({...t,a:g}),[t,n]);return s.jsxs(L,{sx:IQ,children:[s.jsx(bk,{color:t,onChange:n,style:MQ,...r}),o&&s.jsxs(L,{children:[s.jsxs(U,{children:[s.jsx(Y,{children:l("common.red")}),s.jsx($e,{value:t.r,onChange:c,min:0,max:255,step:1,w:rd,defaultValue:90})]}),s.jsxs(U,{children:[s.jsx(Y,{children:l("common.green")}),s.jsx($e,{value:t.g,onChange:d,min:0,max:255,step:1,w:rd,defaultValue:90})]}),s.jsxs(U,{children:[s.jsx(Y,{children:l("common.blue")}),s.jsx($e,{value:t.b,onChange:f,min:0,max:255,step:1,w:rd,defaultValue:255})]}),s.jsxs(U,{children:[s.jsx(Y,{children:l("common.alpha")}),s.jsx($e,{value:t.a,onChange:m,step:.1,min:0,max:1,w:rd,defaultValue:1})]})]})]})},d4=u.memo(_Q),AQ={flexGrow:1},PQ=()=>{const e=J(),{t}=R(),n=j(y=>y.canvas.layer),o=j(y=>y.canvas.maskColor),r=j(y=>y.canvas.isMaskEnabled),l=j(y=>y.canvas.shouldPreserveMaskedArea),c=j(ks);Oe(["q"],()=>{d()},{enabled:()=>!c,preventDefault:!0},[n]),Oe(["shift+c"],()=>{f()},{enabled:()=>!c,preventDefault:!0},[]),Oe(["h"],()=>{m()},{enabled:()=>!c,preventDefault:!0},[r]);const d=u.useCallback(()=>{e(gb(n==="mask"?"base":"mask"))},[e,n]),f=u.useCallback(()=>{e(mb())},[e]),m=u.useCallback(()=>{e(N0(!r))},[e,r]),g=u.useCallback(async()=>{e(v9())},[e]),p=u.useCallback(y=>{e(C9(y.target.checked))},[e]),x=u.useCallback(y=>{e(y9(y))},[e]);return s.jsxs(Zr,{isLazy:!0,children:[s.jsx(za,{children:s.jsx(je,{"aria-label":t("unifiedCanvas.maskingOptions"),tooltip:t("unifiedCanvas.maskingOptions"),icon:s.jsx(Kb,{}),isChecked:n==="mask",isDisabled:c})}),s.jsx(qr,{children:s.jsx(Qr,{children:s.jsxs(L,{direction:"column",gap:2,children:[s.jsxs(wn,{formLabelProps:AQ,children:[s.jsxs(U,{children:[s.jsx(Y,{children:`${t("unifiedCanvas.enableMask")} (H)`}),s.jsx(jn,{isChecked:r,onChange:m})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("unifiedCanvas.preserveMaskedArea")}),s.jsx(jn,{isChecked:l,onChange:p})]})]}),s.jsx(We,{pt:2,pb:2,children:s.jsx(d4,{color:o,onChange:x})}),s.jsxs(wt,{isAttached:!1,children:[s.jsx(Ge,{size:"sm",leftIcon:s.jsx(q7,{}),onClick:g,children:t("unifiedCanvas.saveMask")}),s.jsx(Ge,{size:"sm",leftIcon:s.jsx(bc,{}),onClick:f,children:t("unifiedCanvas.clearMask")})]})]})})})]})},EQ=u.memo(PQ),DQ=()=>{const e=J(),t=j(l=>l.canvas.futureLayerStates.length>0),n=j(js),{t:o}=R(),r=u.useCallback(()=>{e(b9())},[e]);return Oe(["meta+shift+z","ctrl+shift+z","control+y","meta+y"],()=>{r()},{enabled:()=>t,preventDefault:!0},[n,t]),s.jsx(je,{"aria-label":`${o("unifiedCanvas.redo")} (Ctrl+Shift+Z)`,tooltip:`${o("unifiedCanvas.redo")} (Ctrl+Shift+Z)`,icon:s.jsx(f7,{}),onClick:r,isDisabled:!t})},LQ=u.memo(DQ),TQ=()=>{const e=j(ks),t=J(),{t:n}=R(),{isOpen:o,onOpen:r,onClose:l}=an(),c=u.useCallback(()=>t(j9()),[t]);return s.jsxs(s.Fragment,{children:[s.jsx(Ge,{onClick:r,size:"sm",leftIcon:s.jsx(bc,{}),isDisabled:e,children:n("unifiedCanvas.clearCanvasHistory")}),s.jsxs(Gr,{isOpen:o,onClose:l,title:n("unifiedCanvas.clearCanvasHistory"),acceptCallback:c,acceptButtonText:n("unifiedCanvas.clearHistory"),children:[s.jsx("p",{children:n("unifiedCanvas.clearCanvasHistoryMessage")}),s.jsx("br",{}),s.jsx("p",{children:n("unifiedCanvas.clearCanvasHistoryConfirm")})]})]})},RQ=u.memo(TQ),BQ={flexGrow:1},OQ=()=>{const e=J(),{t}=R(),n=j(T=>T.canvas.shouldAutoSave),o=j(T=>T.canvas.shouldCropToBoundingBoxOnSave),r=j(T=>T.canvas.shouldDarkenOutsideBoundingBox),l=j(T=>T.canvas.shouldShowCanvasDebugInfo),c=j(T=>T.canvas.shouldShowGrid),d=j(T=>T.canvas.shouldShowIntermediates),f=j(T=>T.canvas.shouldSnapToGrid),m=j(T=>T.canvas.shouldRestrictStrokesToBox),g=j(T=>T.canvas.shouldAntialias);Oe(["n"],()=>{e(_d(!f))},{enabled:!0,preventDefault:!0},[f]);const p=u.useCallback(T=>e(_d(T.target.checked)),[e]),x=u.useCallback(T=>e(S9(T.target.checked)),[e]),y=u.useCallback(T=>e(k9(T.target.checked)),[e]),S=u.useCallback(T=>e(w9(T.target.checked)),[e]),b=u.useCallback(T=>e(I9(T.target.checked)),[e]),I=u.useCallback(T=>e(M9(T.target.checked)),[e]),M=u.useCallback(T=>e(_9(T.target.checked)),[e]),w=u.useCallback(T=>e(A9(T.target.checked)),[e]),_=u.useCallback(T=>e(P9(T.target.checked)),[e]);return s.jsxs(Zr,{children:[s.jsx(za,{children:s.jsx(je,{tooltip:t("unifiedCanvas.canvasSettings"),"aria-label":t("unifiedCanvas.canvasSettings"),icon:s.jsx(_7,{})})}),s.jsx(qr,{children:s.jsx(Qr,{children:s.jsxs(L,{direction:"column",gap:2,children:[s.jsxs(wn,{formLabelProps:BQ,children:[s.jsxs(U,{children:[s.jsx(Y,{children:t("unifiedCanvas.showIntermediates")}),s.jsx(jn,{isChecked:d,onChange:x})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("unifiedCanvas.showGrid")}),s.jsx(jn,{isChecked:c,onChange:y})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("unifiedCanvas.snapToGrid")}),s.jsx(jn,{isChecked:f,onChange:p})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("unifiedCanvas.darkenOutsideSelection")}),s.jsx(jn,{isChecked:r,onChange:S})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("unifiedCanvas.autoSaveToGallery")}),s.jsx(jn,{isChecked:n,onChange:b})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("unifiedCanvas.saveBoxRegionOnly")}),s.jsx(jn,{isChecked:o,onChange:I})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("unifiedCanvas.limitStrokesToBox")}),s.jsx(jn,{isChecked:m,onChange:M})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("unifiedCanvas.showCanvasDebugInfo")}),s.jsx(jn,{isChecked:l,onChange:w})]}),s.jsxs(U,{children:[s.jsx(Y,{children:t("unifiedCanvas.antialiasing")}),s.jsx(jn,{isChecked:g,onChange:_})]})]}),s.jsx(RQ,{})]})})})]})},NQ=u.memo(OQ),FQ=[1,25,50,75,100],zQ=()=>{const e=J(),t=gt(ln),n=j(y=>y.canvas.brushColor),o=j(y=>y.canvas.brushSize),r=j(ks),{t:l}=R();Oe(["b"],()=>{c()},{enabled:()=>!r,preventDefault:!0},[]),Oe(["e"],()=>{d()},{enabled:()=>!r,preventDefault:!0},[t]),Oe(["c"],()=>{f()},{enabled:()=>!r,preventDefault:!0},[t]),Oe(["shift+f"],()=>{m()},{enabled:()=>!r,preventDefault:!0}),Oe(["delete","backspace"],()=>{g()},{enabled:()=>!r,preventDefault:!0}),Oe(["BracketLeft"],()=>{o-5<=5?e(_i(Math.max(o-1,1))):e(_i(Math.max(o-5,1)))},{enabled:()=>!r,preventDefault:!0},[o]),Oe(["BracketRight"],()=>{e(_i(Math.min(o+5,500)))},{enabled:()=>!r,preventDefault:!0},[o]),Oe(["Shift+BracketLeft"],()=>{e(Ph({...n,a:Xo(n.a-.05,.05,1)}))},{enabled:()=>!r,preventDefault:!0},[n]),Oe(["Shift+BracketRight"],()=>{e(Ph({...n,a:Xo(n.a+.05,.05,1)}))},{enabled:()=>!r,preventDefault:!0},[n]);const c=u.useCallback(()=>{ln.set("brush"),dd()},[]),d=u.useCallback(()=>{ln.set("eraser"),dd()},[]),f=u.useCallback(()=>{ln.set("colorPicker"),dd()},[]),m=u.useCallback(()=>{e(E9())},[e]),g=u.useCallback(()=>{e(D9())},[e]),p=u.useCallback(y=>{e(_i(y))},[e]),x=u.useCallback(y=>{e(Ph(y))},[e]);return s.jsxs(wt,{children:[s.jsx(je,{"aria-label":`${l("unifiedCanvas.brush")} (B)`,tooltip:`${l("unifiedCanvas.brush")} (B)`,icon:s.jsx(W7,{}),isChecked:t==="brush"&&!r,onClick:c,isDisabled:r}),s.jsx(je,{"aria-label":`${l("unifiedCanvas.eraser")} (E)`,tooltip:`${l("unifiedCanvas.eraser")} (E)`,icon:s.jsx(S7,{}),isChecked:t==="eraser"&&!r,isDisabled:r,onClick:d}),s.jsx(je,{"aria-label":`${l("unifiedCanvas.fillBoundingBox")} (Shift+F)`,tooltip:`${l("unifiedCanvas.fillBoundingBox")} (Shift+F)`,icon:s.jsx(U7,{}),isDisabled:r,onClick:m}),s.jsx(je,{"aria-label":`${l("unifiedCanvas.eraseBoundingBox")} (Del/Backspace)`,tooltip:`${l("unifiedCanvas.eraseBoundingBox")} (Del/Backspace)`,icon:s.jsx(oo,{}),isDisabled:r,onClick:g}),s.jsx(je,{"aria-label":`${l("unifiedCanvas.colorPicker")} (C)`,tooltip:`${l("unifiedCanvas.colorPicker")} (C)`,icon:s.jsx(I7,{}),isChecked:t==="colorPicker"&&!r,isDisabled:r,onClick:f}),s.jsxs(Zr,{children:[s.jsx(za,{children:s.jsx(je,{"aria-label":l("unifiedCanvas.brushOptions"),tooltip:l("unifiedCanvas.brushOptions"),icon:s.jsx(tj,{})})}),s.jsx(qr,{children:s.jsx(Qr,{children:s.jsxs(L,{minWidth:60,direction:"column",gap:4,width:"100%",children:[s.jsx(L,{gap:4,justifyContent:"space-between",children:s.jsxs(U,{children:[s.jsx(Y,{children:l("unifiedCanvas.brushSize")}),s.jsx(Ue,{value:o,min:1,max:100,step:1,onChange:p,marks:FQ,defaultValue:50}),s.jsx($e,{value:o,min:1,max:500,step:1,onChange:p,defaultValue:50})]})}),s.jsx(We,{w:"full",pt:2,pb:2,children:s.jsx(d4,{color:n,onChange:x,withNumberInput:!0})})]})})})]})]})},HQ=u.memo(zQ),$Q=()=>{const e=J(),{t}=R(),n=j(js),o=j(l=>l.canvas.pastLayerStates.length>0),r=u.useCallback(()=>{e(L9())},[e]);return Oe(["meta+z","ctrl+z"],()=>{r()},{enabled:()=>o,preventDefault:!0},[n,o]),s.jsx(je,{"aria-label":`${t("unifiedCanvas.undo")} (Ctrl+Z)`,tooltip:`${t("unifiedCanvas.undo")} (Ctrl+Z)`,icon:s.jsx(vc,{}),onClick:r,isDisabled:!o})},VQ=u.memo($Q),WQ=()=>{const e=J(),t=j(D=>D.canvas.isMaskEnabled),n=j(D=>D.canvas.layer),o=gt(ln),r=j(ks),{t:l}=R(),{isClipboardAPIAvailable:c}=DS(),{getUploadButtonProps:d,getUploadInputProps:f}=Pg({postUploadAction:{type:"SET_CANVAS_INITIAL_IMAGE"}});Oe(["v"],()=>{m()},{enabled:()=>!r,preventDefault:!0},[]),Oe(["r"],()=>{g()},{enabled:()=>!0,preventDefault:!0},[]),Oe(["shift+m"],()=>{b()},{enabled:()=>!r,preventDefault:!0},[]),Oe(["shift+s"],()=>{!r&&I()},{enabled:!0,preventDefault:!0},[r]),Oe(["meta+c","ctrl+c"],()=>{M()},{enabled:()=>!r&&c,preventDefault:!0},[c]),Oe(["shift+d"],()=>{w()},{enabled:()=>!r,preventDefault:!0},[]);const m=u.useCallback(()=>{ln.set("move")},[]),g=u.useCallback((D=!1)=>{const A=F0.get();if(!A)return;const F=A.getClientRect({skipTransform:!0});e(T9({contentRect:F,shouldScaleTo1:D}))},[e]),p=u.useCallback(()=>{g(!1)},[g]),x=u.useCallback(()=>{g(!0)},[g]),y=wQ({onSingleClick:p,onDoubleClick:x}),S=u.useCallback(()=>{e(Ly())},[e]),b=u.useCallback(()=>{e(R9())},[e]),I=u.useCallback(()=>{e(B9())},[e]),M=u.useCallback(()=>{c&&e(O9())},[e,c]),w=u.useCallback(()=>{e(N9())},[e]),_=u.useCallback(D=>{D&&(e(gb(D.value)),D.value==="mask"&&!t&&e(N0(!0)))},[e,t]),T=u.useMemo(()=>g2.filter(D=>D.value===n)[0],[n]);return s.jsxs(L,{alignItems:"center",gap:2,flexWrap:"wrap",children:[s.jsx(jt,{label:`${l("unifiedCanvas.layer")} (Q)`,children:s.jsx(U,{isDisabled:r,w:"5rem",children:s.jsx(Xe,{value:T,options:g2,onChange:_})})}),s.jsx(EQ,{}),s.jsx(HQ,{}),s.jsxs(wt,{children:[s.jsx(je,{"aria-label":`${l("unifiedCanvas.move")} (V)`,tooltip:`${l("unifiedCanvas.move")} (V)`,icon:s.jsx(P7,{}),isChecked:o==="move"||r,onClick:m}),s.jsx(je,{"aria-label":`${l("unifiedCanvas.resetView")} (R)`,tooltip:`${l("unifiedCanvas.resetView")} (R)`,icon:s.jsx(b7,{}),onClick:y})]}),s.jsxs(wt,{children:[s.jsx(je,{"aria-label":`${l("unifiedCanvas.mergeVisible")} (Shift+M)`,tooltip:`${l("unifiedCanvas.mergeVisible")} (Shift+M)`,icon:s.jsx(Z7,{}),onClick:b,isDisabled:r}),s.jsx(je,{"aria-label":`${l("unifiedCanvas.saveToGallery")} (Shift+S)`,tooltip:`${l("unifiedCanvas.saveToGallery")} (Shift+S)`,icon:s.jsx(yc,{}),onClick:I,isDisabled:r}),c&&s.jsx(je,{"aria-label":`${l("unifiedCanvas.copyToClipboard")} (Cmd/Ctrl+C)`,tooltip:`${l("unifiedCanvas.copyToClipboard")} (Cmd/Ctrl+C)`,icon:s.jsx(el,{}),onClick:M,isDisabled:r}),s.jsx(je,{"aria-label":`${l("unifiedCanvas.downloadAsImage")} (Shift+D)`,tooltip:`${l("unifiedCanvas.downloadAsImage")} (Shift+D)`,icon:s.jsx(Cc,{}),onClick:w,isDisabled:r})]}),s.jsxs(wt,{children:[s.jsx(VQ,{}),s.jsx(LQ,{})]}),s.jsxs(wt,{children:[s.jsx(je,{"aria-label":`${l("common.upload")}`,tooltip:`${l("common.upload")}`,icon:s.jsx(_f,{}),isDisabled:r,...d()}),s.jsx("input",{...f()}),s.jsx(je,{"aria-label":`${l("unifiedCanvas.clearCanvas")}`,tooltip:`${l("unifiedCanvas.clearCanvas")}`,icon:s.jsx(Vs,{}),onClick:S,colorScheme:"error",isDisabled:r})]}),s.jsx(wt,{children:s.jsx(NQ,{})})]})},UQ=u.memo(WQ),HC={id:"canvas-intial-image",actionType:"SET_CANVAS_INITIAL_IMAGE"},GQ=()=>{const{t:e}=R(),{isOver:t,setNodeRef:n,active:o}=$j({id:"unifiedCanvas",data:HC});return s.jsxs(L,{layerStyle:"first",ref:n,flexDirection:"column",alignItems:"center",gap:4,p:2,borderRadius:"base",w:"full",h:"full","data-testid":F9,children:[s.jsx(UQ,{}),s.jsx(kQ,{}),Vj(HC,o)&&s.jsx(Wj,{isOver:t,label:e("toast.setCanvasInitialImage")})]})},ZQ=u.memo(GQ),qQ=[{id:"txt2img",translationKey:"common.txt2img",icon:s.jsx(IE,{}),content:s.jsx(hw,{})},{id:"img2img",translationKey:"common.img2img",icon:s.jsx(EE,{}),content:s.jsx(TH,{})},{id:"unifiedCanvas",translationKey:"common.unifiedCanvas",icon:s.jsx(wE,{}),content:s.jsx(ZQ,{})},{id:"nodes",translationKey:"common.nodes",icon:s.jsx(If,{}),content:s.jsx(wG,{})},{id:"modelManager",translationKey:"modelManager.modelManager",icon:s.jsx(DE,{}),content:s.jsx(gV,{})},{id:"queue",translationKey:"queue.queue",icon:s.jsx(zj,{}),content:s.jsx(CZ,{})}],QQ=Fe(z9,e=>qQ.filter(t=>!e.disabledTabs.includes(t.id))),KQ=["modelManager","queue"],YQ=["modelManager","queue"],XQ={height:"100%",width:"100%"},JQ=310,eK=20,tK=430,nK=20,sK="app-panel-group",oK=()=>{const e=j(H9),t=j(js),n=j(QQ),{t:o}=R(),r=J(),l=gt($9),c=u.useRef(null),d=u.useCallback(w=>{w.target instanceof HTMLElement&&w.target.blur()},[]),f=u.useMemo(()=>!YQ.includes(t),[t]),m=u.useMemo(()=>!KQ.includes(t),[t]),g=u.useMemo(()=>n.map(w=>s.jsx(jt,{label:o(w.translationKey),placement:"end",children:s.jsx(hn,{as:je,p:0,onClick:d,icon:w.icon,size:"md",fontSize:"24px",variant:"appTab","data-selected":t===w.id,"aria-label":o(w.translationKey),"data-testid":o(w.translationKey)})},w.id)),[n,o,d,t]),p=u.useMemo(()=>n.map(w=>s.jsx(An,{children:w.content},w.id)),[n]),x=u.useCallback(w=>{const _=n[w];_&&r(jo(_.id))},[r,n]),y=u.useMemo(()=>({unit:"pixels",minSize:tK,fallbackMinSizePct:nK,panelGroupRef:c,panelGroupDirection:"horizontal"}),[]),S=u.useMemo(()=>({unit:"pixels",minSize:JQ,fallbackMinSizePct:eK,panelGroupRef:c,panelGroupDirection:"horizontal"}),[]),b=Tg(),I=Dv(y),M=Dv(S);return Oe("g",M.toggle,[M.toggle]),Oe(["t","o"],I.toggle,[I.toggle]),Oe("shift+r",()=>{I.reset(),M.reset()},[I.reset,M.reset]),Oe("f",()=>{I.isCollapsed||M.isCollapsed?(I.expand(),M.expand()):(I.collapse(),M.collapse())},[I.isCollapsed,M.isCollapsed,I.expand,M.expand,I.collapse,M.collapse]),s.jsxs(Xr,{id:"invoke-app-tabs",variant:"appTabs",defaultIndex:e,index:e,onChange:x,w:"full",h:"full",gap:4,p:4,isLazy:!0,children:[s.jsxs(L,{flexDir:"column",alignItems:"center",pt:4,pb:2,gap:4,children:[s.jsx(JB,{}),s.jsx(Jr,{gap:4,pt:6,h:"full",flexDir:"column",children:g}),s.jsx(Cs,{}),s.jsx(gO,{}),l||s.jsx(hO,{})]}),s.jsxs(Kf,{ref:c,id:sK,autoSaveId:"app",direction:"horizontal",style:XQ,storage:b,children:[f&&s.jsxs(s.Fragment,{children:[s.jsx(Fr,{id:"options-panel",ref:I.ref,order:0,defaultSize:I.minSize,minSize:I.minSize,onCollapse:I.onCollapse,onExpand:I.onExpand,collapsible:!0,children:t==="nodes"?s.jsx(KB,{}):s.jsx(qz,{})}),s.jsx(Yd,{id:"options-main-handle",onDoubleClick:I.onDoubleClickHandle,orientation:"vertical"})]}),s.jsx(Fr,{id:"main-panel",order:1,minSize:20,children:s.jsx(Rl,{w:"full",h:"full",children:p})}),m&&s.jsxs(s.Fragment,{children:[s.jsx(Yd,{id:"main-gallery-handle",orientation:"vertical",onDoubleClick:M.onDoubleClickHandle}),s.jsx(Fr,{id:"gallery-panel",ref:M.ref,order:2,defaultSize:M.minSize,minSize:M.minSize,onCollapse:M.onCollapse,onExpand:M.onExpand,collapsible:!0,children:s.jsx(ET,{})})]})]}),f&&s.jsx(jO,{panelApi:I}),m&&s.jsx(vO,{panelApi:M})]})},rK=u.memo(oK),lK=u.createContext(null),fp={didCatch:!1,error:null};class aK extends u.Component{constructor(t){super(t),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=fp}static getDerivedStateFromError(t){return{didCatch:!0,error:t}}resetErrorBoundary(){const{error:t}=this.state;if(t!==null){for(var n,o,r=arguments.length,l=new Array(r),c=0;c<r;c++)l[c]=arguments[c];(n=(o=this.props).onReset)===null||n===void 0||n.call(o,{args:l,reason:"imperative-api"}),this.setState(fp)}}componentDidCatch(t,n){var o,r;(o=(r=this.props).onError)===null||o===void 0||o.call(r,t,n)}componentDidUpdate(t,n){const{didCatch:o}=this.state,{resetKeys:r}=this.props;if(o&&n.error!==null&&iK(t.resetKeys,r)){var l,c;(l=(c=this.props).onReset)===null||l===void 0||l.call(c,{next:r,prev:t.resetKeys,reason:"keys"}),this.setState(fp)}}render(){const{children:t,fallbackRender:n,FallbackComponent:o,fallback:r}=this.props,{didCatch:l,error:c}=this.state;let d=t;if(l){const f={error:c,resetErrorBoundary:this.resetErrorBoundary};if(typeof n=="function")d=n(f);else if(o)d=u.createElement(o,f);else if(r===null||u.isValidElement(r))d=r;else throw c}return u.createElement(lK.Provider,{value:{didCatch:l,error:c,resetErrorBoundary:this.resetErrorBoundary}},d)}}function iK(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return e.length!==t.length||e.some((n,o)=>!Object.is(n,t[o]))}function cK(e={}){let t;if(e.repoUrl)t=e.repoUrl;else if(e.user&&e.repo)t=`https://github.com/${e.user}/${e.repo}`;else throw new Error("You need to specify either the `repoUrl` option or both the `user` and `repo` options");const n=new URL(`${t}/issues/new`),o=["body","title","labels","template","milestone","assignee","projects"];for(const r of o){let l=e[r];if(l!==void 0){if(r==="labels"||r==="projects"){if(!Array.isArray(l))throw new TypeError(`The \`${r}\` option should be an array`);l=l.join(",")}n.searchParams.set(r,l)}}return n.toString()}const uK=({error:e,resetErrorBoundary:t})=>{const n=Oa(),{t:o}=R(),r=u.useCallback(()=>{const c=JSON.stringify(V9(e),null,2);navigator.clipboard.writeText(`\`\`\`
${c}
\`\`\``),n({title:"Error Copied"})},[e,n]),l=u.useMemo(()=>cK({user:"invoke-ai",repo:"InvokeAI",template:"BUG_REPORT.yml",title:`[bug]: ${e.name}: ${e.message}`}),[e.message,e.name]);return s.jsx(L,{layerStyle:"body",w:"100vw",h:"100vh",alignItems:"center",justifyContent:"center",p:4,children:s.jsxs(L,{layerStyle:"first",flexDir:"column",borderRadius:"base",justifyContent:"center",gap:8,p:16,children:[s.jsx(ns,{children:o("common.somethingWentWrong")}),s.jsx(L,{layerStyle:"second",px:8,py:4,gap:4,borderRadius:"base",justifyContent:"space-between",alignItems:"center",children:s.jsxs(pe,{fontWeight:"semibold",color:"error.400",children:[e.name,": ",e.message]})}),s.jsxs(L,{gap:4,children:[s.jsx(Ge,{leftIcon:s.jsx(vc,{}),onClick:t,children:o("accessibility.resetUI")}),s.jsx(Ge,{leftIcon:s.jsx(el,{}),onClick:r,children:o("common.copyError")}),s.jsx(W9,{href:l,isExternal:!0,children:s.jsx(Ge,{leftIcon:s.jsx(Ub,{}),children:o("accessibility.createIssue")})})]})]})})},dK=u.memo(uK),fK=e=>{const t=J(),{recallAllParameters:n}=_c(),o=j(ls),r=ao(),{currentData:l}=zs((e==null?void 0:e.imageName)??ss),{currentData:c}=yy((e==null?void 0:e.imageName)??ss),d=u.useCallback(()=>{l&&(t(by(l,o)),t(jo("unifiedCanvas")),r({title:Zo("toast.sentToUnifiedCanvas"),status:"info",duration:2500,isClosable:!0}))},[l,t,o,r]),f=u.useCallback(()=>{l&&t(Cf(l))},[t,l]),m=u.useCallback(()=>{c&&n(c)},[c]);return u.useEffect(()=>{e&&e.action==="sendToCanvas"&&d()},[e,d]),u.useEffect(()=>{e&&e.action==="sendToImg2Img"&&f()},[e,f]),u.useEffect(()=>{e&&e.action==="useAllParameters"&&m()},[e,m]),{handleSendToCanvas:d,handleSendToImg2Img:f,handleUseAllMetadata:m}},mK=e=>(fK(e.selectedImage),null),hK=u.memo(mK),pK={},gK=({config:e=pK,selectedImage:t})=>{const n=j(kE),o=yb("system"),r=J(),l=Ib();U9(),G9(),YA();const{dropzone:c,isHandlingUpload:d,setIsHandlingUpload:f}=QA(),m=u.useCallback(()=>(l(),location.reload(),!1),[l]);return u.useEffect(()=>{nn.changeLanguage(n)},[n]),u.useEffect(()=>{$y(e)&&(o.info({config:e},"Received config"),r(Z9(e)))},[r,e,o]),u.useEffect(()=>{r(q9())},[r]),s.jsxs(aK,{onReset:m,FallbackComponent:dK,children:[s.jsxs(We,{id:"invoke-app-wrapper",w:"100vw",h:"100vh",position:"relative",overflow:"hidden",...c.getRootProps(),children:[s.jsx("input",{...c.getInputProps()}),s.jsx(rK,{}),s.jsx(Aa,{children:c.isDragActive&&d&&s.jsx(G_,{dropzone:c,setIsHandlingUpload:f})})]}),s.jsx(o7,{}),s.jsx(e7,{}),s.jsx(Fj,{}),s.jsx(q_,{}),s.jsx(hK,{selectedImage:t})]})},CK=u.memo(gK);export{CK as default};
